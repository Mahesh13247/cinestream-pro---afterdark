var ox=s=>{throw TypeError(s)};var mm=(s,e,t)=>e.has(s)||ox("Cannot "+t);var le=(s,e,t)=>(mm(s,e,"read from private field"),t?t.call(s):e.get(s)),Ze=(s,e,t)=>e.has(s)?ox("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),Pe=(s,e,t,i)=>(mm(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),Ts=(s,e,t)=>(mm(s,e,"access private method"),t);var md=(s,e,t,i)=>({set _(n){Pe(s,e,n,t)},get _(){return le(s,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();function sp(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var gm={exports:{}},zo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lx;function AL(){if(lx)return zo;lx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,n,a){var o=null;if(a!==void 0&&(o=""+a),n.key!==void 0&&(o=""+n.key),"key"in n){a={};for(var c in n)c!=="key"&&(a[c]=n[c])}else a=n;return n=a.ref,{$$typeof:s,type:i,key:o,ref:n!==void 0?n:null,props:a}}return zo.Fragment=e,zo.jsx=t,zo.jsxs=t,zo}var cx;function _L(){return cx||(cx=1,gm.exports=AL()),gm.exports}var E=_L(),pm={exports:{}},Be={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dx;function LL(){if(dx)return Be;dx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),p=Symbol.iterator;function T(O){return O===null||typeof O!="object"?null:(O=p&&O[p]||O["@@iterator"],typeof O=="function"?O:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,A={};function R(O,G,de){this.props=O,this.context=G,this.refs=A,this.updater=de||y}R.prototype.isReactComponent={},R.prototype.setState=function(O,G){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,G,"setState")},R.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function C(){}C.prototype=R.prototype;function I(O,G,de){this.props=O,this.context=G,this.refs=A,this.updater=de||y}var D=I.prototype=new C;D.constructor=I,S(D,R.prototype),D.isPureReactComponent=!0;var k=Array.isArray;function z(){}var P={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function $(O,G,de){var pe=de.ref;return{$$typeof:s,type:O,key:G,ref:pe!==void 0?pe:null,props:de}}function j(O,G){return $(O.type,G,O.props)}function te(O){return typeof O=="object"&&O!==null&&O.$$typeof===s}function ge(O){var G={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(de){return G[de]})}var ye=/\/+/g;function ve(O,G){return typeof O=="object"&&O!==null&&O.key!=null?ge(""+O.key):G.toString(36)}function ue(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(z,z):(O.status="pending",O.then(function(G){O.status==="pending"&&(O.status="fulfilled",O.value=G)},function(G){O.status==="pending"&&(O.status="rejected",O.reason=G)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function F(O,G,de,pe,Te){var Ae=typeof O;(Ae==="undefined"||Ae==="boolean")&&(O=null);var ke=!1;if(O===null)ke=!0;else switch(Ae){case"bigint":case"string":case"number":ke=!0;break;case"object":switch(O.$$typeof){case s:case e:ke=!0;break;case m:return ke=O._init,F(ke(O._payload),G,de,pe,Te)}}if(ke)return Te=Te(O),ke=pe===""?"."+ve(O,0):pe,k(Te)?(de="",ke!=null&&(de=ke.replace(ye,"$&/")+"/"),F(Te,G,de,"",function(xs){return xs})):Te!=null&&(te(Te)&&(Te=j(Te,de+(Te.key==null||O&&O.key===Te.key?"":(""+Te.key).replace(ye,"$&/")+"/")+ke)),G.push(Te)),1;ke=0;var st=pe===""?".":pe+":";if(k(O))for(var Je=0;Je<O.length;Je++)pe=O[Je],Ae=st+ve(pe,Je),ke+=F(pe,G,de,Ae,Te);else if(Je=T(O),typeof Je=="function")for(O=Je.call(O),Je=0;!(pe=O.next()).done;)pe=pe.value,Ae=st+ve(pe,Je++),ke+=F(pe,G,de,Ae,Te);else if(Ae==="object"){if(typeof O.then=="function")return F(ue(O),G,de,pe,Te);throw G=String(O),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return ke}function J(O,G,de){if(O==null)return O;var pe=[],Te=0;return F(O,pe,"","",function(Ae){return G.call(de,Ae,Te++)}),pe}function se(O){if(O._status===-1){var G=O._result;G=G(),G.then(function(de){(O._status===0||O._status===-1)&&(O._status=1,O._result=de)},function(de){(O._status===0||O._status===-1)&&(O._status=2,O._result=de)}),O._status===-1&&(O._status=0,O._result=G)}if(O._status===1)return O._result.default;throw O._result}var ne=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},xe={map:J,forEach:function(O,G,de){J(O,function(){G.apply(this,arguments)},de)},count:function(O){var G=0;return J(O,function(){G++}),G},toArray:function(O){return J(O,function(G){return G})||[]},only:function(O){if(!te(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Be.Activity=g,Be.Children=xe,Be.Component=R,Be.Fragment=t,Be.Profiler=n,Be.PureComponent=I,Be.StrictMode=i,Be.Suspense=f,Be.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Be.__COMPILER_RUNTIME={__proto__:null,c:function(O){return P.H.useMemoCache(O)}},Be.cache=function(O){return function(){return O.apply(null,arguments)}},Be.cacheSignal=function(){return null},Be.cloneElement=function(O,G,de){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var pe=S({},O.props),Te=O.key;if(G!=null)for(Ae in G.key!==void 0&&(Te=""+G.key),G)!V.call(G,Ae)||Ae==="key"||Ae==="__self"||Ae==="__source"||Ae==="ref"&&G.ref===void 0||(pe[Ae]=G[Ae]);var Ae=arguments.length-2;if(Ae===1)pe.children=de;else if(1<Ae){for(var ke=Array(Ae),st=0;st<Ae;st++)ke[st]=arguments[st+2];pe.children=ke}return $(O.type,Te,pe)},Be.createContext=function(O){return O={$$typeof:o,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:a,_context:O},O},Be.createElement=function(O,G,de){var pe,Te={},Ae=null;if(G!=null)for(pe in G.key!==void 0&&(Ae=""+G.key),G)V.call(G,pe)&&pe!=="key"&&pe!=="__self"&&pe!=="__source"&&(Te[pe]=G[pe]);var ke=arguments.length-2;if(ke===1)Te.children=de;else if(1<ke){for(var st=Array(ke),Je=0;Je<ke;Je++)st[Je]=arguments[Je+2];Te.children=st}if(O&&O.defaultProps)for(pe in ke=O.defaultProps,ke)Te[pe]===void 0&&(Te[pe]=ke[pe]);return $(O,Ae,Te)},Be.createRef=function(){return{current:null}},Be.forwardRef=function(O){return{$$typeof:c,render:O}},Be.isValidElement=te,Be.lazy=function(O){return{$$typeof:m,_payload:{_status:-1,_result:O},_init:se}},Be.memo=function(O,G){return{$$typeof:d,type:O,compare:G===void 0?null:G}},Be.startTransition=function(O){var G=P.T,de={};P.T=de;try{var pe=O(),Te=P.S;Te!==null&&Te(de,pe),typeof pe=="object"&&pe!==null&&typeof pe.then=="function"&&pe.then(z,ne)}catch(Ae){ne(Ae)}finally{G!==null&&de.types!==null&&(G.types=de.types),P.T=G}},Be.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Be.use=function(O){return P.H.use(O)},Be.useActionState=function(O,G,de){return P.H.useActionState(O,G,de)},Be.useCallback=function(O,G){return P.H.useCallback(O,G)},Be.useContext=function(O){return P.H.useContext(O)},Be.useDebugValue=function(){},Be.useDeferredValue=function(O,G){return P.H.useDeferredValue(O,G)},Be.useEffect=function(O,G){return P.H.useEffect(O,G)},Be.useEffectEvent=function(O){return P.H.useEffectEvent(O)},Be.useId=function(){return P.H.useId()},Be.useImperativeHandle=function(O,G,de){return P.H.useImperativeHandle(O,G,de)},Be.useInsertionEffect=function(O,G){return P.H.useInsertionEffect(O,G)},Be.useLayoutEffect=function(O,G){return P.H.useLayoutEffect(O,G)},Be.useMemo=function(O,G){return P.H.useMemo(O,G)},Be.useOptimistic=function(O,G){return P.H.useOptimistic(O,G)},Be.useReducer=function(O,G,de){return P.H.useReducer(O,G,de)},Be.useRef=function(O){return P.H.useRef(O)},Be.useState=function(O){return P.H.useState(O)},Be.useSyncExternalStore=function(O,G,de){return P.H.useSyncExternalStore(O,G,de)},Be.useTransition=function(){return P.H.useTransition()},Be.version="19.2.0",Be}var fx;function ip(){return fx||(fx=1,pm.exports=LL()),pm.exports}var U=ip();const RL=sp(U);var bm={exports:{}},Yo={},Em={exports:{}},ym={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hx;function IL(){return hx||(hx=1,(function(s){function e(F,J){var se=F.length;F.push(J);e:for(;0<se;){var ne=se-1>>>1,xe=F[ne];if(0<n(xe,J))F[ne]=J,F[se]=xe,se=ne;else break e}}function t(F){return F.length===0?null:F[0]}function i(F){if(F.length===0)return null;var J=F[0],se=F.pop();if(se!==J){F[0]=se;e:for(var ne=0,xe=F.length,O=xe>>>1;ne<O;){var G=2*(ne+1)-1,de=F[G],pe=G+1,Te=F[pe];if(0>n(de,se))pe<xe&&0>n(Te,de)?(F[ne]=Te,F[pe]=se,ne=pe):(F[ne]=de,F[G]=se,ne=G);else if(pe<xe&&0>n(Te,se))F[ne]=Te,F[pe]=se,ne=pe;else break e}}return J}function n(F,J){var se=F.sortIndex-J.sortIndex;return se!==0?se:F.id-J.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();s.unstable_now=function(){return o.now()-c}}var f=[],d=[],m=1,g=null,p=3,T=!1,y=!1,S=!1,A=!1,R=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function D(F){for(var J=t(d);J!==null;){if(J.callback===null)i(d);else if(J.startTime<=F)i(d),J.sortIndex=J.expirationTime,e(f,J);else break;J=t(d)}}function k(F){if(S=!1,D(F),!y)if(t(f)!==null)y=!0,z||(z=!0,ge());else{var J=t(d);J!==null&&ue(k,J.startTime-F)}}var z=!1,P=-1,V=5,$=-1;function j(){return A?!0:!(s.unstable_now()-$<V)}function te(){if(A=!1,z){var F=s.unstable_now();$=F;var J=!0;try{e:{y=!1,S&&(S=!1,C(P),P=-1),T=!0;var se=p;try{t:{for(D(F),g=t(f);g!==null&&!(g.expirationTime>F&&j());){var ne=g.callback;if(typeof ne=="function"){g.callback=null,p=g.priorityLevel;var xe=ne(g.expirationTime<=F);if(F=s.unstable_now(),typeof xe=="function"){g.callback=xe,D(F),J=!0;break t}g===t(f)&&i(f),D(F)}else i(f);g=t(f)}if(g!==null)J=!0;else{var O=t(d);O!==null&&ue(k,O.startTime-F),J=!1}}break e}finally{g=null,p=se,T=!1}J=void 0}}finally{J?ge():z=!1}}}var ge;if(typeof I=="function")ge=function(){I(te)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,ve=ye.port2;ye.port1.onmessage=te,ge=function(){ve.postMessage(null)}}else ge=function(){R(te,0)};function ue(F,J){P=R(function(){F(s.unstable_now())},J)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(F){F.callback=null},s.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<F?Math.floor(1e3/F):5},s.unstable_getCurrentPriorityLevel=function(){return p},s.unstable_next=function(F){switch(p){case 1:case 2:case 3:var J=3;break;default:J=p}var se=p;p=J;try{return F()}finally{p=se}},s.unstable_requestPaint=function(){A=!0},s.unstable_runWithPriority=function(F,J){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var se=p;p=F;try{return J()}finally{p=se}},s.unstable_scheduleCallback=function(F,J,se){var ne=s.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?ne+se:ne):se=ne,F){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=se+xe,F={id:m++,callback:J,priorityLevel:F,startTime:se,expirationTime:xe,sortIndex:-1},se>ne?(F.sortIndex=se,e(d,F),t(f)===null&&F===t(d)&&(S?(C(P),P=-1):S=!0,ue(k,se-ne))):(F.sortIndex=xe,e(f,F),y||T||(y=!0,z||(z=!0,ge()))),F},s.unstable_shouldYield=j,s.unstable_wrapCallback=function(F){var J=p;return function(){var se=p;p=J;try{return F.apply(this,arguments)}finally{p=se}}}})(ym)),ym}var mx;function CL(){return mx||(mx=1,Em.exports=IL()),Em.exports}var xm={exports:{}},vs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gx;function NL(){if(gx)return vs;gx=1;var s=ip();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},n=Symbol.for("react.portal");function a(f,d,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:g==null?null:""+g,children:f,containerInfo:d,implementation:m}}var o=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return vs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,vs.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(f,d,null,m)},vs.flushSync=function(f){var d=o.T,m=i.p;try{if(o.T=null,i.p=2,f)return f()}finally{o.T=d,i.p=m,i.d.f()}},vs.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(f,d))},vs.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},vs.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,g=c(m,d.crossOrigin),p=typeof d.integrity=="string"?d.integrity:void 0,T=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?i.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:p,fetchPriority:T}):m==="script"&&i.d.X(f,{crossOrigin:g,integrity:p,fetchPriority:T,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},vs.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);i.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(f)},vs.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,g=c(m,d.crossOrigin);i.d.L(f,m,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},vs.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=c(d.as,d.crossOrigin);i.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(f)},vs.requestFormReset=function(f){i.d.r(f)},vs.unstable_batchedUpdates=function(f,d){return f(d)},vs.useFormState=function(f,d,m){return o.H.useFormState(f,d,m)},vs.useFormStatus=function(){return o.H.useHostTransitionStatus()},vs.version="19.2.0",vs}var px;function DL(){if(px)return xm.exports;px=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),xm.exports=NL(),xm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bx;function wL(){if(bx)return Yo;bx=1;var s=CL(),e=ip(),t=DL();function i(r){var u="https://react.dev/errors/"+r;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)u+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var u=r,l=r;if(r.alternate)for(;u.return;)u=u.return;else{r=u;do u=r,(u.flags&4098)!==0&&(l=u.return),r=u.return;while(r)}return u.tag===3?l:null}function o(r){if(r.tag===13){var u=r.memoizedState;if(u===null&&(r=r.alternate,r!==null&&(u=r.memoizedState)),u!==null)return u.dehydrated}return null}function c(r){if(r.tag===31){var u=r.memoizedState;if(u===null&&(r=r.alternate,r!==null&&(u=r.memoizedState)),u!==null)return u.dehydrated}return null}function f(r){if(a(r)!==r)throw Error(i(188))}function d(r){var u=r.alternate;if(!u){if(u=a(r),u===null)throw Error(i(188));return u!==r?null:r}for(var l=r,h=u;;){var b=l.return;if(b===null)break;var x=b.alternate;if(x===null){if(h=b.return,h!==null){l=h;continue}break}if(b.child===x.child){for(x=b.child;x;){if(x===l)return f(b),r;if(x===h)return f(b),u;x=x.sibling}throw Error(i(188))}if(l.return!==h.return)l=b,h=x;else{for(var _=!1,N=b.child;N;){if(N===l){_=!0,l=b,h=x;break}if(N===h){_=!0,h=b,l=x;break}N=N.sibling}if(!_){for(N=x.child;N;){if(N===l){_=!0,l=x,h=b;break}if(N===h){_=!0,h=x,l=b;break}N=N.sibling}if(!_)throw Error(i(189))}}if(l.alternate!==h)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:u}function m(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r;for(r=r.child;r!==null;){if(u=m(r),u!==null)return u;r=r.sibling}return null}var g=Object.assign,p=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),I=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function ge(r){return r===null||typeof r!="object"?null:(r=te&&r[te]||r["@@iterator"],typeof r=="function"?r:null)}var ye=Symbol.for("react.client.reference");function ve(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===ye?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case S:return"Fragment";case R:return"Profiler";case A:return"StrictMode";case k:return"Suspense";case z:return"SuspenseList";case $:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case y:return"Portal";case I:return r.displayName||"Context";case C:return(r._context.displayName||"Context")+".Consumer";case D:var u=r.render;return r=r.displayName,r||(r=u.displayName||u.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return u=r.displayName||null,u!==null?u:ve(r.type)||"Memo";case V:u=r._payload,r=r._init;try{return ve(r(u))}catch{}}return null}var ue=Array.isArray,F=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se={pending:!1,data:null,method:null,action:null},ne=[],xe=-1;function O(r){return{current:r}}function G(r){0>xe||(r.current=ne[xe],ne[xe]=null,xe--)}function de(r,u){xe++,ne[xe]=r.current,r.current=u}var pe=O(null),Te=O(null),Ae=O(null),ke=O(null);function st(r,u){switch(de(Ae,u),de(Te,r),de(pe,null),u.nodeType){case 9:case 11:r=(r=u.documentElement)&&(r=r.namespaceURI)?Dy(r):0;break;default:if(r=u.tagName,u=u.namespaceURI)u=Dy(u),r=wy(u,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}G(pe),de(pe,r)}function Je(){G(pe),G(Te),G(Ae)}function xs(r){r.memoizedState!==null&&de(ke,r);var u=pe.current,l=wy(u,r.type);u!==l&&(de(Te,r),de(pe,l))}function di(r){Te.current===r&&(G(pe),G(Te)),ke.current===r&&(G(ke),$o._currentValue=se)}var Xu,Ia;function Ri(r){if(Xu===void 0)try{throw Error()}catch(l){var u=l.stack.trim().match(/\n( *(at )?)/);Xu=u&&u[1]||"",Ia=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Xu+r+Ia}var Kl=!1;function Ke(r,u){if(!r||Kl)return"";Kl=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(u){var he=function(){throw Error()};if(Object.defineProperty(he.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(he,[])}catch(re){var ee=re}Reflect.construct(r,[],he)}else{try{he.call()}catch(re){ee=re}r.call(he.prototype)}}else{try{throw Error()}catch(re){ee=re}(he=r())&&typeof he.catch=="function"&&he.catch(function(){})}}catch(re){if(re&&ee&&typeof re.stack=="string")return[re.stack,ee.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=h.DetermineComponentFrameRoot(),_=x[0],N=x[1];if(_&&N){var H=_.split(`
`),Z=N.split(`
`);for(b=h=0;h<H.length&&!H[h].includes("DetermineComponentFrameRoot");)h++;for(;b<Z.length&&!Z[b].includes("DetermineComponentFrameRoot");)b++;if(h===H.length||b===Z.length)for(h=H.length-1,b=Z.length-1;1<=h&&0<=b&&H[h]!==Z[b];)b--;for(;1<=h&&0<=b;h--,b--)if(H[h]!==Z[b]){if(h!==1||b!==1)do if(h--,b--,0>b||H[h]!==Z[b]){var oe=`
`+H[h].replace(" at new "," at ");return r.displayName&&oe.includes("<anonymous>")&&(oe=oe.replace("<anonymous>",r.displayName)),oe}while(1<=h&&0<=b);break}}}finally{Kl=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?Ri(l):""}function ts(r,u){switch(r.tag){case 26:case 27:case 5:return Ri(r.type);case 16:return Ri("Lazy");case 13:return r.child!==u&&u!==null?Ri("Suspense Fallback"):Ri("Suspense");case 19:return Ri("SuspenseList");case 0:case 15:return Ke(r.type,!1);case 11:return Ke(r.type.render,!1);case 1:return Ke(r.type,!0);case 31:return Ri("Activity");default:return""}}function _s(r){try{var u="",l=null;do u+=ts(r,l),l=r,r=r.return;while(r);return u}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Ii=Object.prototype.hasOwnProperty,Ls=s.unstable_scheduleCallback,ji=s.unstable_cancelCallback,dn=s.unstable_shouldYield,Ql=s.unstable_requestPaint,ss=s.unstable_now,Xl=s.unstable_getCurrentPriorityLevel,qn=s.unstable_ImmediatePriority,Wu=s.unstable_UserBlockingPriority,Ca=s.unstable_NormalPriority,Wl=s.unstable_LowPriority,Zu=s.unstable_IdlePriority,Fr=s.log,u_=s.unstable_setDisableYieldValue,Ju=null,Xs=null;function Vn(r){if(typeof Fr=="function"&&u_(r),Xs&&typeof Xs.setStrictMode=="function")try{Xs.setStrictMode(Ju,r)}catch{}}var Ws=Math.clz32?Math.clz32:c_,o_=Math.log,l_=Math.LN2;function c_(r){return r>>>=0,r===0?32:31-(o_(r)/l_|0)|0}var Zl=256,Jl=262144,ec=4194304;function Hr(r){var u=r&42;if(u!==0)return u;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function tc(r,u,l){var h=r.pendingLanes;if(h===0)return 0;var b=0,x=r.suspendedLanes,_=r.pingedLanes;r=r.warmLanes;var N=h&134217727;return N!==0?(h=N&~x,h!==0?b=Hr(h):(_&=N,_!==0?b=Hr(_):l||(l=N&~r,l!==0&&(b=Hr(l))))):(N=h&~x,N!==0?b=Hr(N):_!==0?b=Hr(_):l||(l=h&~r,l!==0&&(b=Hr(l)))),b===0?0:u!==0&&u!==b&&(u&x)===0&&(x=b&-b,l=u&-u,x>=l||x===32&&(l&4194048)!==0)?u:b}function eo(r,u){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&u)===0}function d_(r,u){switch(r){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function f1(){var r=ec;return ec<<=1,(ec&62914560)===0&&(ec=4194304),r}function sh(r){for(var u=[],l=0;31>l;l++)u.push(r);return u}function to(r,u){r.pendingLanes|=u,u!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function f_(r,u,l,h,b,x){var _=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var N=r.entanglements,H=r.expirationTimes,Z=r.hiddenUpdates;for(l=_&~l;0<l;){var oe=31-Ws(l),he=1<<oe;N[oe]=0,H[oe]=-1;var ee=Z[oe];if(ee!==null)for(Z[oe]=null,oe=0;oe<ee.length;oe++){var re=ee[oe];re!==null&&(re.lane&=-536870913)}l&=~he}h!==0&&h1(r,h,0),x!==0&&b===0&&r.tag!==0&&(r.suspendedLanes|=x&~(_&~u))}function h1(r,u,l){r.pendingLanes|=u,r.suspendedLanes&=~u;var h=31-Ws(u);r.entangledLanes|=u,r.entanglements[h]=r.entanglements[h]|1073741824|l&261930}function m1(r,u){var l=r.entangledLanes|=u;for(r=r.entanglements;l;){var h=31-Ws(l),b=1<<h;b&u|r[h]&u&&(r[h]|=u),l&=~b}}function g1(r,u){var l=u&-u;return l=(l&42)!==0?1:ih(l),(l&(r.suspendedLanes|u))!==0?0:l}function ih(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function nh(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function p1(){var r=J.p;return r!==0?r:(r=window.event,r===void 0?32:tx(r.type))}function b1(r,u){var l=J.p;try{return J.p=r,u()}finally{J.p=l}}var zn=Math.random().toString(36).slice(2),fs="__reactFiber$"+zn,ws="__reactProps$"+zn,Na="__reactContainer$"+zn,rh="__reactEvents$"+zn,h_="__reactListeners$"+zn,m_="__reactHandles$"+zn,E1="__reactResources$"+zn,so="__reactMarker$"+zn;function ah(r){delete r[fs],delete r[ws],delete r[rh],delete r[h_],delete r[m_]}function Da(r){var u=r[fs];if(u)return u;for(var l=r.parentNode;l;){if(u=l[Na]||l[fs]){if(l=u.alternate,u.child!==null||l!==null&&l.child!==null)for(r=Fy(r);r!==null;){if(l=r[fs])return l;r=Fy(r)}return u}r=l,l=r.parentNode}return null}function wa(r){if(r=r[fs]||r[Na]){var u=r.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return r}return null}function io(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r.stateNode;throw Error(i(33))}function Oa(r){var u=r[E1];return u||(u=r[E1]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function is(r){r[so]=!0}var y1=new Set,x1={};function jr(r,u){ka(r,u),ka(r+"Capture",u)}function ka(r,u){for(x1[r]=u,r=0;r<u.length;r++)y1.add(u[r])}var g_=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),T1={},v1={};function p_(r){return Ii.call(v1,r)?!0:Ii.call(T1,r)?!1:g_.test(r)?v1[r]=!0:(T1[r]=!0,!1)}function sc(r,u,l){if(p_(u))if(l===null)r.removeAttribute(u);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(u);return;case"boolean":var h=u.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){r.removeAttribute(u);return}}r.setAttribute(u,""+l)}}function ic(r,u,l){if(l===null)r.removeAttribute(u);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttribute(u,""+l)}}function fn(r,u,l,h){if(h===null)r.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(u,l,""+h)}}function fi(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function S1(r){var u=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function b_(r,u,l){var h=Object.getOwnPropertyDescriptor(r.constructor.prototype,u);if(!r.hasOwnProperty(u)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var b=h.get,x=h.set;return Object.defineProperty(r,u,{configurable:!0,get:function(){return b.call(this)},set:function(_){l=""+_,x.call(this,_)}}),Object.defineProperty(r,u,{enumerable:h.enumerable}),{getValue:function(){return l},setValue:function(_){l=""+_},stopTracking:function(){r._valueTracker=null,delete r[u]}}}}function uh(r){if(!r._valueTracker){var u=S1(r)?"checked":"value";r._valueTracker=b_(r,u,""+r[u])}}function A1(r){if(!r)return!1;var u=r._valueTracker;if(!u)return!0;var l=u.getValue(),h="";return r&&(h=S1(r)?r.checked?"true":"false":r.value),r=h,r!==l?(u.setValue(r),!0):!1}function nc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var E_=/[\n"\\]/g;function hi(r){return r.replace(E_,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function oh(r,u,l,h,b,x,_,N){r.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?r.type=_:r.removeAttribute("type"),u!=null?_==="number"?(u===0&&r.value===""||r.value!=u)&&(r.value=""+fi(u)):r.value!==""+fi(u)&&(r.value=""+fi(u)):_!=="submit"&&_!=="reset"||r.removeAttribute("value"),u!=null?lh(r,_,fi(u)):l!=null?lh(r,_,fi(l)):h!=null&&r.removeAttribute("value"),b==null&&x!=null&&(r.defaultChecked=!!x),b!=null&&(r.checked=b&&typeof b!="function"&&typeof b!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?r.name=""+fi(N):r.removeAttribute("name")}function _1(r,u,l,h,b,x,_,N){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(r.type=x),u!=null||l!=null){if(!(x!=="submit"&&x!=="reset"||u!=null)){uh(r);return}l=l!=null?""+fi(l):"",u=u!=null?""+fi(u):l,N||u===r.value||(r.value=u),r.defaultValue=u}h=h??b,h=typeof h!="function"&&typeof h!="symbol"&&!!h,r.checked=N?r.checked:!!h,r.defaultChecked=!!h,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(r.name=_),uh(r)}function lh(r,u,l){u==="number"&&nc(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function Ma(r,u,l,h){if(r=r.options,u){u={};for(var b=0;b<l.length;b++)u["$"+l[b]]=!0;for(l=0;l<r.length;l++)b=u.hasOwnProperty("$"+r[l].value),r[l].selected!==b&&(r[l].selected=b),b&&h&&(r[l].defaultSelected=!0)}else{for(l=""+fi(l),u=null,b=0;b<r.length;b++){if(r[b].value===l){r[b].selected=!0,h&&(r[b].defaultSelected=!0);return}u!==null||r[b].disabled||(u=r[b])}u!==null&&(u.selected=!0)}}function L1(r,u,l){if(u!=null&&(u=""+fi(u),u!==r.value&&(r.value=u),l==null)){r.defaultValue!==u&&(r.defaultValue=u);return}r.defaultValue=l!=null?""+fi(l):""}function R1(r,u,l,h){if(u==null){if(h!=null){if(l!=null)throw Error(i(92));if(ue(h)){if(1<h.length)throw Error(i(93));h=h[0]}l=h}l==null&&(l=""),u=l}l=fi(u),r.defaultValue=l,h=r.textContent,h===l&&h!==""&&h!==null&&(r.value=h),uh(r)}function Pa(r,u){if(u){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=u;return}}r.textContent=u}var y_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function I1(r,u,l){var h=u.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?h?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="":h?r.setProperty(u,l):typeof l!="number"||l===0||y_.has(u)?u==="float"?r.cssFloat=l:r[u]=(""+l).trim():r[u]=l+"px"}function C1(r,u,l){if(u!=null&&typeof u!="object")throw Error(i(62));if(r=r.style,l!=null){for(var h in l)!l.hasOwnProperty(h)||u!=null&&u.hasOwnProperty(h)||(h.indexOf("--")===0?r.setProperty(h,""):h==="float"?r.cssFloat="":r[h]="");for(var b in u)h=u[b],u.hasOwnProperty(b)&&l[b]!==h&&I1(r,b,h)}else for(var x in u)u.hasOwnProperty(x)&&I1(r,x,u[x])}function ch(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var x_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),T_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function rc(r){return T_.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function hn(){}var dh=null;function fh(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ua=null,Ba=null;function N1(r){var u=wa(r);if(u&&(r=u.stateNode)){var l=r[ws]||null;e:switch(r=u.stateNode,u.type){case"input":if(oh(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),u=l.name,l.type==="radio"&&u!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+hi(""+u)+'"][type="radio"]'),u=0;u<l.length;u++){var h=l[u];if(h!==r&&h.form===r.form){var b=h[ws]||null;if(!b)throw Error(i(90));oh(h,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(u=0;u<l.length;u++)h=l[u],h.form===r.form&&A1(h)}break e;case"textarea":L1(r,l.value,l.defaultValue);break e;case"select":u=l.value,u!=null&&Ma(r,!!l.multiple,u,!1)}}}var hh=!1;function D1(r,u,l){if(hh)return r(u,l);hh=!0;try{var h=r(u);return h}finally{if(hh=!1,(Ua!==null||Ba!==null)&&(zc(),Ua&&(u=Ua,r=Ba,Ba=Ua=null,N1(u),r)))for(u=0;u<r.length;u++)N1(r[u])}}function no(r,u){var l=r.stateNode;if(l===null)return null;var h=l[ws]||null;if(h===null)return null;l=h[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,u,typeof l));return l}var mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mh=!1;if(mn)try{var ro={};Object.defineProperty(ro,"passive",{get:function(){mh=!0}}),window.addEventListener("test",ro,ro),window.removeEventListener("test",ro,ro)}catch{mh=!1}var Yn=null,gh=null,ac=null;function w1(){if(ac)return ac;var r,u=gh,l=u.length,h,b="value"in Yn?Yn.value:Yn.textContent,x=b.length;for(r=0;r<l&&u[r]===b[r];r++);var _=l-r;for(h=1;h<=_&&u[l-h]===b[x-h];h++);return ac=b.slice(r,1<h?1-h:void 0)}function uc(r){var u=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&u===13&&(r=13)):r=u,r===10&&(r=13),32<=r||r===13?r:0}function oc(){return!0}function O1(){return!1}function Os(r){function u(l,h,b,x,_){this._reactName=l,this._targetInst=b,this.type=h,this.nativeEvent=x,this.target=_,this.currentTarget=null;for(var N in r)r.hasOwnProperty(N)&&(l=r[N],this[N]=l?l(x):x[N]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?oc:O1,this.isPropagationStopped=O1,this}return g(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=oc)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=oc)},persist:function(){},isPersistent:oc}),u}var $r={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lc=Os($r),ao=g({},$r,{view:0,detail:0}),v_=Os(ao),ph,bh,uo,cc=g({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yh,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==uo&&(uo&&r.type==="mousemove"?(ph=r.screenX-uo.screenX,bh=r.screenY-uo.screenY):bh=ph=0,uo=r),ph)},movementY:function(r){return"movementY"in r?r.movementY:bh}}),k1=Os(cc),S_=g({},cc,{dataTransfer:0}),A_=Os(S_),__=g({},ao,{relatedTarget:0}),Eh=Os(__),L_=g({},$r,{animationName:0,elapsedTime:0,pseudoElement:0}),R_=Os(L_),I_=g({},$r,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),C_=Os(I_),N_=g({},$r,{data:0}),M1=Os(N_),D_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},w_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function k_(r){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(r):(r=O_[r])?!!u[r]:!1}function yh(){return k_}var M_=g({},ao,{key:function(r){if(r.key){var u=D_[r.key]||r.key;if(u!=="Unidentified")return u}return r.type==="keypress"?(r=uc(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?w_[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yh,charCode:function(r){return r.type==="keypress"?uc(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?uc(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),P_=Os(M_),U_=g({},cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),P1=Os(U_),B_=g({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yh}),F_=Os(B_),H_=g({},$r,{propertyName:0,elapsedTime:0,pseudoElement:0}),j_=Os(H_),$_=g({},cc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),G_=Os($_),q_=g({},$r,{newState:0,oldState:0}),V_=Os(q_),z_=[9,13,27,32],xh=mn&&"CompositionEvent"in window,oo=null;mn&&"documentMode"in document&&(oo=document.documentMode);var Y_=mn&&"TextEvent"in window&&!oo,U1=mn&&(!xh||oo&&8<oo&&11>=oo),B1=" ",F1=!1;function H1(r,u){switch(r){case"keyup":return z_.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function j1(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Fa=!1;function K_(r,u){switch(r){case"compositionend":return j1(u);case"keypress":return u.which!==32?null:(F1=!0,B1);case"textInput":return r=u.data,r===B1&&F1?null:r;default:return null}}function Q_(r,u){if(Fa)return r==="compositionend"||!xh&&H1(r,u)?(r=w1(),ac=gh=Yn=null,Fa=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return U1&&u.locale!=="ko"?null:u.data;default:return null}}var X_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $1(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u==="input"?!!X_[r.type]:u==="textarea"}function G1(r,u,l,h){Ua?Ba?Ba.push(h):Ba=[h]:Ua=h,u=Jc(u,"onChange"),0<u.length&&(l=new lc("onChange","change",null,l,h),r.push({event:l,listeners:u}))}var lo=null,co=null;function W_(r){_y(r,0)}function dc(r){var u=io(r);if(A1(u))return r}function q1(r,u){if(r==="change")return u}var V1=!1;if(mn){var Th;if(mn){var vh="oninput"in document;if(!vh){var z1=document.createElement("div");z1.setAttribute("oninput","return;"),vh=typeof z1.oninput=="function"}Th=vh}else Th=!1;V1=Th&&(!document.documentMode||9<document.documentMode)}function Y1(){lo&&(lo.detachEvent("onpropertychange",K1),co=lo=null)}function K1(r){if(r.propertyName==="value"&&dc(co)){var u=[];G1(u,co,r,fh(r)),D1(W_,u)}}function Z_(r,u,l){r==="focusin"?(Y1(),lo=u,co=l,lo.attachEvent("onpropertychange",K1)):r==="focusout"&&Y1()}function J_(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return dc(co)}function e6(r,u){if(r==="click")return dc(u)}function t6(r,u){if(r==="input"||r==="change")return dc(u)}function s6(r,u){return r===u&&(r!==0||1/r===1/u)||r!==r&&u!==u}var Zs=typeof Object.is=="function"?Object.is:s6;function fo(r,u){if(Zs(r,u))return!0;if(typeof r!="object"||r===null||typeof u!="object"||u===null)return!1;var l=Object.keys(r),h=Object.keys(u);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var b=l[h];if(!Ii.call(u,b)||!Zs(r[b],u[b]))return!1}return!0}function Q1(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function X1(r,u){var l=Q1(r);r=0;for(var h;l;){if(l.nodeType===3){if(h=r+l.textContent.length,r<=u&&h>=u)return{node:l,offset:u-r};r=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Q1(l)}}function W1(r,u){return r&&u?r===u?!0:r&&r.nodeType===3?!1:u&&u.nodeType===3?W1(r,u.parentNode):"contains"in r?r.contains(u):r.compareDocumentPosition?!!(r.compareDocumentPosition(u)&16):!1:!1}function Z1(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var u=nc(r.document);u instanceof r.HTMLIFrameElement;){try{var l=typeof u.contentWindow.location.href=="string"}catch{l=!1}if(l)r=u.contentWindow;else break;u=nc(r.document)}return u}function Sh(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u&&(u==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||u==="textarea"||r.contentEditable==="true")}var i6=mn&&"documentMode"in document&&11>=document.documentMode,Ha=null,Ah=null,ho=null,_h=!1;function J1(r,u,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;_h||Ha==null||Ha!==nc(h)||(h=Ha,"selectionStart"in h&&Sh(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ho&&fo(ho,h)||(ho=h,h=Jc(Ah,"onSelect"),0<h.length&&(u=new lc("onSelect","select",null,u,l),r.push({event:u,listeners:h}),u.target=Ha)))}function Gr(r,u){var l={};return l[r.toLowerCase()]=u.toLowerCase(),l["Webkit"+r]="webkit"+u,l["Moz"+r]="moz"+u,l}var ja={animationend:Gr("Animation","AnimationEnd"),animationiteration:Gr("Animation","AnimationIteration"),animationstart:Gr("Animation","AnimationStart"),transitionrun:Gr("Transition","TransitionRun"),transitionstart:Gr("Transition","TransitionStart"),transitioncancel:Gr("Transition","TransitionCancel"),transitionend:Gr("Transition","TransitionEnd")},Lh={},eb={};mn&&(eb=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);function qr(r){if(Lh[r])return Lh[r];if(!ja[r])return r;var u=ja[r],l;for(l in u)if(u.hasOwnProperty(l)&&l in eb)return Lh[r]=u[l];return r}var tb=qr("animationend"),sb=qr("animationiteration"),ib=qr("animationstart"),n6=qr("transitionrun"),r6=qr("transitionstart"),a6=qr("transitioncancel"),nb=qr("transitionend"),rb=new Map,Rh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rh.push("scrollEnd");function Ci(r,u){rb.set(r,u),jr(u,[r])}var fc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},mi=[],$a=0,Ih=0;function hc(){for(var r=$a,u=Ih=$a=0;u<r;){var l=mi[u];mi[u++]=null;var h=mi[u];mi[u++]=null;var b=mi[u];mi[u++]=null;var x=mi[u];if(mi[u++]=null,h!==null&&b!==null){var _=h.pending;_===null?b.next=b:(b.next=_.next,_.next=b),h.pending=b}x!==0&&ab(l,b,x)}}function mc(r,u,l,h){mi[$a++]=r,mi[$a++]=u,mi[$a++]=l,mi[$a++]=h,Ih|=h,r.lanes|=h,r=r.alternate,r!==null&&(r.lanes|=h)}function Ch(r,u,l,h){return mc(r,u,l,h),gc(r)}function Vr(r,u){return mc(r,null,null,u),gc(r)}function ab(r,u,l){r.lanes|=l;var h=r.alternate;h!==null&&(h.lanes|=l);for(var b=!1,x=r.return;x!==null;)x.childLanes|=l,h=x.alternate,h!==null&&(h.childLanes|=l),x.tag===22&&(r=x.stateNode,r===null||r._visibility&1||(b=!0)),r=x,x=x.return;return r.tag===3?(x=r.stateNode,b&&u!==null&&(b=31-Ws(l),r=x.hiddenUpdates,h=r[b],h===null?r[b]=[u]:h.push(u),u.lane=l|536870912),x):null}function gc(r){if(50<Mo)throw Mo=0,B0=null,Error(i(185));for(var u=r.return;u!==null;)r=u,u=r.return;return r.tag===3?r.stateNode:null}var Ga={};function u6(r,u,l,h){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Js(r,u,l,h){return new u6(r,u,l,h)}function Nh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function gn(r,u){var l=r.alternate;return l===null?(l=Js(r.tag,u,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=u,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,u=r.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function ub(r,u){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=u,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,u=l.dependencies,r.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),r}function pc(r,u,l,h,b,x){var _=0;if(h=r,typeof r=="function")Nh(r)&&(_=1);else if(typeof r=="string")_=fL(r,l,pe.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case $:return r=Js(31,l,u,b),r.elementType=$,r.lanes=x,r;case S:return zr(l.children,b,x,u);case A:_=8,b|=24;break;case R:return r=Js(12,l,u,b|2),r.elementType=R,r.lanes=x,r;case k:return r=Js(13,l,u,b),r.elementType=k,r.lanes=x,r;case z:return r=Js(19,l,u,b),r.elementType=z,r.lanes=x,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case I:_=10;break e;case C:_=9;break e;case D:_=11;break e;case P:_=14;break e;case V:_=16,h=null;break e}_=29,l=Error(i(130,r===null?"null":typeof r,"")),h=null}return u=Js(_,l,u,b),u.elementType=r,u.type=h,u.lanes=x,u}function zr(r,u,l,h){return r=Js(7,r,h,u),r.lanes=l,r}function Dh(r,u,l){return r=Js(6,r,null,u),r.lanes=l,r}function ob(r){var u=Js(18,null,null,0);return u.stateNode=r,u}function wh(r,u,l){return u=Js(4,r.children!==null?r.children:[],r.key,u),u.lanes=l,u.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},u}var lb=new WeakMap;function gi(r,u){if(typeof r=="object"&&r!==null){var l=lb.get(r);return l!==void 0?l:(u={value:r,source:u,stack:_s(u)},lb.set(r,u),u)}return{value:r,source:u,stack:_s(u)}}var qa=[],Va=0,bc=null,mo=0,pi=[],bi=0,Kn=null,$i=1,Gi="";function pn(r,u){qa[Va++]=mo,qa[Va++]=bc,bc=r,mo=u}function cb(r,u,l){pi[bi++]=$i,pi[bi++]=Gi,pi[bi++]=Kn,Kn=r;var h=$i;r=Gi;var b=32-Ws(h)-1;h&=~(1<<b),l+=1;var x=32-Ws(u)+b;if(30<x){var _=b-b%5;x=(h&(1<<_)-1).toString(32),h>>=_,b-=_,$i=1<<32-Ws(u)+b|l<<b|h,Gi=x+r}else $i=1<<x|l<<b|h,Gi=r}function Oh(r){r.return!==null&&(pn(r,1),cb(r,1,0))}function kh(r){for(;r===bc;)bc=qa[--Va],qa[Va]=null,mo=qa[--Va],qa[Va]=null;for(;r===Kn;)Kn=pi[--bi],pi[bi]=null,Gi=pi[--bi],pi[bi]=null,$i=pi[--bi],pi[bi]=null}function db(r,u){pi[bi++]=$i,pi[bi++]=Gi,pi[bi++]=Kn,$i=u.id,Gi=u.overflow,Kn=r}var hs=null,vt=null,We=!1,Qn=null,Ei=!1,Mh=Error(i(519));function Xn(r){var u=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw go(gi(u,r)),Mh}function fb(r){var u=r.stateNode,l=r.type,h=r.memoizedProps;switch(u[fs]=r,u[ws]=h,l){case"dialog":Ye("cancel",u),Ye("close",u);break;case"iframe":case"object":case"embed":Ye("load",u);break;case"video":case"audio":for(l=0;l<Uo.length;l++)Ye(Uo[l],u);break;case"source":Ye("error",u);break;case"img":case"image":case"link":Ye("error",u),Ye("load",u);break;case"details":Ye("toggle",u);break;case"input":Ye("invalid",u),_1(u,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Ye("invalid",u);break;case"textarea":Ye("invalid",u),R1(u,h.value,h.defaultValue,h.children)}l=h.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||u.textContent===""+l||h.suppressHydrationWarning===!0||Cy(u.textContent,l)?(h.popover!=null&&(Ye("beforetoggle",u),Ye("toggle",u)),h.onScroll!=null&&Ye("scroll",u),h.onScrollEnd!=null&&Ye("scrollend",u),h.onClick!=null&&(u.onclick=hn),u=!0):u=!1,u||Xn(r,!0)}function hb(r){for(hs=r.return;hs;)switch(hs.tag){case 5:case 31:case 13:Ei=!1;return;case 27:case 3:Ei=!0;return;default:hs=hs.return}}function za(r){if(r!==hs)return!1;if(!We)return hb(r),We=!0,!1;var u=r.tag,l;if((l=u!==3&&u!==27)&&((l=u===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||J0(r.type,r.memoizedProps)),l=!l),l&&vt&&Xn(r),hb(r),u===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));vt=By(r)}else if(u===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));vt=By(r)}else u===27?(u=vt,cr(r.type)?(r=nm,nm=null,vt=r):vt=u):vt=hs?xi(r.stateNode.nextSibling):null;return!0}function Yr(){vt=hs=null,We=!1}function Ph(){var r=Qn;return r!==null&&(Us===null?Us=r:Us.push.apply(Us,r),Qn=null),r}function go(r){Qn===null?Qn=[r]:Qn.push(r)}var Uh=O(null),Kr=null,bn=null;function Wn(r,u,l){de(Uh,u._currentValue),u._currentValue=l}function En(r){r._currentValue=Uh.current,G(Uh)}function Bh(r,u,l){for(;r!==null;){var h=r.alternate;if((r.childLanes&u)!==u?(r.childLanes|=u,h!==null&&(h.childLanes|=u)):h!==null&&(h.childLanes&u)!==u&&(h.childLanes|=u),r===l)break;r=r.return}}function Fh(r,u,l,h){var b=r.child;for(b!==null&&(b.return=r);b!==null;){var x=b.dependencies;if(x!==null){var _=b.child;x=x.firstContext;e:for(;x!==null;){var N=x;x=b;for(var H=0;H<u.length;H++)if(N.context===u[H]){x.lanes|=l,N=x.alternate,N!==null&&(N.lanes|=l),Bh(x.return,l,r),h||(_=null);break e}x=N.next}}else if(b.tag===18){if(_=b.return,_===null)throw Error(i(341));_.lanes|=l,x=_.alternate,x!==null&&(x.lanes|=l),Bh(_,l,r),_=null}else _=b.child;if(_!==null)_.return=b;else for(_=b;_!==null;){if(_===r){_=null;break}if(b=_.sibling,b!==null){b.return=_.return,_=b;break}_=_.return}b=_}}function Ya(r,u,l,h){r=null;for(var b=u,x=!1;b!==null;){if(!x){if((b.flags&524288)!==0)x=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var _=b.alternate;if(_===null)throw Error(i(387));if(_=_.memoizedProps,_!==null){var N=b.type;Zs(b.pendingProps.value,_.value)||(r!==null?r.push(N):r=[N])}}else if(b===ke.current){if(_=b.alternate,_===null)throw Error(i(387));_.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(r!==null?r.push($o):r=[$o])}b=b.return}r!==null&&Fh(u,r,l,h),u.flags|=262144}function Ec(r){for(r=r.firstContext;r!==null;){if(!Zs(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Qr(r){Kr=r,bn=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function ms(r){return mb(Kr,r)}function yc(r,u){return Kr===null&&Qr(r),mb(r,u)}function mb(r,u){var l=u._currentValue;if(u={context:u,memoizedValue:l,next:null},bn===null){if(r===null)throw Error(i(308));bn=u,r.dependencies={lanes:0,firstContext:u},r.flags|=524288}else bn=bn.next=u;return l}var o6=typeof AbortController<"u"?AbortController:function(){var r=[],u=this.signal={aborted:!1,addEventListener:function(l,h){r.push(h)}};this.abort=function(){u.aborted=!0,r.forEach(function(l){return l()})}},l6=s.unstable_scheduleCallback,c6=s.unstable_NormalPriority,Ft={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Hh(){return{controller:new o6,data:new Map,refCount:0}}function po(r){r.refCount--,r.refCount===0&&l6(c6,function(){r.controller.abort()})}var bo=null,jh=0,Ka=0,Qa=null;function d6(r,u){if(bo===null){var l=bo=[];jh=0,Ka=q0(),Qa={status:"pending",value:void 0,then:function(h){l.push(h)}}}return jh++,u.then(gb,gb),u}function gb(){if(--jh===0&&bo!==null){Qa!==null&&(Qa.status="fulfilled");var r=bo;bo=null,Ka=0,Qa=null;for(var u=0;u<r.length;u++)(0,r[u])()}}function f6(r,u){var l=[],h={status:"pending",value:null,reason:null,then:function(b){l.push(b)}};return r.then(function(){h.status="fulfilled",h.value=u;for(var b=0;b<l.length;b++)(0,l[b])(u)},function(b){for(h.status="rejected",h.reason=b,b=0;b<l.length;b++)(0,l[b])(void 0)}),h}var pb=F.S;F.S=function(r,u){JE=ss(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&d6(r,u),pb!==null&&pb(r,u)};var Xr=O(null);function $h(){var r=Xr.current;return r!==null?r:Et.pooledCache}function xc(r,u){u===null?de(Xr,Xr.current):de(Xr,u.pool)}function bb(){var r=$h();return r===null?null:{parent:Ft._currentValue,pool:r}}var Xa=Error(i(460)),Gh=Error(i(474)),Tc=Error(i(542)),vc={then:function(){}};function Eb(r){return r=r.status,r==="fulfilled"||r==="rejected"}function yb(r,u,l){switch(l=r[l],l===void 0?r.push(u):l!==u&&(u.then(hn,hn),u=l),u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,Tb(r),r;default:if(typeof u.status=="string")u.then(hn,hn);else{if(r=Et,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=u,r.status="pending",r.then(function(h){if(u.status==="pending"){var b=u;b.status="fulfilled",b.value=h}},function(h){if(u.status==="pending"){var b=u;b.status="rejected",b.reason=h}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,Tb(r),r}throw Zr=u,Xa}}function Wr(r){try{var u=r._init;return u(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Zr=l,Xa):l}}var Zr=null;function xb(){if(Zr===null)throw Error(i(459));var r=Zr;return Zr=null,r}function Tb(r){if(r===Xa||r===Tc)throw Error(i(483))}var Wa=null,Eo=0;function Sc(r){var u=Eo;return Eo+=1,Wa===null&&(Wa=[]),yb(Wa,r,u)}function yo(r,u){u=u.props.ref,r.ref=u!==void 0?u:null}function Ac(r,u){throw u.$$typeof===p?Error(i(525)):(r=Object.prototype.toString.call(u),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":r)))}function vb(r){function u(Y,q){if(r){var W=Y.deletions;W===null?(Y.deletions=[q],Y.flags|=16):W.push(q)}}function l(Y,q){if(!r)return null;for(;q!==null;)u(Y,q),q=q.sibling;return null}function h(Y){for(var q=new Map;Y!==null;)Y.key!==null?q.set(Y.key,Y):q.set(Y.index,Y),Y=Y.sibling;return q}function b(Y,q){return Y=gn(Y,q),Y.index=0,Y.sibling=null,Y}function x(Y,q,W){return Y.index=W,r?(W=Y.alternate,W!==null?(W=W.index,W<q?(Y.flags|=67108866,q):W):(Y.flags|=67108866,q)):(Y.flags|=1048576,q)}function _(Y){return r&&Y.alternate===null&&(Y.flags|=67108866),Y}function N(Y,q,W,fe){return q===null||q.tag!==6?(q=Dh(W,Y.mode,fe),q.return=Y,q):(q=b(q,W),q.return=Y,q)}function H(Y,q,W,fe){var Ce=W.type;return Ce===S?oe(Y,q,W.props.children,fe,W.key):q!==null&&(q.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===V&&Wr(Ce)===q.type)?(q=b(q,W.props),yo(q,W),q.return=Y,q):(q=pc(W.type,W.key,W.props,null,Y.mode,fe),yo(q,W),q.return=Y,q)}function Z(Y,q,W,fe){return q===null||q.tag!==4||q.stateNode.containerInfo!==W.containerInfo||q.stateNode.implementation!==W.implementation?(q=wh(W,Y.mode,fe),q.return=Y,q):(q=b(q,W.children||[]),q.return=Y,q)}function oe(Y,q,W,fe,Ce){return q===null||q.tag!==7?(q=zr(W,Y.mode,fe,Ce),q.return=Y,q):(q=b(q,W),q.return=Y,q)}function he(Y,q,W){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Dh(""+q,Y.mode,W),q.return=Y,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case T:return W=pc(q.type,q.key,q.props,null,Y.mode,W),yo(W,q),W.return=Y,W;case y:return q=wh(q,Y.mode,W),q.return=Y,q;case V:return q=Wr(q),he(Y,q,W)}if(ue(q)||ge(q))return q=zr(q,Y.mode,W,null),q.return=Y,q;if(typeof q.then=="function")return he(Y,Sc(q),W);if(q.$$typeof===I)return he(Y,yc(Y,q),W);Ac(Y,q)}return null}function ee(Y,q,W,fe){var Ce=q!==null?q.key:null;if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return Ce!==null?null:N(Y,q,""+W,fe);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case T:return W.key===Ce?H(Y,q,W,fe):null;case y:return W.key===Ce?Z(Y,q,W,fe):null;case V:return W=Wr(W),ee(Y,q,W,fe)}if(ue(W)||ge(W))return Ce!==null?null:oe(Y,q,W,fe,null);if(typeof W.then=="function")return ee(Y,q,Sc(W),fe);if(W.$$typeof===I)return ee(Y,q,yc(Y,W),fe);Ac(Y,W)}return null}function re(Y,q,W,fe,Ce){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return Y=Y.get(W)||null,N(q,Y,""+fe,Ce);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case T:return Y=Y.get(fe.key===null?W:fe.key)||null,H(q,Y,fe,Ce);case y:return Y=Y.get(fe.key===null?W:fe.key)||null,Z(q,Y,fe,Ce);case V:return fe=Wr(fe),re(Y,q,W,fe,Ce)}if(ue(fe)||ge(fe))return Y=Y.get(W)||null,oe(q,Y,fe,Ce,null);if(typeof fe.then=="function")return re(Y,q,W,Sc(fe),Ce);if(fe.$$typeof===I)return re(Y,q,W,yc(q,fe),Ce);Ac(q,fe)}return null}function Le(Y,q,W,fe){for(var Ce=null,nt=null,Re=q,je=q=0,Xe=null;Re!==null&&je<W.length;je++){Re.index>je?(Xe=Re,Re=null):Xe=Re.sibling;var rt=ee(Y,Re,W[je],fe);if(rt===null){Re===null&&(Re=Xe);break}r&&Re&&rt.alternate===null&&u(Y,Re),q=x(rt,q,je),nt===null?Ce=rt:nt.sibling=rt,nt=rt,Re=Xe}if(je===W.length)return l(Y,Re),We&&pn(Y,je),Ce;if(Re===null){for(;je<W.length;je++)Re=he(Y,W[je],fe),Re!==null&&(q=x(Re,q,je),nt===null?Ce=Re:nt.sibling=Re,nt=Re);return We&&pn(Y,je),Ce}for(Re=h(Re);je<W.length;je++)Xe=re(Re,Y,je,W[je],fe),Xe!==null&&(r&&Xe.alternate!==null&&Re.delete(Xe.key===null?je:Xe.key),q=x(Xe,q,je),nt===null?Ce=Xe:nt.sibling=Xe,nt=Xe);return r&&Re.forEach(function(gr){return u(Y,gr)}),We&&pn(Y,je),Ce}function De(Y,q,W,fe){if(W==null)throw Error(i(151));for(var Ce=null,nt=null,Re=q,je=q=0,Xe=null,rt=W.next();Re!==null&&!rt.done;je++,rt=W.next()){Re.index>je?(Xe=Re,Re=null):Xe=Re.sibling;var gr=ee(Y,Re,rt.value,fe);if(gr===null){Re===null&&(Re=Xe);break}r&&Re&&gr.alternate===null&&u(Y,Re),q=x(gr,q,je),nt===null?Ce=gr:nt.sibling=gr,nt=gr,Re=Xe}if(rt.done)return l(Y,Re),We&&pn(Y,je),Ce;if(Re===null){for(;!rt.done;je++,rt=W.next())rt=he(Y,rt.value,fe),rt!==null&&(q=x(rt,q,je),nt===null?Ce=rt:nt.sibling=rt,nt=rt);return We&&pn(Y,je),Ce}for(Re=h(Re);!rt.done;je++,rt=W.next())rt=re(Re,Y,je,rt.value,fe),rt!==null&&(r&&rt.alternate!==null&&Re.delete(rt.key===null?je:rt.key),q=x(rt,q,je),nt===null?Ce=rt:nt.sibling=rt,nt=rt);return r&&Re.forEach(function(SL){return u(Y,SL)}),We&&pn(Y,je),Ce}function gt(Y,q,W,fe){if(typeof W=="object"&&W!==null&&W.type===S&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case T:e:{for(var Ce=W.key;q!==null;){if(q.key===Ce){if(Ce=W.type,Ce===S){if(q.tag===7){l(Y,q.sibling),fe=b(q,W.props.children),fe.return=Y,Y=fe;break e}}else if(q.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===V&&Wr(Ce)===q.type){l(Y,q.sibling),fe=b(q,W.props),yo(fe,W),fe.return=Y,Y=fe;break e}l(Y,q);break}else u(Y,q);q=q.sibling}W.type===S?(fe=zr(W.props.children,Y.mode,fe,W.key),fe.return=Y,Y=fe):(fe=pc(W.type,W.key,W.props,null,Y.mode,fe),yo(fe,W),fe.return=Y,Y=fe)}return _(Y);case y:e:{for(Ce=W.key;q!==null;){if(q.key===Ce)if(q.tag===4&&q.stateNode.containerInfo===W.containerInfo&&q.stateNode.implementation===W.implementation){l(Y,q.sibling),fe=b(q,W.children||[]),fe.return=Y,Y=fe;break e}else{l(Y,q);break}else u(Y,q);q=q.sibling}fe=wh(W,Y.mode,fe),fe.return=Y,Y=fe}return _(Y);case V:return W=Wr(W),gt(Y,q,W,fe)}if(ue(W))return Le(Y,q,W,fe);if(ge(W)){if(Ce=ge(W),typeof Ce!="function")throw Error(i(150));return W=Ce.call(W),De(Y,q,W,fe)}if(typeof W.then=="function")return gt(Y,q,Sc(W),fe);if(W.$$typeof===I)return gt(Y,q,yc(Y,W),fe);Ac(Y,W)}return typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint"?(W=""+W,q!==null&&q.tag===6?(l(Y,q.sibling),fe=b(q,W),fe.return=Y,Y=fe):(l(Y,q),fe=Dh(W,Y.mode,fe),fe.return=Y,Y=fe),_(Y)):l(Y,q)}return function(Y,q,W,fe){try{Eo=0;var Ce=gt(Y,q,W,fe);return Wa=null,Ce}catch(Re){if(Re===Xa||Re===Tc)throw Re;var nt=Js(29,Re,null,Y.mode);return nt.lanes=fe,nt.return=Y,nt}finally{}}}var Jr=vb(!0),Sb=vb(!1),Zn=!1;function qh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vh(r,u){r=r.updateQueue,u.updateQueue===r&&(u.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Jn(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function er(r,u,l){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(at&2)!==0){var b=h.pending;return b===null?u.next=u:(u.next=b.next,b.next=u),h.pending=u,u=gc(r),ab(r,null,l),u}return mc(r,h,u,l),gc(r)}function xo(r,u,l){if(u=u.updateQueue,u!==null&&(u=u.shared,(l&4194048)!==0)){var h=u.lanes;h&=r.pendingLanes,l|=h,u.lanes=l,m1(r,l)}}function zh(r,u){var l=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var b=null,x=null;if(l=l.firstBaseUpdate,l!==null){do{var _={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};x===null?b=x=_:x=x.next=_,l=l.next}while(l!==null);x===null?b=x=u:x=x.next=u}else b=x=u;l={baseState:h.baseState,firstBaseUpdate:b,lastBaseUpdate:x,shared:h.shared,callbacks:h.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=u:r.next=u,l.lastBaseUpdate=u}var Yh=!1;function To(){if(Yh){var r=Qa;if(r!==null)throw r}}function vo(r,u,l,h){Yh=!1;var b=r.updateQueue;Zn=!1;var x=b.firstBaseUpdate,_=b.lastBaseUpdate,N=b.shared.pending;if(N!==null){b.shared.pending=null;var H=N,Z=H.next;H.next=null,_===null?x=Z:_.next=Z,_=H;var oe=r.alternate;oe!==null&&(oe=oe.updateQueue,N=oe.lastBaseUpdate,N!==_&&(N===null?oe.firstBaseUpdate=Z:N.next=Z,oe.lastBaseUpdate=H))}if(x!==null){var he=b.baseState;_=0,oe=Z=H=null,N=x;do{var ee=N.lane&-536870913,re=ee!==N.lane;if(re?(Qe&ee)===ee:(h&ee)===ee){ee!==0&&ee===Ka&&(Yh=!0),oe!==null&&(oe=oe.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var Le=r,De=N;ee=u;var gt=l;switch(De.tag){case 1:if(Le=De.payload,typeof Le=="function"){he=Le.call(gt,he,ee);break e}he=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=De.payload,ee=typeof Le=="function"?Le.call(gt,he,ee):Le,ee==null)break e;he=g({},he,ee);break e;case 2:Zn=!0}}ee=N.callback,ee!==null&&(r.flags|=64,re&&(r.flags|=8192),re=b.callbacks,re===null?b.callbacks=[ee]:re.push(ee))}else re={lane:ee,tag:N.tag,payload:N.payload,callback:N.callback,next:null},oe===null?(Z=oe=re,H=he):oe=oe.next=re,_|=ee;if(N=N.next,N===null){if(N=b.shared.pending,N===null)break;re=N,N=re.next,re.next=null,b.lastBaseUpdate=re,b.shared.pending=null}}while(!0);oe===null&&(H=he),b.baseState=H,b.firstBaseUpdate=Z,b.lastBaseUpdate=oe,x===null&&(b.shared.lanes=0),rr|=_,r.lanes=_,r.memoizedState=he}}function Ab(r,u){if(typeof r!="function")throw Error(i(191,r));r.call(u)}function _b(r,u){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)Ab(l[r],u)}var Za=O(null),_c=O(0);function Lb(r,u){r=Rn,de(_c,r),de(Za,u),Rn=r|u.baseLanes}function Kh(){de(_c,Rn),de(Za,Za.current)}function Qh(){Rn=_c.current,G(Za),G(_c)}var ei=O(null),yi=null;function tr(r){var u=r.alternate;de(Mt,Mt.current&1),de(ei,r),yi===null&&(u===null||Za.current!==null||u.memoizedState!==null)&&(yi=r)}function Xh(r){de(Mt,Mt.current),de(ei,r),yi===null&&(yi=r)}function Rb(r){r.tag===22?(de(Mt,Mt.current),de(ei,r),yi===null&&(yi=r)):sr()}function sr(){de(Mt,Mt.current),de(ei,ei.current)}function ti(r){G(ei),yi===r&&(yi=null),G(Mt)}var Mt=O(0);function Lc(r){for(var u=r;u!==null;){if(u.tag===13){var l=u.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||sm(l)||im(l)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var yn=0,Fe=null,ht=null,Ht=null,Rc=!1,Ja=!1,ea=!1,Ic=0,So=0,eu=null,h6=0;function Nt(){throw Error(i(321))}function Wh(r,u){if(u===null)return!1;for(var l=0;l<u.length&&l<r.length;l++)if(!Zs(r[l],u[l]))return!1;return!0}function Zh(r,u,l,h,b,x){return yn=x,Fe=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,F.H=r===null||r.memoizedState===null?cE:h0,ea=!1,x=l(h,b),ea=!1,Ja&&(x=Cb(u,l,h,b)),Ib(r),x}function Ib(r){F.H=Lo;var u=ht!==null&&ht.next!==null;if(yn=0,Ht=ht=Fe=null,Rc=!1,So=0,eu=null,u)throw Error(i(300));r===null||jt||(r=r.dependencies,r!==null&&Ec(r)&&(jt=!0))}function Cb(r,u,l,h){Fe=r;var b=0;do{if(Ja&&(eu=null),So=0,Ja=!1,25<=b)throw Error(i(301));if(b+=1,Ht=ht=null,r.updateQueue!=null){var x=r.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}F.H=dE,x=u(l,h)}while(Ja);return x}function m6(){var r=F.H,u=r.useState()[0];return u=typeof u.then=="function"?Ao(u):u,r=r.useState()[0],(ht!==null?ht.memoizedState:null)!==r&&(Fe.flags|=1024),u}function Jh(){var r=Ic!==0;return Ic=0,r}function e0(r,u,l){u.updateQueue=r.updateQueue,u.flags&=-2053,r.lanes&=~l}function t0(r){if(Rc){for(r=r.memoizedState;r!==null;){var u=r.queue;u!==null&&(u.pending=null),r=r.next}Rc=!1}yn=0,Ht=ht=Fe=null,Ja=!1,So=Ic=0,eu=null}function Rs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?Fe.memoizedState=Ht=r:Ht=Ht.next=r,Ht}function Pt(){if(ht===null){var r=Fe.alternate;r=r!==null?r.memoizedState:null}else r=ht.next;var u=Ht===null?Fe.memoizedState:Ht.next;if(u!==null)Ht=u,ht=r;else{if(r===null)throw Fe.alternate===null?Error(i(467)):Error(i(310));ht=r,r={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},Ht===null?Fe.memoizedState=Ht=r:Ht=Ht.next=r}return Ht}function Cc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ao(r){var u=So;return So+=1,eu===null&&(eu=[]),r=yb(eu,r,u),u=Fe,(Ht===null?u.memoizedState:Ht.next)===null&&(u=u.alternate,F.H=u===null||u.memoizedState===null?cE:h0),r}function Nc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Ao(r);if(r.$$typeof===I)return ms(r)}throw Error(i(438,String(r)))}function s0(r){var u=null,l=Fe.updateQueue;if(l!==null&&(u=l.memoCache),u==null){var h=Fe.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(u={data:h.data.map(function(b){return b.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),l===null&&(l=Cc(),Fe.updateQueue=l),l.memoCache=u,l=u.data[u.index],l===void 0)for(l=u.data[u.index]=Array(r),h=0;h<r;h++)l[h]=j;return u.index++,l}function xn(r,u){return typeof u=="function"?u(r):u}function Dc(r){var u=Pt();return i0(u,ht,r)}function i0(r,u,l){var h=r.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=l;var b=r.baseQueue,x=h.pending;if(x!==null){if(b!==null){var _=b.next;b.next=x.next,x.next=_}u.baseQueue=b=x,h.pending=null}if(x=r.baseState,b===null)r.memoizedState=x;else{u=b.next;var N=_=null,H=null,Z=u,oe=!1;do{var he=Z.lane&-536870913;if(he!==Z.lane?(Qe&he)===he:(yn&he)===he){var ee=Z.revertLane;if(ee===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),he===Ka&&(oe=!0);else if((yn&ee)===ee){Z=Z.next,ee===Ka&&(oe=!0);continue}else he={lane:0,revertLane:Z.revertLane,gesture:null,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},H===null?(N=H=he,_=x):H=H.next=he,Fe.lanes|=ee,rr|=ee;he=Z.action,ea&&l(x,he),x=Z.hasEagerState?Z.eagerState:l(x,he)}else ee={lane:he,revertLane:Z.revertLane,gesture:Z.gesture,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},H===null?(N=H=ee,_=x):H=H.next=ee,Fe.lanes|=he,rr|=he;Z=Z.next}while(Z!==null&&Z!==u);if(H===null?_=x:H.next=N,!Zs(x,r.memoizedState)&&(jt=!0,oe&&(l=Qa,l!==null)))throw l;r.memoizedState=x,r.baseState=_,r.baseQueue=H,h.lastRenderedState=x}return b===null&&(h.lanes=0),[r.memoizedState,h.dispatch]}function n0(r){var u=Pt(),l=u.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var h=l.dispatch,b=l.pending,x=u.memoizedState;if(b!==null){l.pending=null;var _=b=b.next;do x=r(x,_.action),_=_.next;while(_!==b);Zs(x,u.memoizedState)||(jt=!0),u.memoizedState=x,u.baseQueue===null&&(u.baseState=x),l.lastRenderedState=x}return[x,h]}function Nb(r,u,l){var h=Fe,b=Pt(),x=We;if(x){if(l===void 0)throw Error(i(407));l=l()}else l=u();var _=!Zs((ht||b).memoizedState,l);if(_&&(b.memoizedState=l,jt=!0),b=b.queue,u0(Ob.bind(null,h,b,r),[r]),b.getSnapshot!==u||_||Ht!==null&&Ht.memoizedState.tag&1){if(h.flags|=2048,tu(9,{destroy:void 0},wb.bind(null,h,b,l,u),null),Et===null)throw Error(i(349));x||(yn&127)!==0||Db(h,u,l)}return l}function Db(r,u,l){r.flags|=16384,r={getSnapshot:u,value:l},u=Fe.updateQueue,u===null?(u=Cc(),Fe.updateQueue=u,u.stores=[r]):(l=u.stores,l===null?u.stores=[r]:l.push(r))}function wb(r,u,l,h){u.value=l,u.getSnapshot=h,kb(u)&&Mb(r)}function Ob(r,u,l){return l(function(){kb(u)&&Mb(r)})}function kb(r){var u=r.getSnapshot;r=r.value;try{var l=u();return!Zs(r,l)}catch{return!0}}function Mb(r){var u=Vr(r,2);u!==null&&Bs(u,r,2)}function r0(r){var u=Rs();if(typeof r=="function"){var l=r;if(r=l(),ea){Vn(!0);try{l()}finally{Vn(!1)}}}return u.memoizedState=u.baseState=r,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xn,lastRenderedState:r},u}function Pb(r,u,l,h){return r.baseState=l,i0(r,ht,typeof h=="function"?h:xn)}function g6(r,u,l,h,b){if(kc(r))throw Error(i(485));if(r=u.action,r!==null){var x={payload:b,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){x.listeners.push(_)}};F.T!==null?l(!0):x.isTransition=!1,h(x),l=u.pending,l===null?(x.next=u.pending=x,Ub(u,x)):(x.next=l.next,u.pending=l.next=x)}}function Ub(r,u){var l=u.action,h=u.payload,b=r.state;if(u.isTransition){var x=F.T,_={};F.T=_;try{var N=l(b,h),H=F.S;H!==null&&H(_,N),Bb(r,u,N)}catch(Z){a0(r,u,Z)}finally{x!==null&&_.types!==null&&(x.types=_.types),F.T=x}}else try{x=l(b,h),Bb(r,u,x)}catch(Z){a0(r,u,Z)}}function Bb(r,u,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(h){Fb(r,u,h)},function(h){return a0(r,u,h)}):Fb(r,u,l)}function Fb(r,u,l){u.status="fulfilled",u.value=l,Hb(u),r.state=l,u=r.pending,u!==null&&(l=u.next,l===u?r.pending=null:(l=l.next,u.next=l,Ub(r,l)))}function a0(r,u,l){var h=r.pending;if(r.pending=null,h!==null){h=h.next;do u.status="rejected",u.reason=l,Hb(u),u=u.next;while(u!==h)}r.action=null}function Hb(r){r=r.listeners;for(var u=0;u<r.length;u++)(0,r[u])()}function jb(r,u){return u}function $b(r,u){if(We){var l=Et.formState;if(l!==null){e:{var h=Fe;if(We){if(vt){t:{for(var b=vt,x=Ei;b.nodeType!==8;){if(!x){b=null;break t}if(b=xi(b.nextSibling),b===null){b=null;break t}}x=b.data,b=x==="F!"||x==="F"?b:null}if(b){vt=xi(b.nextSibling),h=b.data==="F!";break e}}Xn(h)}h=!1}h&&(u=l[0])}}return l=Rs(),l.memoizedState=l.baseState=u,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jb,lastRenderedState:u},l.queue=h,l=uE.bind(null,Fe,h),h.dispatch=l,h=r0(!1),x=f0.bind(null,Fe,!1,h.queue),h=Rs(),b={state:u,dispatch:null,action:r,pending:null},h.queue=b,l=g6.bind(null,Fe,b,x,l),b.dispatch=l,h.memoizedState=r,[u,l,!1]}function Gb(r){var u=Pt();return qb(u,ht,r)}function qb(r,u,l){if(u=i0(r,u,jb)[0],r=Dc(xn)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var h=Ao(u)}catch(_){throw _===Xa?Tc:_}else h=u;u=Pt();var b=u.queue,x=b.dispatch;return l!==u.memoizedState&&(Fe.flags|=2048,tu(9,{destroy:void 0},p6.bind(null,b,l),null)),[h,x,r]}function p6(r,u){r.action=u}function Vb(r){var u=Pt(),l=ht;if(l!==null)return qb(u,l,r);Pt(),u=u.memoizedState,l=Pt();var h=l.queue.dispatch;return l.memoizedState=r,[u,h,!1]}function tu(r,u,l,h){return r={tag:r,create:l,deps:h,inst:u,next:null},u=Fe.updateQueue,u===null&&(u=Cc(),Fe.updateQueue=u),l=u.lastEffect,l===null?u.lastEffect=r.next=r:(h=l.next,l.next=r,r.next=h,u.lastEffect=r),r}function zb(){return Pt().memoizedState}function wc(r,u,l,h){var b=Rs();Fe.flags|=r,b.memoizedState=tu(1|u,{destroy:void 0},l,h===void 0?null:h)}function Oc(r,u,l,h){var b=Pt();h=h===void 0?null:h;var x=b.memoizedState.inst;ht!==null&&h!==null&&Wh(h,ht.memoizedState.deps)?b.memoizedState=tu(u,x,l,h):(Fe.flags|=r,b.memoizedState=tu(1|u,x,l,h))}function Yb(r,u){wc(8390656,8,r,u)}function u0(r,u){Oc(2048,8,r,u)}function b6(r){Fe.flags|=4;var u=Fe.updateQueue;if(u===null)u=Cc(),Fe.updateQueue=u,u.events=[r];else{var l=u.events;l===null?u.events=[r]:l.push(r)}}function Kb(r){var u=Pt().memoizedState;return b6({ref:u,nextImpl:r}),function(){if((at&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}function Qb(r,u){return Oc(4,2,r,u)}function Xb(r,u){return Oc(4,4,r,u)}function Wb(r,u){if(typeof u=="function"){r=r();var l=u(r);return function(){typeof l=="function"?l():u(null)}}if(u!=null)return r=r(),u.current=r,function(){u.current=null}}function Zb(r,u,l){l=l!=null?l.concat([r]):null,Oc(4,4,Wb.bind(null,u,r),l)}function o0(){}function Jb(r,u){var l=Pt();u=u===void 0?null:u;var h=l.memoizedState;return u!==null&&Wh(u,h[1])?h[0]:(l.memoizedState=[r,u],r)}function eE(r,u){var l=Pt();u=u===void 0?null:u;var h=l.memoizedState;if(u!==null&&Wh(u,h[1]))return h[0];if(h=r(),ea){Vn(!0);try{r()}finally{Vn(!1)}}return l.memoizedState=[h,u],h}function l0(r,u,l){return l===void 0||(yn&1073741824)!==0&&(Qe&261930)===0?r.memoizedState=u:(r.memoizedState=l,r=ty(),Fe.lanes|=r,rr|=r,l)}function tE(r,u,l,h){return Zs(l,u)?l:Za.current!==null?(r=l0(r,l,h),Zs(r,u)||(jt=!0),r):(yn&42)===0||(yn&1073741824)!==0&&(Qe&261930)===0?(jt=!0,r.memoizedState=l):(r=ty(),Fe.lanes|=r,rr|=r,u)}function sE(r,u,l,h,b){var x=J.p;J.p=x!==0&&8>x?x:8;var _=F.T,N={};F.T=N,f0(r,!1,u,l);try{var H=b(),Z=F.S;if(Z!==null&&Z(N,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var oe=f6(H,h);_o(r,u,oe,ni(r))}else _o(r,u,h,ni(r))}catch(he){_o(r,u,{then:function(){},status:"rejected",reason:he},ni())}finally{J.p=x,_!==null&&N.types!==null&&(_.types=N.types),F.T=_}}function E6(){}function c0(r,u,l,h){if(r.tag!==5)throw Error(i(476));var b=iE(r).queue;sE(r,b,u,se,l===null?E6:function(){return nE(r),l(h)})}function iE(r){var u=r.memoizedState;if(u!==null)return u;u={memoizedState:se,baseState:se,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xn,lastRenderedState:se},next:null};var l={};return u.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xn,lastRenderedState:l},next:null},r.memoizedState=u,r=r.alternate,r!==null&&(r.memoizedState=u),u}function nE(r){var u=iE(r);u.next===null&&(u=r.alternate.memoizedState),_o(r,u.next.queue,{},ni())}function d0(){return ms($o)}function rE(){return Pt().memoizedState}function aE(){return Pt().memoizedState}function y6(r){for(var u=r.return;u!==null;){switch(u.tag){case 24:case 3:var l=ni();r=Jn(l);var h=er(u,r,l);h!==null&&(Bs(h,u,l),xo(h,u,l)),u={cache:Hh()},r.payload=u;return}u=u.return}}function x6(r,u,l){var h=ni();l={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},kc(r)?oE(u,l):(l=Ch(r,u,l,h),l!==null&&(Bs(l,r,h),lE(l,u,h)))}function uE(r,u,l){var h=ni();_o(r,u,l,h)}function _o(r,u,l,h){var b={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(kc(r))oE(u,b);else{var x=r.alternate;if(r.lanes===0&&(x===null||x.lanes===0)&&(x=u.lastRenderedReducer,x!==null))try{var _=u.lastRenderedState,N=x(_,l);if(b.hasEagerState=!0,b.eagerState=N,Zs(N,_))return mc(r,u,b,0),Et===null&&hc(),!1}catch{}finally{}if(l=Ch(r,u,b,h),l!==null)return Bs(l,r,h),lE(l,u,h),!0}return!1}function f0(r,u,l,h){if(h={lane:2,revertLane:q0(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},kc(r)){if(u)throw Error(i(479))}else u=Ch(r,l,h,2),u!==null&&Bs(u,r,2)}function kc(r){var u=r.alternate;return r===Fe||u!==null&&u===Fe}function oE(r,u){Ja=Rc=!0;var l=r.pending;l===null?u.next=u:(u.next=l.next,l.next=u),r.pending=u}function lE(r,u,l){if((l&4194048)!==0){var h=u.lanes;h&=r.pendingLanes,l|=h,u.lanes=l,m1(r,l)}}var Lo={readContext:ms,use:Nc,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt,useHostTransitionStatus:Nt,useFormState:Nt,useActionState:Nt,useOptimistic:Nt,useMemoCache:Nt,useCacheRefresh:Nt};Lo.useEffectEvent=Nt;var cE={readContext:ms,use:Nc,useCallback:function(r,u){return Rs().memoizedState=[r,u===void 0?null:u],r},useContext:ms,useEffect:Yb,useImperativeHandle:function(r,u,l){l=l!=null?l.concat([r]):null,wc(4194308,4,Wb.bind(null,u,r),l)},useLayoutEffect:function(r,u){return wc(4194308,4,r,u)},useInsertionEffect:function(r,u){wc(4,2,r,u)},useMemo:function(r,u){var l=Rs();u=u===void 0?null:u;var h=r();if(ea){Vn(!0);try{r()}finally{Vn(!1)}}return l.memoizedState=[h,u],h},useReducer:function(r,u,l){var h=Rs();if(l!==void 0){var b=l(u);if(ea){Vn(!0);try{l(u)}finally{Vn(!1)}}}else b=u;return h.memoizedState=h.baseState=b,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:b},h.queue=r,r=r.dispatch=x6.bind(null,Fe,r),[h.memoizedState,r]},useRef:function(r){var u=Rs();return r={current:r},u.memoizedState=r},useState:function(r){r=r0(r);var u=r.queue,l=uE.bind(null,Fe,u);return u.dispatch=l,[r.memoizedState,l]},useDebugValue:o0,useDeferredValue:function(r,u){var l=Rs();return l0(l,r,u)},useTransition:function(){var r=r0(!1);return r=sE.bind(null,Fe,r.queue,!0,!1),Rs().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,u,l){var h=Fe,b=Rs();if(We){if(l===void 0)throw Error(i(407));l=l()}else{if(l=u(),Et===null)throw Error(i(349));(Qe&127)!==0||Db(h,u,l)}b.memoizedState=l;var x={value:l,getSnapshot:u};return b.queue=x,Yb(Ob.bind(null,h,x,r),[r]),h.flags|=2048,tu(9,{destroy:void 0},wb.bind(null,h,x,l,u),null),l},useId:function(){var r=Rs(),u=Et.identifierPrefix;if(We){var l=Gi,h=$i;l=(h&~(1<<32-Ws(h)-1)).toString(32)+l,u="_"+u+"R_"+l,l=Ic++,0<l&&(u+="H"+l.toString(32)),u+="_"}else l=h6++,u="_"+u+"r_"+l.toString(32)+"_";return r.memoizedState=u},useHostTransitionStatus:d0,useFormState:$b,useActionState:$b,useOptimistic:function(r){var u=Rs();u.memoizedState=u.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=l,u=f0.bind(null,Fe,!0,l),l.dispatch=u,[r,u]},useMemoCache:s0,useCacheRefresh:function(){return Rs().memoizedState=y6.bind(null,Fe)},useEffectEvent:function(r){var u=Rs(),l={impl:r};return u.memoizedState=l,function(){if((at&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},h0={readContext:ms,use:Nc,useCallback:Jb,useContext:ms,useEffect:u0,useImperativeHandle:Zb,useInsertionEffect:Qb,useLayoutEffect:Xb,useMemo:eE,useReducer:Dc,useRef:zb,useState:function(){return Dc(xn)},useDebugValue:o0,useDeferredValue:function(r,u){var l=Pt();return tE(l,ht.memoizedState,r,u)},useTransition:function(){var r=Dc(xn)[0],u=Pt().memoizedState;return[typeof r=="boolean"?r:Ao(r),u]},useSyncExternalStore:Nb,useId:rE,useHostTransitionStatus:d0,useFormState:Gb,useActionState:Gb,useOptimistic:function(r,u){var l=Pt();return Pb(l,ht,r,u)},useMemoCache:s0,useCacheRefresh:aE};h0.useEffectEvent=Kb;var dE={readContext:ms,use:Nc,useCallback:Jb,useContext:ms,useEffect:u0,useImperativeHandle:Zb,useInsertionEffect:Qb,useLayoutEffect:Xb,useMemo:eE,useReducer:n0,useRef:zb,useState:function(){return n0(xn)},useDebugValue:o0,useDeferredValue:function(r,u){var l=Pt();return ht===null?l0(l,r,u):tE(l,ht.memoizedState,r,u)},useTransition:function(){var r=n0(xn)[0],u=Pt().memoizedState;return[typeof r=="boolean"?r:Ao(r),u]},useSyncExternalStore:Nb,useId:rE,useHostTransitionStatus:d0,useFormState:Vb,useActionState:Vb,useOptimistic:function(r,u){var l=Pt();return ht!==null?Pb(l,ht,r,u):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:s0,useCacheRefresh:aE};dE.useEffectEvent=Kb;function m0(r,u,l,h){u=r.memoizedState,l=l(h,u),l=l==null?u:g({},u,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var g0={enqueueSetState:function(r,u,l){r=r._reactInternals;var h=ni(),b=Jn(h);b.payload=u,l!=null&&(b.callback=l),u=er(r,b,h),u!==null&&(Bs(u,r,h),xo(u,r,h))},enqueueReplaceState:function(r,u,l){r=r._reactInternals;var h=ni(),b=Jn(h);b.tag=1,b.payload=u,l!=null&&(b.callback=l),u=er(r,b,h),u!==null&&(Bs(u,r,h),xo(u,r,h))},enqueueForceUpdate:function(r,u){r=r._reactInternals;var l=ni(),h=Jn(l);h.tag=2,u!=null&&(h.callback=u),u=er(r,h,l),u!==null&&(Bs(u,r,l),xo(u,r,l))}};function fE(r,u,l,h,b,x,_){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,x,_):u.prototype&&u.prototype.isPureReactComponent?!fo(l,h)||!fo(b,x):!0}function hE(r,u,l,h){r=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(l,h),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(l,h),u.state!==r&&g0.enqueueReplaceState(u,u.state,null)}function ta(r,u){var l=u;if("ref"in u){l={};for(var h in u)h!=="ref"&&(l[h]=u[h])}if(r=r.defaultProps){l===u&&(l=g({},l));for(var b in r)l[b]===void 0&&(l[b]=r[b])}return l}function mE(r){fc(r)}function gE(r){console.error(r)}function pE(r){fc(r)}function Mc(r,u){try{var l=r.onUncaughtError;l(u.value,{componentStack:u.stack})}catch(h){setTimeout(function(){throw h})}}function bE(r,u,l){try{var h=r.onCaughtError;h(l.value,{componentStack:l.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function p0(r,u,l){return l=Jn(l),l.tag=3,l.payload={element:null},l.callback=function(){Mc(r,u)},l}function EE(r){return r=Jn(r),r.tag=3,r}function yE(r,u,l,h){var b=l.type.getDerivedStateFromError;if(typeof b=="function"){var x=h.value;r.payload=function(){return b(x)},r.callback=function(){bE(u,l,h)}}var _=l.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(r.callback=function(){bE(u,l,h),typeof b!="function"&&(ar===null?ar=new Set([this]):ar.add(this));var N=h.stack;this.componentDidCatch(h.value,{componentStack:N!==null?N:""})})}function T6(r,u,l,h,b){if(l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(u=l.alternate,u!==null&&Ya(u,l,b,!0),l=ei.current,l!==null){switch(l.tag){case 31:case 13:return yi===null?Yc():l.alternate===null&&Dt===0&&(Dt=3),l.flags&=-257,l.flags|=65536,l.lanes=b,h===vc?l.flags|=16384:(u=l.updateQueue,u===null?l.updateQueue=new Set([h]):u.add(h),j0(r,h,b)),!1;case 22:return l.flags|=65536,h===vc?l.flags|=16384:(u=l.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([h])},l.updateQueue=u):(l=u.retryQueue,l===null?u.retryQueue=new Set([h]):l.add(h)),j0(r,h,b)),!1}throw Error(i(435,l.tag))}return j0(r,h,b),Yc(),!1}if(We)return u=ei.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=b,h!==Mh&&(r=Error(i(422),{cause:h}),go(gi(r,l)))):(h!==Mh&&(u=Error(i(423),{cause:h}),go(gi(u,l))),r=r.current.alternate,r.flags|=65536,b&=-b,r.lanes|=b,h=gi(h,l),b=p0(r.stateNode,h,b),zh(r,b),Dt!==4&&(Dt=2)),!1;var x=Error(i(520),{cause:h});if(x=gi(x,l),ko===null?ko=[x]:ko.push(x),Dt!==4&&(Dt=2),u===null)return!0;h=gi(h,l),l=u;do{switch(l.tag){case 3:return l.flags|=65536,r=b&-b,l.lanes|=r,r=p0(l.stateNode,h,r),zh(l,r),!1;case 1:if(u=l.type,x=l.stateNode,(l.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ar===null||!ar.has(x))))return l.flags|=65536,b&=-b,l.lanes|=b,b=EE(b),yE(b,r,l,h),zh(l,b),!1}l=l.return}while(l!==null);return!1}var b0=Error(i(461)),jt=!1;function gs(r,u,l,h){u.child=r===null?Sb(u,null,l,h):Jr(u,r.child,l,h)}function xE(r,u,l,h,b){l=l.render;var x=u.ref;if("ref"in h){var _={};for(var N in h)N!=="ref"&&(_[N]=h[N])}else _=h;return Qr(u),h=Zh(r,u,l,_,x,b),N=Jh(),r!==null&&!jt?(e0(r,u,b),Tn(r,u,b)):(We&&N&&Oh(u),u.flags|=1,gs(r,u,h,b),u.child)}function TE(r,u,l,h,b){if(r===null){var x=l.type;return typeof x=="function"&&!Nh(x)&&x.defaultProps===void 0&&l.compare===null?(u.tag=15,u.type=x,vE(r,u,x,h,b)):(r=pc(l.type,null,h,u,u.mode,b),r.ref=u.ref,r.return=u,u.child=r)}if(x=r.child,!_0(r,b)){var _=x.memoizedProps;if(l=l.compare,l=l!==null?l:fo,l(_,h)&&r.ref===u.ref)return Tn(r,u,b)}return u.flags|=1,r=gn(x,h),r.ref=u.ref,r.return=u,u.child=r}function vE(r,u,l,h,b){if(r!==null){var x=r.memoizedProps;if(fo(x,h)&&r.ref===u.ref)if(jt=!1,u.pendingProps=h=x,_0(r,b))(r.flags&131072)!==0&&(jt=!0);else return u.lanes=r.lanes,Tn(r,u,b)}return E0(r,u,l,h,b)}function SE(r,u,l,h){var b=h.children,x=r!==null?r.memoizedState:null;if(r===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((u.flags&128)!==0){if(x=x!==null?x.baseLanes|l:l,r!==null){for(h=u.child=r.child,b=0;h!==null;)b=b|h.lanes|h.childLanes,h=h.sibling;h=b&~x}else h=0,u.child=null;return AE(r,u,x,l,h)}if((l&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},r!==null&&xc(u,x!==null?x.cachePool:null),x!==null?Lb(u,x):Kh(),Rb(u);else return h=u.lanes=536870912,AE(r,u,x!==null?x.baseLanes|l:l,l,h)}else x!==null?(xc(u,x.cachePool),Lb(u,x),sr(),u.memoizedState=null):(r!==null&&xc(u,null),Kh(),sr());return gs(r,u,b,l),u.child}function Ro(r,u){return r!==null&&r.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function AE(r,u,l,h,b){var x=$h();return x=x===null?null:{parent:Ft._currentValue,pool:x},u.memoizedState={baseLanes:l,cachePool:x},r!==null&&xc(u,null),Kh(),Rb(u),r!==null&&Ya(r,u,h,!0),u.childLanes=b,null}function Pc(r,u){return u=Bc({mode:u.mode,children:u.children},r.mode),u.ref=r.ref,r.child=u,u.return=r,u}function _E(r,u,l){return Jr(u,r.child,null,l),r=Pc(u,u.pendingProps),r.flags|=2,ti(u),u.memoizedState=null,r}function v6(r,u,l){var h=u.pendingProps,b=(u.flags&128)!==0;if(u.flags&=-129,r===null){if(We){if(h.mode==="hidden")return r=Pc(u,h),u.lanes=536870912,Ro(null,r);if(Xh(u),(r=vt)?(r=Uy(r,Ei),r=r!==null&&r.data==="&"?r:null,r!==null&&(u.memoizedState={dehydrated:r,treeContext:Kn!==null?{id:$i,overflow:Gi}:null,retryLane:536870912,hydrationErrors:null},l=ob(r),l.return=u,u.child=l,hs=u,vt=null)):r=null,r===null)throw Xn(u);return u.lanes=536870912,null}return Pc(u,h)}var x=r.memoizedState;if(x!==null){var _=x.dehydrated;if(Xh(u),b)if(u.flags&256)u.flags&=-257,u=_E(r,u,l);else if(u.memoizedState!==null)u.child=r.child,u.flags|=128,u=null;else throw Error(i(558));else if(jt||Ya(r,u,l,!1),b=(l&r.childLanes)!==0,jt||b){if(h=Et,h!==null&&(_=g1(h,l),_!==0&&_!==x.retryLane))throw x.retryLane=_,Vr(r,_),Bs(h,r,_),b0;Yc(),u=_E(r,u,l)}else r=x.treeContext,vt=xi(_.nextSibling),hs=u,We=!0,Qn=null,Ei=!1,r!==null&&db(u,r),u=Pc(u,h),u.flags|=4096;return u}return r=gn(r.child,{mode:h.mode,children:h.children}),r.ref=u.ref,u.child=r,r.return=u,r}function Uc(r,u){var l=u.ref;if(l===null)r!==null&&r.ref!==null&&(u.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(u.flags|=4194816)}}function E0(r,u,l,h,b){return Qr(u),l=Zh(r,u,l,h,void 0,b),h=Jh(),r!==null&&!jt?(e0(r,u,b),Tn(r,u,b)):(We&&h&&Oh(u),u.flags|=1,gs(r,u,l,b),u.child)}function LE(r,u,l,h,b,x){return Qr(u),u.updateQueue=null,l=Cb(u,h,l,b),Ib(r),h=Jh(),r!==null&&!jt?(e0(r,u,x),Tn(r,u,x)):(We&&h&&Oh(u),u.flags|=1,gs(r,u,l,x),u.child)}function RE(r,u,l,h,b){if(Qr(u),u.stateNode===null){var x=Ga,_=l.contextType;typeof _=="object"&&_!==null&&(x=ms(_)),x=new l(h,x),u.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=g0,u.stateNode=x,x._reactInternals=u,x=u.stateNode,x.props=h,x.state=u.memoizedState,x.refs={},qh(u),_=l.contextType,x.context=typeof _=="object"&&_!==null?ms(_):Ga,x.state=u.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(m0(u,l,_,h),x.state=u.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(_=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),_!==x.state&&g0.enqueueReplaceState(x,x.state,null),vo(u,h,x,b),To(),x.state=u.memoizedState),typeof x.componentDidMount=="function"&&(u.flags|=4194308),h=!0}else if(r===null){x=u.stateNode;var N=u.memoizedProps,H=ta(l,N);x.props=H;var Z=x.context,oe=l.contextType;_=Ga,typeof oe=="object"&&oe!==null&&(_=ms(oe));var he=l.getDerivedStateFromProps;oe=typeof he=="function"||typeof x.getSnapshotBeforeUpdate=="function",N=u.pendingProps!==N,oe||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(N||Z!==_)&&hE(u,x,h,_),Zn=!1;var ee=u.memoizedState;x.state=ee,vo(u,h,x,b),To(),Z=u.memoizedState,N||ee!==Z||Zn?(typeof he=="function"&&(m0(u,l,he,h),Z=u.memoizedState),(H=Zn||fE(u,l,H,h,ee,Z,_))?(oe||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(u.flags|=4194308)):(typeof x.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=h,u.memoizedState=Z),x.props=h,x.state=Z,x.context=_,h=H):(typeof x.componentDidMount=="function"&&(u.flags|=4194308),h=!1)}else{x=u.stateNode,Vh(r,u),_=u.memoizedProps,oe=ta(l,_),x.props=oe,he=u.pendingProps,ee=x.context,Z=l.contextType,H=Ga,typeof Z=="object"&&Z!==null&&(H=ms(Z)),N=l.getDerivedStateFromProps,(Z=typeof N=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(_!==he||ee!==H)&&hE(u,x,h,H),Zn=!1,ee=u.memoizedState,x.state=ee,vo(u,h,x,b),To();var re=u.memoizedState;_!==he||ee!==re||Zn||r!==null&&r.dependencies!==null&&Ec(r.dependencies)?(typeof N=="function"&&(m0(u,l,N,h),re=u.memoizedState),(oe=Zn||fE(u,l,oe,h,ee,re,H)||r!==null&&r.dependencies!==null&&Ec(r.dependencies))?(Z||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,re,H),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,re,H)),typeof x.componentDidUpdate=="function"&&(u.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof x.componentDidUpdate!="function"||_===r.memoizedProps&&ee===r.memoizedState||(u.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||_===r.memoizedProps&&ee===r.memoizedState||(u.flags|=1024),u.memoizedProps=h,u.memoizedState=re),x.props=h,x.state=re,x.context=H,h=oe):(typeof x.componentDidUpdate!="function"||_===r.memoizedProps&&ee===r.memoizedState||(u.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||_===r.memoizedProps&&ee===r.memoizedState||(u.flags|=1024),h=!1)}return x=h,Uc(r,u),h=(u.flags&128)!==0,x||h?(x=u.stateNode,l=h&&typeof l.getDerivedStateFromError!="function"?null:x.render(),u.flags|=1,r!==null&&h?(u.child=Jr(u,r.child,null,b),u.child=Jr(u,null,l,b)):gs(r,u,l,b),u.memoizedState=x.state,r=u.child):r=Tn(r,u,b),r}function IE(r,u,l,h){return Yr(),u.flags|=256,gs(r,u,l,h),u.child}var y0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function x0(r){return{baseLanes:r,cachePool:bb()}}function T0(r,u,l){return r=r!==null?r.childLanes&~l:0,u&&(r|=ii),r}function CE(r,u,l){var h=u.pendingProps,b=!1,x=(u.flags&128)!==0,_;if((_=x)||(_=r!==null&&r.memoizedState===null?!1:(Mt.current&2)!==0),_&&(b=!0,u.flags&=-129),_=(u.flags&32)!==0,u.flags&=-33,r===null){if(We){if(b?tr(u):sr(),(r=vt)?(r=Uy(r,Ei),r=r!==null&&r.data!=="&"?r:null,r!==null&&(u.memoizedState={dehydrated:r,treeContext:Kn!==null?{id:$i,overflow:Gi}:null,retryLane:536870912,hydrationErrors:null},l=ob(r),l.return=u,u.child=l,hs=u,vt=null)):r=null,r===null)throw Xn(u);return im(r)?u.lanes=32:u.lanes=536870912,null}var N=h.children;return h=h.fallback,b?(sr(),b=u.mode,N=Bc({mode:"hidden",children:N},b),h=zr(h,b,l,null),N.return=u,h.return=u,N.sibling=h,u.child=N,h=u.child,h.memoizedState=x0(l),h.childLanes=T0(r,_,l),u.memoizedState=y0,Ro(null,h)):(tr(u),v0(u,N))}var H=r.memoizedState;if(H!==null&&(N=H.dehydrated,N!==null)){if(x)u.flags&256?(tr(u),u.flags&=-257,u=S0(r,u,l)):u.memoizedState!==null?(sr(),u.child=r.child,u.flags|=128,u=null):(sr(),N=h.fallback,b=u.mode,h=Bc({mode:"visible",children:h.children},b),N=zr(N,b,l,null),N.flags|=2,h.return=u,N.return=u,h.sibling=N,u.child=h,Jr(u,r.child,null,l),h=u.child,h.memoizedState=x0(l),h.childLanes=T0(r,_,l),u.memoizedState=y0,u=Ro(null,h));else if(tr(u),im(N)){if(_=N.nextSibling&&N.nextSibling.dataset,_)var Z=_.dgst;_=Z,h=Error(i(419)),h.stack="",h.digest=_,go({value:h,source:null,stack:null}),u=S0(r,u,l)}else if(jt||Ya(r,u,l,!1),_=(l&r.childLanes)!==0,jt||_){if(_=Et,_!==null&&(h=g1(_,l),h!==0&&h!==H.retryLane))throw H.retryLane=h,Vr(r,h),Bs(_,r,h),b0;sm(N)||Yc(),u=S0(r,u,l)}else sm(N)?(u.flags|=192,u.child=r.child,u=null):(r=H.treeContext,vt=xi(N.nextSibling),hs=u,We=!0,Qn=null,Ei=!1,r!==null&&db(u,r),u=v0(u,h.children),u.flags|=4096);return u}return b?(sr(),N=h.fallback,b=u.mode,H=r.child,Z=H.sibling,h=gn(H,{mode:"hidden",children:h.children}),h.subtreeFlags=H.subtreeFlags&65011712,Z!==null?N=gn(Z,N):(N=zr(N,b,l,null),N.flags|=2),N.return=u,h.return=u,h.sibling=N,u.child=h,Ro(null,h),h=u.child,N=r.child.memoizedState,N===null?N=x0(l):(b=N.cachePool,b!==null?(H=Ft._currentValue,b=b.parent!==H?{parent:H,pool:H}:b):b=bb(),N={baseLanes:N.baseLanes|l,cachePool:b}),h.memoizedState=N,h.childLanes=T0(r,_,l),u.memoizedState=y0,Ro(r.child,h)):(tr(u),l=r.child,r=l.sibling,l=gn(l,{mode:"visible",children:h.children}),l.return=u,l.sibling=null,r!==null&&(_=u.deletions,_===null?(u.deletions=[r],u.flags|=16):_.push(r)),u.child=l,u.memoizedState=null,l)}function v0(r,u){return u=Bc({mode:"visible",children:u},r.mode),u.return=r,r.child=u}function Bc(r,u){return r=Js(22,r,null,u),r.lanes=0,r}function S0(r,u,l){return Jr(u,r.child,null,l),r=v0(u,u.pendingProps.children),r.flags|=2,u.memoizedState=null,r}function NE(r,u,l){r.lanes|=u;var h=r.alternate;h!==null&&(h.lanes|=u),Bh(r.return,u,l)}function A0(r,u,l,h,b,x){var _=r.memoizedState;_===null?r.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:b,treeForkCount:x}:(_.isBackwards=u,_.rendering=null,_.renderingStartTime=0,_.last=h,_.tail=l,_.tailMode=b,_.treeForkCount=x)}function DE(r,u,l){var h=u.pendingProps,b=h.revealOrder,x=h.tail;h=h.children;var _=Mt.current,N=(_&2)!==0;if(N?(_=_&1|2,u.flags|=128):_&=1,de(Mt,_),gs(r,u,h,l),h=We?mo:0,!N&&r!==null&&(r.flags&128)!==0)e:for(r=u.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&NE(r,l,u);else if(r.tag===19)NE(r,l,u);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===u)break e;for(;r.sibling===null;){if(r.return===null||r.return===u)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(b){case"forwards":for(l=u.child,b=null;l!==null;)r=l.alternate,r!==null&&Lc(r)===null&&(b=l),l=l.sibling;l=b,l===null?(b=u.child,u.child=null):(b=l.sibling,l.sibling=null),A0(u,!1,b,l,x,h);break;case"backwards":case"unstable_legacy-backwards":for(l=null,b=u.child,u.child=null;b!==null;){if(r=b.alternate,r!==null&&Lc(r)===null){u.child=b;break}r=b.sibling,b.sibling=l,l=b,b=r}A0(u,!0,l,null,x,h);break;case"together":A0(u,!1,null,null,void 0,h);break;default:u.memoizedState=null}return u.child}function Tn(r,u,l){if(r!==null&&(u.dependencies=r.dependencies),rr|=u.lanes,(l&u.childLanes)===0)if(r!==null){if(Ya(r,u,l,!1),(l&u.childLanes)===0)return null}else return null;if(r!==null&&u.child!==r.child)throw Error(i(153));if(u.child!==null){for(r=u.child,l=gn(r,r.pendingProps),u.child=l,l.return=u;r.sibling!==null;)r=r.sibling,l=l.sibling=gn(r,r.pendingProps),l.return=u;l.sibling=null}return u.child}function _0(r,u){return(r.lanes&u)!==0?!0:(r=r.dependencies,!!(r!==null&&Ec(r)))}function S6(r,u,l){switch(u.tag){case 3:st(u,u.stateNode.containerInfo),Wn(u,Ft,r.memoizedState.cache),Yr();break;case 27:case 5:xs(u);break;case 4:st(u,u.stateNode.containerInfo);break;case 10:Wn(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,Xh(u),null;break;case 13:var h=u.memoizedState;if(h!==null)return h.dehydrated!==null?(tr(u),u.flags|=128,null):(l&u.child.childLanes)!==0?CE(r,u,l):(tr(u),r=Tn(r,u,l),r!==null?r.sibling:null);tr(u);break;case 19:var b=(r.flags&128)!==0;if(h=(l&u.childLanes)!==0,h||(Ya(r,u,l,!1),h=(l&u.childLanes)!==0),b){if(h)return DE(r,u,l);u.flags|=128}if(b=u.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),de(Mt,Mt.current),h)break;return null;case 22:return u.lanes=0,SE(r,u,l,u.pendingProps);case 24:Wn(u,Ft,r.memoizedState.cache)}return Tn(r,u,l)}function wE(r,u,l){if(r!==null)if(r.memoizedProps!==u.pendingProps)jt=!0;else{if(!_0(r,l)&&(u.flags&128)===0)return jt=!1,S6(r,u,l);jt=(r.flags&131072)!==0}else jt=!1,We&&(u.flags&1048576)!==0&&cb(u,mo,u.index);switch(u.lanes=0,u.tag){case 16:e:{var h=u.pendingProps;if(r=Wr(u.elementType),u.type=r,typeof r=="function")Nh(r)?(h=ta(r,h),u.tag=1,u=RE(null,u,r,h,l)):(u.tag=0,u=E0(null,u,r,h,l));else{if(r!=null){var b=r.$$typeof;if(b===D){u.tag=11,u=xE(null,u,r,h,l);break e}else if(b===P){u.tag=14,u=TE(null,u,r,h,l);break e}}throw u=ve(r)||r,Error(i(306,u,""))}}return u;case 0:return E0(r,u,u.type,u.pendingProps,l);case 1:return h=u.type,b=ta(h,u.pendingProps),RE(r,u,h,b,l);case 3:e:{if(st(u,u.stateNode.containerInfo),r===null)throw Error(i(387));h=u.pendingProps;var x=u.memoizedState;b=x.element,Vh(r,u),vo(u,h,null,l);var _=u.memoizedState;if(h=_.cache,Wn(u,Ft,h),h!==x.cache&&Fh(u,[Ft],l,!0),To(),h=_.element,x.isDehydrated)if(x={element:h,isDehydrated:!1,cache:_.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=IE(r,u,h,l);break e}else if(h!==b){b=gi(Error(i(424)),u),go(b),u=IE(r,u,h,l);break e}else{switch(r=u.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(vt=xi(r.firstChild),hs=u,We=!0,Qn=null,Ei=!0,l=Sb(u,null,h,l),u.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Yr(),h===b){u=Tn(r,u,l);break e}gs(r,u,h,l)}u=u.child}return u;case 26:return Uc(r,u),r===null?(l=Gy(u.type,null,u.pendingProps,null))?u.memoizedState=l:We||(l=u.type,r=u.pendingProps,h=ed(Ae.current).createElement(l),h[fs]=u,h[ws]=r,ps(h,l,r),is(h),u.stateNode=h):u.memoizedState=Gy(u.type,r.memoizedProps,u.pendingProps,r.memoizedState),null;case 27:return xs(u),r===null&&We&&(h=u.stateNode=Hy(u.type,u.pendingProps,Ae.current),hs=u,Ei=!0,b=vt,cr(u.type)?(nm=b,vt=xi(h.firstChild)):vt=b),gs(r,u,u.pendingProps.children,l),Uc(r,u),r===null&&(u.flags|=4194304),u.child;case 5:return r===null&&We&&((b=h=vt)&&(h=J6(h,u.type,u.pendingProps,Ei),h!==null?(u.stateNode=h,hs=u,vt=xi(h.firstChild),Ei=!1,b=!0):b=!1),b||Xn(u)),xs(u),b=u.type,x=u.pendingProps,_=r!==null?r.memoizedProps:null,h=x.children,J0(b,x)?h=null:_!==null&&J0(b,_)&&(u.flags|=32),u.memoizedState!==null&&(b=Zh(r,u,m6,null,null,l),$o._currentValue=b),Uc(r,u),gs(r,u,h,l),u.child;case 6:return r===null&&We&&((r=l=vt)&&(l=eL(l,u.pendingProps,Ei),l!==null?(u.stateNode=l,hs=u,vt=null,r=!0):r=!1),r||Xn(u)),null;case 13:return CE(r,u,l);case 4:return st(u,u.stateNode.containerInfo),h=u.pendingProps,r===null?u.child=Jr(u,null,h,l):gs(r,u,h,l),u.child;case 11:return xE(r,u,u.type,u.pendingProps,l);case 7:return gs(r,u,u.pendingProps,l),u.child;case 8:return gs(r,u,u.pendingProps.children,l),u.child;case 12:return gs(r,u,u.pendingProps.children,l),u.child;case 10:return h=u.pendingProps,Wn(u,u.type,h.value),gs(r,u,h.children,l),u.child;case 9:return b=u.type._context,h=u.pendingProps.children,Qr(u),b=ms(b),h=h(b),u.flags|=1,gs(r,u,h,l),u.child;case 14:return TE(r,u,u.type,u.pendingProps,l);case 15:return vE(r,u,u.type,u.pendingProps,l);case 19:return DE(r,u,l);case 31:return v6(r,u,l);case 22:return SE(r,u,l,u.pendingProps);case 24:return Qr(u),h=ms(Ft),r===null?(b=$h(),b===null&&(b=Et,x=Hh(),b.pooledCache=x,x.refCount++,x!==null&&(b.pooledCacheLanes|=l),b=x),u.memoizedState={parent:h,cache:b},qh(u),Wn(u,Ft,b)):((r.lanes&l)!==0&&(Vh(r,u),vo(u,null,null,l),To()),b=r.memoizedState,x=u.memoizedState,b.parent!==h?(b={parent:h,cache:h},u.memoizedState=b,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=b),Wn(u,Ft,h)):(h=x.cache,Wn(u,Ft,h),h!==b.cache&&Fh(u,[Ft],l,!0))),gs(r,u,u.pendingProps.children,l),u.child;case 29:throw u.pendingProps}throw Error(i(156,u.tag))}function vn(r){r.flags|=4}function L0(r,u,l,h,b){if((u=(r.mode&32)!==0)&&(u=!1),u){if(r.flags|=16777216,(b&335544128)===b)if(r.stateNode.complete)r.flags|=8192;else if(ry())r.flags|=8192;else throw Zr=vc,Gh}else r.flags&=-16777217}function OE(r,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Ky(u))if(ry())r.flags|=8192;else throw Zr=vc,Gh}function Fc(r,u){u!==null&&(r.flags|=4),r.flags&16384&&(u=r.tag!==22?f1():536870912,r.lanes|=u,ru|=u)}function Io(r,u){if(!We)switch(r.tailMode){case"hidden":u=r.tail;for(var l=null;u!==null;)u.alternate!==null&&(l=u),u=u.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?u||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function St(r){var u=r.alternate!==null&&r.alternate.child===r.child,l=0,h=0;if(u)for(var b=r.child;b!==null;)l|=b.lanes|b.childLanes,h|=b.subtreeFlags&65011712,h|=b.flags&65011712,b.return=r,b=b.sibling;else for(b=r.child;b!==null;)l|=b.lanes|b.childLanes,h|=b.subtreeFlags,h|=b.flags,b.return=r,b=b.sibling;return r.subtreeFlags|=h,r.childLanes=l,u}function A6(r,u,l){var h=u.pendingProps;switch(kh(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(u),null;case 1:return St(u),null;case 3:return l=u.stateNode,h=null,r!==null&&(h=r.memoizedState.cache),u.memoizedState.cache!==h&&(u.flags|=2048),En(Ft),Je(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(za(u)?vn(u):r===null||r.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ph())),St(u),null;case 26:var b=u.type,x=u.memoizedState;return r===null?(vn(u),x!==null?(St(u),OE(u,x)):(St(u),L0(u,b,null,h,l))):x?x!==r.memoizedState?(vn(u),St(u),OE(u,x)):(St(u),u.flags&=-16777217):(r=r.memoizedProps,r!==h&&vn(u),St(u),L0(u,b,r,h,l)),null;case 27:if(di(u),l=Ae.current,b=u.type,r!==null&&u.stateNode!=null)r.memoizedProps!==h&&vn(u);else{if(!h){if(u.stateNode===null)throw Error(i(166));return St(u),null}r=pe.current,za(u)?fb(u):(r=Hy(b,h,l),u.stateNode=r,vn(u))}return St(u),null;case 5:if(di(u),b=u.type,r!==null&&u.stateNode!=null)r.memoizedProps!==h&&vn(u);else{if(!h){if(u.stateNode===null)throw Error(i(166));return St(u),null}if(x=pe.current,za(u))fb(u);else{var _=ed(Ae.current);switch(x){case 1:x=_.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:x=_.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":x=_.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":x=_.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":x=_.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof h.is=="string"?_.createElement("select",{is:h.is}):_.createElement("select"),h.multiple?x.multiple=!0:h.size&&(x.size=h.size);break;default:x=typeof h.is=="string"?_.createElement(b,{is:h.is}):_.createElement(b)}}x[fs]=u,x[ws]=h;e:for(_=u.child;_!==null;){if(_.tag===5||_.tag===6)x.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===u)break e;for(;_.sibling===null;){if(_.return===null||_.return===u)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}u.stateNode=x;e:switch(ps(x,b,h),b){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&vn(u)}}return St(u),L0(u,u.type,r===null?null:r.memoizedProps,u.pendingProps,l),null;case 6:if(r&&u.stateNode!=null)r.memoizedProps!==h&&vn(u);else{if(typeof h!="string"&&u.stateNode===null)throw Error(i(166));if(r=Ae.current,za(u)){if(r=u.stateNode,l=u.memoizedProps,h=null,b=hs,b!==null)switch(b.tag){case 27:case 5:h=b.memoizedProps}r[fs]=u,r=!!(r.nodeValue===l||h!==null&&h.suppressHydrationWarning===!0||Cy(r.nodeValue,l)),r||Xn(u,!0)}else r=ed(r).createTextNode(h),r[fs]=u,u.stateNode=r}return St(u),null;case 31:if(l=u.memoizedState,r===null||r.memoizedState!==null){if(h=za(u),l!==null){if(r===null){if(!h)throw Error(i(318));if(r=u.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[fs]=u}else Yr(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;St(u),r=!1}else l=Ph(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return u.flags&256?(ti(u),u):(ti(u),null);if((u.flags&128)!==0)throw Error(i(558))}return St(u),null;case 13:if(h=u.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(b=za(u),h!==null&&h.dehydrated!==null){if(r===null){if(!b)throw Error(i(318));if(b=u.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(i(317));b[fs]=u}else Yr(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;St(u),b=!1}else b=Ph(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=b),b=!0;if(!b)return u.flags&256?(ti(u),u):(ti(u),null)}return ti(u),(u.flags&128)!==0?(u.lanes=l,u):(l=h!==null,r=r!==null&&r.memoizedState!==null,l&&(h=u.child,b=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(b=h.alternate.memoizedState.cachePool.pool),x=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==b&&(h.flags|=2048)),l!==r&&l&&(u.child.flags|=8192),Fc(u,u.updateQueue),St(u),null);case 4:return Je(),r===null&&K0(u.stateNode.containerInfo),St(u),null;case 10:return En(u.type),St(u),null;case 19:if(G(Mt),h=u.memoizedState,h===null)return St(u),null;if(b=(u.flags&128)!==0,x=h.rendering,x===null)if(b)Io(h,!1);else{if(Dt!==0||r!==null&&(r.flags&128)!==0)for(r=u.child;r!==null;){if(x=Lc(r),x!==null){for(u.flags|=128,Io(h,!1),r=x.updateQueue,u.updateQueue=r,Fc(u,r),u.subtreeFlags=0,r=l,l=u.child;l!==null;)ub(l,r),l=l.sibling;return de(Mt,Mt.current&1|2),We&&pn(u,h.treeForkCount),u.child}r=r.sibling}h.tail!==null&&ss()>qc&&(u.flags|=128,b=!0,Io(h,!1),u.lanes=4194304)}else{if(!b)if(r=Lc(x),r!==null){if(u.flags|=128,b=!0,r=r.updateQueue,u.updateQueue=r,Fc(u,r),Io(h,!0),h.tail===null&&h.tailMode==="hidden"&&!x.alternate&&!We)return St(u),null}else 2*ss()-h.renderingStartTime>qc&&l!==536870912&&(u.flags|=128,b=!0,Io(h,!1),u.lanes=4194304);h.isBackwards?(x.sibling=u.child,u.child=x):(r=h.last,r!==null?r.sibling=x:u.child=x,h.last=x)}return h.tail!==null?(r=h.tail,h.rendering=r,h.tail=r.sibling,h.renderingStartTime=ss(),r.sibling=null,l=Mt.current,de(Mt,b?l&1|2:l&1),We&&pn(u,h.treeForkCount),r):(St(u),null);case 22:case 23:return ti(u),Qh(),h=u.memoizedState!==null,r!==null?r.memoizedState!==null!==h&&(u.flags|=8192):h&&(u.flags|=8192),h?(l&536870912)!==0&&(u.flags&128)===0&&(St(u),u.subtreeFlags&6&&(u.flags|=8192)):St(u),l=u.updateQueue,l!==null&&Fc(u,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),h=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(h=u.memoizedState.cachePool.pool),h!==l&&(u.flags|=2048),r!==null&&G(Xr),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),u.memoizedState.cache!==l&&(u.flags|=2048),En(Ft),St(u),null;case 25:return null;case 30:return null}throw Error(i(156,u.tag))}function _6(r,u){switch(kh(u),u.tag){case 1:return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 3:return En(Ft),Je(),r=u.flags,(r&65536)!==0&&(r&128)===0?(u.flags=r&-65537|128,u):null;case 26:case 27:case 5:return di(u),null;case 31:if(u.memoizedState!==null){if(ti(u),u.alternate===null)throw Error(i(340));Yr()}return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 13:if(ti(u),r=u.memoizedState,r!==null&&r.dehydrated!==null){if(u.alternate===null)throw Error(i(340));Yr()}return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 19:return G(Mt),null;case 4:return Je(),null;case 10:return En(u.type),null;case 22:case 23:return ti(u),Qh(),r!==null&&G(Xr),r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 24:return En(Ft),null;case 25:return null;default:return null}}function kE(r,u){switch(kh(u),u.tag){case 3:En(Ft),Je();break;case 26:case 27:case 5:di(u);break;case 4:Je();break;case 31:u.memoizedState!==null&&ti(u);break;case 13:ti(u);break;case 19:G(Mt);break;case 10:En(u.type);break;case 22:case 23:ti(u),Qh(),r!==null&&G(Xr);break;case 24:En(Ft)}}function Co(r,u){try{var l=u.updateQueue,h=l!==null?l.lastEffect:null;if(h!==null){var b=h.next;l=b;do{if((l.tag&r)===r){h=void 0;var x=l.create,_=l.inst;h=x(),_.destroy=h}l=l.next}while(l!==b)}}catch(N){ct(u,u.return,N)}}function ir(r,u,l){try{var h=u.updateQueue,b=h!==null?h.lastEffect:null;if(b!==null){var x=b.next;h=x;do{if((h.tag&r)===r){var _=h.inst,N=_.destroy;if(N!==void 0){_.destroy=void 0,b=u;var H=l,Z=N;try{Z()}catch(oe){ct(b,H,oe)}}}h=h.next}while(h!==x)}}catch(oe){ct(u,u.return,oe)}}function ME(r){var u=r.updateQueue;if(u!==null){var l=r.stateNode;try{_b(u,l)}catch(h){ct(r,r.return,h)}}}function PE(r,u,l){l.props=ta(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(h){ct(r,u,h)}}function No(r,u){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var h=r.stateNode;break;case 30:h=r.stateNode;break;default:h=r.stateNode}typeof l=="function"?r.refCleanup=l(h):l.current=h}}catch(b){ct(r,u,b)}}function qi(r,u){var l=r.ref,h=r.refCleanup;if(l!==null)if(typeof h=="function")try{h()}catch(b){ct(r,u,b)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(b){ct(r,u,b)}else l.current=null}function UE(r){var u=r.type,l=r.memoizedProps,h=r.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":l.autoFocus&&h.focus();break e;case"img":l.src?h.src=l.src:l.srcSet&&(h.srcset=l.srcSet)}}catch(b){ct(r,r.return,b)}}function R0(r,u,l){try{var h=r.stateNode;Y6(h,r.type,l,u),h[ws]=u}catch(b){ct(r,r.return,b)}}function BE(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&cr(r.type)||r.tag===4}function I0(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||BE(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&cr(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function C0(r,u,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,u?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,u):(u=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,u.appendChild(r),l=l._reactRootContainer,l!=null||u.onclick!==null||(u.onclick=hn));else if(h!==4&&(h===27&&cr(r.type)&&(l=r.stateNode,u=null),r=r.child,r!==null))for(C0(r,u,l),r=r.sibling;r!==null;)C0(r,u,l),r=r.sibling}function Hc(r,u,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,u?l.insertBefore(r,u):l.appendChild(r);else if(h!==4&&(h===27&&cr(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(Hc(r,u,l),r=r.sibling;r!==null;)Hc(r,u,l),r=r.sibling}function FE(r){var u=r.stateNode,l=r.memoizedProps;try{for(var h=r.type,b=u.attributes;b.length;)u.removeAttributeNode(b[0]);ps(u,h,l),u[fs]=r,u[ws]=l}catch(x){ct(r,r.return,x)}}var Sn=!1,$t=!1,N0=!1,HE=typeof WeakSet=="function"?WeakSet:Set,ns=null;function L6(r,u){if(r=r.containerInfo,W0=ud,r=Z1(r),Sh(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var b=h.anchorOffset,x=h.focusNode;h=h.focusOffset;try{l.nodeType,x.nodeType}catch{l=null;break e}var _=0,N=-1,H=-1,Z=0,oe=0,he=r,ee=null;t:for(;;){for(var re;he!==l||b!==0&&he.nodeType!==3||(N=_+b),he!==x||h!==0&&he.nodeType!==3||(H=_+h),he.nodeType===3&&(_+=he.nodeValue.length),(re=he.firstChild)!==null;)ee=he,he=re;for(;;){if(he===r)break t;if(ee===l&&++Z===b&&(N=_),ee===x&&++oe===h&&(H=_),(re=he.nextSibling)!==null)break;he=ee,ee=he.parentNode}he=re}l=N===-1||H===-1?null:{start:N,end:H}}else l=null}l=l||{start:0,end:0}}else l=null;for(Z0={focusedElem:r,selectionRange:l},ud=!1,ns=u;ns!==null;)if(u=ns,r=u.child,(u.subtreeFlags&1028)!==0&&r!==null)r.return=u,ns=r;else for(;ns!==null;){switch(u=ns,x=u.alternate,r=u.flags,u.tag){case 0:if((r&4)!==0&&(r=u.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)b=r[l],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&x!==null){r=void 0,l=u,b=x.memoizedProps,x=x.memoizedState,h=l.stateNode;try{var Le=ta(l.type,b);r=h.getSnapshotBeforeUpdate(Le,x),h.__reactInternalSnapshotBeforeUpdate=r}catch(De){ct(l,l.return,De)}}break;case 3:if((r&1024)!==0){if(r=u.stateNode.containerInfo,l=r.nodeType,l===9)tm(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":tm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=u.sibling,r!==null){r.return=u.return,ns=r;break}ns=u.return}}function jE(r,u,l){var h=l.flags;switch(l.tag){case 0:case 11:case 15:_n(r,l),h&4&&Co(5,l);break;case 1:if(_n(r,l),h&4)if(r=l.stateNode,u===null)try{r.componentDidMount()}catch(_){ct(l,l.return,_)}else{var b=ta(l.type,u.memoizedProps);u=u.memoizedState;try{r.componentDidUpdate(b,u,r.__reactInternalSnapshotBeforeUpdate)}catch(_){ct(l,l.return,_)}}h&64&&ME(l),h&512&&No(l,l.return);break;case 3:if(_n(r,l),h&64&&(r=l.updateQueue,r!==null)){if(u=null,l.child!==null)switch(l.child.tag){case 27:case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}try{_b(r,u)}catch(_){ct(l,l.return,_)}}break;case 27:u===null&&h&4&&FE(l);case 26:case 5:_n(r,l),u===null&&h&4&&UE(l),h&512&&No(l,l.return);break;case 12:_n(r,l);break;case 31:_n(r,l),h&4&&qE(r,l);break;case 13:_n(r,l),h&4&&VE(r,l),h&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=M6.bind(null,l),tL(r,l))));break;case 22:if(h=l.memoizedState!==null||Sn,!h){u=u!==null&&u.memoizedState!==null||$t,b=Sn;var x=$t;Sn=h,($t=u)&&!x?Ln(r,l,(l.subtreeFlags&8772)!==0):_n(r,l),Sn=b,$t=x}break;case 30:break;default:_n(r,l)}}function $E(r){var u=r.alternate;u!==null&&(r.alternate=null,$E(u)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(u=r.stateNode,u!==null&&ah(u)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var At=null,ks=!1;function An(r,u,l){for(l=l.child;l!==null;)GE(r,u,l),l=l.sibling}function GE(r,u,l){if(Xs&&typeof Xs.onCommitFiberUnmount=="function")try{Xs.onCommitFiberUnmount(Ju,l)}catch{}switch(l.tag){case 26:$t||qi(l,u),An(r,u,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:$t||qi(l,u);var h=At,b=ks;cr(l.type)&&(At=l.stateNode,ks=!1),An(r,u,l),Fo(l.stateNode),At=h,ks=b;break;case 5:$t||qi(l,u);case 6:if(h=At,b=ks,At=null,An(r,u,l),At=h,ks=b,At!==null)if(ks)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(l.stateNode)}catch(x){ct(l,u,x)}else try{At.removeChild(l.stateNode)}catch(x){ct(l,u,x)}break;case 18:At!==null&&(ks?(r=At,My(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),hu(r)):My(At,l.stateNode));break;case 4:h=At,b=ks,At=l.stateNode.containerInfo,ks=!0,An(r,u,l),At=h,ks=b;break;case 0:case 11:case 14:case 15:ir(2,l,u),$t||ir(4,l,u),An(r,u,l);break;case 1:$t||(qi(l,u),h=l.stateNode,typeof h.componentWillUnmount=="function"&&PE(l,u,h)),An(r,u,l);break;case 21:An(r,u,l);break;case 22:$t=(h=$t)||l.memoizedState!==null,An(r,u,l),$t=h;break;default:An(r,u,l)}}function qE(r,u){if(u.memoizedState===null&&(r=u.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{hu(r)}catch(l){ct(u,u.return,l)}}}function VE(r,u){if(u.memoizedState===null&&(r=u.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{hu(r)}catch(l){ct(u,u.return,l)}}function R6(r){switch(r.tag){case 31:case 13:case 19:var u=r.stateNode;return u===null&&(u=r.stateNode=new HE),u;case 22:return r=r.stateNode,u=r._retryCache,u===null&&(u=r._retryCache=new HE),u;default:throw Error(i(435,r.tag))}}function jc(r,u){var l=R6(r);u.forEach(function(h){if(!l.has(h)){l.add(h);var b=P6.bind(null,r,h);h.then(b,b)}})}function Ms(r,u){var l=u.deletions;if(l!==null)for(var h=0;h<l.length;h++){var b=l[h],x=r,_=u,N=_;e:for(;N!==null;){switch(N.tag){case 27:if(cr(N.type)){At=N.stateNode,ks=!1;break e}break;case 5:At=N.stateNode,ks=!1;break e;case 3:case 4:At=N.stateNode.containerInfo,ks=!0;break e}N=N.return}if(At===null)throw Error(i(160));GE(x,_,b),At=null,ks=!1,x=b.alternate,x!==null&&(x.return=null),b.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)zE(u,r),u=u.sibling}var Ni=null;function zE(r,u){var l=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ms(u,r),Ps(r),h&4&&(ir(3,r,r.return),Co(3,r),ir(5,r,r.return));break;case 1:Ms(u,r),Ps(r),h&512&&($t||l===null||qi(l,l.return)),h&64&&Sn&&(r=r.updateQueue,r!==null&&(h=r.callbacks,h!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?h:l.concat(h))));break;case 26:var b=Ni;if(Ms(u,r),Ps(r),h&512&&($t||l===null||qi(l,l.return)),h&4){var x=l!==null?l.memoizedState:null;if(h=r.memoizedState,l===null)if(h===null)if(r.stateNode===null){e:{h=r.type,l=r.memoizedProps,b=b.ownerDocument||b;t:switch(h){case"title":x=b.getElementsByTagName("title")[0],(!x||x[so]||x[fs]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=b.createElement(h),b.head.insertBefore(x,b.querySelector("head > title"))),ps(x,h,l),x[fs]=r,is(x),h=x;break e;case"link":var _=zy("link","href",b).get(h+(l.href||""));if(_){for(var N=0;N<_.length;N++)if(x=_[N],x.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&x.getAttribute("rel")===(l.rel==null?null:l.rel)&&x.getAttribute("title")===(l.title==null?null:l.title)&&x.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){_.splice(N,1);break t}}x=b.createElement(h),ps(x,h,l),b.head.appendChild(x);break;case"meta":if(_=zy("meta","content",b).get(h+(l.content||""))){for(N=0;N<_.length;N++)if(x=_[N],x.getAttribute("content")===(l.content==null?null:""+l.content)&&x.getAttribute("name")===(l.name==null?null:l.name)&&x.getAttribute("property")===(l.property==null?null:l.property)&&x.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&x.getAttribute("charset")===(l.charSet==null?null:l.charSet)){_.splice(N,1);break t}}x=b.createElement(h),ps(x,h,l),b.head.appendChild(x);break;default:throw Error(i(468,h))}x[fs]=r,is(x),h=x}r.stateNode=h}else Yy(b,r.type,r.stateNode);else r.stateNode=Vy(b,h,r.memoizedProps);else x!==h?(x===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):x.count--,h===null?Yy(b,r.type,r.stateNode):Vy(b,h,r.memoizedProps)):h===null&&r.stateNode!==null&&R0(r,r.memoizedProps,l.memoizedProps)}break;case 27:Ms(u,r),Ps(r),h&512&&($t||l===null||qi(l,l.return)),l!==null&&h&4&&R0(r,r.memoizedProps,l.memoizedProps);break;case 5:if(Ms(u,r),Ps(r),h&512&&($t||l===null||qi(l,l.return)),r.flags&32){b=r.stateNode;try{Pa(b,"")}catch(Le){ct(r,r.return,Le)}}h&4&&r.stateNode!=null&&(b=r.memoizedProps,R0(r,b,l!==null?l.memoizedProps:b)),h&1024&&(N0=!0);break;case 6:if(Ms(u,r),Ps(r),h&4){if(r.stateNode===null)throw Error(i(162));h=r.memoizedProps,l=r.stateNode;try{l.nodeValue=h}catch(Le){ct(r,r.return,Le)}}break;case 3:if(id=null,b=Ni,Ni=td(u.containerInfo),Ms(u,r),Ni=b,Ps(r),h&4&&l!==null&&l.memoizedState.isDehydrated)try{hu(u.containerInfo)}catch(Le){ct(r,r.return,Le)}N0&&(N0=!1,YE(r));break;case 4:h=Ni,Ni=td(r.stateNode.containerInfo),Ms(u,r),Ps(r),Ni=h;break;case 12:Ms(u,r),Ps(r);break;case 31:Ms(u,r),Ps(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,jc(r,h)));break;case 13:Ms(u,r),Ps(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Gc=ss()),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,jc(r,h)));break;case 22:b=r.memoizedState!==null;var H=l!==null&&l.memoizedState!==null,Z=Sn,oe=$t;if(Sn=Z||b,$t=oe||H,Ms(u,r),$t=oe,Sn=Z,Ps(r),h&8192)e:for(u=r.stateNode,u._visibility=b?u._visibility&-2:u._visibility|1,b&&(l===null||H||Sn||$t||sa(r)),l=null,u=r;;){if(u.tag===5||u.tag===26){if(l===null){H=l=u;try{if(x=H.stateNode,b)_=x.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{N=H.stateNode;var he=H.memoizedProps.style,ee=he!=null&&he.hasOwnProperty("display")?he.display:null;N.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(Le){ct(H,H.return,Le)}}}else if(u.tag===6){if(l===null){H=u;try{H.stateNode.nodeValue=b?"":H.memoizedProps}catch(Le){ct(H,H.return,Le)}}}else if(u.tag===18){if(l===null){H=u;try{var re=H.stateNode;b?Py(re,!0):Py(H.stateNode,!1)}catch(Le){ct(H,H.return,Le)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===r)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break e;for(;u.sibling===null;){if(u.return===null||u.return===r)break e;l===u&&(l=null),u=u.return}l===u&&(l=null),u.sibling.return=u.return,u=u.sibling}h&4&&(h=r.updateQueue,h!==null&&(l=h.retryQueue,l!==null&&(h.retryQueue=null,jc(r,l))));break;case 19:Ms(u,r),Ps(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,jc(r,h)));break;case 30:break;case 21:break;default:Ms(u,r),Ps(r)}}function Ps(r){var u=r.flags;if(u&2){try{for(var l,h=r.return;h!==null;){if(BE(h)){l=h;break}h=h.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var b=l.stateNode,x=I0(r);Hc(r,x,b);break;case 5:var _=l.stateNode;l.flags&32&&(Pa(_,""),l.flags&=-33);var N=I0(r);Hc(r,N,_);break;case 3:case 4:var H=l.stateNode.containerInfo,Z=I0(r);C0(r,Z,H);break;default:throw Error(i(161))}}catch(oe){ct(r,r.return,oe)}r.flags&=-3}u&4096&&(r.flags&=-4097)}function YE(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var u=r;YE(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),r=r.sibling}}function _n(r,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)jE(r,u.alternate,u),u=u.sibling}function sa(r){for(r=r.child;r!==null;){var u=r;switch(u.tag){case 0:case 11:case 14:case 15:ir(4,u,u.return),sa(u);break;case 1:qi(u,u.return);var l=u.stateNode;typeof l.componentWillUnmount=="function"&&PE(u,u.return,l),sa(u);break;case 27:Fo(u.stateNode);case 26:case 5:qi(u,u.return),sa(u);break;case 22:u.memoizedState===null&&sa(u);break;case 30:sa(u);break;default:sa(u)}r=r.sibling}}function Ln(r,u,l){for(l=l&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var h=u.alternate,b=r,x=u,_=x.flags;switch(x.tag){case 0:case 11:case 15:Ln(b,x,l),Co(4,x);break;case 1:if(Ln(b,x,l),h=x,b=h.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Z){ct(h,h.return,Z)}if(h=x,b=h.updateQueue,b!==null){var N=h.stateNode;try{var H=b.shared.hiddenCallbacks;if(H!==null)for(b.shared.hiddenCallbacks=null,b=0;b<H.length;b++)Ab(H[b],N)}catch(Z){ct(h,h.return,Z)}}l&&_&64&&ME(x),No(x,x.return);break;case 27:FE(x);case 26:case 5:Ln(b,x,l),l&&h===null&&_&4&&UE(x),No(x,x.return);break;case 12:Ln(b,x,l);break;case 31:Ln(b,x,l),l&&_&4&&qE(b,x);break;case 13:Ln(b,x,l),l&&_&4&&VE(b,x);break;case 22:x.memoizedState===null&&Ln(b,x,l),No(x,x.return);break;case 30:break;default:Ln(b,x,l)}u=u.sibling}}function D0(r,u){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(r=u.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&po(l))}function w0(r,u){r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&po(r))}function Di(r,u,l,h){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)KE(r,u,l,h),u=u.sibling}function KE(r,u,l,h){var b=u.flags;switch(u.tag){case 0:case 11:case 15:Di(r,u,l,h),b&2048&&Co(9,u);break;case 1:Di(r,u,l,h);break;case 3:Di(r,u,l,h),b&2048&&(r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&po(r)));break;case 12:if(b&2048){Di(r,u,l,h),r=u.stateNode;try{var x=u.memoizedProps,_=x.id,N=x.onPostCommit;typeof N=="function"&&N(_,u.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(H){ct(u,u.return,H)}}else Di(r,u,l,h);break;case 31:Di(r,u,l,h);break;case 13:Di(r,u,l,h);break;case 23:break;case 22:x=u.stateNode,_=u.alternate,u.memoizedState!==null?x._visibility&2?Di(r,u,l,h):Do(r,u):x._visibility&2?Di(r,u,l,h):(x._visibility|=2,su(r,u,l,h,(u.subtreeFlags&10256)!==0||!1)),b&2048&&D0(_,u);break;case 24:Di(r,u,l,h),b&2048&&w0(u.alternate,u);break;default:Di(r,u,l,h)}}function su(r,u,l,h,b){for(b=b&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var x=r,_=u,N=l,H=h,Z=_.flags;switch(_.tag){case 0:case 11:case 15:su(x,_,N,H,b),Co(8,_);break;case 23:break;case 22:var oe=_.stateNode;_.memoizedState!==null?oe._visibility&2?su(x,_,N,H,b):Do(x,_):(oe._visibility|=2,su(x,_,N,H,b)),b&&Z&2048&&D0(_.alternate,_);break;case 24:su(x,_,N,H,b),b&&Z&2048&&w0(_.alternate,_);break;default:su(x,_,N,H,b)}u=u.sibling}}function Do(r,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var l=r,h=u,b=h.flags;switch(h.tag){case 22:Do(l,h),b&2048&&D0(h.alternate,h);break;case 24:Do(l,h),b&2048&&w0(h.alternate,h);break;default:Do(l,h)}u=u.sibling}}var wo=8192;function iu(r,u,l){if(r.subtreeFlags&wo)for(r=r.child;r!==null;)QE(r,u,l),r=r.sibling}function QE(r,u,l){switch(r.tag){case 26:iu(r,u,l),r.flags&wo&&r.memoizedState!==null&&hL(l,Ni,r.memoizedState,r.memoizedProps);break;case 5:iu(r,u,l);break;case 3:case 4:var h=Ni;Ni=td(r.stateNode.containerInfo),iu(r,u,l),Ni=h;break;case 22:r.memoizedState===null&&(h=r.alternate,h!==null&&h.memoizedState!==null?(h=wo,wo=16777216,iu(r,u,l),wo=h):iu(r,u,l));break;default:iu(r,u,l)}}function XE(r){var u=r.alternate;if(u!==null&&(r=u.child,r!==null)){u.child=null;do u=r.sibling,r.sibling=null,r=u;while(r!==null)}}function Oo(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var l=0;l<u.length;l++){var h=u[l];ns=h,ZE(h,r)}XE(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)WE(r),r=r.sibling}function WE(r){switch(r.tag){case 0:case 11:case 15:Oo(r),r.flags&2048&&ir(9,r,r.return);break;case 3:Oo(r);break;case 12:Oo(r);break;case 22:var u=r.stateNode;r.memoizedState!==null&&u._visibility&2&&(r.return===null||r.return.tag!==13)?(u._visibility&=-3,$c(r)):Oo(r);break;default:Oo(r)}}function $c(r){var u=r.deletions;if((r.flags&16)!==0){if(u!==null)for(var l=0;l<u.length;l++){var h=u[l];ns=h,ZE(h,r)}XE(r)}for(r=r.child;r!==null;){switch(u=r,u.tag){case 0:case 11:case 15:ir(8,u,u.return),$c(u);break;case 22:l=u.stateNode,l._visibility&2&&(l._visibility&=-3,$c(u));break;default:$c(u)}r=r.sibling}}function ZE(r,u){for(;ns!==null;){var l=ns;switch(l.tag){case 0:case 11:case 15:ir(8,l,u);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var h=l.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:po(l.memoizedState.cache)}if(h=l.child,h!==null)h.return=l,ns=h;else e:for(l=r;ns!==null;){h=ns;var b=h.sibling,x=h.return;if($E(h),h===l){ns=null;break e}if(b!==null){b.return=x,ns=b;break e}ns=x}}}var I6={getCacheForType:function(r){var u=ms(Ft),l=u.data.get(r);return l===void 0&&(l=r(),u.data.set(r,l)),l},cacheSignal:function(){return ms(Ft).controller.signal}},C6=typeof WeakMap=="function"?WeakMap:Map,at=0,Et=null,ze=null,Qe=0,lt=0,si=null,nr=!1,nu=!1,O0=!1,Rn=0,Dt=0,rr=0,ia=0,k0=0,ii=0,ru=0,ko=null,Us=null,M0=!1,Gc=0,JE=0,qc=1/0,Vc=null,ar=null,Wt=0,ur=null,au=null,In=0,P0=0,U0=null,ey=null,Mo=0,B0=null;function ni(){return(at&2)!==0&&Qe!==0?Qe&-Qe:F.T!==null?q0():p1()}function ty(){if(ii===0)if((Qe&536870912)===0||We){var r=Jl;Jl<<=1,(Jl&3932160)===0&&(Jl=262144),ii=r}else ii=536870912;return r=ei.current,r!==null&&(r.flags|=32),ii}function Bs(r,u,l){(r===Et&&(lt===2||lt===9)||r.cancelPendingCommit!==null)&&(uu(r,0),or(r,Qe,ii,!1)),to(r,l),((at&2)===0||r!==Et)&&(r===Et&&((at&2)===0&&(ia|=l),Dt===4&&or(r,Qe,ii,!1)),Vi(r))}function sy(r,u,l){if((at&6)!==0)throw Error(i(327));var h=!l&&(u&127)===0&&(u&r.expiredLanes)===0||eo(r,u),b=h?w6(r,u):H0(r,u,!0),x=h;do{if(b===0){nu&&!h&&or(r,u,0,!1);break}else{if(l=r.current.alternate,x&&!N6(l)){b=H0(r,u,!1),x=!1;continue}if(b===2){if(x=u,r.errorRecoveryDisabledLanes&x)var _=0;else _=r.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){u=_;e:{var N=r;b=ko;var H=N.current.memoizedState.isDehydrated;if(H&&(uu(N,_).flags|=256),_=H0(N,_,!1),_!==2){if(O0&&!H){N.errorRecoveryDisabledLanes|=x,ia|=x,b=4;break e}x=Us,Us=b,x!==null&&(Us===null?Us=x:Us.push.apply(Us,x))}b=_}if(x=!1,b!==2)continue}}if(b===1){uu(r,0),or(r,u,0,!0);break}e:{switch(h=r,x=b,x){case 0:case 1:throw Error(i(345));case 4:if((u&4194048)!==u)break;case 6:or(h,u,ii,!nr);break e;case 2:Us=null;break;case 3:case 5:break;default:throw Error(i(329))}if((u&62914560)===u&&(b=Gc+300-ss(),10<b)){if(or(h,u,ii,!nr),tc(h,0,!0)!==0)break e;In=u,h.timeoutHandle=Oy(iy.bind(null,h,l,Us,Vc,M0,u,ii,ia,ru,nr,x,"Throttled",-0,0),b);break e}iy(h,l,Us,Vc,M0,u,ii,ia,ru,nr,x,null,-0,0)}}break}while(!0);Vi(r)}function iy(r,u,l,h,b,x,_,N,H,Z,oe,he,ee,re){if(r.timeoutHandle=-1,he=u.subtreeFlags,he&8192||(he&16785408)===16785408){he={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hn},QE(u,x,he);var Le=(x&62914560)===x?Gc-ss():(x&4194048)===x?JE-ss():0;if(Le=mL(he,Le),Le!==null){In=x,r.cancelPendingCommit=Le(dy.bind(null,r,u,x,l,h,b,_,N,H,oe,he,null,ee,re)),or(r,x,_,!Z);return}}dy(r,u,x,l,h,b,_,N,H)}function N6(r){for(var u=r;;){var l=u.tag;if((l===0||l===11||l===15)&&u.flags&16384&&(l=u.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var h=0;h<l.length;h++){var b=l[h],x=b.getSnapshot;b=b.value;try{if(!Zs(x(),b))return!1}catch{return!1}}if(l=u.child,u.subtreeFlags&16384&&l!==null)l.return=u,u=l;else{if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function or(r,u,l,h){u&=~k0,u&=~ia,r.suspendedLanes|=u,r.pingedLanes&=~u,h&&(r.warmLanes|=u),h=r.expirationTimes;for(var b=u;0<b;){var x=31-Ws(b),_=1<<x;h[x]=-1,b&=~_}l!==0&&h1(r,l,u)}function zc(){return(at&6)===0?(Po(0),!1):!0}function F0(){if(ze!==null){if(lt===0)var r=ze.return;else r=ze,bn=Kr=null,t0(r),Wa=null,Eo=0,r=ze;for(;r!==null;)kE(r.alternate,r),r=r.return;ze=null}}function uu(r,u){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,X6(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),In=0,F0(),Et=r,ze=l=gn(r.current,null),Qe=u,lt=0,si=null,nr=!1,nu=eo(r,u),O0=!1,ru=ii=k0=ia=rr=Dt=0,Us=ko=null,M0=!1,(u&8)!==0&&(u|=u&32);var h=r.entangledLanes;if(h!==0)for(r=r.entanglements,h&=u;0<h;){var b=31-Ws(h),x=1<<b;u|=r[b],h&=~x}return Rn=u,hc(),l}function ny(r,u){Fe=null,F.H=Lo,u===Xa||u===Tc?(u=xb(),lt=3):u===Gh?(u=xb(),lt=4):lt=u===b0?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,si=u,ze===null&&(Dt=1,Mc(r,gi(u,r.current)))}function ry(){var r=ei.current;return r===null?!0:(Qe&4194048)===Qe?yi===null:(Qe&62914560)===Qe||(Qe&536870912)!==0?r===yi:!1}function ay(){var r=F.H;return F.H=Lo,r===null?Lo:r}function uy(){var r=F.A;return F.A=I6,r}function Yc(){Dt=4,nr||(Qe&4194048)!==Qe&&ei.current!==null||(nu=!0),(rr&134217727)===0&&(ia&134217727)===0||Et===null||or(Et,Qe,ii,!1)}function H0(r,u,l){var h=at;at|=2;var b=ay(),x=uy();(Et!==r||Qe!==u)&&(Vc=null,uu(r,u)),u=!1;var _=Dt;e:do try{if(lt!==0&&ze!==null){var N=ze,H=si;switch(lt){case 8:F0(),_=6;break e;case 3:case 2:case 9:case 6:ei.current===null&&(u=!0);var Z=lt;if(lt=0,si=null,ou(r,N,H,Z),l&&nu){_=0;break e}break;default:Z=lt,lt=0,si=null,ou(r,N,H,Z)}}D6(),_=Dt;break}catch(oe){ny(r,oe)}while(!0);return u&&r.shellSuspendCounter++,bn=Kr=null,at=h,F.H=b,F.A=x,ze===null&&(Et=null,Qe=0,hc()),_}function D6(){for(;ze!==null;)oy(ze)}function w6(r,u){var l=at;at|=2;var h=ay(),b=uy();Et!==r||Qe!==u?(Vc=null,qc=ss()+500,uu(r,u)):nu=eo(r,u);e:do try{if(lt!==0&&ze!==null){u=ze;var x=si;t:switch(lt){case 1:lt=0,si=null,ou(r,u,x,1);break;case 2:case 9:if(Eb(x)){lt=0,si=null,ly(u);break}u=function(){lt!==2&&lt!==9||Et!==r||(lt=7),Vi(r)},x.then(u,u);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:Eb(x)?(lt=0,si=null,ly(u)):(lt=0,si=null,ou(r,u,x,7));break;case 5:var _=null;switch(ze.tag){case 26:_=ze.memoizedState;case 5:case 27:var N=ze;if(_?Ky(_):N.stateNode.complete){lt=0,si=null;var H=N.sibling;if(H!==null)ze=H;else{var Z=N.return;Z!==null?(ze=Z,Kc(Z)):ze=null}break t}}lt=0,si=null,ou(r,u,x,5);break;case 6:lt=0,si=null,ou(r,u,x,6);break;case 8:F0(),Dt=6;break e;default:throw Error(i(462))}}O6();break}catch(oe){ny(r,oe)}while(!0);return bn=Kr=null,F.H=h,F.A=b,at=l,ze!==null?0:(Et=null,Qe=0,hc(),Dt)}function O6(){for(;ze!==null&&!dn();)oy(ze)}function oy(r){var u=wE(r.alternate,r,Rn);r.memoizedProps=r.pendingProps,u===null?Kc(r):ze=u}function ly(r){var u=r,l=u.alternate;switch(u.tag){case 15:case 0:u=LE(l,u,u.pendingProps,u.type,void 0,Qe);break;case 11:u=LE(l,u,u.pendingProps,u.type.render,u.ref,Qe);break;case 5:t0(u);default:kE(l,u),u=ze=ub(u,Rn),u=wE(l,u,Rn)}r.memoizedProps=r.pendingProps,u===null?Kc(r):ze=u}function ou(r,u,l,h){bn=Kr=null,t0(u),Wa=null,Eo=0;var b=u.return;try{if(T6(r,b,u,l,Qe)){Dt=1,Mc(r,gi(l,r.current)),ze=null;return}}catch(x){if(b!==null)throw ze=b,x;Dt=1,Mc(r,gi(l,r.current)),ze=null;return}u.flags&32768?(We||h===1?r=!0:nu||(Qe&536870912)!==0?r=!1:(nr=r=!0,(h===2||h===9||h===3||h===6)&&(h=ei.current,h!==null&&h.tag===13&&(h.flags|=16384))),cy(u,r)):Kc(u)}function Kc(r){var u=r;do{if((u.flags&32768)!==0){cy(u,nr);return}r=u.return;var l=A6(u.alternate,u,Rn);if(l!==null){ze=l;return}if(u=u.sibling,u!==null){ze=u;return}ze=u=r}while(u!==null);Dt===0&&(Dt=5)}function cy(r,u){do{var l=_6(r.alternate,r);if(l!==null){l.flags&=32767,ze=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!u&&(r=r.sibling,r!==null)){ze=r;return}ze=r=l}while(r!==null);Dt=6,ze=null}function dy(r,u,l,h,b,x,_,N,H){r.cancelPendingCommit=null;do Qc();while(Wt!==0);if((at&6)!==0)throw Error(i(327));if(u!==null){if(u===r.current)throw Error(i(177));if(x=u.lanes|u.childLanes,x|=Ih,f_(r,l,x,_,N,H),r===Et&&(ze=Et=null,Qe=0),au=u,ur=r,In=l,P0=x,U0=b,ey=h,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,U6(Ca,function(){return py(),null})):(r.callbackNode=null,r.callbackPriority=0),h=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||h){h=F.T,F.T=null,b=J.p,J.p=2,_=at,at|=4;try{L6(r,u,l)}finally{at=_,J.p=b,F.T=h}}Wt=1,fy(),hy(),my()}}function fy(){if(Wt===1){Wt=0;var r=ur,u=au,l=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||l){l=F.T,F.T=null;var h=J.p;J.p=2;var b=at;at|=4;try{zE(u,r);var x=Z0,_=Z1(r.containerInfo),N=x.focusedElem,H=x.selectionRange;if(_!==N&&N&&N.ownerDocument&&W1(N.ownerDocument.documentElement,N)){if(H!==null&&Sh(N)){var Z=H.start,oe=H.end;if(oe===void 0&&(oe=Z),"selectionStart"in N)N.selectionStart=Z,N.selectionEnd=Math.min(oe,N.value.length);else{var he=N.ownerDocument||document,ee=he&&he.defaultView||window;if(ee.getSelection){var re=ee.getSelection(),Le=N.textContent.length,De=Math.min(H.start,Le),gt=H.end===void 0?De:Math.min(H.end,Le);!re.extend&&De>gt&&(_=gt,gt=De,De=_);var Y=X1(N,De),q=X1(N,gt);if(Y&&q&&(re.rangeCount!==1||re.anchorNode!==Y.node||re.anchorOffset!==Y.offset||re.focusNode!==q.node||re.focusOffset!==q.offset)){var W=he.createRange();W.setStart(Y.node,Y.offset),re.removeAllRanges(),De>gt?(re.addRange(W),re.extend(q.node,q.offset)):(W.setEnd(q.node,q.offset),re.addRange(W))}}}}for(he=[],re=N;re=re.parentNode;)re.nodeType===1&&he.push({element:re,left:re.scrollLeft,top:re.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<he.length;N++){var fe=he[N];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}ud=!!W0,Z0=W0=null}finally{at=b,J.p=h,F.T=l}}r.current=u,Wt=2}}function hy(){if(Wt===2){Wt=0;var r=ur,u=au,l=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||l){l=F.T,F.T=null;var h=J.p;J.p=2;var b=at;at|=4;try{jE(r,u.alternate,u)}finally{at=b,J.p=h,F.T=l}}Wt=3}}function my(){if(Wt===4||Wt===3){Wt=0,Ql();var r=ur,u=au,l=In,h=ey;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Wt=5:(Wt=0,au=ur=null,gy(r,r.pendingLanes));var b=r.pendingLanes;if(b===0&&(ar=null),nh(l),u=u.stateNode,Xs&&typeof Xs.onCommitFiberRoot=="function")try{Xs.onCommitFiberRoot(Ju,u,void 0,(u.current.flags&128)===128)}catch{}if(h!==null){u=F.T,b=J.p,J.p=2,F.T=null;try{for(var x=r.onRecoverableError,_=0;_<h.length;_++){var N=h[_];x(N.value,{componentStack:N.stack})}}finally{F.T=u,J.p=b}}(In&3)!==0&&Qc(),Vi(r),b=r.pendingLanes,(l&261930)!==0&&(b&42)!==0?r===B0?Mo++:(Mo=0,B0=r):Mo=0,Po(0)}}function gy(r,u){(r.pooledCacheLanes&=u)===0&&(u=r.pooledCache,u!=null&&(r.pooledCache=null,po(u)))}function Qc(){return fy(),hy(),my(),py()}function py(){if(Wt!==5)return!1;var r=ur,u=P0;P0=0;var l=nh(In),h=F.T,b=J.p;try{J.p=32>l?32:l,F.T=null,l=U0,U0=null;var x=ur,_=In;if(Wt=0,au=ur=null,In=0,(at&6)!==0)throw Error(i(331));var N=at;if(at|=4,WE(x.current),KE(x,x.current,_,l),at=N,Po(0,!1),Xs&&typeof Xs.onPostCommitFiberRoot=="function")try{Xs.onPostCommitFiberRoot(Ju,x)}catch{}return!0}finally{J.p=b,F.T=h,gy(r,u)}}function by(r,u,l){u=gi(l,u),u=p0(r.stateNode,u,2),r=er(r,u,2),r!==null&&(to(r,2),Vi(r))}function ct(r,u,l){if(r.tag===3)by(r,r,l);else for(;u!==null;){if(u.tag===3){by(u,r,l);break}else if(u.tag===1){var h=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ar===null||!ar.has(h))){r=gi(l,r),l=EE(2),h=er(u,l,2),h!==null&&(yE(l,h,u,r),to(h,2),Vi(h));break}}u=u.return}}function j0(r,u,l){var h=r.pingCache;if(h===null){h=r.pingCache=new C6;var b=new Set;h.set(u,b)}else b=h.get(u),b===void 0&&(b=new Set,h.set(u,b));b.has(l)||(O0=!0,b.add(l),r=k6.bind(null,r,u,l),u.then(r,r))}function k6(r,u,l){var h=r.pingCache;h!==null&&h.delete(u),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,Et===r&&(Qe&l)===l&&(Dt===4||Dt===3&&(Qe&62914560)===Qe&&300>ss()-Gc?(at&2)===0&&uu(r,0):k0|=l,ru===Qe&&(ru=0)),Vi(r)}function Ey(r,u){u===0&&(u=f1()),r=Vr(r,u),r!==null&&(to(r,u),Vi(r))}function M6(r){var u=r.memoizedState,l=0;u!==null&&(l=u.retryLane),Ey(r,l)}function P6(r,u){var l=0;switch(r.tag){case 31:case 13:var h=r.stateNode,b=r.memoizedState;b!==null&&(l=b.retryLane);break;case 19:h=r.stateNode;break;case 22:h=r.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(u),Ey(r,l)}function U6(r,u){return Ls(r,u)}var Xc=null,lu=null,$0=!1,Wc=!1,G0=!1,lr=0;function Vi(r){r!==lu&&r.next===null&&(lu===null?Xc=lu=r:lu=lu.next=r),Wc=!0,$0||($0=!0,F6())}function Po(r,u){if(!G0&&Wc){G0=!0;do for(var l=!1,h=Xc;h!==null;){if(r!==0){var b=h.pendingLanes;if(b===0)var x=0;else{var _=h.suspendedLanes,N=h.pingedLanes;x=(1<<31-Ws(42|r)+1)-1,x&=b&~(_&~N),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(l=!0,vy(h,x))}else x=Qe,x=tc(h,h===Et?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(x&3)===0||eo(h,x)||(l=!0,vy(h,x));h=h.next}while(l);G0=!1}}function B6(){yy()}function yy(){Wc=$0=!1;var r=0;lr!==0&&Q6()&&(r=lr);for(var u=ss(),l=null,h=Xc;h!==null;){var b=h.next,x=xy(h,u);x===0?(h.next=null,l===null?Xc=b:l.next=b,b===null&&(lu=l)):(l=h,(r!==0||(x&3)!==0)&&(Wc=!0)),h=b}Wt!==0&&Wt!==5||Po(r),lr!==0&&(lr=0)}function xy(r,u){for(var l=r.suspendedLanes,h=r.pingedLanes,b=r.expirationTimes,x=r.pendingLanes&-62914561;0<x;){var _=31-Ws(x),N=1<<_,H=b[_];H===-1?((N&l)===0||(N&h)!==0)&&(b[_]=d_(N,u)):H<=u&&(r.expiredLanes|=N),x&=~N}if(u=Et,l=Qe,l=tc(r,r===u?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h=r.callbackNode,l===0||r===u&&(lt===2||lt===9)||r.cancelPendingCommit!==null)return h!==null&&h!==null&&ji(h),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||eo(r,l)){if(u=l&-l,u===r.callbackPriority)return u;switch(h!==null&&ji(h),nh(l)){case 2:case 8:l=Wu;break;case 32:l=Ca;break;case 268435456:l=Zu;break;default:l=Ca}return h=Ty.bind(null,r),l=Ls(l,h),r.callbackPriority=u,r.callbackNode=l,u}return h!==null&&h!==null&&ji(h),r.callbackPriority=2,r.callbackNode=null,2}function Ty(r,u){if(Wt!==0&&Wt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(Qc()&&r.callbackNode!==l)return null;var h=Qe;return h=tc(r,r===Et?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h===0?null:(sy(r,h,u),xy(r,ss()),r.callbackNode!=null&&r.callbackNode===l?Ty.bind(null,r):null)}function vy(r,u){if(Qc())return null;sy(r,u,!0)}function F6(){W6(function(){(at&6)!==0?Ls(qn,B6):yy()})}function q0(){if(lr===0){var r=Ka;r===0&&(r=Zl,Zl<<=1,(Zl&261888)===0&&(Zl=256)),lr=r}return lr}function Sy(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:rc(""+r)}function Ay(r,u){var l=u.ownerDocument.createElement("input");return l.name=u.name,l.value=u.value,r.id&&l.setAttribute("form",r.id),u.parentNode.insertBefore(l,u),r=new FormData(r),l.parentNode.removeChild(l),r}function H6(r,u,l,h,b){if(u==="submit"&&l&&l.stateNode===b){var x=Sy((b[ws]||null).action),_=h.submitter;_&&(u=(u=_[ws]||null)?Sy(u.formAction):_.getAttribute("formAction"),u!==null&&(x=u,_=null));var N=new lc("action","action",null,h,b);r.push({event:N,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(lr!==0){var H=_?Ay(b,_):new FormData(b);c0(l,{pending:!0,data:H,method:b.method,action:x},null,H)}}else typeof x=="function"&&(N.preventDefault(),H=_?Ay(b,_):new FormData(b),c0(l,{pending:!0,data:H,method:b.method,action:x},x,H))},currentTarget:b}]})}}for(var V0=0;V0<Rh.length;V0++){var z0=Rh[V0],j6=z0.toLowerCase(),$6=z0[0].toUpperCase()+z0.slice(1);Ci(j6,"on"+$6)}Ci(tb,"onAnimationEnd"),Ci(sb,"onAnimationIteration"),Ci(ib,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(n6,"onTransitionRun"),Ci(r6,"onTransitionStart"),Ci(a6,"onTransitionCancel"),Ci(nb,"onTransitionEnd"),ka("onMouseEnter",["mouseout","mouseover"]),ka("onMouseLeave",["mouseout","mouseover"]),ka("onPointerEnter",["pointerout","pointerover"]),ka("onPointerLeave",["pointerout","pointerover"]),jr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),jr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),jr("onBeforeInput",["compositionend","keypress","textInput","paste"]),jr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),jr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),jr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Uo));function _y(r,u){u=(u&4)!==0;for(var l=0;l<r.length;l++){var h=r[l],b=h.event;h=h.listeners;e:{var x=void 0;if(u)for(var _=h.length-1;0<=_;_--){var N=h[_],H=N.instance,Z=N.currentTarget;if(N=N.listener,H!==x&&b.isPropagationStopped())break e;x=N,b.currentTarget=Z;try{x(b)}catch(oe){fc(oe)}b.currentTarget=null,x=H}else for(_=0;_<h.length;_++){if(N=h[_],H=N.instance,Z=N.currentTarget,N=N.listener,H!==x&&b.isPropagationStopped())break e;x=N,b.currentTarget=Z;try{x(b)}catch(oe){fc(oe)}b.currentTarget=null,x=H}}}}function Ye(r,u){var l=u[rh];l===void 0&&(l=u[rh]=new Set);var h=r+"__bubble";l.has(h)||(Ly(u,r,2,!1),l.add(h))}function Y0(r,u,l){var h=0;u&&(h|=4),Ly(l,r,h,u)}var Zc="_reactListening"+Math.random().toString(36).slice(2);function K0(r){if(!r[Zc]){r[Zc]=!0,y1.forEach(function(l){l!=="selectionchange"&&(G6.has(l)||Y0(l,!1,r),Y0(l,!0,r))});var u=r.nodeType===9?r:r.ownerDocument;u===null||u[Zc]||(u[Zc]=!0,Y0("selectionchange",!1,u))}}function Ly(r,u,l,h){switch(tx(u)){case 2:var b=bL;break;case 8:b=EL;break;default:b=lm}l=b.bind(null,u,l,r),b=void 0,!mh||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(b=!0),h?b!==void 0?r.addEventListener(u,l,{capture:!0,passive:b}):r.addEventListener(u,l,!0):b!==void 0?r.addEventListener(u,l,{passive:b}):r.addEventListener(u,l,!1)}function Q0(r,u,l,h,b){var x=h;if((u&1)===0&&(u&2)===0&&h!==null)e:for(;;){if(h===null)return;var _=h.tag;if(_===3||_===4){var N=h.stateNode.containerInfo;if(N===b)break;if(_===4)for(_=h.return;_!==null;){var H=_.tag;if((H===3||H===4)&&_.stateNode.containerInfo===b)return;_=_.return}for(;N!==null;){if(_=Da(N),_===null)return;if(H=_.tag,H===5||H===6||H===26||H===27){h=x=_;continue e}N=N.parentNode}}h=h.return}D1(function(){var Z=x,oe=fh(l),he=[];e:{var ee=rb.get(r);if(ee!==void 0){var re=lc,Le=r;switch(r){case"keypress":if(uc(l)===0)break e;case"keydown":case"keyup":re=P_;break;case"focusin":Le="focus",re=Eh;break;case"focusout":Le="blur",re=Eh;break;case"beforeblur":case"afterblur":re=Eh;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=k1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=A_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=F_;break;case tb:case sb:case ib:re=R_;break;case nb:re=j_;break;case"scroll":case"scrollend":re=v_;break;case"wheel":re=G_;break;case"copy":case"cut":case"paste":re=C_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=P1;break;case"toggle":case"beforetoggle":re=V_}var De=(u&4)!==0,gt=!De&&(r==="scroll"||r==="scrollend"),Y=De?ee!==null?ee+"Capture":null:ee;De=[];for(var q=Z,W;q!==null;){var fe=q;if(W=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||W===null||Y===null||(fe=no(q,Y),fe!=null&&De.push(Bo(q,fe,W))),gt)break;q=q.return}0<De.length&&(ee=new re(ee,Le,null,l,oe),he.push({event:ee,listeners:De}))}}if((u&7)===0){e:{if(ee=r==="mouseover"||r==="pointerover",re=r==="mouseout"||r==="pointerout",ee&&l!==dh&&(Le=l.relatedTarget||l.fromElement)&&(Da(Le)||Le[Na]))break e;if((re||ee)&&(ee=oe.window===oe?oe:(ee=oe.ownerDocument)?ee.defaultView||ee.parentWindow:window,re?(Le=l.relatedTarget||l.toElement,re=Z,Le=Le?Da(Le):null,Le!==null&&(gt=a(Le),De=Le.tag,Le!==gt||De!==5&&De!==27&&De!==6)&&(Le=null)):(re=null,Le=Z),re!==Le)){if(De=k1,fe="onMouseLeave",Y="onMouseEnter",q="mouse",(r==="pointerout"||r==="pointerover")&&(De=P1,fe="onPointerLeave",Y="onPointerEnter",q="pointer"),gt=re==null?ee:io(re),W=Le==null?ee:io(Le),ee=new De(fe,q+"leave",re,l,oe),ee.target=gt,ee.relatedTarget=W,fe=null,Da(oe)===Z&&(De=new De(Y,q+"enter",Le,l,oe),De.target=W,De.relatedTarget=gt,fe=De),gt=fe,re&&Le)t:{for(De=q6,Y=re,q=Le,W=0,fe=Y;fe;fe=De(fe))W++;fe=0;for(var Ce=q;Ce;Ce=De(Ce))fe++;for(;0<W-fe;)Y=De(Y),W--;for(;0<fe-W;)q=De(q),fe--;for(;W--;){if(Y===q||q!==null&&Y===q.alternate){De=Y;break t}Y=De(Y),q=De(q)}De=null}else De=null;re!==null&&Ry(he,ee,re,De,!1),Le!==null&&gt!==null&&Ry(he,gt,Le,De,!0)}}e:{if(ee=Z?io(Z):window,re=ee.nodeName&&ee.nodeName.toLowerCase(),re==="select"||re==="input"&&ee.type==="file")var nt=q1;else if($1(ee))if(V1)nt=t6;else{nt=J_;var Re=Z_}else re=ee.nodeName,!re||re.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?Z&&ch(Z.elementType)&&(nt=q1):nt=e6;if(nt&&(nt=nt(r,Z))){G1(he,nt,l,oe);break e}Re&&Re(r,ee,Z),r==="focusout"&&Z&&ee.type==="number"&&Z.memoizedProps.value!=null&&lh(ee,"number",ee.value)}switch(Re=Z?io(Z):window,r){case"focusin":($1(Re)||Re.contentEditable==="true")&&(Ha=Re,Ah=Z,ho=null);break;case"focusout":ho=Ah=Ha=null;break;case"mousedown":_h=!0;break;case"contextmenu":case"mouseup":case"dragend":_h=!1,J1(he,l,oe);break;case"selectionchange":if(i6)break;case"keydown":case"keyup":J1(he,l,oe)}var je;if(xh)e:{switch(r){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else Fa?H1(r,l)&&(Xe="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(Xe="onCompositionStart");Xe&&(U1&&l.locale!=="ko"&&(Fa||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&Fa&&(je=w1()):(Yn=oe,gh="value"in Yn?Yn.value:Yn.textContent,Fa=!0)),Re=Jc(Z,Xe),0<Re.length&&(Xe=new M1(Xe,r,null,l,oe),he.push({event:Xe,listeners:Re}),je?Xe.data=je:(je=j1(l),je!==null&&(Xe.data=je)))),(je=Y_?K_(r,l):Q_(r,l))&&(Xe=Jc(Z,"onBeforeInput"),0<Xe.length&&(Re=new M1("onBeforeInput","beforeinput",null,l,oe),he.push({event:Re,listeners:Xe}),Re.data=je)),H6(he,r,Z,l,oe)}_y(he,u)})}function Bo(r,u,l){return{instance:r,listener:u,currentTarget:l}}function Jc(r,u){for(var l=u+"Capture",h=[];r!==null;){var b=r,x=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||x===null||(b=no(r,l),b!=null&&h.unshift(Bo(r,b,x)),b=no(r,u),b!=null&&h.push(Bo(r,b,x))),r.tag===3)return h;r=r.return}return[]}function q6(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Ry(r,u,l,h,b){for(var x=u._reactName,_=[];l!==null&&l!==h;){var N=l,H=N.alternate,Z=N.stateNode;if(N=N.tag,H!==null&&H===h)break;N!==5&&N!==26&&N!==27||Z===null||(H=Z,b?(Z=no(l,x),Z!=null&&_.unshift(Bo(l,Z,H))):b||(Z=no(l,x),Z!=null&&_.push(Bo(l,Z,H)))),l=l.return}_.length!==0&&r.push({event:u,listeners:_})}var V6=/\r\n?/g,z6=/\u0000|\uFFFD/g;function Iy(r){return(typeof r=="string"?r:""+r).replace(V6,`
`).replace(z6,"")}function Cy(r,u){return u=Iy(u),Iy(r)===u}function mt(r,u,l,h,b,x){switch(l){case"children":typeof h=="string"?u==="body"||u==="textarea"&&h===""||Pa(r,h):(typeof h=="number"||typeof h=="bigint")&&u!=="body"&&Pa(r,""+h);break;case"className":ic(r,"class",h);break;case"tabIndex":ic(r,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ic(r,l,h);break;case"style":C1(r,h,x);break;case"data":if(u!=="object"){ic(r,"data",h);break}case"src":case"href":if(h===""&&(u!=="a"||l!=="href")){r.removeAttribute(l);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(l);break}h=rc(""+h),r.setAttribute(l,h);break;case"action":case"formAction":if(typeof h=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(l==="formAction"?(u!=="input"&&mt(r,u,"name",b.name,b,null),mt(r,u,"formEncType",b.formEncType,b,null),mt(r,u,"formMethod",b.formMethod,b,null),mt(r,u,"formTarget",b.formTarget,b,null)):(mt(r,u,"encType",b.encType,b,null),mt(r,u,"method",b.method,b,null),mt(r,u,"target",b.target,b,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(l);break}h=rc(""+h),r.setAttribute(l,h);break;case"onClick":h!=null&&(r.onclick=hn);break;case"onScroll":h!=null&&Ye("scroll",r);break;case"onScrollEnd":h!=null&&Ye("scrollend",r);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(l=h.__html,l!=null){if(b.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":r.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){r.removeAttribute("xlink:href");break}l=rc(""+h),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,""+h):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":h===!0?r.setAttribute(l,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,h):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?r.setAttribute(l,h):r.removeAttribute(l);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?r.removeAttribute(l):r.setAttribute(l,h);break;case"popover":Ye("beforetoggle",r),Ye("toggle",r),sc(r,"popover",h);break;case"xlinkActuate":fn(r,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":fn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":fn(r,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":fn(r,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":fn(r,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":fn(r,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":fn(r,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":fn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":fn(r,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":sc(r,"is",h);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=x_.get(l)||l,sc(r,l,h))}}function X0(r,u,l,h,b,x){switch(l){case"style":C1(r,h,x);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(l=h.__html,l!=null){if(b.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof h=="string"?Pa(r,h):(typeof h=="number"||typeof h=="bigint")&&Pa(r,""+h);break;case"onScroll":h!=null&&Ye("scroll",r);break;case"onScrollEnd":h!=null&&Ye("scrollend",r);break;case"onClick":h!=null&&(r.onclick=hn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!x1.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(b=l.endsWith("Capture"),u=l.slice(2,b?l.length-7:void 0),x=r[ws]||null,x=x!=null?x[l]:null,typeof x=="function"&&r.removeEventListener(u,x,b),typeof h=="function")){typeof x!="function"&&x!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(u,h,b);break e}l in r?r[l]=h:h===!0?r.setAttribute(l,""):sc(r,l,h)}}}function ps(r,u,l){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ye("error",r),Ye("load",r);var h=!1,b=!1,x;for(x in l)if(l.hasOwnProperty(x)){var _=l[x];if(_!=null)switch(x){case"src":h=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,u));default:mt(r,u,x,_,l,null)}}b&&mt(r,u,"srcSet",l.srcSet,l,null),h&&mt(r,u,"src",l.src,l,null);return;case"input":Ye("invalid",r);var N=x=_=b=null,H=null,Z=null;for(h in l)if(l.hasOwnProperty(h)){var oe=l[h];if(oe!=null)switch(h){case"name":b=oe;break;case"type":_=oe;break;case"checked":H=oe;break;case"defaultChecked":Z=oe;break;case"value":x=oe;break;case"defaultValue":N=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,u));break;default:mt(r,u,h,oe,l,null)}}_1(r,x,N,H,Z,_,b,!1);return;case"select":Ye("invalid",r),h=_=x=null;for(b in l)if(l.hasOwnProperty(b)&&(N=l[b],N!=null))switch(b){case"value":x=N;break;case"defaultValue":_=N;break;case"multiple":h=N;default:mt(r,u,b,N,l,null)}u=x,l=_,r.multiple=!!h,u!=null?Ma(r,!!h,u,!1):l!=null&&Ma(r,!!h,l,!0);return;case"textarea":Ye("invalid",r),x=b=h=null;for(_ in l)if(l.hasOwnProperty(_)&&(N=l[_],N!=null))switch(_){case"value":h=N;break;case"defaultValue":b=N;break;case"children":x=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:mt(r,u,_,N,l,null)}R1(r,h,b,x);return;case"option":for(H in l)if(l.hasOwnProperty(H)&&(h=l[H],h!=null))switch(H){case"selected":r.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:mt(r,u,H,h,l,null)}return;case"dialog":Ye("beforetoggle",r),Ye("toggle",r),Ye("cancel",r),Ye("close",r);break;case"iframe":case"object":Ye("load",r);break;case"video":case"audio":for(h=0;h<Uo.length;h++)Ye(Uo[h],r);break;case"image":Ye("error",r),Ye("load",r);break;case"details":Ye("toggle",r);break;case"embed":case"source":case"link":Ye("error",r),Ye("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in l)if(l.hasOwnProperty(Z)&&(h=l[Z],h!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,u));default:mt(r,u,Z,h,l,null)}return;default:if(ch(u)){for(oe in l)l.hasOwnProperty(oe)&&(h=l[oe],h!==void 0&&X0(r,u,oe,h,l,void 0));return}}for(N in l)l.hasOwnProperty(N)&&(h=l[N],h!=null&&mt(r,u,N,h,l,null))}function Y6(r,u,l,h){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,x=null,_=null,N=null,H=null,Z=null,oe=null;for(re in l){var he=l[re];if(l.hasOwnProperty(re)&&he!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":H=he;default:h.hasOwnProperty(re)||mt(r,u,re,null,h,he)}}for(var ee in h){var re=h[ee];if(he=l[ee],h.hasOwnProperty(ee)&&(re!=null||he!=null))switch(ee){case"type":x=re;break;case"name":b=re;break;case"checked":Z=re;break;case"defaultChecked":oe=re;break;case"value":_=re;break;case"defaultValue":N=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(i(137,u));break;default:re!==he&&mt(r,u,ee,re,h,he)}}oh(r,_,N,H,Z,oe,x,b);return;case"select":re=_=N=ee=null;for(x in l)if(H=l[x],l.hasOwnProperty(x)&&H!=null)switch(x){case"value":break;case"multiple":re=H;default:h.hasOwnProperty(x)||mt(r,u,x,null,h,H)}for(b in h)if(x=h[b],H=l[b],h.hasOwnProperty(b)&&(x!=null||H!=null))switch(b){case"value":ee=x;break;case"defaultValue":N=x;break;case"multiple":_=x;default:x!==H&&mt(r,u,b,x,h,H)}u=N,l=_,h=re,ee!=null?Ma(r,!!l,ee,!1):!!h!=!!l&&(u!=null?Ma(r,!!l,u,!0):Ma(r,!!l,l?[]:"",!1));return;case"textarea":re=ee=null;for(N in l)if(b=l[N],l.hasOwnProperty(N)&&b!=null&&!h.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:mt(r,u,N,null,h,b)}for(_ in h)if(b=h[_],x=l[_],h.hasOwnProperty(_)&&(b!=null||x!=null))switch(_){case"value":ee=b;break;case"defaultValue":re=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(i(91));break;default:b!==x&&mt(r,u,_,b,h,x)}L1(r,ee,re);return;case"option":for(var Le in l)if(ee=l[Le],l.hasOwnProperty(Le)&&ee!=null&&!h.hasOwnProperty(Le))switch(Le){case"selected":r.selected=!1;break;default:mt(r,u,Le,null,h,ee)}for(H in h)if(ee=h[H],re=l[H],h.hasOwnProperty(H)&&ee!==re&&(ee!=null||re!=null))switch(H){case"selected":r.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:mt(r,u,H,ee,h,re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var De in l)ee=l[De],l.hasOwnProperty(De)&&ee!=null&&!h.hasOwnProperty(De)&&mt(r,u,De,null,h,ee);for(Z in h)if(ee=h[Z],re=l[Z],h.hasOwnProperty(Z)&&ee!==re&&(ee!=null||re!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(i(137,u));break;default:mt(r,u,Z,ee,h,re)}return;default:if(ch(u)){for(var gt in l)ee=l[gt],l.hasOwnProperty(gt)&&ee!==void 0&&!h.hasOwnProperty(gt)&&X0(r,u,gt,void 0,h,ee);for(oe in h)ee=h[oe],re=l[oe],!h.hasOwnProperty(oe)||ee===re||ee===void 0&&re===void 0||X0(r,u,oe,ee,h,re);return}}for(var Y in l)ee=l[Y],l.hasOwnProperty(Y)&&ee!=null&&!h.hasOwnProperty(Y)&&mt(r,u,Y,null,h,ee);for(he in h)ee=h[he],re=l[he],!h.hasOwnProperty(he)||ee===re||ee==null&&re==null||mt(r,u,he,ee,h,re)}function Ny(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function K6(){if(typeof performance.getEntriesByType=="function"){for(var r=0,u=0,l=performance.getEntriesByType("resource"),h=0;h<l.length;h++){var b=l[h],x=b.transferSize,_=b.initiatorType,N=b.duration;if(x&&N&&Ny(_)){for(_=0,N=b.responseEnd,h+=1;h<l.length;h++){var H=l[h],Z=H.startTime;if(Z>N)break;var oe=H.transferSize,he=H.initiatorType;oe&&Ny(he)&&(H=H.responseEnd,_+=oe*(H<N?1:(N-Z)/(H-Z)))}if(--h,u+=8*(x+_)/(b.duration/1e3),r++,10<r)break}}if(0<r)return u/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var W0=null,Z0=null;function ed(r){return r.nodeType===9?r:r.ownerDocument}function Dy(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wy(r,u){if(r===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&u==="foreignObject"?0:r}function J0(r,u){return r==="textarea"||r==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var em=null;function Q6(){var r=window.event;return r&&r.type==="popstate"?r===em?!1:(em=r,!0):(em=null,!1)}var Oy=typeof setTimeout=="function"?setTimeout:void 0,X6=typeof clearTimeout=="function"?clearTimeout:void 0,ky=typeof Promise=="function"?Promise:void 0,W6=typeof queueMicrotask=="function"?queueMicrotask:typeof ky<"u"?function(r){return ky.resolve(null).then(r).catch(Z6)}:Oy;function Z6(r){setTimeout(function(){throw r})}function cr(r){return r==="head"}function My(r,u){var l=u,h=0;do{var b=l.nextSibling;if(r.removeChild(l),b&&b.nodeType===8)if(l=b.data,l==="/$"||l==="/&"){if(h===0){r.removeChild(b),hu(u);return}h--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")h++;else if(l==="html")Fo(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,Fo(l);for(var x=l.firstChild;x;){var _=x.nextSibling,N=x.nodeName;x[so]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&x.rel.toLowerCase()==="stylesheet"||l.removeChild(x),x=_}}else l==="body"&&Fo(r.ownerDocument.body);l=b}while(l);hu(u)}function Py(r,u){var l=r;r=0;do{var h=l.nextSibling;if(l.nodeType===1?u?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(u?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=h}while(l)}function tm(r){var u=r.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var l=u;switch(u=u.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":tm(l),ah(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function J6(r,u,l,h){for(;r.nodeType===1;){var b=l;if(r.nodeName.toLowerCase()!==u.toLowerCase()){if(!h&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(h){if(!r[so])switch(u){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(x=r.getAttribute("rel"),x==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(x!==b.rel||r.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||r.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||r.getAttribute("title")!==(b.title==null?null:b.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(x=r.getAttribute("src"),(x!==(b.src==null?null:b.src)||r.getAttribute("type")!==(b.type==null?null:b.type)||r.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&x&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(u==="input"&&r.type==="hidden"){var x=b.name==null?null:""+b.name;if(b.type==="hidden"&&r.getAttribute("name")===x)return r}else return r;if(r=xi(r.nextSibling),r===null)break}return null}function eL(r,u,l){if(u==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=xi(r.nextSibling),r===null))return null;return r}function Uy(r,u){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=xi(r.nextSibling),r===null))return null;return r}function sm(r){return r.data==="$?"||r.data==="$~"}function im(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function tL(r,u){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=u;else if(r.data!=="$?"||l.readyState!=="loading")u();else{var h=function(){u(),l.removeEventListener("DOMContentLoaded",h)};l.addEventListener("DOMContentLoaded",h),r._reactRetry=h}}function xi(r){for(;r!=null;r=r.nextSibling){var u=r.nodeType;if(u===1||u===3)break;if(u===8){if(u=r.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return r}var nm=null;function By(r){r=r.nextSibling;for(var u=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(u===0)return xi(r.nextSibling);u--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||u++}r=r.nextSibling}return null}function Fy(r){r=r.previousSibling;for(var u=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(u===0)return r;u--}else l!=="/$"&&l!=="/&"||u++}r=r.previousSibling}return null}function Hy(r,u,l){switch(u=ed(l),r){case"html":if(r=u.documentElement,!r)throw Error(i(452));return r;case"head":if(r=u.head,!r)throw Error(i(453));return r;case"body":if(r=u.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Fo(r){for(var u=r.attributes;u.length;)r.removeAttributeNode(u[0]);ah(r)}var Ti=new Map,jy=new Set;function td(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Cn=J.d;J.d={f:sL,r:iL,D:nL,C:rL,L:aL,m:uL,X:lL,S:oL,M:cL};function sL(){var r=Cn.f(),u=zc();return r||u}function iL(r){var u=wa(r);u!==null&&u.tag===5&&u.type==="form"?nE(u):Cn.r(r)}var cu=typeof document>"u"?null:document;function $y(r,u,l){var h=cu;if(h&&typeof u=="string"&&u){var b=hi(u);b='link[rel="'+r+'"][href="'+b+'"]',typeof l=="string"&&(b+='[crossorigin="'+l+'"]'),jy.has(b)||(jy.add(b),r={rel:r,crossOrigin:l,href:u},h.querySelector(b)===null&&(u=h.createElement("link"),ps(u,"link",r),is(u),h.head.appendChild(u)))}}function nL(r){Cn.D(r),$y("dns-prefetch",r,null)}function rL(r,u){Cn.C(r,u),$y("preconnect",r,u)}function aL(r,u,l){Cn.L(r,u,l);var h=cu;if(h&&r&&u){var b='link[rel="preload"][as="'+hi(u)+'"]';u==="image"&&l&&l.imageSrcSet?(b+='[imagesrcset="'+hi(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(b+='[imagesizes="'+hi(l.imageSizes)+'"]')):b+='[href="'+hi(r)+'"]';var x=b;switch(u){case"style":x=du(r);break;case"script":x=fu(r)}Ti.has(x)||(r=g({rel:"preload",href:u==="image"&&l&&l.imageSrcSet?void 0:r,as:u},l),Ti.set(x,r),h.querySelector(b)!==null||u==="style"&&h.querySelector(Ho(x))||u==="script"&&h.querySelector(jo(x))||(u=h.createElement("link"),ps(u,"link",r),is(u),h.head.appendChild(u)))}}function uL(r,u){Cn.m(r,u);var l=cu;if(l&&r){var h=u&&typeof u.as=="string"?u.as:"script",b='link[rel="modulepreload"][as="'+hi(h)+'"][href="'+hi(r)+'"]',x=b;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=fu(r)}if(!Ti.has(x)&&(r=g({rel:"modulepreload",href:r},u),Ti.set(x,r),l.querySelector(b)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(jo(x)))return}h=l.createElement("link"),ps(h,"link",r),is(h),l.head.appendChild(h)}}}function oL(r,u,l){Cn.S(r,u,l);var h=cu;if(h&&r){var b=Oa(h).hoistableStyles,x=du(r);u=u||"default";var _=b.get(x);if(!_){var N={loading:0,preload:null};if(_=h.querySelector(Ho(x)))N.loading=5;else{r=g({rel:"stylesheet",href:r,"data-precedence":u},l),(l=Ti.get(x))&&rm(r,l);var H=_=h.createElement("link");is(H),ps(H,"link",r),H._p=new Promise(function(Z,oe){H.onload=Z,H.onerror=oe}),H.addEventListener("load",function(){N.loading|=1}),H.addEventListener("error",function(){N.loading|=2}),N.loading|=4,sd(_,u,h)}_={type:"stylesheet",instance:_,count:1,state:N},b.set(x,_)}}}function lL(r,u){Cn.X(r,u);var l=cu;if(l&&r){var h=Oa(l).hoistableScripts,b=fu(r),x=h.get(b);x||(x=l.querySelector(jo(b)),x||(r=g({src:r,async:!0},u),(u=Ti.get(b))&&am(r,u),x=l.createElement("script"),is(x),ps(x,"link",r),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(b,x))}}function cL(r,u){Cn.M(r,u);var l=cu;if(l&&r){var h=Oa(l).hoistableScripts,b=fu(r),x=h.get(b);x||(x=l.querySelector(jo(b)),x||(r=g({src:r,async:!0,type:"module"},u),(u=Ti.get(b))&&am(r,u),x=l.createElement("script"),is(x),ps(x,"link",r),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(b,x))}}function Gy(r,u,l,h){var b=(b=Ae.current)?td(b):null;if(!b)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(u=du(l.href),l=Oa(b).hoistableStyles,h=l.get(u),h||(h={type:"style",instance:null,count:0,state:null},l.set(u,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=du(l.href);var x=Oa(b).hoistableStyles,_=x.get(r);if(_||(b=b.ownerDocument||b,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(r,_),(x=b.querySelector(Ho(r)))&&!x._p&&(_.instance=x,_.state.loading=5),Ti.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ti.set(r,l),x||dL(b,r,l,_.state))),u&&h===null)throw Error(i(528,""));return _}if(u&&h!==null)throw Error(i(529,""));return null;case"script":return u=l.async,l=l.src,typeof l=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=fu(l),l=Oa(b).hoistableScripts,h=l.get(u),h||(h={type:"script",instance:null,count:0,state:null},l.set(u,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function du(r){return'href="'+hi(r)+'"'}function Ho(r){return'link[rel="stylesheet"]['+r+"]"}function qy(r){return g({},r,{"data-precedence":r.precedence,precedence:null})}function dL(r,u,l,h){r.querySelector('link[rel="preload"][as="style"]['+u+"]")?h.loading=1:(u=r.createElement("link"),h.preload=u,u.addEventListener("load",function(){return h.loading|=1}),u.addEventListener("error",function(){return h.loading|=2}),ps(u,"link",l),is(u),r.head.appendChild(u))}function fu(r){return'[src="'+hi(r)+'"]'}function jo(r){return"script[async]"+r}function Vy(r,u,l){if(u.count++,u.instance===null)switch(u.type){case"style":var h=r.querySelector('style[data-href~="'+hi(l.href)+'"]');if(h)return u.instance=h,is(h),h;var b=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return h=(r.ownerDocument||r).createElement("style"),is(h),ps(h,"style",b),sd(h,l.precedence,r),u.instance=h;case"stylesheet":b=du(l.href);var x=r.querySelector(Ho(b));if(x)return u.state.loading|=4,u.instance=x,is(x),x;h=qy(l),(b=Ti.get(b))&&rm(h,b),x=(r.ownerDocument||r).createElement("link"),is(x);var _=x;return _._p=new Promise(function(N,H){_.onload=N,_.onerror=H}),ps(x,"link",h),u.state.loading|=4,sd(x,l.precedence,r),u.instance=x;case"script":return x=fu(l.src),(b=r.querySelector(jo(x)))?(u.instance=b,is(b),b):(h=l,(b=Ti.get(x))&&(h=g({},l),am(h,b)),r=r.ownerDocument||r,b=r.createElement("script"),is(b),ps(b,"link",h),r.head.appendChild(b),u.instance=b);case"void":return null;default:throw Error(i(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(h=u.instance,u.state.loading|=4,sd(h,l.precedence,r));return u.instance}function sd(r,u,l){for(var h=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=h.length?h[h.length-1]:null,x=b,_=0;_<h.length;_++){var N=h[_];if(N.dataset.precedence===u)x=N;else if(x!==b)break}x?x.parentNode.insertBefore(r,x.nextSibling):(u=l.nodeType===9?l.head:l,u.insertBefore(r,u.firstChild))}function rm(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.title==null&&(r.title=u.title)}function am(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.integrity==null&&(r.integrity=u.integrity)}var id=null;function zy(r,u,l){if(id===null){var h=new Map,b=id=new Map;b.set(l,h)}else b=id,h=b.get(l),h||(h=new Map,b.set(l,h));if(h.has(r))return h;for(h.set(r,null),l=l.getElementsByTagName(r),b=0;b<l.length;b++){var x=l[b];if(!(x[so]||x[fs]||r==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var _=x.getAttribute(u)||"";_=r+_;var N=h.get(_);N?N.push(x):h.set(_,[x])}}return h}function Yy(r,u,l){r=r.ownerDocument||r,r.head.insertBefore(l,u==="title"?r.querySelector("head > title"):null)}function fL(r,u,l){if(l===1||u.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return r=u.disabled,typeof u.precedence=="string"&&r==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function Ky(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function hL(r,u,l,h){if(l.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var b=du(h.href),x=u.querySelector(Ho(b));if(x){u=x._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(r.count++,r=nd.bind(r),u.then(r,r)),l.state.loading|=4,l.instance=x,is(x);return}x=u.ownerDocument||u,h=qy(h),(b=Ti.get(b))&&rm(h,b),x=x.createElement("link"),is(x);var _=x;_._p=new Promise(function(N,H){_.onload=N,_.onerror=H}),ps(x,"link",h),l.instance=x}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,u),(u=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=nd.bind(r),u.addEventListener("load",l),u.addEventListener("error",l))}}var um=0;function mL(r,u){return r.stylesheets&&r.count===0&&ad(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var h=setTimeout(function(){if(r.stylesheets&&ad(r,r.stylesheets),r.unsuspend){var x=r.unsuspend;r.unsuspend=null,x()}},6e4+u);0<r.imgBytes&&um===0&&(um=62500*K6());var b=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&ad(r,r.stylesheets),r.unsuspend)){var x=r.unsuspend;r.unsuspend=null,x()}},(r.imgBytes>um?50:800)+u);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(h),clearTimeout(b)}}:null}function nd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ad(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var rd=null;function ad(r,u){r.stylesheets=null,r.unsuspend!==null&&(r.count++,rd=new Map,u.forEach(gL,r),rd=null,nd.call(r))}function gL(r,u){if(!(u.state.loading&4)){var l=rd.get(r);if(l)var h=l.get(null);else{l=new Map,rd.set(r,l);for(var b=r.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<b.length;x++){var _=b[x];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(l.set(_.dataset.precedence,_),h=_)}h&&l.set(null,h)}b=u.instance,_=b.getAttribute("data-precedence"),x=l.get(_)||h,x===h&&l.set(null,b),l.set(_,b),this.count++,h=nd.bind(this),b.addEventListener("load",h),b.addEventListener("error",h),x?x.parentNode.insertBefore(b,x.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(b,r.firstChild)),u.state.loading|=4}}var $o={$$typeof:I,Provider:null,Consumer:null,_currentValue:se,_currentValue2:se,_threadCount:0};function pL(r,u,l,h,b,x,_,N,H){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=sh(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sh(0),this.hiddenUpdates=sh(null),this.identifierPrefix=h,this.onUncaughtError=b,this.onCaughtError=x,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function Qy(r,u,l,h,b,x,_,N,H,Z,oe,he){return r=new pL(r,u,l,_,H,Z,oe,he,N),u=1,x===!0&&(u|=24),x=Js(3,null,null,u),r.current=x,x.stateNode=r,u=Hh(),u.refCount++,r.pooledCache=u,u.refCount++,x.memoizedState={element:h,isDehydrated:l,cache:u},qh(x),r}function Xy(r){return r?(r=Ga,r):Ga}function Wy(r,u,l,h,b,x){b=Xy(b),h.context===null?h.context=b:h.pendingContext=b,h=Jn(u),h.payload={element:l},x=x===void 0?null:x,x!==null&&(h.callback=x),l=er(r,h,u),l!==null&&(Bs(l,r,u),xo(l,r,u))}function Zy(r,u){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<u?l:u}}function om(r,u){Zy(r,u),(r=r.alternate)&&Zy(r,u)}function Jy(r){if(r.tag===13||r.tag===31){var u=Vr(r,67108864);u!==null&&Bs(u,r,67108864),om(r,67108864)}}function ex(r){if(r.tag===13||r.tag===31){var u=ni();u=ih(u);var l=Vr(r,u);l!==null&&Bs(l,r,u),om(r,u)}}var ud=!0;function bL(r,u,l,h){var b=F.T;F.T=null;var x=J.p;try{J.p=2,lm(r,u,l,h)}finally{J.p=x,F.T=b}}function EL(r,u,l,h){var b=F.T;F.T=null;var x=J.p;try{J.p=8,lm(r,u,l,h)}finally{J.p=x,F.T=b}}function lm(r,u,l,h){if(ud){var b=cm(h);if(b===null)Q0(r,u,h,od,l),sx(r,h);else if(xL(b,r,u,l,h))h.stopPropagation();else if(sx(r,h),u&4&&-1<yL.indexOf(r)){for(;b!==null;){var x=wa(b);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var _=Hr(x.pendingLanes);if(_!==0){var N=x;for(N.pendingLanes|=2,N.entangledLanes|=2;_;){var H=1<<31-Ws(_);N.entanglements[1]|=H,_&=~H}Vi(x),(at&6)===0&&(qc=ss()+500,Po(0))}}break;case 31:case 13:N=Vr(x,2),N!==null&&Bs(N,x,2),zc(),om(x,2)}if(x=cm(h),x===null&&Q0(r,u,h,od,l),x===b)break;b=x}b!==null&&h.stopPropagation()}else Q0(r,u,h,null,l)}}function cm(r){return r=fh(r),dm(r)}var od=null;function dm(r){if(od=null,r=Da(r),r!==null){var u=a(r);if(u===null)r=null;else{var l=u.tag;if(l===13){if(r=o(u),r!==null)return r;r=null}else if(l===31){if(r=c(u),r!==null)return r;r=null}else if(l===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;r=null}else u!==r&&(r=null)}}return od=r,null}function tx(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xl()){case qn:return 2;case Wu:return 8;case Ca:case Wl:return 32;case Zu:return 268435456;default:return 32}default:return 32}}var fm=!1,dr=null,fr=null,hr=null,Go=new Map,qo=new Map,mr=[],yL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sx(r,u){switch(r){case"focusin":case"focusout":dr=null;break;case"dragenter":case"dragleave":fr=null;break;case"mouseover":case"mouseout":hr=null;break;case"pointerover":case"pointerout":Go.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":qo.delete(u.pointerId)}}function Vo(r,u,l,h,b,x){return r===null||r.nativeEvent!==x?(r={blockedOn:u,domEventName:l,eventSystemFlags:h,nativeEvent:x,targetContainers:[b]},u!==null&&(u=wa(u),u!==null&&Jy(u)),r):(r.eventSystemFlags|=h,u=r.targetContainers,b!==null&&u.indexOf(b)===-1&&u.push(b),r)}function xL(r,u,l,h,b){switch(u){case"focusin":return dr=Vo(dr,r,u,l,h,b),!0;case"dragenter":return fr=Vo(fr,r,u,l,h,b),!0;case"mouseover":return hr=Vo(hr,r,u,l,h,b),!0;case"pointerover":var x=b.pointerId;return Go.set(x,Vo(Go.get(x)||null,r,u,l,h,b)),!0;case"gotpointercapture":return x=b.pointerId,qo.set(x,Vo(qo.get(x)||null,r,u,l,h,b)),!0}return!1}function ix(r){var u=Da(r.target);if(u!==null){var l=a(u);if(l!==null){if(u=l.tag,u===13){if(u=o(l),u!==null){r.blockedOn=u,b1(r.priority,function(){ex(l)});return}}else if(u===31){if(u=c(l),u!==null){r.blockedOn=u,b1(r.priority,function(){ex(l)});return}}else if(u===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ld(r){if(r.blockedOn!==null)return!1;for(var u=r.targetContainers;0<u.length;){var l=cm(r.nativeEvent);if(l===null){l=r.nativeEvent;var h=new l.constructor(l.type,l);dh=h,l.target.dispatchEvent(h),dh=null}else return u=wa(l),u!==null&&Jy(u),r.blockedOn=l,!1;u.shift()}return!0}function nx(r,u,l){ld(r)&&l.delete(u)}function TL(){fm=!1,dr!==null&&ld(dr)&&(dr=null),fr!==null&&ld(fr)&&(fr=null),hr!==null&&ld(hr)&&(hr=null),Go.forEach(nx),qo.forEach(nx)}function cd(r,u){r.blockedOn===u&&(r.blockedOn=null,fm||(fm=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,TL)))}var dd=null;function rx(r){dd!==r&&(dd=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){dd===r&&(dd=null);for(var u=0;u<r.length;u+=3){var l=r[u],h=r[u+1],b=r[u+2];if(typeof h!="function"){if(dm(h||l)===null)continue;break}var x=wa(l);x!==null&&(r.splice(u,3),u-=3,c0(x,{pending:!0,data:b,method:l.method,action:h},h,b))}}))}function hu(r){function u(H){return cd(H,r)}dr!==null&&cd(dr,r),fr!==null&&cd(fr,r),hr!==null&&cd(hr,r),Go.forEach(u),qo.forEach(u);for(var l=0;l<mr.length;l++){var h=mr[l];h.blockedOn===r&&(h.blockedOn=null)}for(;0<mr.length&&(l=mr[0],l.blockedOn===null);)ix(l),l.blockedOn===null&&mr.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(h=0;h<l.length;h+=3){var b=l[h],x=l[h+1],_=b[ws]||null;if(typeof x=="function")_||rx(l);else if(_){var N=null;if(x&&x.hasAttribute("formAction")){if(b=x,_=x[ws]||null)N=_.formAction;else if(dm(b)!==null)continue}else N=_.action;typeof N=="function"?l[h+1]=N:(l.splice(h,3),h-=3),rx(l)}}}function ax(){function r(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(_){return b=_})},focusReset:"manual",scroll:"manual"})}function u(){b!==null&&(b(),b=null),h||setTimeout(l,20)}function l(){if(!h&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,b=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(l,100),function(){h=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),b!==null&&(b(),b=null)}}}function hm(r){this._internalRoot=r}fd.prototype.render=hm.prototype.render=function(r){var u=this._internalRoot;if(u===null)throw Error(i(409));var l=u.current,h=ni();Wy(l,h,r,u,null,null)},fd.prototype.unmount=hm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var u=r.containerInfo;Wy(r.current,2,null,r,null,null),zc(),u[Na]=null}};function fd(r){this._internalRoot=r}fd.prototype.unstable_scheduleHydration=function(r){if(r){var u=p1();r={blockedOn:null,target:r,priority:u};for(var l=0;l<mr.length&&u!==0&&u<mr[l].priority;l++);mr.splice(l,0,r),l===0&&ix(r)}};var ux=e.version;if(ux!=="19.2.0")throw Error(i(527,ux,"19.2.0"));J.findDOMNode=function(r){var u=r._reactInternals;if(u===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=d(u),r=r!==null?m(r):null,r=r===null?null:r.stateNode,r};var vL={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hd.isDisabled&&hd.supportsFiber)try{Ju=hd.inject(vL),Xs=hd}catch{}}return Yo.createRoot=function(r,u){if(!n(r))throw Error(i(299));var l=!1,h="",b=mE,x=gE,_=pE;return u!=null&&(u.unstable_strictMode===!0&&(l=!0),u.identifierPrefix!==void 0&&(h=u.identifierPrefix),u.onUncaughtError!==void 0&&(b=u.onUncaughtError),u.onCaughtError!==void 0&&(x=u.onCaughtError),u.onRecoverableError!==void 0&&(_=u.onRecoverableError)),u=Qy(r,1,!1,null,null,l,h,null,b,x,_,ax),r[Na]=u.current,K0(r),new hm(u)},Yo.hydrateRoot=function(r,u,l){if(!n(r))throw Error(i(299));var h=!1,b="",x=mE,_=gE,N=pE,H=null;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(b=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError),l.formState!==void 0&&(H=l.formState)),u=Qy(r,1,!0,u,l??null,h,b,H,x,_,N,ax),u.context=Xy(null),l=u.current,h=ni(),h=ih(h),b=Jn(h),b.callback=null,er(l,b,h),l=h,u.current.lanes=l,to(u,l),Vi(u),r[Na]=u.current,K0(r),new fd(u)},Yo.version="19.2.0",Yo}var Ex;function OL(){if(Ex)return bm.exports;Ex=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),bm.exports=wL(),bm.exports}var kL=OL();const ML=sp(kL);/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var yx="popstate";function PL(s={}){function e(n,a){let{pathname:o="/",search:c="",hash:f=""}=Aa(n.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),lg("",{pathname:o,search:c,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(n,a){let o=n.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let f=n.location.href,d=f.indexOf("#");c=d===-1?f:f.slice(0,d)}return c+"#"+(typeof a=="string"?a:ml(a))}function i(n,a){Qs(n.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return BL(e,t,i,s)}function Lt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Qs(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UL(){return Math.random().toString(36).substring(2,10)}function xx(s,e){return{usr:s.state,key:s.key,idx:e}}function lg(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Aa(e):e,state:t,key:e&&e.key||i||UL()}}function ml({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Aa(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function BL(s,e,t,i={}){let{window:n=document.defaultView,v5Compat:a=!1}=i,o=n.history,c="POP",f=null,d=m();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function m(){return(o.state||{idx:null}).idx}function g(){c="POP";let A=m(),R=A==null?null:A-d;d=A,f&&f({action:c,location:S.location,delta:R})}function p(A,R){c="PUSH";let C=lg(S.location,A,R);t&&t(C,A),d=m()+1;let I=xx(C,d),D=S.createHref(C);try{o.pushState(I,"",D)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;n.location.assign(D)}a&&f&&f({action:c,location:S.location,delta:1})}function T(A,R){c="REPLACE";let C=lg(S.location,A,R);t&&t(C,A),d=m();let I=xx(C,d),D=S.createHref(C);o.replaceState(I,"",D),a&&f&&f({action:c,location:S.location,delta:0})}function y(A){return FL(A)}let S={get action(){return c},get location(){return s(n,o)},listen(A){if(f)throw new Error("A history only accepts one active listener");return n.addEventListener(yx,g),f=A,()=>{n.removeEventListener(yx,g),f=null}},createHref(A){return e(n,A)},createURL:y,encodeLocation(A){let R=y(A);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:p,replace:T,go(A){return o.go(A)}};return S}function FL(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Lt(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:ml(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function cv(s,e,t="/"){return HL(s,e,t,!1)}function HL(s,e,t,i){let n=typeof e=="string"?Aa(e):e,a=$n(n.pathname||"/",t);if(a==null)return null;let o=dv(s);jL(o);let c=null;for(let f=0;c==null&&f<o.length;++f){let d=ZL(a);c=XL(o[f],d,i)}return c}function dv(s,e=[],t=[],i="",n=!1){let a=(o,c,f=n,d)=>{let m={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(i)&&f)return;Lt(m.relativePath.startsWith(i),`Absolute route path "${m.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(i.length)}let g=Hn([i,m.relativePath]),p=t.concat(m);o.children&&o.children.length>0&&(Lt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),dv(o.children,e,p,g,f)),!(o.path==null&&!o.index)&&e.push({path:g,score:KL(g,o.index),routesMeta:p})};return s.forEach((o,c)=>{var f;if(o.path===""||!((f=o.path)!=null&&f.includes("?")))a(o,c);else for(let d of fv(o.path))a(o,c,!0,d)}),e}function fv(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,n=t.endsWith("?"),a=t.replace(/\?$/,"");if(i.length===0)return n?[a,""]:[a];let o=fv(i.join("/")),c=[];return c.push(...o.map(f=>f===""?a:[a,f].join("/"))),n&&c.push(...o),c.map(f=>s.startsWith("/")&&f===""?"/":f)}function jL(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:QL(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var $L=/^:[\w-]+$/,GL=3,qL=2,VL=1,zL=10,YL=-2,Tx=s=>s==="*";function KL(s,e){let t=s.split("/"),i=t.length;return t.some(Tx)&&(i+=YL),e&&(i+=qL),t.filter(n=>!Tx(n)).reduce((n,a)=>n+($L.test(a)?GL:a===""?VL:zL),i)}function QL(s,e){return s.length===e.length&&s.slice(0,-1).every((i,n)=>i===e[n])?s[s.length-1]-e[e.length-1]:0}function XL(s,e,t=!1){let{routesMeta:i}=s,n={},a="/",o=[];for(let c=0;c<i.length;++c){let f=i[c],d=c===i.length-1,m=a==="/"?e:e.slice(a.length)||"/",g=ef({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},m),p=f.route;if(!g&&d&&t&&!i[i.length-1].route.index&&(g=ef({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},m)),!g)return null;Object.assign(n,g.params),o.push({params:n,pathname:Hn([a,g.pathname]),pathnameBase:iR(Hn([a,g.pathnameBase])),route:p}),g.pathnameBase!=="/"&&(a=Hn([a,g.pathnameBase]))}return o}function ef(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=WL(s.path,s.caseSensitive,s.end),n=e.match(t);if(!n)return null;let a=n[0],o=a.replace(/(.)\/+$/,"$1"),c=n.slice(1);return{params:i.reduce((d,{paramName:m,isOptional:g},p)=>{if(m==="*"){let y=c[p]||"";o=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const T=c[p];return g&&!T?d[m]=void 0:d[m]=(T||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:s}}function WL(s,e=!1,t=!0){Qs(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],n="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,f)=>(i.push({paramName:c,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),n+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":s!==""&&s!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),i]}function ZL(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qs(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function $n(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var JL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eR=s=>JL.test(s);function tR(s,e="/"){let{pathname:t,search:i="",hash:n=""}=typeof s=="string"?Aa(s):s,a;if(t)if(eR(t))a=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Qs(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?a=vx(t.substring(1),"/"):a=vx(t,e)}else a=e;return{pathname:a,search:nR(i),hash:rR(n)}}function vx(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function Tm(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function sR(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function np(s){let e=sR(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function rp(s,e,t,i=!1){let n;typeof s=="string"?n=Aa(s):(n={...s},Lt(!n.pathname||!n.pathname.includes("?"),Tm("?","pathname","search",n)),Lt(!n.pathname||!n.pathname.includes("#"),Tm("#","pathname","hash",n)),Lt(!n.search||!n.search.includes("#"),Tm("#","search","hash",n)));let a=s===""||n.pathname==="",o=a?"/":n.pathname,c;if(o==null)c=t;else{let g=e.length-1;if(!i&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),g-=1;n.pathname=p.join("/")}c=g>=0?e[g]:"/"}let f=tR(n,c),d=o&&o!=="/"&&o.endsWith("/"),m=(a||o===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(d||m)&&(f.pathname+="/"),f}var Hn=s=>s.join("/").replace(/\/\/+/g,"/"),iR=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),nR=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,rR=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function aR(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var hv=["POST","PUT","PATCH","DELETE"];new Set(hv);var uR=["GET",...hv];new Set(uR);var Gu=U.createContext(null);Gu.displayName="DataRouter";var Df=U.createContext(null);Df.displayName="DataRouterState";U.createContext(!1);var mv=U.createContext({isTransitioning:!1});mv.displayName="ViewTransition";var oR=U.createContext(new Map);oR.displayName="Fetchers";var lR=U.createContext(null);lR.displayName="Await";var Ui=U.createContext(null);Ui.displayName="Navigation";var Ml=U.createContext(null);Ml.displayName="Location";var Bi=U.createContext({outlet:null,matches:[],isDataRoute:!1});Bi.displayName="Route";var ap=U.createContext(null);ap.displayName="RouteError";function cR(s,{relative:e}={}){Lt(qu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=U.useContext(Ui),{hash:n,pathname:a,search:o}=Pl(s,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Hn([t,a])),i.createHref({pathname:c,search:o,hash:n})}function qu(){return U.useContext(Ml)!=null}function cn(){return Lt(qu(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(Ml).location}var gv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pv(s){U.useContext(Ui).static||U.useLayoutEffect(s)}function _a(){let{isDataRoute:s}=U.useContext(Bi);return s?SR():dR()}function dR(){Lt(qu(),"useNavigate() may be used only in the context of a <Router> component.");let s=U.useContext(Gu),{basename:e,navigator:t}=U.useContext(Ui),{matches:i}=U.useContext(Bi),{pathname:n}=cn(),a=JSON.stringify(np(i)),o=U.useRef(!1);return pv(()=>{o.current=!0}),U.useCallback((f,d={})=>{if(Qs(o.current,gv),!o.current)return;if(typeof f=="number"){t.go(f);return}let m=rp(f,JSON.parse(a),n,d.relative==="path");s==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Hn([e,m.pathname])),(d.replace?t.replace:t.push)(m,d.state,d)},[e,t,a,n,s])}U.createContext(null);function wf(){let{matches:s}=U.useContext(Bi),e=s[s.length-1];return e?e.params:{}}function Pl(s,{relative:e}={}){let{matches:t}=U.useContext(Bi),{pathname:i}=cn(),n=JSON.stringify(np(t));return U.useMemo(()=>rp(s,JSON.parse(n),i,e==="path"),[s,n,i,e])}function fR(s,e){return bv(s,e)}function bv(s,e,t,i,n){var C;Lt(qu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(Ui),{matches:o}=U.useContext(Bi),c=o[o.length-1],f=c?c.params:{},d=c?c.pathname:"/",m=c?c.pathnameBase:"/",g=c&&c.route;{let I=g&&g.path||"";Ev(d,!g||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let p=cn(),T;if(e){let I=typeof e=="string"?Aa(e):e;Lt(m==="/"||((C=I.pathname)==null?void 0:C.startsWith(m)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${I.pathname}" was given in the \`location\` prop.`),T=I}else T=p;let y=T.pathname||"/",S=y;if(m!=="/"){let I=m.replace(/^\//,"").split("/");S="/"+y.replace(/^\//,"").split("/").slice(I.length).join("/")}let A=cv(s,{pathname:S});Qs(g||A!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),Qs(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=bR(A&&A.map(I=>Object.assign({},I,{params:Object.assign({},f,I.params),pathname:Hn([m,a.encodeLocation?a.encodeLocation(I.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?m:Hn([m,a.encodeLocation?a.encodeLocation(I.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathnameBase])})),o,t,i,n);return e&&R?U.createElement(Ml.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},R):R}function hR(){let s=vR(),e=aR(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",s),o=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:n},t):null,o)}var mR=U.createElement(hR,null),gR=class extends U.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?U.createElement(Bi.Provider,{value:this.props.routeContext},U.createElement(ap.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function pR({routeContext:s,match:e,children:t}){let i=U.useContext(Gu);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(Bi.Provider,{value:s},t)}function bR(s,e=[],t=null,i=null,n=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let a=s,o=t==null?void 0:t.errors;if(o!=null){let m=a.findIndex(g=>g.route.id&&(o==null?void 0:o[g.route.id])!==void 0);Lt(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,m+1))}let c=!1,f=-1;if(t)for(let m=0;m<a.length;m++){let g=a[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=m),g.route.id){let{loaderData:p,errors:T}=t,y=g.route.loader&&!p.hasOwnProperty(g.route.id)&&(!T||T[g.route.id]===void 0);if(g.route.lazy||y){c=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}let d=t&&i?(m,g)=>{var p,T;i(m,{location:t.location,params:((T=(p=t.matches)==null?void 0:p[0])==null?void 0:T.params)??{},errorInfo:g})}:void 0;return a.reduceRight((m,g,p)=>{let T,y=!1,S=null,A=null;t&&(T=o&&g.route.id?o[g.route.id]:void 0,S=g.route.errorElement||mR,c&&(f<0&&p===0?(Ev("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,A=null):f===p&&(y=!0,A=g.route.hydrateFallbackElement||null)));let R=e.concat(a.slice(0,p+1)),C=()=>{let I;return T?I=S:y?I=A:g.route.Component?I=U.createElement(g.route.Component,null):g.route.element?I=g.route.element:I=m,U.createElement(pR,{match:g,routeContext:{outlet:m,matches:R,isDataRoute:t!=null},children:I})};return t&&(g.route.ErrorBoundary||g.route.errorElement||p===0)?U.createElement(gR,{location:t.location,revalidation:t.revalidation,component:S,error:T,children:C(),routeContext:{outlet:null,matches:R,isDataRoute:!0},onError:d}):C()},null)}function up(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ER(s){let e=U.useContext(Gu);return Lt(e,up(s)),e}function yR(s){let e=U.useContext(Df);return Lt(e,up(s)),e}function xR(s){let e=U.useContext(Bi);return Lt(e,up(s)),e}function op(s){let e=xR(s),t=e.matches[e.matches.length-1];return Lt(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function TR(){return op("useRouteId")}function vR(){var i;let s=U.useContext(ap),e=yR("useRouteError"),t=op("useRouteError");return s!==void 0?s:(i=e.errors)==null?void 0:i[t]}function SR(){let{router:s}=ER("useNavigate"),e=op("useNavigate"),t=U.useRef(!1);return pv(()=>{t.current=!0}),U.useCallback(async(n,a={})=>{Qs(t.current,gv),t.current&&(typeof n=="number"?s.navigate(n):await s.navigate(n,{fromRouteId:e,...a}))},[s,e])}var Sx={};function Ev(s,e,t){!e&&!Sx[s]&&(Sx[s]=!0,Qs(!1,t))}U.memo(AR);function AR({routes:s,future:e,state:t,unstable_onError:i}){return bv(s,void 0,t,i,e)}function lp({to:s,replace:e,state:t,relative:i}){Lt(qu(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=U.useContext(Ui);Qs(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=U.useContext(Bi),{pathname:o}=cn(),c=_a(),f=rp(s,np(a),o,i==="path"),d=JSON.stringify(f);return U.useEffect(()=>{c(JSON.parse(d),{replace:e,state:t,relative:i})},[c,d,i,e,t]),null}function as(s){Lt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function _R({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:n,static:a=!1}){Lt(!qu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=s.replace(/^\/*/,"/"),c=U.useMemo(()=>({basename:o,navigator:n,static:a,future:{}}),[o,n,a]);typeof t=="string"&&(t=Aa(t));let{pathname:f="/",search:d="",hash:m="",state:g=null,key:p="default"}=t,T=U.useMemo(()=>{let y=$n(f,o);return y==null?null:{location:{pathname:y,search:d,hash:m,state:g,key:p},navigationType:i}},[o,f,d,m,g,p,i]);return Qs(T!=null,`<Router basename="${o}"> is not able to match the URL "${f}${d}${m}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:U.createElement(Ui.Provider,{value:c},U.createElement(Ml.Provider,{children:e,value:T}))}function LR({children:s,location:e}){return fR(cg(s),e)}function cg(s,e=[]){let t=[];return U.Children.forEach(s,(i,n)=>{if(!U.isValidElement(i))return;let a=[...e,n];if(i.type===U.Fragment){t.push.apply(t,cg(i.props.children,a));return}Lt(i.type===as,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Lt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=cg(i.props.children,a)),t.push(o)}),t}var Bd="get",Fd="application/x-www-form-urlencoded";function Of(s){return s!=null&&typeof s.tagName=="string"}function RR(s){return Of(s)&&s.tagName.toLowerCase()==="button"}function IR(s){return Of(s)&&s.tagName.toLowerCase()==="form"}function CR(s){return Of(s)&&s.tagName.toLowerCase()==="input"}function NR(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function DR(s,e){return s.button===0&&(!e||e==="_self")&&!NR(s)}function dg(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(n=>[t,n]):[[t,i]])},[]))}function wR(s,e){let t=dg(s);return e&&e.forEach((i,n)=>{t.has(n)||e.getAll(n).forEach(a=>{t.append(n,a)})}),t}var gd=null;function OR(){if(gd===null)try{new FormData(document.createElement("form"),0),gd=!1}catch{gd=!0}return gd}var kR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function vm(s){return s!=null&&!kR.has(s)?(Qs(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Fd}"`),null):s}function MR(s,e){let t,i,n,a,o;if(IR(s)){let c=s.getAttribute("action");i=c?$n(c,e):null,t=s.getAttribute("method")||Bd,n=vm(s.getAttribute("enctype"))||Fd,a=new FormData(s)}else if(RR(s)||CR(s)&&(s.type==="submit"||s.type==="image")){let c=s.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=s.getAttribute("formaction")||c.getAttribute("action");if(i=f?$n(f,e):null,t=s.getAttribute("formmethod")||c.getAttribute("method")||Bd,n=vm(s.getAttribute("formenctype"))||vm(c.getAttribute("enctype"))||Fd,a=new FormData(c,s),!OR()){let{name:d,type:m,value:g}=s;if(m==="image"){let p=d?`${d}.`:"";a.append(`${p}x`,"0"),a.append(`${p}y`,"0")}else d&&a.append(d,g)}}else{if(Of(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Bd,i=null,n=Fd,o=s}return a&&n==="text/plain"&&(o=a,a=void 0),{action:i,method:t.toLowerCase(),encType:n,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cp(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function PR(s,e,t){let i=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return i.pathname==="/"?i.pathname=`_root.${t}`:e&&$n(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${t}`,i}async function UR(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function BR(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function FR(s,e,t){let i=await Promise.all(s.map(async n=>{let a=e.routes[n.route.id];if(a){let o=await UR(a,t);return o.links?o.links():[]}return[]}));return GR(i.flat(1).filter(BR).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function Ax(s,e,t,i,n,a){let o=(f,d)=>t[d]?f.route.id!==t[d].route.id:!0,c=(f,d)=>{var m;return t[d].pathname!==f.pathname||((m=t[d].route.path)==null?void 0:m.endsWith("*"))&&t[d].params["*"]!==f.params["*"]};return a==="assets"?e.filter((f,d)=>o(f,d)||c(f,d)):a==="data"?e.filter((f,d)=>{var g;let m=i.routes[f.route.id];if(!m||!m.hasLoader)return!1;if(o(f,d)||c(f,d))return!0;if(f.route.shouldRevalidate){let p=f.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(s,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function HR(s,e,{includeHydrateFallback:t}={}){return jR(s.map(i=>{let n=e.routes[i.route.id];if(!n)return[];let a=[n.module];return n.clientActionModule&&(a=a.concat(n.clientActionModule)),n.clientLoaderModule&&(a=a.concat(n.clientLoaderModule)),t&&n.hydrateFallbackModule&&(a=a.concat(n.hydrateFallbackModule)),n.imports&&(a=a.concat(n.imports)),a}).flat(1))}function jR(s){return[...new Set(s)]}function $R(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function GR(s,e){let t=new Set;return new Set(e),s.reduce((i,n)=>{let a=JSON.stringify($R(n));return t.has(a)||(t.add(a),i.push({key:a,link:n})),i},[])}function yv(){let s=U.useContext(Gu);return cp(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function qR(){let s=U.useContext(Df);return cp(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var dp=U.createContext(void 0);dp.displayName="FrameworkContext";function xv(){let s=U.useContext(dp);return cp(s,"You must render this element inside a <HydratedRouter> element"),s}function VR(s,e){let t=U.useContext(dp),[i,n]=U.useState(!1),[a,o]=U.useState(!1),{onFocus:c,onBlur:f,onMouseEnter:d,onMouseLeave:m,onTouchStart:g}=e,p=U.useRef(null);U.useEffect(()=>{if(s==="render"&&o(!0),s==="viewport"){let S=R=>{R.forEach(C=>{o(C.isIntersecting)})},A=new IntersectionObserver(S,{threshold:.5});return p.current&&A.observe(p.current),()=>{A.disconnect()}}},[s]),U.useEffect(()=>{if(i){let S=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(S)}}},[i]);let T=()=>{n(!0)},y=()=>{n(!1),o(!1)};return t?s!=="intent"?[a,p,{}]:[a,p,{onFocus:Ko(c,T),onBlur:Ko(f,y),onMouseEnter:Ko(d,T),onMouseLeave:Ko(m,y),onTouchStart:Ko(g,T)}]:[!1,p,{}]}function Ko(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function zR({page:s,...e}){let{router:t}=yv(),i=U.useMemo(()=>cv(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?U.createElement(KR,{page:s,matches:i,...e}):null}function YR(s){let{manifest:e,routeModules:t}=xv(),[i,n]=U.useState([]);return U.useEffect(()=>{let a=!1;return FR(s,e,t).then(o=>{a||n(o)}),()=>{a=!0}},[s,e,t]),i}function KR({page:s,matches:e,...t}){let i=cn(),{manifest:n,routeModules:a}=xv(),{basename:o}=yv(),{loaderData:c,matches:f}=qR(),d=U.useMemo(()=>Ax(s,e,f,n,i,"data"),[s,e,f,n,i]),m=U.useMemo(()=>Ax(s,e,f,n,i,"assets"),[s,e,f,n,i]),g=U.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let y=new Set,S=!1;if(e.forEach(R=>{var I;let C=n.routes[R.route.id];!C||!C.hasLoader||(!d.some(D=>D.route.id===R.route.id)&&R.route.id in c&&((I=a[R.route.id])!=null&&I.shouldRevalidate)||C.hasClientLoader?S=!0:y.add(R.route.id))}),y.size===0)return[];let A=PR(s,o,"data");return S&&y.size>0&&A.searchParams.set("_routes",e.filter(R=>y.has(R.route.id)).map(R=>R.route.id).join(",")),[A.pathname+A.search]},[o,c,i,n,d,e,s,a]),p=U.useMemo(()=>HR(m,n),[m,n]),T=YR(m);return U.createElement(U.Fragment,null,g.map(y=>U.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),p.map(y=>U.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),T.map(({key:y,link:S})=>U.createElement("link",{key:y,nonce:t.nonce,...S})))}function QR(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Tv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Tv&&(window.__reactRouterVersion="7.9.6")}catch{}function XR({basename:s,children:e,window:t}){let i=U.useRef();i.current==null&&(i.current=PL({window:t,v5Compat:!0}));let n=i.current,[a,o]=U.useState({action:n.action,location:n.location}),c=U.useCallback(f=>{U.startTransition(()=>o(f))},[o]);return U.useLayoutEffect(()=>n.listen(c),[n,c]),U.createElement(_R,{basename:s,children:e,location:a.location,navigationType:a.action,navigator:n})}var vv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xt=U.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:n,reloadDocument:a,replace:o,state:c,target:f,to:d,preventScrollReset:m,viewTransition:g,...p},T){let{basename:y}=U.useContext(Ui),S=typeof d=="string"&&vv.test(d),A,R=!1;if(typeof d=="string"&&S&&(A=d,Tv))try{let $=new URL(window.location.href),j=d.startsWith("//")?new URL($.protocol+d):new URL(d),te=$n(j.pathname,y);j.origin===$.origin&&te!=null?d=te+j.search+j.hash:R=!0}catch{Qs(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=cR(d,{relative:n}),[I,D,k]=VR(i,p),z=eI(d,{replace:o,state:c,target:f,preventScrollReset:m,relative:n,viewTransition:g});function P($){e&&e($),$.defaultPrevented||z($)}let V=U.createElement("a",{...p,...k,href:A||C,onClick:R||a?e:P,ref:QR(T,D),target:f,"data-discover":!S&&t==="render"?"true":void 0});return I&&!S?U.createElement(U.Fragment,null,V,U.createElement(zR,{page:C})):V});xt.displayName="Link";var WR=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:n=!1,style:a,to:o,viewTransition:c,children:f,...d},m){let g=Pl(o,{relative:d.relative}),p=cn(),T=U.useContext(Df),{navigator:y,basename:S}=U.useContext(Ui),A=T!=null&&aI(g)&&c===!0,R=y.encodeLocation?y.encodeLocation(g).pathname:g.pathname,C=p.pathname,I=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;t||(C=C.toLowerCase(),I=I?I.toLowerCase():null,R=R.toLowerCase()),I&&S&&(I=$n(I,S)||I);const D=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let k=C===R||!n&&C.startsWith(R)&&C.charAt(D)==="/",z=I!=null&&(I===R||!n&&I.startsWith(R)&&I.charAt(R.length)==="/"),P={isActive:k,isPending:z,isTransitioning:A},V=k?e:void 0,$;typeof i=="function"?$=i(P):$=[i,k?"active":null,z?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let j=typeof a=="function"?a(P):a;return U.createElement(xt,{...d,"aria-current":V,className:$,ref:m,style:j,to:o,viewTransition:c},typeof f=="function"?f(P):f)});WR.displayName="NavLink";var ZR=U.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:n,state:a,method:o=Bd,action:c,onSubmit:f,relative:d,preventScrollReset:m,viewTransition:g,...p},T)=>{let y=nI(),S=rI(c,{relative:d}),A=o.toLowerCase()==="get"?"get":"post",R=typeof c=="string"&&vv.test(c),C=I=>{if(f&&f(I),I.defaultPrevented)return;I.preventDefault();let D=I.nativeEvent.submitter,k=(D==null?void 0:D.getAttribute("formmethod"))||o;y(D||I.currentTarget,{fetcherKey:e,method:k,navigate:t,replace:n,state:a,relative:d,preventScrollReset:m,viewTransition:g})};return U.createElement("form",{ref:T,method:A,action:S,onSubmit:i?f:C,...p,"data-discover":!R&&s==="render"?"true":void 0})});ZR.displayName="Form";function JR(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Sv(s){let e=U.useContext(Gu);return Lt(e,JR(s)),e}function eI(s,{target:e,replace:t,state:i,preventScrollReset:n,relative:a,viewTransition:o}={}){let c=_a(),f=cn(),d=Pl(s,{relative:a});return U.useCallback(m=>{if(DR(m,e)){m.preventDefault();let g=t!==void 0?t:ml(f)===ml(d);c(s,{replace:g,state:i,preventScrollReset:n,relative:a,viewTransition:o})}},[f,c,d,t,i,e,s,n,a,o])}function tI(s){Qs(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=U.useRef(dg(s)),t=U.useRef(!1),i=cn(),n=U.useMemo(()=>wR(i.search,t.current?null:e.current),[i.search]),a=_a(),o=U.useCallback((c,f)=>{const d=dg(typeof c=="function"?c(new URLSearchParams(n)):c);t.current=!0,a("?"+d,f)},[a,n]);return[n,o]}var sI=0,iI=()=>`__${String(++sI)}__`;function nI(){let{router:s}=Sv("useSubmit"),{basename:e}=U.useContext(Ui),t=TR();return U.useCallback(async(i,n={})=>{let{action:a,method:o,encType:c,formData:f,body:d}=MR(i,e);if(n.navigate===!1){let m=n.fetcherKey||iI();await s.fetch(m,t,n.action||a,{preventScrollReset:n.preventScrollReset,formData:f,body:d,formMethod:n.method||o,formEncType:n.encType||c,flushSync:n.flushSync})}else await s.navigate(n.action||a,{preventScrollReset:n.preventScrollReset,formData:f,body:d,formMethod:n.method||o,formEncType:n.encType||c,replace:n.replace,state:n.state,fromRouteId:t,flushSync:n.flushSync,viewTransition:n.viewTransition})},[s,e,t])}function rI(s,{relative:e}={}){let{basename:t}=U.useContext(Ui),i=U.useContext(Bi);Lt(i,"useFormAction must be used inside a RouteContext");let[n]=i.matches.slice(-1),a={...Pl(s||".",{relative:e})},o=cn();if(s==null){a.search=o.search;let c=new URLSearchParams(a.search),f=c.getAll("index");if(f.some(m=>m==="")){c.delete("index"),f.filter(g=>g).forEach(g=>c.append("index",g));let m=c.toString();a.search=m?`?${m}`:""}}return(!s||s===".")&&n.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Hn([t,a.pathname])),ml(a)}function aI(s,{relative:e}={}){let t=U.useContext(mv);Lt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Sv("useViewTransitionState"),n=Pl(s,{relative:e});if(!t.isTransitioning)return!1;let a=$n(t.currentLocation.pathname,i)||t.currentLocation.pathname,o=$n(t.nextLocation.pathname,i)||t.nextLocation.pathname;return ef(n.pathname,o)!=null||ef(n.pathname,a)!=null}var kf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},uI={setTimeout:(s,e)=>setTimeout(s,e),clearTimeout:s=>clearTimeout(s),setInterval:(s,e)=>setInterval(s,e),clearInterval:s=>clearInterval(s)},Ar,tp,tv,oI=(tv=class{constructor(){Ze(this,Ar,uI);Ze(this,tp,!1)}setTimeoutProvider(s){Pe(this,Ar,s)}setTimeout(s,e){return le(this,Ar).setTimeout(s,e)}clearTimeout(s){le(this,Ar).clearTimeout(s)}setInterval(s,e){return le(this,Ar).setInterval(s,e)}clearInterval(s){le(this,Ar).clearInterval(s)}},Ar=new WeakMap,tp=new WeakMap,tv),fg=new oI;function lI(s){setTimeout(s,0)}var Mf=typeof window>"u"||"Deno"in globalThis;function ki(){}function cI(s,e){return typeof s=="function"?s(e):s}function dI(s){return typeof s=="number"&&s>=0&&s!==1/0}function fI(s,e){return Math.max(s+(e||0)-Date.now(),0)}function hg(s,e){return typeof s=="function"?s(e):s}function hI(s,e){return typeof s=="function"?s(e):s}function _x(s,e){const{type:t="all",exact:i,fetchStatus:n,predicate:a,queryKey:o,stale:c}=s;if(o){if(i){if(e.queryHash!==fp(o,e.options))return!1}else if(!pl(e.queryKey,o))return!1}if(t!=="all"){const f=e.isActive();if(t==="active"&&!f||t==="inactive"&&f)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||n&&n!==e.state.fetchStatus||a&&!a(e))}function Lx(s,e){const{exact:t,status:i,predicate:n,mutationKey:a}=s;if(a){if(!e.options.mutationKey)return!1;if(t){if(gl(e.options.mutationKey)!==gl(a))return!1}else if(!pl(e.options.mutationKey,a))return!1}return!(i&&e.state.status!==i||n&&!n(e))}function fp(s,e){return((e==null?void 0:e.queryKeyHashFn)||gl)(s)}function gl(s){return JSON.stringify(s,(e,t)=>mg(t)?Object.keys(t).sort().reduce((i,n)=>(i[n]=t[n],i),{}):t)}function pl(s,e){return s===e?!0:typeof s!=typeof e?!1:s&&e&&typeof s=="object"&&typeof e=="object"?Object.keys(e).every(t=>pl(s[t],e[t])):!1}var mI=Object.prototype.hasOwnProperty;function Av(s,e){if(s===e)return s;const t=Rx(s)&&Rx(e);if(!t&&!(mg(s)&&mg(e)))return e;const n=(t?s:Object.keys(s)).length,a=t?e:Object.keys(e),o=a.length,c=t?new Array(o):{};let f=0;for(let d=0;d<o;d++){const m=t?d:a[d],g=s[m],p=e[m];if(g===p){c[m]=g,(t?d<n:mI.call(s,m))&&f++;continue}if(g===null||p===null||typeof g!="object"||typeof p!="object"){c[m]=p;continue}const T=Av(g,p);c[m]=T,T===g&&f++}return n===o&&f===n?s:c}function Rx(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function mg(s){if(!Ix(s))return!1;const e=s.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!Ix(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function Ix(s){return Object.prototype.toString.call(s)==="[object Object]"}function gI(s){return new Promise(e=>{fg.setTimeout(e,s)})}function pI(s,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(s,e):t.structuralSharing!==!1?Av(s,e):e}function bI(s,e,t=0){const i=[...s,e];return t&&i.length>t?i.slice(1):i}function EI(s,e,t=0){const i=[e,...s];return t&&i.length>t?i.slice(0,-1):i}var hp=Symbol();function _v(s,e){return!s.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!s.queryFn||s.queryFn===hp?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}var ca,_r,Cu,sv,yI=(sv=class extends kf{constructor(){super();Ze(this,ca);Ze(this,_r);Ze(this,Cu);Pe(this,Cu,e=>{if(!Mf&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){le(this,_r)||this.setEventListener(le(this,Cu))}onUnsubscribe(){var e;this.hasListeners()||((e=le(this,_r))==null||e.call(this),Pe(this,_r,void 0))}setEventListener(e){var t;Pe(this,Cu,e),(t=le(this,_r))==null||t.call(this),Pe(this,_r,e(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(e){le(this,ca)!==e&&(Pe(this,ca,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof le(this,ca)=="boolean"?le(this,ca):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ca=new WeakMap,_r=new WeakMap,Cu=new WeakMap,sv),Lv=new yI;function xI(){let s,e;const t=new Promise((n,a)=>{s=n,e=a});t.status="pending",t.catch(()=>{});function i(n){Object.assign(t,n),delete t.resolve,delete t.reject}return t.resolve=n=>{i({status:"fulfilled",value:n}),s(n)},t.reject=n=>{i({status:"rejected",reason:n}),e(n)},t}var TI=lI;function vI(){let s=[],e=0,t=c=>{c()},i=c=>{c()},n=TI;const a=c=>{e?s.push(c):n(()=>{t(c)})},o=()=>{const c=s;s=[],c.length&&n(()=>{i(()=>{c.forEach(f=>{t(f)})})})};return{batch:c=>{let f;e++;try{f=c()}finally{e--,e||o()}return f},batchCalls:c=>(...f)=>{a(()=>{c(...f)})},schedule:a,setNotifyFunction:c=>{t=c},setBatchNotifyFunction:c=>{i=c},setScheduler:c=>{n=c}}}var Cs=vI(),Nu,Lr,Du,iv,SI=(iv=class extends kf{constructor(){super();Ze(this,Nu,!0);Ze(this,Lr);Ze(this,Du);Pe(this,Du,e=>{if(!Mf&&window.addEventListener){const t=()=>e(!0),i=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",i)}}})}onSubscribe(){le(this,Lr)||this.setEventListener(le(this,Du))}onUnsubscribe(){var e;this.hasListeners()||((e=le(this,Lr))==null||e.call(this),Pe(this,Lr,void 0))}setEventListener(e){var t;Pe(this,Du,e),(t=le(this,Lr))==null||t.call(this),Pe(this,Lr,e(this.setOnline.bind(this)))}setOnline(e){le(this,Nu)!==e&&(Pe(this,Nu,e),this.listeners.forEach(i=>{i(e)}))}isOnline(){return le(this,Nu)}},Nu=new WeakMap,Lr=new WeakMap,Du=new WeakMap,iv),tf=new SI;function AI(s){return Math.min(1e3*2**s,3e4)}function Rv(s){return(s??"online")==="online"?tf.isOnline():!0}var gg=class extends Error{constructor(s){super("CancelledError"),this.revert=s==null?void 0:s.revert,this.silent=s==null?void 0:s.silent}};function Iv(s){let e=!1,t=0,i;const n=xI(),a=()=>n.status!=="pending",o=S=>{var A;if(!a()){const R=new gg(S);p(R),(A=s.onCancel)==null||A.call(s,R)}},c=()=>{e=!0},f=()=>{e=!1},d=()=>Lv.isFocused()&&(s.networkMode==="always"||tf.isOnline())&&s.canRun(),m=()=>Rv(s.networkMode)&&s.canRun(),g=S=>{a()||(i==null||i(),n.resolve(S))},p=S=>{a()||(i==null||i(),n.reject(S))},T=()=>new Promise(S=>{var A;i=R=>{(a()||d())&&S(R)},(A=s.onPause)==null||A.call(s)}).then(()=>{var S;i=void 0,a()||(S=s.onContinue)==null||S.call(s)}),y=()=>{if(a())return;let S;const A=t===0?s.initialPromise:void 0;try{S=A??s.fn()}catch(R){S=Promise.reject(R)}Promise.resolve(S).then(g).catch(R=>{var z;if(a())return;const C=s.retry??(Mf?0:3),I=s.retryDelay??AI,D=typeof I=="function"?I(t,R):I,k=C===!0||typeof C=="number"&&t<C||typeof C=="function"&&C(t,R);if(e||!k){p(R);return}t++,(z=s.onFail)==null||z.call(s,t,R),gI(D).then(()=>d()?void 0:T()).then(()=>{e?p(R):y()})})};return{promise:n,status:()=>n.status,cancel:o,continue:()=>(i==null||i(),n),cancelRetry:c,continueRetry:f,canStart:m,start:()=>(m()?y():T().then(y),n)}}var da,nv,Cv=(nv=class{constructor(){Ze(this,da)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),dI(this.gcTime)&&Pe(this,da,fg.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(Mf?1/0:300*1e3))}clearGcTimeout(){le(this,da)&&(fg.clearTimeout(le(this,da)),Pe(this,da,void 0))}},da=new WeakMap,nv),fa,wu,Si,ha,ls,wl,ma,Mi,wn,rv,_I=(rv=class extends Cv{constructor(e){super();Ze(this,Mi);Ze(this,fa);Ze(this,wu);Ze(this,Si);Ze(this,ha);Ze(this,ls);Ze(this,wl);Ze(this,ma);Pe(this,ma,!1),Pe(this,wl,e.defaultOptions),this.setOptions(e.options),this.observers=[],Pe(this,ha,e.client),Pe(this,Si,le(this,ha).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Pe(this,fa,Nx(this.options)),this.state=e.state??le(this,fa),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=le(this,ls))==null?void 0:e.promise}setOptions(e){if(this.options={...le(this,wl),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=Nx(this.options);t.data!==void 0&&(this.setState(Cx(t.data,t.dataUpdatedAt)),Pe(this,fa,t))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&le(this,Si).remove(this)}setData(e,t){const i=pI(this.state.data,e,this.options);return Ts(this,Mi,wn).call(this,{data:i,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),i}setState(e,t){Ts(this,Mi,wn).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var i,n;const t=(i=le(this,ls))==null?void 0:i.promise;return(n=le(this,ls))==null||n.cancel(e),t?t.then(ki).catch(ki):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(le(this,fa))}isActive(){return this.observers.some(e=>hI(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===hp||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>hg(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!fI(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(i=>i.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=le(this,ls))==null||t.continue()}onOnline(){var t;const e=this.observers.find(i=>i.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=le(this,ls))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),le(this,Si).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(le(this,ls)&&(le(this,ma)?le(this,ls).cancel({revert:!0}):le(this,ls).cancelRetry()),this.scheduleGc()),le(this,Si).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ts(this,Mi,wn).call(this,{type:"invalidate"})}async fetch(e,t){var f,d,m,g,p,T,y,S,A,R,C,I;if(this.state.fetchStatus!=="idle"&&((f=le(this,ls))==null?void 0:f.status())!=="rejected"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(le(this,ls))return le(this,ls).continueRetry(),le(this,ls).promise}if(e&&this.setOptions(e),!this.options.queryFn){const D=this.observers.find(k=>k.options.queryFn);D&&this.setOptions(D.options)}const i=new AbortController,n=D=>{Object.defineProperty(D,"signal",{enumerable:!0,get:()=>(Pe(this,ma,!0),i.signal)})},a=()=>{const D=_v(this.options,t),z=(()=>{const P={client:le(this,ha),queryKey:this.queryKey,meta:this.meta};return n(P),P})();return Pe(this,ma,!1),this.options.persister?this.options.persister(D,z,this):D(z)},c=(()=>{const D={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:le(this,ha),state:this.state,fetchFn:a};return n(D),D})();(d=this.options.behavior)==null||d.onFetch(c,this),Pe(this,wu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=c.fetchOptions)==null?void 0:m.meta))&&Ts(this,Mi,wn).call(this,{type:"fetch",meta:(g=c.fetchOptions)==null?void 0:g.meta}),Pe(this,ls,Iv({initialPromise:t==null?void 0:t.initialPromise,fn:c.fetchFn,onCancel:D=>{D instanceof gg&&D.revert&&this.setState({...le(this,wu),fetchStatus:"idle"}),i.abort()},onFail:(D,k)=>{Ts(this,Mi,wn).call(this,{type:"failed",failureCount:D,error:k})},onPause:()=>{Ts(this,Mi,wn).call(this,{type:"pause"})},onContinue:()=>{Ts(this,Mi,wn).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}));try{const D=await le(this,ls).start();if(D===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(D),(T=(p=le(this,Si).config).onSuccess)==null||T.call(p,D,this),(S=(y=le(this,Si).config).onSettled)==null||S.call(y,D,this.state.error,this),D}catch(D){if(D instanceof gg){if(D.silent)return le(this,ls).promise;if(D.revert){if(this.state.data===void 0)throw D;return this.state.data}}throw Ts(this,Mi,wn).call(this,{type:"error",error:D}),(R=(A=le(this,Si).config).onError)==null||R.call(A,D,this),(I=(C=le(this,Si).config).onSettled)==null||I.call(C,this.state.data,D,this),D}finally{this.scheduleGc()}}},fa=new WeakMap,wu=new WeakMap,Si=new WeakMap,ha=new WeakMap,ls=new WeakMap,wl=new WeakMap,ma=new WeakMap,Mi=new WeakSet,wn=function(e){const t=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...LI(i.data,this.options),fetchMeta:e.meta??null};case"success":const n={...i,...Cx(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Pe(this,wu,e.manual?n:void 0),n;case"error":const a=e.error;return{...i,error:a,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=t(this.state),Cs.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),le(this,Si).notify({query:this,type:"updated",action:e})})},rv);function LI(s,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Rv(e.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function Cx(s,e){return{data:s,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Nx(s){const e=typeof s.initialData=="function"?s.initialData():s.initialData,t=e!==void 0,i=t?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}function Dx(s){return{onFetch:(e,t)=>{var m,g,p,T,y;const i=e.options,n=(p=(g=(m=e.fetchOptions)==null?void 0:m.meta)==null?void 0:g.fetchMore)==null?void 0:p.direction,a=((T=e.state.data)==null?void 0:T.pages)||[],o=((y=e.state.data)==null?void 0:y.pageParams)||[];let c={pages:[],pageParams:[]},f=0;const d=async()=>{let S=!1;const A=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(e.signal.aborted?S=!0:e.signal.addEventListener("abort",()=>{S=!0}),e.signal)})},R=_v(e.options,e.fetchOptions),C=async(I,D,k)=>{if(S)return Promise.reject();if(D==null&&I.pages.length)return Promise.resolve(I);const P=(()=>{const te={client:e.client,queryKey:e.queryKey,pageParam:D,direction:k?"backward":"forward",meta:e.options.meta};return A(te),te})(),V=await R(P),{maxPages:$}=e.options,j=k?EI:bI;return{pages:j(I.pages,V,$),pageParams:j(I.pageParams,D,$)}};if(n&&a.length){const I=n==="backward",D=I?RI:wx,k={pages:a,pageParams:o},z=D(i,k);c=await C(k,z,I)}else{const I=s??a.length;do{const D=f===0?o[0]??i.initialPageParam:wx(i,c);if(f>0&&D==null)break;c=await C(c,D),f++}while(f<I)}return c};e.options.persister?e.fetchFn=()=>{var S,A;return(A=(S=e.options).persister)==null?void 0:A.call(S,d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=d}}}function wx(s,{pages:e,pageParams:t}){const i=e.length-1;return e.length>0?s.getNextPageParam(e[i],e,t[i],t):void 0}function RI(s,{pages:e,pageParams:t}){var i;return e.length>0?(i=s.getPreviousPageParam)==null?void 0:i.call(s,e[0],e,t[0],t):void 0}var Ol,Xi,Is,ga,Wi,Er,av,II=(av=class extends Cv{constructor(e){super();Ze(this,Wi);Ze(this,Ol);Ze(this,Xi);Ze(this,Is);Ze(this,ga);Pe(this,Ol,e.client),this.mutationId=e.mutationId,Pe(this,Is,e.mutationCache),Pe(this,Xi,[]),this.state=e.state||CI(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){le(this,Xi).includes(e)||(le(this,Xi).push(e),this.clearGcTimeout(),le(this,Is).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Pe(this,Xi,le(this,Xi).filter(t=>t!==e)),this.scheduleGc(),le(this,Is).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){le(this,Xi).length||(this.state.status==="pending"?this.scheduleGc():le(this,Is).remove(this))}continue(){var e;return((e=le(this,ga))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,c,f,d,m,g,p,T,y,S,A,R,C,I,D,k,z,P,V,$;const t=()=>{Ts(this,Wi,Er).call(this,{type:"continue"})},i={client:le(this,Ol),meta:this.options.meta,mutationKey:this.options.mutationKey};Pe(this,ga,Iv({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(j,te)=>{Ts(this,Wi,Er).call(this,{type:"failed",failureCount:j,error:te})},onPause:()=>{Ts(this,Wi,Er).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>le(this,Is).canRun(this)}));const n=this.state.status==="pending",a=!le(this,ga).canStart();try{if(n)t();else{Ts(this,Wi,Er).call(this,{type:"pending",variables:e,isPaused:a}),await((c=(o=le(this,Is).config).onMutate)==null?void 0:c.call(o,e,this,i));const te=await((d=(f=this.options).onMutate)==null?void 0:d.call(f,e,i));te!==this.state.context&&Ts(this,Wi,Er).call(this,{type:"pending",context:te,variables:e,isPaused:a})}const j=await le(this,ga).start();return await((g=(m=le(this,Is).config).onSuccess)==null?void 0:g.call(m,j,e,this.state.context,this,i)),await((T=(p=this.options).onSuccess)==null?void 0:T.call(p,j,e,this.state.context,i)),await((S=(y=le(this,Is).config).onSettled)==null?void 0:S.call(y,j,null,this.state.variables,this.state.context,this,i)),await((R=(A=this.options).onSettled)==null?void 0:R.call(A,j,null,e,this.state.context,i)),Ts(this,Wi,Er).call(this,{type:"success",data:j}),j}catch(j){try{throw await((I=(C=le(this,Is).config).onError)==null?void 0:I.call(C,j,e,this.state.context,this,i)),await((k=(D=this.options).onError)==null?void 0:k.call(D,j,e,this.state.context,i)),await((P=(z=le(this,Is).config).onSettled)==null?void 0:P.call(z,void 0,j,this.state.variables,this.state.context,this,i)),await(($=(V=this.options).onSettled)==null?void 0:$.call(V,void 0,j,e,this.state.context,i)),j}finally{Ts(this,Wi,Er).call(this,{type:"error",error:j})}}finally{le(this,Is).runNext(this)}}},Ol=new WeakMap,Xi=new WeakMap,Is=new WeakMap,ga=new WeakMap,Wi=new WeakSet,Er=function(e){const t=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Cs.batch(()=>{le(this,Xi).forEach(i=>{i.onMutationUpdate(e)}),le(this,Is).notify({mutation:this,type:"updated",action:e})})},av);function CI(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Un,Pi,kl,uv,NI=(uv=class extends kf{constructor(e={}){super();Ze(this,Un);Ze(this,Pi);Ze(this,kl);this.config=e,Pe(this,Un,new Set),Pe(this,Pi,new Map),Pe(this,kl,0)}build(e,t,i){const n=new II({client:e,mutationCache:this,mutationId:++md(this,kl)._,options:e.defaultMutationOptions(t),state:i});return this.add(n),n}add(e){le(this,Un).add(e);const t=pd(e);if(typeof t=="string"){const i=le(this,Pi).get(t);i?i.push(e):le(this,Pi).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(le(this,Un).delete(e)){const t=pd(e);if(typeof t=="string"){const i=le(this,Pi).get(t);if(i)if(i.length>1){const n=i.indexOf(e);n!==-1&&i.splice(n,1)}else i[0]===e&&le(this,Pi).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=pd(e);if(typeof t=="string"){const i=le(this,Pi).get(t),n=i==null?void 0:i.find(a=>a.state.status==="pending");return!n||n===e}else return!0}runNext(e){var i;const t=pd(e);if(typeof t=="string"){const n=(i=le(this,Pi).get(t))==null?void 0:i.find(a=>a!==e&&a.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Cs.batch(()=>{le(this,Un).forEach(e=>{this.notify({type:"removed",mutation:e})}),le(this,Un).clear(),le(this,Pi).clear()})}getAll(){return Array.from(le(this,Un))}find(e){const t={exact:!0,...e};return this.getAll().find(i=>Lx(t,i))}findAll(e={}){return this.getAll().filter(t=>Lx(e,t))}notify(e){Cs.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return Cs.batch(()=>Promise.all(e.map(t=>t.continue().catch(ki))))}},Un=new WeakMap,Pi=new WeakMap,kl=new WeakMap,uv);function pd(s){var e;return(e=s.options.scope)==null?void 0:e.id}var Zi,ov,DI=(ov=class extends kf{constructor(e={}){super();Ze(this,Zi);this.config=e,Pe(this,Zi,new Map)}build(e,t,i){const n=t.queryKey,a=t.queryHash??fp(n,t);let o=this.get(a);return o||(o=new _I({client:e,queryKey:n,queryHash:a,options:e.defaultQueryOptions(t),state:i,defaultOptions:e.getQueryDefaults(n)}),this.add(o)),o}add(e){le(this,Zi).has(e.queryHash)||(le(this,Zi).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=le(this,Zi).get(e.queryHash);t&&(e.destroy(),t===e&&le(this,Zi).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Cs.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return le(this,Zi).get(e)}getAll(){return[...le(this,Zi).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(i=>_x(t,i))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(i=>_x(e,i)):t}notify(e){Cs.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Cs.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Cs.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Zi=new WeakMap,ov),Ot,Rr,Ir,Ou,ku,Cr,Mu,Pu,lv,wI=(lv=class{constructor(s={}){Ze(this,Ot);Ze(this,Rr);Ze(this,Ir);Ze(this,Ou);Ze(this,ku);Ze(this,Cr);Ze(this,Mu);Ze(this,Pu);Pe(this,Ot,s.queryCache||new DI),Pe(this,Rr,s.mutationCache||new NI),Pe(this,Ir,s.defaultOptions||{}),Pe(this,Ou,new Map),Pe(this,ku,new Map),Pe(this,Cr,0)}mount(){md(this,Cr)._++,le(this,Cr)===1&&(Pe(this,Mu,Lv.subscribe(async s=>{s&&(await this.resumePausedMutations(),le(this,Ot).onFocus())})),Pe(this,Pu,tf.subscribe(async s=>{s&&(await this.resumePausedMutations(),le(this,Ot).onOnline())})))}unmount(){var s,e;md(this,Cr)._--,le(this,Cr)===0&&((s=le(this,Mu))==null||s.call(this),Pe(this,Mu,void 0),(e=le(this,Pu))==null||e.call(this),Pe(this,Pu,void 0))}isFetching(s){return le(this,Ot).findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return le(this,Rr).findAll({...s,status:"pending"}).length}getQueryData(s){var t;const e=this.defaultQueryOptions({queryKey:s});return(t=le(this,Ot).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(s){const e=this.defaultQueryOptions(s),t=le(this,Ot).build(this,e),i=t.state.data;return i===void 0?this.fetchQuery(s):(s.revalidateIfStale&&t.isStaleByTime(hg(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(s){return le(this,Ot).findAll(s).map(({queryKey:e,state:t})=>{const i=t.data;return[e,i]})}setQueryData(s,e,t){const i=this.defaultQueryOptions({queryKey:s}),n=le(this,Ot).get(i.queryHash),a=n==null?void 0:n.state.data,o=cI(e,a);if(o!==void 0)return le(this,Ot).build(this,i).setData(o,{...t,manual:!0})}setQueriesData(s,e,t){return Cs.batch(()=>le(this,Ot).findAll(s).map(({queryKey:i})=>[i,this.setQueryData(i,e,t)]))}getQueryState(s){var t;const e=this.defaultQueryOptions({queryKey:s});return(t=le(this,Ot).get(e.queryHash))==null?void 0:t.state}removeQueries(s){const e=le(this,Ot);Cs.batch(()=>{e.findAll(s).forEach(t=>{e.remove(t)})})}resetQueries(s,e){const t=le(this,Ot);return Cs.batch(()=>(t.findAll(s).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...s},e)))}cancelQueries(s,e={}){const t={revert:!0,...e},i=Cs.batch(()=>le(this,Ot).findAll(s).map(n=>n.cancel(t)));return Promise.all(i).then(ki).catch(ki)}invalidateQueries(s,e={}){return Cs.batch(()=>(le(this,Ot).findAll(s).forEach(t=>{t.invalidate()}),(s==null?void 0:s.refetchType)==="none"?Promise.resolve():this.refetchQueries({...s,type:(s==null?void 0:s.refetchType)??(s==null?void 0:s.type)??"active"},e)))}refetchQueries(s,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},i=Cs.batch(()=>le(this,Ot).findAll(s).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let a=n.fetch(void 0,t);return t.throwOnError||(a=a.catch(ki)),n.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(i).then(ki)}fetchQuery(s){const e=this.defaultQueryOptions(s);e.retry===void 0&&(e.retry=!1);const t=le(this,Ot).build(this,e);return t.isStaleByTime(hg(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(ki).catch(ki)}fetchInfiniteQuery(s){return s.behavior=Dx(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(ki).catch(ki)}ensureInfiniteQueryData(s){return s.behavior=Dx(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return tf.isOnline()?le(this,Rr).resumePausedMutations():Promise.resolve()}getQueryCache(){return le(this,Ot)}getMutationCache(){return le(this,Rr)}getDefaultOptions(){return le(this,Ir)}setDefaultOptions(s){Pe(this,Ir,s)}setQueryDefaults(s,e){le(this,Ou).set(gl(s),{queryKey:s,defaultOptions:e})}getQueryDefaults(s){const e=[...le(this,Ou).values()],t={};return e.forEach(i=>{pl(s,i.queryKey)&&Object.assign(t,i.defaultOptions)}),t}setMutationDefaults(s,e){le(this,ku).set(gl(s),{mutationKey:s,defaultOptions:e})}getMutationDefaults(s){const e=[...le(this,ku).values()],t={};return e.forEach(i=>{pl(s,i.mutationKey)&&Object.assign(t,i.defaultOptions)}),t}defaultQueryOptions(s){if(s._defaulted)return s;const e={...le(this,Ir).queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return e.queryHash||(e.queryHash=fp(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===hp&&(e.enabled=!1),e}defaultMutationOptions(s){return s!=null&&s._defaulted?s:{...le(this,Ir).mutations,...(s==null?void 0:s.mutationKey)&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){le(this,Ot).clear(),le(this,Rr).clear()}},Ot=new WeakMap,Rr=new WeakMap,Ir=new WeakMap,Ou=new WeakMap,ku=new WeakMap,Cr=new WeakMap,Mu=new WeakMap,Pu=new WeakMap,lv),OI=U.createContext(void 0),kI=({client:s,children:e})=>(U.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),E.jsx(OI.Provider,{value:s,children:e}));function Nv(s,e){return function(){return s.apply(e,arguments)}}const{toString:MI}=Object.prototype,{getPrototypeOf:mp}=Object,{iterator:Pf,toStringTag:Dv}=Symbol,Uf=(s=>e=>{const t=MI.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Fi=s=>(s=s.toLowerCase(),e=>Uf(e)===s),Bf=s=>e=>typeof e===s,{isArray:Vu}=Array,Uu=Bf("undefined");function Ul(s){return s!==null&&!Uu(s)&&s.constructor!==null&&!Uu(s.constructor)&&Ys(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const wv=Fi("ArrayBuffer");function PI(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&wv(s.buffer),e}const UI=Bf("string"),Ys=Bf("function"),Ov=Bf("number"),Bl=s=>s!==null&&typeof s=="object",BI=s=>s===!0||s===!1,Hd=s=>{if(Uf(s)!=="object")return!1;const e=mp(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Dv in s)&&!(Pf in s)},FI=s=>{if(!Bl(s)||Ul(s))return!1;try{return Object.keys(s).length===0&&Object.getPrototypeOf(s)===Object.prototype}catch{return!1}},HI=Fi("Date"),jI=Fi("File"),$I=Fi("Blob"),GI=Fi("FileList"),qI=s=>Bl(s)&&Ys(s.pipe),VI=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||Ys(s.append)&&((e=Uf(s))==="formdata"||e==="object"&&Ys(s.toString)&&s.toString()==="[object FormData]"))},zI=Fi("URLSearchParams"),[YI,KI,QI,XI]=["ReadableStream","Request","Response","Headers"].map(Fi),WI=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Fl(s,e,{allOwnKeys:t=!1}={}){if(s===null||typeof s>"u")return;let i,n;if(typeof s!="object"&&(s=[s]),Vu(s))for(i=0,n=s.length;i<n;i++)e.call(null,s[i],i,s);else{if(Ul(s))return;const a=t?Object.getOwnPropertyNames(s):Object.keys(s),o=a.length;let c;for(i=0;i<o;i++)c=a[i],e.call(null,s[c],c,s)}}function kv(s,e){if(Ul(s))return null;e=e.toLowerCase();const t=Object.keys(s);let i=t.length,n;for(;i-- >0;)if(n=t[i],e===n.toLowerCase())return n;return null}const la=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Mv=s=>!Uu(s)&&s!==la;function pg(){const{caseless:s,skipUndefined:e}=Mv(this)&&this||{},t={},i=(n,a)=>{const o=s&&kv(t,a)||a;Hd(t[o])&&Hd(n)?t[o]=pg(t[o],n):Hd(n)?t[o]=pg({},n):Vu(n)?t[o]=n.slice():(!e||!Uu(n))&&(t[o]=n)};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&Fl(arguments[n],i);return t}const ZI=(s,e,t,{allOwnKeys:i}={})=>(Fl(e,(n,a)=>{t&&Ys(n)?s[a]=Nv(n,t):s[a]=n},{allOwnKeys:i}),s),JI=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),eC=(s,e,t,i)=>{s.prototype=Object.create(e.prototype,i),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),t&&Object.assign(s.prototype,t)},tC=(s,e,t,i)=>{let n,a,o;const c={};if(e=e||{},s==null)return e;do{for(n=Object.getOwnPropertyNames(s),a=n.length;a-- >0;)o=n[a],(!i||i(o,s,e))&&!c[o]&&(e[o]=s[o],c[o]=!0);s=t!==!1&&mp(s)}while(s&&(!t||t(s,e))&&s!==Object.prototype);return e},sC=(s,e,t)=>{s=String(s),(t===void 0||t>s.length)&&(t=s.length),t-=e.length;const i=s.indexOf(e,t);return i!==-1&&i===t},iC=s=>{if(!s)return null;if(Vu(s))return s;let e=s.length;if(!Ov(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=s[e];return t},nC=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&mp(Uint8Array)),rC=(s,e)=>{const i=(s&&s[Pf]).call(s);let n;for(;(n=i.next())&&!n.done;){const a=n.value;e.call(s,a[0],a[1])}},aC=(s,e)=>{let t;const i=[];for(;(t=s.exec(e))!==null;)i.push(t);return i},uC=Fi("HTMLFormElement"),oC=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,n){return i.toUpperCase()+n}),Ox=(({hasOwnProperty:s})=>(e,t)=>s.call(e,t))(Object.prototype),lC=Fi("RegExp"),Pv=(s,e)=>{const t=Object.getOwnPropertyDescriptors(s),i={};Fl(t,(n,a)=>{let o;(o=e(n,a,s))!==!1&&(i[a]=o||n)}),Object.defineProperties(s,i)},cC=s=>{Pv(s,(e,t)=>{if(Ys(s)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=s[t];if(Ys(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},dC=(s,e)=>{const t={},i=n=>{n.forEach(a=>{t[a]=!0})};return Vu(s)?i(s):i(String(s).split(e)),t},fC=()=>{},hC=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function mC(s){return!!(s&&Ys(s.append)&&s[Dv]==="FormData"&&s[Pf])}const gC=s=>{const e=new Array(10),t=(i,n)=>{if(Bl(i)){if(e.indexOf(i)>=0)return;if(Ul(i))return i;if(!("toJSON"in i)){e[n]=i;const a=Vu(i)?[]:{};return Fl(i,(o,c)=>{const f=t(o,n+1);!Uu(f)&&(a[c]=f)}),e[n]=void 0,a}}return i};return t(s,0)},pC=Fi("AsyncFunction"),bC=s=>s&&(Bl(s)||Ys(s))&&Ys(s.then)&&Ys(s.catch),Uv=((s,e)=>s?setImmediate:e?((t,i)=>(la.addEventListener("message",({source:n,data:a})=>{n===la&&a===t&&i.length&&i.shift()()},!1),n=>{i.push(n),la.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ys(la.postMessage)),EC=typeof queueMicrotask<"u"?queueMicrotask.bind(la):typeof process<"u"&&process.nextTick||Uv,yC=s=>s!=null&&Ys(s[Pf]),ie={isArray:Vu,isArrayBuffer:wv,isBuffer:Ul,isFormData:VI,isArrayBufferView:PI,isString:UI,isNumber:Ov,isBoolean:BI,isObject:Bl,isPlainObject:Hd,isEmptyObject:FI,isReadableStream:YI,isRequest:KI,isResponse:QI,isHeaders:XI,isUndefined:Uu,isDate:HI,isFile:jI,isBlob:$I,isRegExp:lC,isFunction:Ys,isStream:qI,isURLSearchParams:zI,isTypedArray:nC,isFileList:GI,forEach:Fl,merge:pg,extend:ZI,trim:WI,stripBOM:JI,inherits:eC,toFlatObject:tC,kindOf:Uf,kindOfTest:Fi,endsWith:sC,toArray:iC,forEachEntry:rC,matchAll:aC,isHTMLForm:uC,hasOwnProperty:Ox,hasOwnProp:Ox,reduceDescriptors:Pv,freezeMethods:cC,toObjectSet:dC,toCamelCase:oC,noop:fC,toFiniteNumber:hC,findKey:kv,global:la,isContextDefined:Mv,isSpecCompliantForm:mC,toJSONObject:gC,isAsyncFn:pC,isThenable:bC,setImmediate:Uv,asap:EC,isIterable:yC};function He(s,e,t,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),n&&(this.response=n,this.status=n.status?n.status:null)}ie.inherits(He,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ie.toJSONObject(this.config),code:this.code,status:this.status}}});const Bv=He.prototype,Fv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{Fv[s]={value:s}});Object.defineProperties(He,Fv);Object.defineProperty(Bv,"isAxiosError",{value:!0});He.from=(s,e,t,i,n,a)=>{const o=Object.create(Bv);ie.toFlatObject(s,o,function(m){return m!==Error.prototype},d=>d!=="isAxiosError");const c=s&&s.message?s.message:"Error",f=e==null&&s?s.code:e;return He.call(o,c,f,t,i,n),s&&o.cause==null&&Object.defineProperty(o,"cause",{value:s,configurable:!0}),o.name=s&&s.name||"Error",a&&Object.assign(o,a),o};const xC=null;function bg(s){return ie.isPlainObject(s)||ie.isArray(s)}function Hv(s){return ie.endsWith(s,"[]")?s.slice(0,-2):s}function kx(s,e,t){return s?s.concat(e).map(function(n,a){return n=Hv(n),!t&&a?"["+n+"]":n}).join(t?".":""):e}function TC(s){return ie.isArray(s)&&!s.some(bg)}const vC=ie.toFlatObject(ie,{},null,function(e){return/^is[A-Z]/.test(e)});function Ff(s,e,t){if(!ie.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,t=ie.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,A){return!ie.isUndefined(A[S])});const i=t.metaTokens,n=t.visitor||m,a=t.dots,o=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&ie.isSpecCompliantForm(e);if(!ie.isFunction(n))throw new TypeError("visitor must be a function");function d(y){if(y===null)return"";if(ie.isDate(y))return y.toISOString();if(ie.isBoolean(y))return y.toString();if(!f&&ie.isBlob(y))throw new He("Blob is not supported. Use a Buffer instead.");return ie.isArrayBuffer(y)||ie.isTypedArray(y)?f&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function m(y,S,A){let R=y;if(y&&!A&&typeof y=="object"){if(ie.endsWith(S,"{}"))S=i?S:S.slice(0,-2),y=JSON.stringify(y);else if(ie.isArray(y)&&TC(y)||(ie.isFileList(y)||ie.endsWith(S,"[]"))&&(R=ie.toArray(y)))return S=Hv(S),R.forEach(function(I,D){!(ie.isUndefined(I)||I===null)&&e.append(o===!0?kx([S],D,a):o===null?S:S+"[]",d(I))}),!1}return bg(y)?!0:(e.append(kx(A,S,a),d(y)),!1)}const g=[],p=Object.assign(vC,{defaultVisitor:m,convertValue:d,isVisitable:bg});function T(y,S){if(!ie.isUndefined(y)){if(g.indexOf(y)!==-1)throw Error("Circular reference detected in "+S.join("."));g.push(y),ie.forEach(y,function(R,C){(!(ie.isUndefined(R)||R===null)&&n.call(e,R,ie.isString(C)?C.trim():C,S,p))===!0&&T(R,S?S.concat(C):[C])}),g.pop()}}if(!ie.isObject(s))throw new TypeError("data must be an object");return T(s),e}function Mx(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function gp(s,e){this._pairs=[],s&&Ff(s,this,e)}const jv=gp.prototype;jv.append=function(e,t){this._pairs.push([e,t])};jv.toString=function(e){const t=e?function(i){return e.call(this,i,Mx)}:Mx;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function SC(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function $v(s,e,t){if(!e)return s;const i=t&&t.encode||SC;ie.isFunction(t)&&(t={serialize:t});const n=t&&t.serialize;let a;if(n?a=n(e,t):a=ie.isURLSearchParams(e)?e.toString():new gp(e,t).toString(i),a){const o=s.indexOf("#");o!==-1&&(s=s.slice(0,o)),s+=(s.indexOf("?")===-1?"?":"&")+a}return s}class Px{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ie.forEach(this.handlers,function(i){i!==null&&e(i)})}}const Gv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},AC=typeof URLSearchParams<"u"?URLSearchParams:gp,_C=typeof FormData<"u"?FormData:null,LC=typeof Blob<"u"?Blob:null,RC={isBrowser:!0,classes:{URLSearchParams:AC,FormData:_C,Blob:LC},protocols:["http","https","file","blob","url","data"]},pp=typeof window<"u"&&typeof document<"u",Eg=typeof navigator=="object"&&navigator||void 0,IC=pp&&(!Eg||["ReactNative","NativeScript","NS"].indexOf(Eg.product)<0),CC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",NC=pp&&window.location.href||"http://localhost",DC=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:pp,hasStandardBrowserEnv:IC,hasStandardBrowserWebWorkerEnv:CC,navigator:Eg,origin:NC},Symbol.toStringTag,{value:"Module"})),Ss={...DC,...RC};function wC(s,e){return Ff(s,new Ss.classes.URLSearchParams,{visitor:function(t,i,n,a){return Ss.isNode&&ie.isBuffer(t)?(this.append(i,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function OC(s){return ie.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function kC(s){const e={},t=Object.keys(s);let i;const n=t.length;let a;for(i=0;i<n;i++)a=t[i],e[a]=s[a];return e}function qv(s){function e(t,i,n,a){let o=t[a++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),f=a>=t.length;return o=!o&&ie.isArray(n)?n.length:o,f?(ie.hasOwnProp(n,o)?n[o]=[n[o],i]:n[o]=i,!c):((!n[o]||!ie.isObject(n[o]))&&(n[o]=[]),e(t,i,n[o],a)&&ie.isArray(n[o])&&(n[o]=kC(n[o])),!c)}if(ie.isFormData(s)&&ie.isFunction(s.entries)){const t={};return ie.forEachEntry(s,(i,n)=>{e(OC(i),n,t,0)}),t}return null}function MC(s,e,t){if(ie.isString(s))try{return(e||JSON.parse)(s),ie.trim(s)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(s)}const Hl={transitional:Gv,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",n=i.indexOf("application/json")>-1,a=ie.isObject(e);if(a&&ie.isHTMLForm(e)&&(e=new FormData(e)),ie.isFormData(e))return n?JSON.stringify(qv(e)):e;if(ie.isArrayBuffer(e)||ie.isBuffer(e)||ie.isStream(e)||ie.isFile(e)||ie.isBlob(e)||ie.isReadableStream(e))return e;if(ie.isArrayBufferView(e))return e.buffer;if(ie.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let c;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return wC(e,this.formSerializer).toString();if((c=ie.isFileList(e))||i.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Ff(c?{"files[]":e}:e,f&&new f,this.formSerializer)}}return a||n?(t.setContentType("application/json",!1),MC(e)):e}],transformResponse:[function(e){const t=this.transitional||Hl.transitional,i=t&&t.forcedJSONParsing,n=this.responseType==="json";if(ie.isResponse(e)||ie.isReadableStream(e))return e;if(e&&ie.isString(e)&&(i&&!this.responseType||n)){const o=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e,this.parseReviver)}catch(c){if(o)throw c.name==="SyntaxError"?He.from(c,He.ERR_BAD_RESPONSE,this,null,this.response):c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ss.classes.FormData,Blob:Ss.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ie.forEach(["delete","get","head","post","put","patch"],s=>{Hl.headers[s]={}});const PC=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),UC=s=>{const e={};let t,i,n;return s&&s.split(`
`).forEach(function(o){n=o.indexOf(":"),t=o.substring(0,n).trim().toLowerCase(),i=o.substring(n+1).trim(),!(!t||e[t]&&PC[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},Ux=Symbol("internals");function Qo(s){return s&&String(s).trim().toLowerCase()}function jd(s){return s===!1||s==null?s:ie.isArray(s)?s.map(jd):String(s)}function BC(s){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(s);)e[i[1]]=i[2];return e}const FC=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function Sm(s,e,t,i,n){if(ie.isFunction(i))return i.call(this,e,t);if(n&&(e=t),!!ie.isString(e)){if(ie.isString(i))return e.indexOf(i)!==-1;if(ie.isRegExp(i))return i.test(e)}}function HC(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function jC(s,e){const t=ie.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(s,i+t,{value:function(n,a,o){return this[i].call(this,e,n,a,o)},configurable:!0})})}let Ks=class{constructor(e){e&&this.set(e)}set(e,t,i){const n=this;function a(c,f,d){const m=Qo(f);if(!m)throw new Error("header name must be a non-empty string");const g=ie.findKey(n,m);(!g||n[g]===void 0||d===!0||d===void 0&&n[g]!==!1)&&(n[g||f]=jd(c))}const o=(c,f)=>ie.forEach(c,(d,m)=>a(d,m,f));if(ie.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(ie.isString(e)&&(e=e.trim())&&!FC(e))o(UC(e),t);else if(ie.isObject(e)&&ie.isIterable(e)){let c={},f,d;for(const m of e){if(!ie.isArray(m))throw TypeError("Object iterator must return a key-value pair");c[d=m[0]]=(f=c[d])?ie.isArray(f)?[...f,m[1]]:[f,m[1]]:m[1]}o(c,t)}else e!=null&&a(t,e,i);return this}get(e,t){if(e=Qo(e),e){const i=ie.findKey(this,e);if(i){const n=this[i];if(!t)return n;if(t===!0)return BC(n);if(ie.isFunction(t))return t.call(this,n,i);if(ie.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Qo(e),e){const i=ie.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||Sm(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let n=!1;function a(o){if(o=Qo(o),o){const c=ie.findKey(i,o);c&&(!t||Sm(i,i[c],c,t))&&(delete i[c],n=!0)}}return ie.isArray(e)?e.forEach(a):a(e),n}clear(e){const t=Object.keys(this);let i=t.length,n=!1;for(;i--;){const a=t[i];(!e||Sm(this,this[a],a,e,!0))&&(delete this[a],n=!0)}return n}normalize(e){const t=this,i={};return ie.forEach(this,(n,a)=>{const o=ie.findKey(i,a);if(o){t[o]=jd(n),delete t[a];return}const c=e?HC(a):String(a).trim();c!==a&&delete t[a],t[c]=jd(n),i[c]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ie.forEach(this,(i,n)=>{i!=null&&i!==!1&&(t[n]=e&&ie.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(n=>i.set(n)),i}static accessor(e){const i=(this[Ux]=this[Ux]={accessors:{}}).accessors,n=this.prototype;function a(o){const c=Qo(o);i[c]||(jC(n,o),i[c]=!0)}return ie.isArray(e)?e.forEach(a):a(e),this}};Ks.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ie.reduceDescriptors(Ks.prototype,({value:s},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(i){this[t]=i}}});ie.freezeMethods(Ks);function Am(s,e){const t=this||Hl,i=e||t,n=Ks.from(i.headers);let a=i.data;return ie.forEach(s,function(c){a=c.call(t,a,n.normalize(),e?e.status:void 0)}),n.normalize(),a}function Vv(s){return!!(s&&s.__CANCEL__)}function zu(s,e,t){He.call(this,s??"canceled",He.ERR_CANCELED,e,t),this.name="CanceledError"}ie.inherits(zu,He,{__CANCEL__:!0});function zv(s,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?s(t):e(new He("Request failed with status code "+t.status,[He.ERR_BAD_REQUEST,He.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function $C(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function GC(s,e){s=s||10;const t=new Array(s),i=new Array(s);let n=0,a=0,o;return e=e!==void 0?e:1e3,function(f){const d=Date.now(),m=i[a];o||(o=d),t[n]=f,i[n]=d;let g=a,p=0;for(;g!==n;)p+=t[g++],g=g%s;if(n=(n+1)%s,n===a&&(a=(a+1)%s),d-o<e)return;const T=m&&d-m;return T?Math.round(p*1e3/T):void 0}}function qC(s,e){let t=0,i=1e3/e,n,a;const o=(d,m=Date.now())=>{t=m,n=null,a&&(clearTimeout(a),a=null),s(...d)};return[(...d)=>{const m=Date.now(),g=m-t;g>=i?o(d,m):(n=d,a||(a=setTimeout(()=>{a=null,o(n)},i-g)))},()=>n&&o(n)]}const sf=(s,e,t=3)=>{let i=0;const n=GC(50,250);return qC(a=>{const o=a.loaded,c=a.lengthComputable?a.total:void 0,f=o-i,d=n(f),m=o<=c;i=o;const g={loaded:o,total:c,progress:c?o/c:void 0,bytes:f,rate:d||void 0,estimated:d&&c&&m?(c-o)/d:void 0,event:a,lengthComputable:c!=null,[e?"download":"upload"]:!0};s(g)},t)},Bx=(s,e)=>{const t=s!=null;return[i=>e[0]({lengthComputable:t,total:s,loaded:i}),e[1]]},Fx=s=>(...e)=>ie.asap(()=>s(...e)),VC=Ss.hasStandardBrowserEnv?((s,e)=>t=>(t=new URL(t,Ss.origin),s.protocol===t.protocol&&s.host===t.host&&(e||s.port===t.port)))(new URL(Ss.origin),Ss.navigator&&/(msie|trident)/i.test(Ss.navigator.userAgent)):()=>!0,zC=Ss.hasStandardBrowserEnv?{write(s,e,t,i,n,a,o){if(typeof document>"u")return;const c=[`${s}=${encodeURIComponent(e)}`];ie.isNumber(t)&&c.push(`expires=${new Date(t).toUTCString()}`),ie.isString(i)&&c.push(`path=${i}`),ie.isString(n)&&c.push(`domain=${n}`),a===!0&&c.push("secure"),ie.isString(o)&&c.push(`SameSite=${o}`),document.cookie=c.join("; ")},read(s){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+s+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(s){this.write(s,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function YC(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function KC(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function Yv(s,e,t){let i=!YC(e);return s&&(i||t==!1)?KC(s,e):e}const Hx=s=>s instanceof Ks?{...s}:s;function ya(s,e){e=e||{};const t={};function i(d,m,g,p){return ie.isPlainObject(d)&&ie.isPlainObject(m)?ie.merge.call({caseless:p},d,m):ie.isPlainObject(m)?ie.merge({},m):ie.isArray(m)?m.slice():m}function n(d,m,g,p){if(ie.isUndefined(m)){if(!ie.isUndefined(d))return i(void 0,d,g,p)}else return i(d,m,g,p)}function a(d,m){if(!ie.isUndefined(m))return i(void 0,m)}function o(d,m){if(ie.isUndefined(m)){if(!ie.isUndefined(d))return i(void 0,d)}else return i(void 0,m)}function c(d,m,g){if(g in e)return i(d,m);if(g in s)return i(void 0,d)}const f={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(d,m,g)=>n(Hx(d),Hx(m),g,!0)};return ie.forEach(Object.keys({...s,...e}),function(m){const g=f[m]||n,p=g(s[m],e[m],m);ie.isUndefined(p)&&g!==c||(t[m]=p)}),t}const Kv=s=>{const e=ya({},s);let{data:t,withXSRFToken:i,xsrfHeaderName:n,xsrfCookieName:a,headers:o,auth:c}=e;if(e.headers=o=Ks.from(o),e.url=$v(Yv(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),ie.isFormData(t)){if(Ss.hasStandardBrowserEnv||Ss.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(ie.isFunction(t.getHeaders)){const f=t.getHeaders(),d=["content-type","content-length"];Object.entries(f).forEach(([m,g])=>{d.includes(m.toLowerCase())&&o.set(m,g)})}}if(Ss.hasStandardBrowserEnv&&(i&&ie.isFunction(i)&&(i=i(e)),i||i!==!1&&VC(e.url))){const f=n&&a&&zC.read(a);f&&o.set(n,f)}return e},QC=typeof XMLHttpRequest<"u",XC=QC&&function(s){return new Promise(function(t,i){const n=Kv(s);let a=n.data;const o=Ks.from(n.headers).normalize();let{responseType:c,onUploadProgress:f,onDownloadProgress:d}=n,m,g,p,T,y;function S(){T&&T(),y&&y(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let A=new XMLHttpRequest;A.open(n.method.toUpperCase(),n.url,!0),A.timeout=n.timeout;function R(){if(!A)return;const I=Ks.from("getAllResponseHeaders"in A&&A.getAllResponseHeaders()),k={data:!c||c==="text"||c==="json"?A.responseText:A.response,status:A.status,statusText:A.statusText,headers:I,config:s,request:A};zv(function(P){t(P),S()},function(P){i(P),S()},k),A=null}"onloadend"in A?A.onloadend=R:A.onreadystatechange=function(){!A||A.readyState!==4||A.status===0&&!(A.responseURL&&A.responseURL.indexOf("file:")===0)||setTimeout(R)},A.onabort=function(){A&&(i(new He("Request aborted",He.ECONNABORTED,s,A)),A=null)},A.onerror=function(D){const k=D&&D.message?D.message:"Network Error",z=new He(k,He.ERR_NETWORK,s,A);z.event=D||null,i(z),A=null},A.ontimeout=function(){let D=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const k=n.transitional||Gv;n.timeoutErrorMessage&&(D=n.timeoutErrorMessage),i(new He(D,k.clarifyTimeoutError?He.ETIMEDOUT:He.ECONNABORTED,s,A)),A=null},a===void 0&&o.setContentType(null),"setRequestHeader"in A&&ie.forEach(o.toJSON(),function(D,k){A.setRequestHeader(k,D)}),ie.isUndefined(n.withCredentials)||(A.withCredentials=!!n.withCredentials),c&&c!=="json"&&(A.responseType=n.responseType),d&&([p,y]=sf(d,!0),A.addEventListener("progress",p)),f&&A.upload&&([g,T]=sf(f),A.upload.addEventListener("progress",g),A.upload.addEventListener("loadend",T)),(n.cancelToken||n.signal)&&(m=I=>{A&&(i(!I||I.type?new zu(null,s,A):I),A.abort(),A=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const C=$C(n.url);if(C&&Ss.protocols.indexOf(C)===-1){i(new He("Unsupported protocol "+C+":",He.ERR_BAD_REQUEST,s));return}A.send(a||null)})},WC=(s,e)=>{const{length:t}=s=s?s.filter(Boolean):[];if(e||t){let i=new AbortController,n;const a=function(d){if(!n){n=!0,c();const m=d instanceof Error?d:this.reason;i.abort(m instanceof He?m:new zu(m instanceof Error?m.message:m))}};let o=e&&setTimeout(()=>{o=null,a(new He(`timeout ${e} of ms exceeded`,He.ETIMEDOUT))},e);const c=()=>{s&&(o&&clearTimeout(o),o=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(a):d.removeEventListener("abort",a)}),s=null)};s.forEach(d=>d.addEventListener("abort",a));const{signal:f}=i;return f.unsubscribe=()=>ie.asap(c),f}},ZC=function*(s,e){let t=s.byteLength;if(t<e){yield s;return}let i=0,n;for(;i<t;)n=i+e,yield s.slice(i,n),i=n},JC=async function*(s,e){for await(const t of eN(s))yield*ZC(t,e)},eN=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},jx=(s,e,t,i)=>{const n=JC(s,e);let a=0,o,c=f=>{o||(o=!0,i&&i(f))};return new ReadableStream({async pull(f){try{const{done:d,value:m}=await n.next();if(d){c(),f.close();return}let g=m.byteLength;if(t){let p=a+=g;t(p)}f.enqueue(new Uint8Array(m))}catch(d){throw c(d),d}},cancel(f){return c(f),n.return()}},{highWaterMark:2})},$x=64*1024,{isFunction:bd}=ie,tN=(({Request:s,Response:e})=>({Request:s,Response:e}))(ie.global),{ReadableStream:Gx,TextEncoder:qx}=ie.global,Vx=(s,...e)=>{try{return!!s(...e)}catch{return!1}},sN=s=>{s=ie.merge.call({skipUndefined:!0},tN,s);const{fetch:e,Request:t,Response:i}=s,n=e?bd(e):typeof fetch=="function",a=bd(t),o=bd(i);if(!n)return!1;const c=n&&bd(Gx),f=n&&(typeof qx=="function"?(y=>S=>y.encode(S))(new qx):async y=>new Uint8Array(await new t(y).arrayBuffer())),d=a&&c&&Vx(()=>{let y=!1;const S=new t(Ss.origin,{body:new Gx,method:"POST",get duplex(){return y=!0,"half"}}).headers.has("Content-Type");return y&&!S}),m=o&&c&&Vx(()=>ie.isReadableStream(new i("").body)),g={stream:m&&(y=>y.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(y=>{!g[y]&&(g[y]=(S,A)=>{let R=S&&S[y];if(R)return R.call(S);throw new He(`Response type '${y}' is not supported`,He.ERR_NOT_SUPPORT,A)})});const p=async y=>{if(y==null)return 0;if(ie.isBlob(y))return y.size;if(ie.isSpecCompliantForm(y))return(await new t(Ss.origin,{method:"POST",body:y}).arrayBuffer()).byteLength;if(ie.isArrayBufferView(y)||ie.isArrayBuffer(y))return y.byteLength;if(ie.isURLSearchParams(y)&&(y=y+""),ie.isString(y))return(await f(y)).byteLength},T=async(y,S)=>{const A=ie.toFiniteNumber(y.getContentLength());return A??p(S)};return async y=>{let{url:S,method:A,data:R,signal:C,cancelToken:I,timeout:D,onDownloadProgress:k,onUploadProgress:z,responseType:P,headers:V,withCredentials:$="same-origin",fetchOptions:j}=Kv(y),te=e||fetch;P=P?(P+"").toLowerCase():"text";let ge=WC([C,I&&I.toAbortSignal()],D),ye=null;const ve=ge&&ge.unsubscribe&&(()=>{ge.unsubscribe()});let ue;try{if(z&&d&&A!=="get"&&A!=="head"&&(ue=await T(V,R))!==0){let O=new t(S,{method:"POST",body:R,duplex:"half"}),G;if(ie.isFormData(R)&&(G=O.headers.get("content-type"))&&V.setContentType(G),O.body){const[de,pe]=Bx(ue,sf(Fx(z)));R=jx(O.body,$x,de,pe)}}ie.isString($)||($=$?"include":"omit");const F=a&&"credentials"in t.prototype,J={...j,signal:ge,method:A.toUpperCase(),headers:V.normalize().toJSON(),body:R,duplex:"half",credentials:F?$:void 0};ye=a&&new t(S,J);let se=await(a?te(ye,j):te(S,J));const ne=m&&(P==="stream"||P==="response");if(m&&(k||ne&&ve)){const O={};["status","statusText","headers"].forEach(Te=>{O[Te]=se[Te]});const G=ie.toFiniteNumber(se.headers.get("content-length")),[de,pe]=k&&Bx(G,sf(Fx(k),!0))||[];se=new i(jx(se.body,$x,de,()=>{pe&&pe(),ve&&ve()}),O)}P=P||"text";let xe=await g[ie.findKey(g,P)||"text"](se,y);return!ne&&ve&&ve(),await new Promise((O,G)=>{zv(O,G,{data:xe,headers:Ks.from(se.headers),status:se.status,statusText:se.statusText,config:y,request:ye})})}catch(F){throw ve&&ve(),F&&F.name==="TypeError"&&/Load failed|fetch/i.test(F.message)?Object.assign(new He("Network Error",He.ERR_NETWORK,y,ye),{cause:F.cause||F}):He.from(F,F&&F.code,y,ye)}}},iN=new Map,Qv=s=>{let e=s&&s.env||{};const{fetch:t,Request:i,Response:n}=e,a=[i,n,t];let o=a.length,c=o,f,d,m=iN;for(;c--;)f=a[c],d=m.get(f),d===void 0&&m.set(f,d=c?new Map:sN(e)),m=d;return d};Qv();const bp={http:xC,xhr:XC,fetch:{get:Qv}};ie.forEach(bp,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const zx=s=>`- ${s}`,nN=s=>ie.isFunction(s)||s===null||s===!1;function rN(s,e){s=ie.isArray(s)?s:[s];const{length:t}=s;let i,n;const a={};for(let o=0;o<t;o++){i=s[o];let c;if(n=i,!nN(i)&&(n=bp[(c=String(i)).toLowerCase()],n===void 0))throw new He(`Unknown adapter '${c}'`);if(n&&(ie.isFunction(n)||(n=n.get(e))))break;a[c||"#"+o]=n}if(!n){const o=Object.entries(a).map(([f,d])=>`adapter ${f} `+(d===!1?"is not supported by the environment":"is not available in the build"));let c=t?o.length>1?`since :
`+o.map(zx).join(`
`):" "+zx(o[0]):"as no adapter specified";throw new He("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return n}const Xv={getAdapter:rN,adapters:bp};function _m(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new zu(null,s)}function Yx(s){return _m(s),s.headers=Ks.from(s.headers),s.data=Am.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),Xv.getAdapter(s.adapter||Hl.adapter,s)(s).then(function(i){return _m(s),i.data=Am.call(s,s.transformResponse,i),i.headers=Ks.from(i.headers),i},function(i){return Vv(i)||(_m(s),i&&i.response&&(i.response.data=Am.call(s,s.transformResponse,i.response),i.response.headers=Ks.from(i.response.headers))),Promise.reject(i)})}const Wv="1.13.2",Hf={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{Hf[s]=function(i){return typeof i===s||"a"+(e<1?"n ":" ")+s}});const Kx={};Hf.transitional=function(e,t,i){function n(a,o){return"[Axios v"+Wv+"] Transitional option '"+a+"'"+o+(i?". "+i:"")}return(a,o,c)=>{if(e===!1)throw new He(n(o," has been removed"+(t?" in "+t:"")),He.ERR_DEPRECATED);return t&&!Kx[o]&&(Kx[o]=!0,console.warn(n(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,o,c):!0}};Hf.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function aN(s,e,t){if(typeof s!="object")throw new He("options must be an object",He.ERR_BAD_OPTION_VALUE);const i=Object.keys(s);let n=i.length;for(;n-- >0;){const a=i[n],o=e[a];if(o){const c=s[a],f=c===void 0||o(c,a,s);if(f!==!0)throw new He("option "+a+" must be "+f,He.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new He("Unknown option "+a,He.ERR_BAD_OPTION)}}const $d={assertOptions:aN,validators:Hf},zi=$d.validators;let pa=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Px,response:new Px}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const a=n.stack?n.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ya(this.defaults,t);const{transitional:i,paramsSerializer:n,headers:a}=t;i!==void 0&&$d.assertOptions(i,{silentJSONParsing:zi.transitional(zi.boolean),forcedJSONParsing:zi.transitional(zi.boolean),clarifyTimeoutError:zi.transitional(zi.boolean)},!1),n!=null&&(ie.isFunction(n)?t.paramsSerializer={serialize:n}:$d.assertOptions(n,{encode:zi.function,serialize:zi.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),$d.assertOptions(t,{baseUrl:zi.spelling("baseURL"),withXsrfToken:zi.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=a&&ie.merge(a.common,a[t.method]);a&&ie.forEach(["delete","get","head","post","put","patch","common"],y=>{delete a[y]}),t.headers=Ks.concat(o,a);const c=[];let f=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(t)===!1||(f=f&&S.synchronous,c.unshift(S.fulfilled,S.rejected))});const d=[];this.interceptors.response.forEach(function(S){d.push(S.fulfilled,S.rejected)});let m,g=0,p;if(!f){const y=[Yx.bind(this),void 0];for(y.unshift(...c),y.push(...d),p=y.length,m=Promise.resolve(t);g<p;)m=m.then(y[g++],y[g++]);return m}p=c.length;let T=t;for(;g<p;){const y=c[g++],S=c[g++];try{T=y(T)}catch(A){S.call(this,A);break}}try{m=Yx.call(this,T)}catch(y){return Promise.reject(y)}for(g=0,p=d.length;g<p;)m=m.then(d[g++],d[g++]);return m}getUri(e){e=ya(this.defaults,e);const t=Yv(e.baseURL,e.url,e.allowAbsoluteUrls);return $v(t,e.params,e.paramsSerializer)}};ie.forEach(["delete","get","head","options"],function(e){pa.prototype[e]=function(t,i){return this.request(ya(i||{},{method:e,url:t,data:(i||{}).data}))}});ie.forEach(["post","put","patch"],function(e){function t(i){return function(a,o,c){return this.request(ya(c||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}pa.prototype[e]=t(),pa.prototype[e+"Form"]=t(!0)});let uN=class Zv{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const i=this;this.promise.then(n=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](n);i._listeners=null}),this.promise.then=n=>{let a;const o=new Promise(c=>{i.subscribe(c),a=c}).then(n);return o.cancel=function(){i.unsubscribe(a)},o},e(function(a,o,c){i.reason||(i.reason=new zu(a,o,c),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Zv(function(n){e=n}),cancel:e}}};function oN(s){return function(t){return s.apply(null,t)}}function lN(s){return ie.isObject(s)&&s.isAxiosError===!0}const yg={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(yg).forEach(([s,e])=>{yg[e]=s});function Jv(s){const e=new pa(s),t=Nv(pa.prototype.request,e);return ie.extend(t,pa.prototype,e,{allOwnKeys:!0}),ie.extend(t,e,null,{allOwnKeys:!0}),t.create=function(n){return Jv(ya(s,n))},t}const ut=Jv(Hl);ut.Axios=pa;ut.CanceledError=zu;ut.CancelToken=uN;ut.isCancel=Vv;ut.VERSION=Wv;ut.toFormData=Ff;ut.AxiosError=He;ut.Cancel=ut.CanceledError;ut.all=function(e){return Promise.all(e)};ut.spread=oN;ut.isAxiosError=lN;ut.mergeConfig=ya;ut.AxiosHeaders=Ks;ut.formToJSON=s=>qv(ie.isHTMLForm(s)?new FormData(s):s);ut.getAdapter=Xv.getAdapter;ut.HttpStatusCode=yg;ut.default=ut;const{Axios:u7,AxiosError:o7,CanceledError:l7,isCancel:c7,CancelToken:d7,VERSION:f7,all:h7,Cancel:m7,isAxiosError:g7,spread:p7,toFormData:b7,AxiosHeaders:E7,HttpStatusCode:y7,formToJSON:x7,getAdapter:T7,mergeConfig:v7}=ut,eS="https://cinestream-pro-afterdark.onrender.com";console.log(" Connecting to Auth Server (Hardcoded):",eS);const vi=ut.create({baseURL:eS,headers:{"Content-Type":"application/json"}});vi.interceptors.request.use(s=>{const e=sessionStorage.getItem("accessToken");return e&&(s.headers.Authorization=`Bearer ${e}`),s},s=>Promise.reject(s));vi.interceptors.response.use(s=>s,s=>{var e;return((e=s.response)==null?void 0:e.status)===401&&(sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),sessionStorage.removeItem("user"),window.location.href="/#/login"),Promise.reject(s)});const xr={login:async(s,e)=>(await vi.post("/api/auth/login",{username:s,password:e})).data,logout:async()=>(await vi.post("/api/auth/logout")).data,getCurrentUser:async()=>(await vi.get("/api/auth/me")).data,getAllUsers:async(s=1,e=50)=>(await vi.get("/api/admin/users",{params:{page:s,limit:e}})).data,createUser:async(s,e,t)=>(await vi.post("/api/admin/users",{username:s,password:e,role:t})).data,updateUser:async(s,e)=>(await vi.put(`/api/admin/users/${s}`,e)).data,deleteUser:async s=>(await vi.delete(`/api/admin/users/${s}`)).data,blockUser:async s=>(await vi.patch(`/api/admin/users/${s}/block`)).data,unblockUser:async s=>(await vi.patch(`/api/admin/users/${s}/unblock`)).data,resetPassword:async(s,e)=>(await vi.patch(`/api/admin/users/${s}/reset-password`,{newPassword:e})).data},tS=U.createContext(void 0),cN=({children:s})=>{const[e,t]=U.useState(null),[i,n]=U.useState(!0),a=async()=>{try{const d=sessionStorage.getItem("accessToken");if(sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),!d){t(null),n(!1);return}t(null),n(!1)}catch(d){console.error("Auth check failed:",d),t(null),sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),n(!1)}},o=async(d,m)=>{var g,p;try{const T=await xr.login(d,m);if(T.success){const{user:y,accessToken:S,refreshToken:A}=T.data;sessionStorage.setItem("accessToken",S),sessionStorage.setItem("refreshToken",A),t(y),y.role==="admin"?window.location.href="/#/admin-dashboard":window.location.href="/#/"}else throw new Error(T.message||"Login failed")}catch(T){const y=((p=(g=T.response)==null?void 0:g.data)==null?void 0:p.message)||T.message||"Login failed";throw new Error(y)}},c=async()=>{try{await xr.logout()}catch(d){console.error("Logout error:",d)}finally{sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),t(null),window.location.href="/#/login"}};U.useEffect(()=>{sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),t(null),n(!1)},[]);const f={user:e,isAuthenticated:!!e,isAdmin:(e==null?void 0:e.role)==="admin",loading:i,login:o,logout:c,checkAuth:a};return E.jsx(tS.Provider,{value:f,children:s})},jl=()=>{const s=U.useContext(tS);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},sS=U.createContext(void 0),dN=({children:s})=>{const[e,t]=U.useState(()=>{const n=localStorage.getItem("theme");return n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});U.useEffect(()=>{const n=window.document.documentElement;e==="dark"?n.classList.add("dark"):n.classList.remove("dark"),localStorage.setItem("theme",e)},[e]);const i=()=>{t(n=>n==="dark"?"light":"dark")};return E.jsx(sS.Provider,{value:{theme:e,toggleTheme:i},children:s})},fN=()=>{const s=U.useContext(sS);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mN=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),Qx=s=>{const e=mN(s);return e.charAt(0).toUpperCase()+e.slice(1)},iS=(...s)=>s.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),gN=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=U.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:n="",children:a,iconNode:o,...c},f)=>U.createElement("svg",{ref:f,...pN,width:e,height:e,stroke:s,strokeWidth:i?Number(t)*24/Number(e):t,className:iS("lucide",n),...!a&&!gN(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,m])=>U.createElement(d,m)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=(s,e)=>{const t=U.forwardRef(({className:i,...n},a)=>U.createElement(bN,{ref:a,iconNode:e,className:iS(`lucide-${hN(Qx(s))}`,`lucide-${s}`,i),...n}));return t.displayName=Qx(s),t};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],nS=et("arrow-left",EN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],nf=et("calendar",yN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],TN=et("chevron-right",xN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],rS=et("circle-alert",vN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Xx=et("circle-check-big",SN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Or=et("clock",AN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],LN=et("eye-off",_N);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RN=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xu=et("eye",RN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],xg=et("film",IN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],aS=et("funnel",CN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],uS=et("globe",NN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DN=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Tg=et("heart",DN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],rf=et("info",wN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],kN=et("key",ON);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Gn=et("loader",MN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],UN=et("lock-open",PN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Su=et("lock",BN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Wx=et("log-out",FN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],jN=et("menu",HN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],GN=et("moon",$N);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]],VN=et("octagon-alert",qN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],an=et("play",zN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Bu=et("search",YN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],Zx=et("server",KN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],af=et("shield",QN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Ns=et("star",XN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],ZN=et("sun",WN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],uf=et("trash-2",JN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],nl=et("trending-up",e4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=[["path",{d:"m17 2-5 5-5-5",key:"16satq"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",key:"1e6viu"}]],bl=et("tv",t4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],i4=et("user-plus",s4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],of=et("user",n4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Jx=et("users",r4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],El=et("x",a4),u4=()=>{const[s,e]=U.useState(!1),[t,i]=U.useState(""),[n,a]=U.useState(!1),o=_a(),c=cn(),{user:f,isAdmin:d,logout:m}=jl(),{theme:g,toggleTheme:p}=fN(),T=c.pathname.startsWith("/adult"),S=(["/","/adult"].includes(c.pathname)||c.pathname.startsWith("/watch")||c.pathname.startsWith("/movies/"))&&!s;U.useEffect(()=>{const I=()=>e(window.scrollY>50);return window.addEventListener("scroll",I),()=>window.removeEventListener("scroll",I)},[]);const A=I=>{if(I.preventDefault(),!t.trim())return;o(`${T?"/adult/search":"/search"}?q=${encodeURIComponent(t)}`),a(!1)},R=async()=>{await m()},C=T?[{name:"Home",path:"/adult"},{name:"Latest",path:"/adult/latest"},{name:"Categories",path:"/adult/categories"}]:[{name:"Home",path:"/"},{name:"Movies",path:"/movies"},{name:"Genres",path:"/genres"},{name:"Web Series",path:"/webseries"},{name:"Favorites",path:"/favorites"},{name:"History",path:"/history"}];return E.jsxs("nav",{className:`fixed top-0 w-full z-50 transition-all duration-300 ${S?"bg-transparent":"bg-background/95 backdrop-blur-md border-b border-white/5 shadow-sm"}`,children:[E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-6 h-16 flex items-center justify-between",children:[E.jsxs(xt,{to:"/",className:"flex items-center gap-2 z-50",children:[E.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center font-bold text-xl ${T?"bg-secondary":"bg-primary"}`,children:T?"X":"C"}),E.jsx("span",{className:`font-bold text-xl tracking-tight hidden sm:block ${S?"text-white":"text-text"}`,children:T?"AfterDark":"CineStream Pro AfterDark"})]}),E.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[C.map(I=>E.jsx(xt,{to:I.path,className:`text-sm font-medium transition-colors ${S?"text-gray-300 hover:text-white":"text-text-muted hover:text-primary"}`,children:I.name},I.path)),E.jsxs(xt,{to:"/livetv",className:`text-sm font-medium transition-colors flex items-center gap-1 ${S?"text-gray-300 hover:text-red-500":"text-text-muted hover:text-red-500"}`,children:[E.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"})," Live TV"]}),d&&E.jsxs(xt,{to:"/admin-dashboard",className:"text-sm font-medium text-purple-400 hover:text-purple-300 transition-colors flex items-center gap-1",children:[E.jsx(af,{className:"w-4 h-4"})," Admin"]})]}),E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsxs("form",{onSubmit:A,className:"hidden md:flex relative items-center",children:[E.jsx(Bu,{className:`absolute left-3 w-4 h-4 ${S?"text-gray-400":"text-text-muted"}`}),E.jsx("input",{type:"text",placeholder:T?"Search videos...":"Search movies...",value:t,onChange:I=>i(I.target.value),className:`border rounded-full py-1.5 pl-9 pr-4 text-sm focus:outline-none transition-all w-48 lg:w-64 ${S?"bg-white/10 border-white/10 focus:border-white/30 focus:bg-white/20 text-white placeholder-gray-400":"bg-surface border-white/10 focus:border-primary/50 focus:bg-surface text-text placeholder-text-muted"}`})]}),E.jsx("button",{onClick:p,className:`p-2 rounded-full transition-colors ${S?"text-gray-300 hover:bg-white/10":"text-text-muted hover:bg-surface"}`,title:`Switch to ${g==="dark"?"light":"dark"} mode`,children:g==="dark"?E.jsx(ZN,{className:"w-5 h-5"}):E.jsx(GN,{className:"w-5 h-5"})}),E.jsx("button",{onClick:()=>o(T?"/":"/adult"),className:`px-3 py-1 rounded-md text-xs font-bold border transition-all ${T?"border-primary text-primary hover:bg-primary hover:text-black":"border-secondary text-secondary hover:bg-secondary hover:text-white"}`,children:T?"SAFE MODE":"18+"}),f&&E.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[E.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full border ${S?"bg-white/10 border-white/10":"bg-surface border-white/10"}`,children:[E.jsx(of,{className:`w-4 h-4 ${S?"text-gray-400":"text-text-muted"}`}),E.jsx("span",{className:`text-sm ${S?"text-gray-300":"text-text"}`,children:f.username})]}),E.jsx("button",{onClick:R,className:"p-2 hover:bg-red-500/20 rounded-lg transition-colors group",title:"Logout",children:E.jsx(Wx,{className:`w-4 h-4 ${S?"text-gray-400":"text-text-muted"} group-hover:text-red-400`})})]}),E.jsx("button",{className:`md:hidden ${S?"text-gray-300":"text-text"}`,onClick:()=>a(!n),children:n?E.jsx(El,{}):E.jsx(jN,{})})]})]}),n&&E.jsxs("div",{className:"md:hidden absolute top-16 left-0 w-full bg-background border-b border-white/10 p-4 flex flex-col gap-4 shadow-2xl animate-slide-up",children:[E.jsxs("form",{onSubmit:A,className:"relative w-full",children:[E.jsx(Bu,{className:"absolute left-3 top-2.5 w-4 h-4 text-text-muted"}),E.jsx("input",{type:"text",placeholder:"Search...",value:t,onChange:I=>i(I.target.value),className:"w-full bg-surface border border-white/10 rounded-lg py-2 pl-9 pr-4 text-sm text-text placeholder-text-muted"})]}),C.map(I=>E.jsx(xt,{to:I.path,onClick:()=>a(!1),className:"text-base font-medium text-text-muted hover:text-primary py-2 border-b border-white/5",children:I.name},I.path)),d&&E.jsxs(xt,{to:"/admin-dashboard",onClick:()=>a(!1),className:"text-base font-medium text-purple-400 hover:text-purple-300 py-2 border-b border-white/5 flex items-center gap-2",children:[E.jsx(af,{className:"w-4 h-4"})," Admin Panel"]}),f&&E.jsx("div",{className:"pt-2 border-t border-white/10",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(of,{className:"w-4 h-4 text-text-muted"}),E.jsx("span",{className:"text-sm text-text",children:f.username})]}),E.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-3 py-1.5 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg transition",children:[E.jsx(Wx,{className:"w-4 h-4"}),E.jsx("span",{className:"text-sm",children:"Logout"})]})]})})]})]})},Fs=({children:s})=>{const{isAuthenticated:e,loading:t}=jl();return t?E.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:E.jsxs("div",{className:"text-center flex flex-col items-center gap-4",children:[E.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),E.jsx("p",{className:"text-text text-lg",children:"Loading..."})]})}):e?E.jsx(E.Fragment,{children:s}):E.jsx(lp,{to:"/login",replace:!0})},o4=({children:s})=>{const{isAuthenticated:e,isAdmin:t,loading:i}=jl();return i?E.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:E.jsxs("div",{className:"text-center flex flex-col items-center gap-4",children:[E.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),E.jsx("p",{className:"text-text text-lg",children:"Loading..."})]})}):e?t?E.jsx(E.Fragment,{children:s}):E.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:E.jsx("div",{className:"max-w-md w-full bg-surface p-8 rounded-2xl border border-white/10 shadow-2xl animate-fade-in",children:E.jsxs("div",{className:"text-center text-text",children:[E.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:E.jsx(af,{className:"w-8 h-8 text-red-500"})}),E.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Access Denied"}),E.jsx("p",{className:"text-text-muted mb-8",children:"You don't have permission to access this page."}),E.jsx(xt,{to:"/",className:"block w-full bg-primary text-black font-bold py-3 rounded-xl hover:bg-blue-400 transition transform hover:scale-105",children:"Return Home"})]})})}):E.jsx(lp,{to:"/login",replace:!0})},l4="https://api.themoviedb.org/3",c4="be36c8a63f4f2aad5c22a368508a1672",d4="https://www.eporner.com/api/v2",Hs=ut.create({baseURL:l4,params:{api_key:c4}}),Ve={getTrending:async(s="week")=>(await Hs.get(`/trending/all/${s}`)).data.results,getPopular:async(s="movie",e=1)=>(await Hs.get(`/${s}/popular`,{params:{page:e}})).data.results,getTopRated:async(s="movie",e=1)=>(await Hs.get(`/${s}/top_rated`,{params:{page:e}})).data.results,getUpcoming:async()=>(await Hs.get("/movie/upcoming")).data.results,getNowPlaying:async()=>(await Hs.get("/movie/now_playing")).data.results,getDetails:async(s,e)=>(await Hs.get(`/${e}/${s}`,{params:{append_to_response:"credits,videos,similar"}})).data,getSimilar:async(s,e="movie")=>(await Hs.get(`/${e}/${s}/similar`)).data.results,search:async(s,e=1)=>(await Hs.get("/search/multi",{params:{query:s,page:e}})).data.results,getMoviesByGenre:async(s,e=1)=>(await Hs.get("/discover/movie",{params:{with_genres:s,page:e,sort_by:"popularity.desc"}})).data.results,getDiscoverTV:async(s=1)=>(await Hs.get("/discover/tv",{params:{page:s,sort_by:"popularity.desc"}})).data.results.map(t=>({...t,title:t.name,release_date:t.first_air_date})),getTrendingTV:async()=>(await Hs.get("/trending/tv/week")).data.results.map(e=>({...e,title:e.name,release_date:e.first_air_date})),getActorDetails:async s=>(await Hs.get(`/person/${s}`)).data,getActorMovieCredits:async s=>(await Hs.get(`/person/${s}/movie_credits`)).data,getActorTVCredits:async s=>(await Hs.get(`/person/${s}/tv_credits`)).data,getImageUrl:(s,e="w500")=>s?`https://image.tmdb.org/t/p/${e}${s}`:"https://picsum.photos/500/750?grayscale"},f4={getVideos:async(s="",e=1,t=20,i="top-weekly")=>{try{return(await ut.get(`${d4}/video/search/`,{params:{query:i==="jav"?`${s} jav`:s,per_page:t,page:e,thumbsize:"medium",order:i==="jav"?"latest-updates":i,format:"json"}})).data.videos}catch{return console.warn("Eporner API failed (likely CORS). Returning fallback data for demo."),Array.from({length:10}).map((a,o)=>({id:`mock-${o}`,title:`Adult Video Demo Title ${o+1}`,url:"#",default_thumb:{src:`https://picsum.photos/400/225?random=${o}`},length_min:"12:34",views:1e4+o*500,rate:"95%",keywords:"demo, test"}))}}},eT=({movie:s,onRemove:e})=>{const t=s.title||s.name||"Untitled",i=s.release_date||s.first_air_date||"",n=i?new Date(i).getFullYear():"",a=s.media_type==="tv"||!!s.name,o=(s.vote_average||0).toFixed(1),c=f=>{f.preventDefault(),f.stopPropagation(),e(s.id.toString())};return E.jsxs(xt,{to:`/${a?"webseries":"movies"}/${s.id}`,className:"group relative block",children:[E.jsx("button",{onClick:c,className:"absolute top-2 right-2 z-20 w-8 h-8 bg-black/80 hover:bg-red-500 rounded-full flex items-center justify-center transition-all opacity-0 group-hover:opacity-100 border border-white/20 hover:border-red-500",title:"Remove from Continue Watching",children:E.jsx(El,{className:"w-4 h-4 text-white"})}),E.jsx("div",{className:"relative backdrop-blur-xl rounded-2xl overflow-hidden transition-all duration-500 hover:scale-[1.02] hover:shadow-2xl bg-card-bg border",style:{borderColor:"var(--color-border)",boxShadow:"0 4px 6px var(--color-shadow)"},onMouseEnter:f=>f.currentTarget.style.borderColor="var(--color-border-hover)",onMouseLeave:f=>f.currentTarget.style.borderColor="var(--color-border)",children:E.jsxs("div",{className:"relative aspect-[2/3] w-full overflow-hidden",children:[E.jsx("img",{src:Ve.getImageUrl(s.poster_path),alt:t,loading:"lazy",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent opacity-60 group-hover:opacity-80 transition-opacity duration-300"}),E.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300",children:E.jsx("div",{className:"w-16 h-16 rounded-full bg-primary backdrop-blur-md flex items-center justify-center transform scale-75 group-hover:scale-100 transition-transform duration-300 shadow-2xl",children:E.jsx(an,{className:"w-7 h-7 text-black fill-current ml-1"})})}),E.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 transform translate-y-0 md:translate-y-full md:group-hover:translate-y-0 transition-transform duration-300",children:E.jsxs("div",{className:"space-y-2",children:[E.jsx("h3",{className:"font-bold text-white text-sm md:text-base line-clamp-2 drop-shadow-lg leading-tight",children:t}),E.jsxs("div",{className:"flex items-center justify-between gap-2",children:[E.jsx("span",{className:"text-gray-300 text-xs font-medium",children:n}),o!=="0.0"&&E.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-black/60 backdrop-blur-md rounded-full border border-yellow-500/30",children:[E.jsx(Ns,{className:"w-3.5 h-3.5 fill-yellow-400 text-yellow-400"}),E.jsx("span",{className:"text-yellow-400 text-xs font-bold",children:o})]})]})]})})]})}),E.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-primary/0 via-primary/20 to-primary/0 rounded-2xl opacity-0 group-hover:opacity-100 blur-xl transition-opacity duration-500 -z-10"})]})},xa=({movie:s})=>{const e=s.title||s.name||"Untitled",t=s.release_date||s.first_air_date||"",i=t?new Date(t).getFullYear():"",n=s.media_type==="tv"||!!s.name,a=(s.vote_average||0).toFixed(1);return E.jsxs(xt,{to:`/${n?"webseries":"movies"}/${s.id}`,className:"group relative block",children:[E.jsx("div",{className:"relative backdrop-blur-xl rounded-2xl overflow-hidden transition-all duration-500 hover:scale-[1.02] hover:shadow-2xl bg-card-bg border",style:{borderColor:"var(--color-border)",boxShadow:"0 4px 6px var(--color-shadow)"},onMouseEnter:o=>o.currentTarget.style.borderColor="var(--color-border-hover)",onMouseLeave:o=>o.currentTarget.style.borderColor="var(--color-border)",children:E.jsxs("div",{className:"relative aspect-[2/3] w-full overflow-hidden",children:[E.jsx("img",{src:Ve.getImageUrl(s.poster_path),alt:e,loading:"lazy",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent opacity-60 group-hover:opacity-80 transition-opacity duration-300"}),s.vote_average&&s.vote_average>8&&E.jsxs("div",{className:"absolute top-3 right-3 px-3 py-1.5 bg-gradient-to-r from-yellow-500/90 to-orange-500/90 backdrop-blur-md rounded-full flex items-center gap-1.5 shadow-lg animate-pulse",children:[E.jsx(nl,{className:"w-3.5 h-3.5 text-white"}),E.jsx("span",{className:"text-white text-xs font-bold",children:"Hot"})]}),E.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300",children:E.jsx("div",{className:"w-16 h-16 rounded-full bg-primary backdrop-blur-md flex items-center justify-center transform scale-75 group-hover:scale-100 transition-transform duration-300 shadow-2xl",children:E.jsx(an,{className:"w-7 h-7 text-black fill-current ml-1"})})}),E.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 transform translate-y-0 md:translate-y-full md:group-hover:translate-y-0 transition-transform duration-300",children:E.jsxs("div",{className:"space-y-2",children:[E.jsx("h3",{className:"font-bold text-white text-sm md:text-base line-clamp-2 drop-shadow-lg leading-tight",children:e}),E.jsxs("div",{className:"flex items-center justify-between gap-2",children:[E.jsx("span",{className:"text-gray-300 text-xs font-medium",children:i}),E.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-black/60 backdrop-blur-md rounded-full border border-yellow-500/30",children:[E.jsx(Ns,{className:"w-3.5 h-3.5 fill-yellow-400 text-yellow-400"}),E.jsx("span",{className:"text-yellow-400 text-xs font-bold",children:a})]})]}),E.jsxs("button",{className:"hidden md:flex w-full items-center justify-center gap-2 bg-primary backdrop-blur-md text-black font-bold py-2.5 rounded-xl transition-all duration-300 hover:bg-blue-400 transform opacity-0 group-hover:opacity-100 shadow-lg",children:[E.jsx(rf,{className:"w-4 h-4"}),E.jsx("span",{className:"text-sm",children:"View Details"})]})]})})]})}),E.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-primary/0 via-primary/20 to-primary/0 rounded-2xl opacity-0 group-hover:opacity-100 blur-xl transition-opacity duration-500 -z-10"})]})},Xo=({title:s,movies:e,link:t})=>!e||e.length===0?null:E.jsxs("section",{className:"space-y-4 md:space-y-6",children:[E.jsxs("div",{className:"flex items-center justify-between px-4 md:px-0",children:[E.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-text flex items-center gap-3",children:[E.jsx("span",{className:"bg-gradient-to-r from-primary to-purple-500 bg-clip-text text-transparent",children:s}),E.jsx("div",{className:"hidden md:block w-20 h-1 bg-gradient-to-r from-primary/50 to-transparent rounded-full"})]}),t&&E.jsxs(xt,{to:t,className:"group flex items-center gap-2 text-sm md:text-base text-text-muted hover:text-primary transition-colors font-medium",children:[E.jsx("span",{children:"View All"}),E.jsx(TN,{className:"w-4 h-4 md:w-5 md:h-5 transform group-hover:translate-x-1 transition-transform"})]})]}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"md:hidden overflow-x-auto scrollbar-hide -mx-4 px-4",children:E.jsx("div",{className:"flex gap-4 pb-4 snap-x snap-mandatory",children:e.slice(0,10).map(i=>E.jsx("div",{className:"flex-none w-[160px] snap-start",children:E.jsx(xa,{movie:i})},i.id))})}),E.jsx("div",{className:"hidden md:grid grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 min-[1800px]:grid-cols-7 gap-6",children:e.slice(0,12).map(i=>E.jsx(xa,{movie:i},i.id))}),E.jsx("div",{className:"md:hidden absolute top-0 right-0 bottom-0 w-16 bg-gradient-to-l from-background to-transparent pointer-events-none"})]}),E.jsx("style",{children:`
        .scrollbar-hide::-webkit-scrollbar {
          display: none;
        }
        .scrollbar-hide {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
      `})]}),Lm="continue_watching",oS=()=>{const[s,e]=U.useState([]);return U.useEffect(()=>{const n=localStorage.getItem(Lm);if(n)try{e(JSON.parse(n))}catch(a){console.error("Failed to parse continue watching data",a)}},[]),{items:s,saveProgress:n=>{e(a=>{const o=a.filter(d=>d.id!==n.id),f=[{...n,lastWatched:Date.now()},...o].slice(0,20);return localStorage.setItem(Lm,JSON.stringify(f)),f})},removeItem:n=>{e(a=>{const o=a.filter(c=>c.id!==n);return localStorage.setItem(Lm,JSON.stringify(o)),o})}}},h4=()=>{var I;const[s,e]=U.useState([]),[t,i]=U.useState([]),[n,a]=U.useState([]),[o,c]=U.useState([]),[f,d]=U.useState([]),[m,g]=U.useState(null),[p,T]=U.useState(!0),[y,S]=U.useState(null),{items:A,removeItem:R}=oS();U.useEffect(()=>{(async()=>{try{S(null);const[k,z,P,V,$]=await Promise.all([Ve.getTrending(),Ve.getPopular(),Ve.getTopRated(),Ve.getUpcoming(),Ve.getNowPlaying()]);e(k),i(z),a(P),c(V),d($),g(k[0])}catch(k){console.error("Failed to fetch movies",k),S("Failed to load movies. Please check your internet connection or API key.")}finally{T(!1)}})()},[]);const C=A.map(D=>({id:parseInt(D.tmdbId),title:D.title,name:D.title,poster_path:D.poster_path,backdrop_path:D.backdrop_path,vote_average:0,release_date:"",first_air_date:"",overview:"",genre_ids:[],original_language:"en",popularity:0,vote_count:0,video:!1,adult:!1}));return p?E.jsx("div",{className:"min-h-screen flex items-center justify-center",children:E.jsxs("div",{className:"flex flex-col items-center gap-4",children:[E.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin"}),E.jsx("p",{className:"text-primary font-medium",children:"Loading amazing content..."})]})}):y?E.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center text-red-500 gap-4 px-4",children:[E.jsx("div",{className:"w-20 h-20 rounded-full bg-red-500/10 flex items-center justify-center",children:E.jsx(rf,{size:40})}),E.jsx("p",{className:"text-xl text-center max-w-md",children:y}),E.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-primary text-black font-bold rounded-lg hover:bg-blue-400 transition-all transform hover:scale-105",children:"Retry"})]}):E.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[m&&E.jsxs("div",{className:"relative h-[60vh] md:h-[75vh] lg:h-[85vh] w-full overflow-hidden",children:[E.jsxs("div",{className:"absolute inset-0",children:[E.jsx("img",{src:Ve.getImageUrl(m.backdrop_path,"original"),alt:m.title,className:"w-full h-full object-cover scale-105 animate-[zoom_20s_ease-in-out_infinite_alternate]"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-background/80 md:via-background/60 to-transparent"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-background/95 md:from-background/90 via-background/50 md:via-background/40 to-transparent"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-transparent"})]}),E.jsx("div",{className:"absolute bottom-0 left-0 w-full p-4 md:p-8 lg:p-16 z-30",children:E.jsxs("div",{className:"max-w-4xl space-y-3 md:space-y-5 animate-fade-in",children:[E.jsxs("div",{className:"flex items-center gap-2 md:gap-3 flex-wrap",children:[E.jsxs("span",{className:"px-3 md:px-4 py-1 md:py-1.5 bg-primary/20 backdrop-blur-md border border-primary/30 rounded-full text-primary text-xs font-bold uppercase tracking-wider flex items-center gap-1.5 md:gap-2",children:[E.jsx(nl,{className:"w-3 md:w-3.5"}),E.jsx("span",{className:"hidden sm:inline",children:"Trending Now"}),E.jsx("span",{className:"sm:hidden",children:"Trending"})]}),m.vote_average&&E.jsxs("span",{className:"px-3 md:px-4 py-1 md:py-1.5 bg-yellow-500/20 backdrop-blur-md border border-yellow-500/30 rounded-full text-yellow-400 text-xs font-bold flex items-center gap-1.5",children:[E.jsx(Ns,{className:"w-3 md:w-3.5 fill-current"}),m.vote_average.toFixed(1)]})]}),E.jsx("h1",{className:"text-3xl sm:text-4xl md:text-6xl lg:text-7xl font-black leading-tight",style:{color:"var(--color-hero-text)"},children:E.jsx("span",{className:"drop-shadow-2xl",children:m.title||m.name})}),E.jsx("p",{className:"hidden sm:block text-sm md:text-base lg:text-lg line-clamp-2 md:line-clamp-3 max-w-2xl drop-shadow-lg leading-relaxed",style:{color:"var(--color-hero-text-muted)"},children:m.overview}),E.jsxs("div",{className:"flex items-center gap-3 md:gap-6 text-xs md:text-sm",style:{color:"var(--color-text-muted)"},children:[E.jsxs("div",{className:"flex items-center gap-1 text-yellow-500 dark:text-yellow-400",children:[E.jsx(Ns,{size:14,className:"md:w-4 md:h-4 fill-current"}),E.jsx("span",{className:"font-bold",children:m.vote_average.toFixed(1)})]}),E.jsxs("div",{className:"flex items-center gap-1",children:[E.jsx(nf,{size:14,className:"md:w-4 md:h-4"}),E.jsx("span",{children:new Date(m.release_date||m.first_air_date||"").getFullYear()})]}),E.jsxs("div",{className:"flex items-center gap-1",children:[E.jsx(uS,{size:14,className:"md:w-4 md:h-4"}),E.jsx("span",{children:((I=m.original_language)==null?void 0:I.toUpperCase())||"EN"})]})]}),E.jsxs("div",{className:"flex items-center gap-3 md:gap-4 pt-2 md:pt-4 flex-wrap",children:[E.jsxs(xt,{to:`/watch/${m.id}`,className:"group bg-primary text-black font-bold px-6 md:px-8 py-3 md:py-4 rounded-xl md:rounded-2xl flex items-center gap-2 md:gap-3 hover:bg-blue-400 transition-all transform active:scale-95 md:hover:scale-105 shadow-lg hover:shadow-2xl hover:shadow-primary/50 min-h-[44px]",children:[E.jsx(an,{className:"w-5 md:w-6 fill-current group-hover:scale-110 transition-transform"}),E.jsx("span",{className:"text-sm md:text-base",children:"Watch Now"})]}),E.jsxs(xt,{to:`/movies/${m.id}`,className:"group backdrop-blur-xl border-2 font-bold px-6 md:px-8 py-3 md:py-4 rounded-xl md:rounded-2xl flex items-center gap-2 md:gap-3 transition-all transform active:scale-95 md:hover:scale-105 min-h-[44px] bg-white/90 dark:bg-white/10 border-gray-300 dark:border-white/20 text-gray-900 dark:text-white hover:bg-white dark:hover:bg-white/20 hover:border-gray-400 dark:hover:border-white/40",children:[E.jsx(rf,{className:"w-5 md:w-6 group-hover:rotate-12 transition-transform"}),E.jsx("span",{className:"text-sm md:text-base",children:"More Info"})]})]})]})}),E.jsx("div",{className:"absolute bottom-6 md:bottom-8 left-1/2 -translate-x-1/2 z-20 animate-bounce hidden md:block",children:E.jsx("div",{className:"w-6 h-10 border-2 border-white/30 dark:border-white/30 rounded-full flex items-start justify-center p-2",children:E.jsx("div",{className:"w-1.5 h-3 bg-white/50 dark:bg-white/50 rounded-full animate-pulse"})})})]}),E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8 mt-12 md:mt-8 lg:mt-4 relative z-10 space-y-10 md:space-y-16",children:[C.length>0&&E.jsxs("section",{className:"space-y-4 md:space-y-6",children:[E.jsx("div",{className:"flex items-center justify-between px-4 md:px-0",children:E.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-text flex items-center gap-3",children:[E.jsx("span",{className:"bg-gradient-to-r from-primary to-purple-500 bg-clip-text text-transparent",children:"Continue Watching"}),E.jsx("div",{className:"hidden md:block w-20 h-1 bg-gradient-to-r from-primary/50 to-transparent rounded-full"})]})}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"md:hidden overflow-x-auto scrollbar-hide -mx-4 px-4",children:E.jsx("div",{className:"flex gap-4 pb-4 snap-x snap-mandatory",children:C.slice(0,10).map(D=>E.jsx("div",{className:"flex-none w-[160px] snap-start",children:E.jsx(eT,{movie:D,onRemove:R})},D.id))})}),E.jsx("div",{className:"hidden md:grid grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 min-[1800px]:grid-cols-7 gap-6",children:C.slice(0,12).map(D=>E.jsx(eT,{movie:D,onRemove:R},D.id))}),E.jsx("div",{className:"md:hidden absolute top-0 right-0 bottom-0 w-16 bg-gradient-to-l from-background to-transparent pointer-events-none"})]})]}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute -top-8 left-0 w-32 h-32 bg-primary/5 rounded-full blur-3xl"}),E.jsx(Xo,{title:"Trending Now",movies:s,link:"/movies"})]}),E.jsx(Xo,{title:"Now Playing",movies:f,link:"/movies"}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-secondary/5 rounded-full blur-3xl"}),E.jsx(Xo,{title:"Popular Movies",movies:t,link:"/movies"})]}),E.jsx(Xo,{title:"Top Rated",movies:n,link:"/movies"}),E.jsx(Xo,{title:"Upcoming Releases",movies:o,link:"/movies"})]}),E.jsx("div",{className:"fixed top-1/4 left-0 w-96 h-96 bg-primary/3 rounded-full blur-3xl pointer-events-none -z-10"}),E.jsx("div",{className:"fixed bottom-1/4 right-0 w-96 h-96 bg-secondary/3 rounded-full blur-3xl pointer-events-none -z-10"})]})},tT=({type:s})=>{var d,m;const{id:e}=wf(),[t,i]=U.useState(null),[n,a]=U.useState(!0),[o,c]=U.useState(null),f=s;return U.useEffect(()=>{(async()=>{if(e){a(!0),c(null);try{const p=await Ve.getDetails(e,f);i(p)}catch(p){console.error(p),c("Failed to load movie details.")}finally{a(!1)}}})()},[e,f]),n?E.jsx("div",{className:"h-screen flex items-center justify-center text-primary",children:"Loading details..."}):o?E.jsxs("div",{className:"h-screen flex flex-col items-center justify-center text-red-500 gap-4",children:[E.jsx("p",{className:"text-xl",children:o}),E.jsx(xt,{to:"/",className:"px-4 py-2 bg-primary text-black rounded hover:bg-blue-400",children:"Go Home"})]}):t?E.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[E.jsx("div",{className:"relative h-[50vh] lg:h-[60vh]",children:E.jsxs("div",{className:"absolute inset-0",children:[E.jsx("img",{src:Ve.getImageUrl(t.backdrop_path,"original"),alt:t.title,className:"w-full h-full object-cover"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-background/60 to-transparent"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-transparent"})]})}),E.jsxs("div",{className:"w-full mx-auto px-4 sm:px-6 md:px-8 lg:px-12 xl:px-16 -mt-32 relative z-10",children:[E.jsxs("div",{className:"flex flex-col md:flex-row gap-6 lg:gap-8 xl:gap-12 mb-8",children:[E.jsx("div",{className:"w-48 md:w-64 lg:w-72 xl:w-80 flex-shrink-0 mx-auto md:mx-0 rounded-xl overflow-hidden shadow-2xl border border-white/10",children:E.jsx("img",{src:Ve.getImageUrl(t.poster_path),alt:t.title,className:"w-full h-full object-fill"})}),E.jsxs("div",{className:"flex-1 pt-8 md:pt-32 text-center md:text-left min-w-0",children:[E.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-text mb-4 lg:mb-6",children:t.title||t.name}),E.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 lg:gap-4 text-sm lg:text-base text-text-muted mb-6 lg:mb-8",children:[E.jsxs("div",{className:"flex items-center gap-1 text-yellow-500 dark:text-yellow-400",children:[E.jsx(Ns,{size:18,fill:"currentColor"}),E.jsx("span",{className:"font-bold",children:t.vote_average.toFixed(1)})]}),E.jsxs("div",{className:"flex items-center gap-1",children:[E.jsx(nf,{size:18}),E.jsx("span",{children:new Date(t.release_date||t.first_air_date||"").getFullYear()})]}),t.runtime&&E.jsxs("div",{className:"flex items-center gap-1",children:[E.jsx(Or,{size:18}),E.jsxs("span",{children:[t.runtime," min"]})]}),E.jsx("div",{className:"flex gap-2 flex-wrap",children:t.genres.map(g=>E.jsx("span",{className:"bg-surface border border-white/10 px-3 py-1 rounded text-xs lg:text-sm",children:g.name},g.id))})]}),E.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 lg:gap-4 mb-6 lg:mb-8",children:[E.jsxs(xt,{to:`/watch/${t.id}`,className:"bg-primary text-black font-bold px-6 lg:px-10 py-3 lg:py-4 rounded-lg flex items-center gap-2 hover:bg-blue-400 transition-transform hover:scale-105 text-sm lg:text-base",children:[E.jsx(an,{size:20,fill:"currentColor"})," Watch Movie"]}),E.jsxs("button",{onClick:()=>{const g=JSON.parse(localStorage.getItem("watchlist")||"[]");if(g.some(p=>p.id===t.id)){const p=g.filter(T=>T.id!==t.id);localStorage.setItem("watchlist",JSON.stringify(p)),alert("Removed from Watchlist")}else g.push({id:t.id,title:t.title||t.name,poster_path:t.poster_path}),localStorage.setItem("watchlist",JSON.stringify(g)),alert("Added to Watchlist")},className:"bg-white/80 dark:bg-white/10 text-gray-900 dark:text-white font-bold px-6 lg:px-10 py-3 lg:py-4 rounded-lg flex items-center gap-2 hover:bg-white hover:border-black/10 dark:hover:bg-white/20 dark:hover:border-white/40 transition-transform hover:scale-105 border border-black/5 dark:border-white/10 text-sm lg:text-base",children:[E.jsx(Ns,{size:20})," Watchlist"]})]}),E.jsx("h3",{className:"text-xl lg:text-2xl font-semibold text-text mb-3",children:"Overview"}),E.jsx("p",{className:"text-text-muted leading-relaxed text-sm lg:text-base mb-6 lg:mb-8",children:t.overview})]})]}),((d=t.videos)==null?void 0:d.results)&&t.videos.results.length>0&&E.jsxs("div",{className:"mb-8 w-full",children:[E.jsxs("h3",{className:"text-xl font-semibold text-text mb-4 flex items-center gap-2",children:[E.jsx(an,{size:20,className:"text-primary",fill:"currentColor"}),"Trailers & Videos"]}),E.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 lg:gap-6",children:t.videos.results.filter(g=>g.site==="YouTube"&&(g.type==="Trailer"||g.type==="Teaser")).slice(0,6).map(g=>E.jsxs("div",{className:"group relative aspect-video rounded-xl overflow-hidden bg-surface border border-white/10 shadow-lg transition-all duration-300 hover:shadow-2xl hover:shadow-primary/20 hover:border-primary/50",children:[E.jsxs("div",{className:"absolute top-0 left-0 right-0 z-10 bg-gradient-to-b from-black/80 via-black/40 to-transparent p-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[E.jsx("p",{className:"text-white text-sm font-semibold truncate",children:g.name||g.type}),E.jsxs("p",{className:"text-white/70 text-xs",children:[g.type,"  YouTube"]})]}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-surface via-surface-highlight to-surface animate-pulse",children:E.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:E.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center",children:E.jsx(an,{size:32,className:"text-primary ml-1",fill:"currentColor"})})})}),E.jsx("iframe",{src:`https://www.youtube.com/embed/${g.key}?rel=0&modestbranding=1`,title:g.name||g.type,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,loading:"lazy",className:"absolute inset-0 w-full h-full z-[5] transition-opacity duration-500",onLoad:p=>{const y=p.currentTarget.previousElementSibling;y&&(y.classList.add("opacity-0"),setTimeout(()=>y.remove(),500))}}),E.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-20 bg-gradient-to-t from-black/60 to-transparent pointer-events-none z-[6] opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]},g.key))})]}),E.jsxs("div",{className:"mb-8",children:[E.jsx("h3",{className:"text-xl lg:text-2xl font-semibold text-text mb-4",children:"Top Cast"}),E.jsx("div",{className:"flex gap-3 lg:gap-4 overflow-x-auto pb-4 scrollbar-hide -mx-4 px-4 sm:-mx-6 sm:px-6 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12 xl:-mx-16 xl:px-16",children:(m=t.credits)==null?void 0:m.cast.slice(0,10).map(g=>E.jsxs(xt,{to:`/actor/${g.id}`,className:"flex-none w-28 lg:w-32 group",children:[E.jsx("div",{className:"w-28 h-28 lg:w-32 lg:h-32 rounded-full overflow-hidden mb-2 border-2 border-transparent group-hover:border-primary transition-colors",children:g.profile_path?E.jsx("img",{src:Ve.getImageUrl(g.profile_path,"w500"),alt:g.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}):E.jsx("div",{className:"w-full h-full bg-surface flex items-center justify-center text-text-muted text-xs text-center p-1",children:"No Image"})}),E.jsx("p",{className:"text-xs lg:text-sm font-medium text-text truncate group-hover:text-primary transition-colors",children:g.name}),E.jsx("p",{className:"text-xs text-text-muted truncate",children:g.character})]},g.id))})]}),t.similar&&t.similar.results.length>0&&E.jsxs("div",{className:"mt-8 mb-8",children:[E.jsx("h3",{className:"text-xl lg:text-2xl font-semibold text-text mb-4",children:"You May Also Like"}),E.jsx("div",{className:"flex overflow-x-auto gap-4 lg:gap-5 pb-4 scrollbar-hide -mx-4 px-4 sm:-mx-6 sm:px-6 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12 xl:-mx-16 xl:px-16",children:t.similar.results.slice(0,10).map(g=>E.jsxs(xt,{to:`/${f==="tv"?"webseries":"movies"}/${g.id}`,className:"w-40 lg:w-44 xl:w-48 flex-shrink-0 block group",children:[E.jsx("div",{className:"aspect-[2/3] rounded-xl overflow-hidden mb-3 border border-white/10 shadow-lg group-hover:shadow-2xl group-hover:shadow-primary/20 transition-all duration-300 group-hover:border-primary/50",children:E.jsx("img",{src:Ve.getImageUrl(g.poster_path),alt:g.title||g.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),E.jsx("p",{className:"text-sm lg:text-base font-medium text-text truncate group-hover:text-primary transition-colors px-1",children:g.title||g.name})]},g.id))})]})]})]}):E.jsx("div",{className:"h-screen flex items-center justify-center",children:"Movie not found"})};class m4{constructor(){this.providers=new Map,this.enabledProviders=[]}register(e){this.providers.set(e.config.id,e),this.updateEnabledProviders()}unregister(e){this.providers.delete(e),this.updateEnabledProviders()}getProvider(e){return this.providers.get(e)}getAllProviders(){return Array.from(this.providers.values())}getEnabledProviders(){return this.enabledProviders}setProviderEnabled(e,t){const i=this.providers.get(e);i&&(i.config.enabled=t,this.updateEnabledProviders())}updateEnabledProviders(){this.enabledProviders=Array.from(this.providers.values()).filter(e=>e.config.enabled).sort((e,t)=>e.config.priority-t.config.priority)}async getPostsFromAll(e){const t=await Promise.allSettled(this.enabledProviders.map(n=>n.getPosts({...e,providerContext:{baseUrl:n.config.baseUrl}}))),i=[];return t.forEach((n,a)=>{n.status==="fulfilled"?i.push(...n.value):console.error(`Provider ${this.enabledProviders[a].config.name} failed:`,n.reason)}),i}async searchAll(e){const t=await Promise.allSettled(this.enabledProviders.filter(n=>n.getSearchPosts).map(n=>n.getSearchPosts({...e,providerContext:{baseUrl:n.config.baseUrl}}))),i=[];return t.forEach((n,a)=>{n.status==="fulfilled"?i.push(...n.value):console.error("Search failed for provider:",n.reason)}),this.deduplicatePosts(i)}async getMetaWithFallback(e,t){const i=t?[this.providers.get(t),...this.enabledProviders].filter(Boolean):this.enabledProviders;for(const n of i)try{return await n.getMeta({link:e,providerContext:{baseUrl:n.config.baseUrl}})}catch(a){console.error(`Failed to get meta from ${n.config.name}:`,a);continue}return null}async getStreamsFromAll(e,t){const i=await Promise.allSettled(this.enabledProviders.map(a=>a.getStream({link:e,type:t,providerContext:{baseUrl:a.config.baseUrl}}))),n=[];return i.forEach((a,o)=>{a.status==="fulfilled"?n.push(...a.value):console.error(`Stream fetch failed for ${this.enabledProviders[o].config.name}:`,a.reason)}),n}async getEpisodesWithFallback(e,t){const i=t?[this.providers.get(t),...this.enabledProviders].filter(Boolean):this.enabledProviders;for(const n of i)if(n.getEpisodes)try{return await n.getEpisodes({url:e,providerContext:{baseUrl:n.config.baseUrl}})}catch(a){console.error(`Failed to get episodes from ${n.config.name}:`,a);continue}return[]}deduplicatePosts(e){const t=new Map;return e.forEach(i=>{const n=`${i.title.toLowerCase()}-${i.year||""}`;t.has(n)||t.set(n,i)}),Array.from(t.values())}getStats(){return{total:this.providers.size,enabled:this.enabledProviders.length,disabled:this.providers.size-this.enabledProviders.length,providers:Array.from(this.providers.values()).map(e=>({id:e.config.id,name:e.config.name,enabled:e.config.enabled,priority:e.config.priority,type:e.config.type}))}}}const Gd=new m4,qt=[{title:"Trending Now",filter:"/trending",type:"both"},{title:"Popular Movies",filter:"/popular/movie",type:"movie"},{title:"Popular TV Shows",filter:"/popular/tv",type:"tv"},{title:"Latest Releases",filter:"/latest",type:"both"}],Vt=[{id:"28",title:"Action",filter:"/genre/28"},{id:"35",title:"Comedy",filter:"/genre/35"},{id:"18",title:"Drama",filter:"/genre/18"},{id:"27",title:"Horror",filter:"/genre/27"},{id:"10749",title:"Romance",filter:"/genre/10749"},{id:"878",title:"Sci-Fi",filter:"/genre/878"},{id:"53",title:"Thriller",filter:"/genre/53"}];async function zt(s){const{filter:e,page:t}=s;try{let i=[];if(e.includes("/trending/movie"))i=await Ve.getTrending("week");else if(e.includes("/popular/movie"))i=await Ve.getPopular("movie",t);else if(e.includes("/top-rated/movie"))i=await Ve.getTopRated("movie",t);else if(e.includes("/trending/tv"))i=await Ve.getTrendingTV();else if(e.includes("/popular/tv"))i=await Ve.getPopular("tv",t);else if(e.includes("/genre/")){const n=e.split("/genre/")[1];i=await Ve.getMoviesByGenre(n,t)}else i=await Ve.getPopular("movie",t);return i.map(n=>({id:n.id.toString(),title:n.title||n.name||"Unknown",image:Ve.getImageUrl(n.poster_path),link:`/movie/${n.id}`,type:n.media_type==="tv"||n.name?"tv":"movie",year:n.release_date||n.first_air_date?new Date(n.release_date||n.first_air_date).getFullYear().toString():void 0,rating:n.vote_average,provider:"vidsrc"}))}catch(i){return console.error("Failed to fetch posts:",i),[]}}async function Yt(s){const{searchQuery:e,page:t}=s;try{return(await Ve.search(e,t)).filter(n=>n.media_type!=="person").map(n=>({id:n.id.toString(),title:n.title||n.name||"Unknown",image:Ve.getImageUrl(n.poster_path),link:`/${n.media_type||"movie"}/${n.id}`,type:n.media_type==="tv"?"tv":"movie",year:n.release_date||n.first_air_date?new Date(n.release_date||n.first_air_date).getFullYear().toString():void 0,rating:n.vote_average,provider:"vidsrc"}))}catch(i){return console.error("Failed to search posts:",i),[]}}async function Kt(s){var o,c,f,d;const{link:e}=s,t=e.match(/\/(movie|tv)\/(\d+)/);if(!t)throw new Error("Invalid link format");const[,i,n]=t,a=i;try{const m=await Ve.getDetails(n,a);let g;return a==="tv"&&m.number_of_seasons&&(g=Array.from({length:m.number_of_seasons},(p,T)=>({title:`Season ${T+1}`,episodesLink:`/tv/${n}/season/${T+1}`}))),{title:m.title||m.name||"Unknown",synopsis:m.overview||"No description available",image:Ve.getImageUrl(m.poster_path),backdrop:Ve.getImageUrl(m.backdrop_path,"original"),rating:m.vote_average,year:m.release_date||m.first_air_date?new Date(m.release_date||m.first_air_date).getFullYear().toString():void 0,genres:(o=m.genres)==null?void 0:o.map(p=>p.name),cast:(c=m.credits)==null?void 0:c.cast.slice(0,10).map(p=>p.name),director:(d=(f=m.credits)==null?void 0:f.crew.find(p=>p.job==="Director"))==null?void 0:d.name,duration:m.runtime?`${m.runtime} min`:void 0,linkList:g,provider:"vidsrc"}}catch(m){throw console.error("Failed to fetch metadata:",m),m}}function Qt(s,e){return async t=>{var o;const{link:i,type:n}=t,a=((o=i.match(/\/(?:movie|tv)\/(\d+)/))==null?void 0:o[1])||i;return e.map((c,f)=>({server:`${s}${f>0?` ${f+1}`:""}`,link:c.replace("{type}",n).replace("{id}",a).replace("{tmdb}",a),type:"iframe",quality:"auto"}))}}const Xt={vidsrc:["https://vidsrc.xyz/embed/{type}/{id}","https://vidsrc.pro/embed/{type}/{id}","https://vidsrc.me/embed/{type}?tmdb={id}","https://vidsrc.cc/v2/embed/{type}/{id}","https://vidsrc.net/embed/{type}/{id}","https://vidsrc.to/embed/{type}/{id}","https://vidsrc.rip/embed/{type}/{id}","https://vidsrc.stream/embed/{type}/{id}","https://vidsrc.vip/embed/{type}/{id}","https://vidsrc.pm/embed/{type}/{id}","https://vidsrc.icu/embed/{type}/{id}","https://vidsrc.in/embed/{type}/{id}"],embedapi:["https://player.embed-api.stream/?id={id}"],superembed:["https://multiembed.mov/?video_id={id}&tmdb=1","https://multiembed.mov/directstream.php?video_id={id}&tmdb=1","https://superembed.stream/embed/{id}"],"2embed":["https://www.2embed.cc/embed/{id}","https://www.2embed.skin/embed/{id}","https://2embed.org/embed/{id}"],godriveplayer:["https://godriveplayer.com/embed/{type}/{id}"],embedsu:["https://embed.su/embed/{type}/{id}"],nontongo:["https://www.nontongo.win/embed/{type}/{id}"],autoembed:["https://autoembed.co/movie/tmdb/{id}","https://autoembed.cc/movie/tmdb/{id}"],vidlink:["https://vidlink.pro/{type}/{id}","https://vidlink.org/embed/{type}/{id}"],smashystream:["https://player.smashy.stream/{type}/{id}","https://embed.smashystream.com/{type}/{id}"],moviesapi:["https://moviesapi.club/{type}/{id}"],embedsoap:["https://www.embedsoap.com/embed/{type}?id={id}"],embedflix:["https://embedflix.net/{type}/{id}"],frembed:["https://frembed.com/api/film.php?id={id}"],embedplayer:["https://embedplayer.site/embed/{type}/{id}"],vidbinge:["https://vidbinge.com/embed/{type}/{id}"],vidfast:["https://vidfast.to/embed/{type}/{id}"],moviee:["https://moviee.tv/embed/{type}/{id}"],warezcdn:["https://embed.warezcdn.com/{type}/{id}"],embedv:["https://www.embedv.net/embed/{type}/{id}"]};var ot;(function(s){s.Root="root",s.Text="text",s.Directive="directive",s.Comment="comment",s.Script="script",s.Style="style",s.Tag="tag",s.CDATA="cdata",s.Doctype="doctype"})(ot||(ot={}));function g4(s){return s.type===ot.Tag||s.type===ot.Script||s.type===ot.Style}const Ep=ot.Root,lS=ot.Text,p4=ot.Directive,cS=ot.Comment,b4=ot.Script,E4=ot.Style,vg=ot.Tag,y4=ot.CDATA,x4=ot.Doctype;class dS{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(e){this.parent=e}get previousSibling(){return this.prev}set previousSibling(e){this.prev=e}get nextSibling(){return this.next}set nextSibling(e){this.next=e}cloneNode(e=!1){return xl(this,e)}}class yp extends dS{constructor(e){super(),this.data=e}get nodeValue(){return this.data}set nodeValue(e){this.data=e}}class yl extends yp{constructor(){super(...arguments),this.type=ot.Text}get nodeType(){return 3}}class xp extends yp{constructor(){super(...arguments),this.type=ot.Comment}get nodeType(){return 8}}class Tp extends yp{constructor(e,t){super(t),this.name=e,this.type=ot.Directive}get nodeType(){return 1}}class vp extends dS{constructor(e){super(),this.children=e}get firstChild(){var e;return(e=this.children[0])!==null&&e!==void 0?e:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(e){this.children=e}}class fS extends vp{constructor(){super(...arguments),this.type=ot.CDATA}get nodeType(){return 4}}class Ta extends vp{constructor(){super(...arguments),this.type=ot.Root}get nodeType(){return 9}}class Sp extends vp{constructor(e,t,i=[],n=e==="script"?ot.Script:e==="style"?ot.Style:ot.Tag){super(i),this.name=e,this.attribs=t,this.type=n}get nodeType(){return 1}get tagName(){return this.name}set tagName(e){this.name=e}get attributes(){return Object.keys(this.attribs).map(e=>{var t,i;return{name:e,value:this.attribs[e],namespace:(t=this["x-attribsNamespace"])===null||t===void 0?void 0:t[e],prefix:(i=this["x-attribsPrefix"])===null||i===void 0?void 0:i[e]}})}}function Oe(s){return g4(s)}function jf(s){return s.type===ot.CDATA}function un(s){return s.type===ot.Text}function $f(s){return s.type===ot.Comment}function Sg(s){return s.type===ot.Directive}function Ur(s){return s.type===ot.Root}function Bt(s){return Object.prototype.hasOwnProperty.call(s,"children")}function xl(s,e=!1){let t;if(un(s))t=new yl(s.data);else if($f(s))t=new xp(s.data);else if(Oe(s)){const i=e?Rm(s.children):[],n=new Sp(s.name,{...s.attribs},i);i.forEach(a=>a.parent=n),s.namespace!=null&&(n.namespace=s.namespace),s["x-attribsNamespace"]&&(n["x-attribsNamespace"]={...s["x-attribsNamespace"]}),s["x-attribsPrefix"]&&(n["x-attribsPrefix"]={...s["x-attribsPrefix"]}),t=n}else if(jf(s)){const i=e?Rm(s.children):[],n=new fS(i);i.forEach(a=>a.parent=n),t=n}else if(Ur(s)){const i=e?Rm(s.children):[],n=new Ta(i);i.forEach(a=>a.parent=n),s["x-mode"]&&(n["x-mode"]=s["x-mode"]),t=n}else if(Sg(s)){const i=new Tp(s.name,s.data);s["x-name"]!=null&&(i["x-name"]=s["x-name"],i["x-publicId"]=s["x-publicId"],i["x-systemId"]=s["x-systemId"]),t=i}else throw new Error(`Not implemented yet: ${s.type}`);return t.startIndex=s.startIndex,t.endIndex=s.endIndex,s.sourceCodeLocation!=null&&(t.sourceCodeLocation=s.sourceCodeLocation),t}function Rm(s){const e=s.map(t=>xl(t,!0));for(let t=1;t<e.length;t++)e[t].prev=e[t-1],e[t-1].next=e[t];return e}const sT={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class T4{constructor(e,t,i){this.dom=[],this.root=new Ta(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof t=="function"&&(i=t,t=sT),typeof e=="object"&&(t=e,e=void 0),this.callback=e??null,this.options=t??sT,this.elementCB=i??null}onparserinit(e){this.parser=e}onreset(){this.dom=[],this.root=new Ta(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(e){this.handleCallback(e)}onclosetag(){this.lastNode=null;const e=this.tagStack.pop();this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(e)}onopentag(e,t){const i=this.options.xmlMode?ot.Tag:void 0,n=new Sp(e,t,void 0,i);this.addNode(n),this.tagStack.push(n)}ontext(e){const{lastNode:t}=this;if(t&&t.type===ot.Text)t.data+=e,this.options.withEndIndices&&(t.endIndex=this.parser.endIndex);else{const i=new yl(e);this.addNode(i),this.lastNode=i}}oncomment(e){if(this.lastNode&&this.lastNode.type===ot.Comment){this.lastNode.data+=e;return}const t=new xp(e);this.addNode(t),this.lastNode=t}oncommentend(){this.lastNode=null}oncdatastart(){const e=new yl(""),t=new fS([e]);this.addNode(t),e.parent=t,this.lastNode=e}oncdataend(){this.lastNode=null}onprocessinginstruction(e,t){const i=new Tp(e,t);this.addNode(i)}handleCallback(e){if(typeof this.callback=="function")this.callback(e,this.dom);else if(e)throw e}addNode(e){const t=this.tagStack[this.tagStack.length-1],i=t.children[t.children.length-1];this.options.withStartIndices&&(e.startIndex=this.parser.startIndex),this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),t.children.push(e),i&&(e.prev=i,i.next=e),e.parent=t,this.lastNode=null}}const iT=/["&'<>$\x80-\uFFFF]/g,v4=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),S4=String.prototype.codePointAt!=null?(s,e)=>s.codePointAt(e):(s,e)=>(s.charCodeAt(e)&64512)===55296?(s.charCodeAt(e)-55296)*1024+s.charCodeAt(e+1)-56320+65536:s.charCodeAt(e);function hS(s){let e="",t=0,i;for(;(i=iT.exec(s))!==null;){const n=i.index,a=s.charCodeAt(n),o=v4.get(a);o!==void 0?(e+=s.substring(t,n)+o,t=n+1):(e+=`${s.substring(t,n)}&#x${S4(s,n).toString(16)};`,t=iT.lastIndex+=+((a&64512)===55296))}return e+s.substr(t)}function mS(s,e){return function(i){let n,a=0,o="";for(;n=s.exec(i);)a!==n.index&&(o+=i.substring(a,n.index)),o+=e.get(n[0].charCodeAt(0)),a=n.index+1;return o+i.substring(a)}}const A4=mS(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),_4=mS(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),L4=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(s=>[s.toLowerCase(),s])),R4=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(s=>[s.toLowerCase(),s])),I4=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function C4(s){return s.replace(/"/g,"&quot;")}function N4(s,e){var t;if(!s)return;const i=((t=e.encodeEntities)!==null&&t!==void 0?t:e.decodeEntities)===!1?C4:e.xmlMode||e.encodeEntities!=="utf8"?hS:A4;return Object.keys(s).map(n=>{var a,o;const c=(a=s[n])!==null&&a!==void 0?a:"";return e.xmlMode==="foreign"&&(n=(o=R4.get(n))!==null&&o!==void 0?o:n),!e.emptyAttrs&&!e.xmlMode&&c===""?n:`${n}="${i(c)}"`}).join(" ")}const nT=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function Gf(s,e={}){const t="length"in s?s:[s];let i="";for(let n=0;n<t.length;n++)i+=D4(t[n],e);return i}function D4(s,e){switch(s.type){case Ep:return Gf(s.children,e);case x4:case p4:return M4(s);case cS:return B4(s);case y4:return U4(s);case b4:case E4:case vg:return k4(s,e);case lS:return P4(s,e)}}const w4=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),O4=new Set(["svg","math"]);function k4(s,e){var t;e.xmlMode==="foreign"&&(s.name=(t=L4.get(s.name))!==null&&t!==void 0?t:s.name,s.parent&&w4.has(s.parent.name)&&(e={...e,xmlMode:!1})),!e.xmlMode&&O4.has(s.name)&&(e={...e,xmlMode:"foreign"});let i=`<${s.name}`;const n=N4(s.attribs,e);return n&&(i+=` ${n}`),s.children.length===0&&(e.xmlMode?e.selfClosingTags!==!1:e.selfClosingTags&&nT.has(s.name))?(e.xmlMode||(i+=" "),i+="/>"):(i+=">",s.children.length>0&&(i+=Gf(s.children,e)),(e.xmlMode||!nT.has(s.name))&&(i+=`</${s.name}>`)),i}function M4(s){return`<${s.data}>`}function P4(s,e){var t;let i=s.data||"";return((t=e.encodeEntities)!==null&&t!==void 0?t:e.decodeEntities)!==!1&&!(!e.xmlMode&&s.parent&&I4.has(s.parent.name))&&(i=e.xmlMode||e.encodeEntities!=="utf8"?hS(i):_4(i)),i}function U4(s){return`<![CDATA[${s.children[0].data}]]>`}function B4(s){return`<!--${s.data}-->`}function gS(s,e){return Gf(s,e)}function F4(s,e){return Bt(s)?s.children.map(t=>gS(t,e)).join(""):""}function qd(s){return Array.isArray(s)?s.map(qd).join(""):Oe(s)?s.name==="br"?`
`:qd(s.children):jf(s)?qd(s.children):un(s)?s.data:""}function Fu(s){return Array.isArray(s)?s.map(Fu).join(""):Bt(s)&&!$f(s)?Fu(s.children):un(s)?s.data:""}function lf(s){return Array.isArray(s)?s.map(lf).join(""):Bt(s)&&(s.type===ot.Tag||jf(s))?lf(s.children):un(s)?s.data:""}function qf(s){return Bt(s)?s.children:[]}function pS(s){return s.parent||null}function bS(s){const e=pS(s);if(e!=null)return qf(e);const t=[s];let{prev:i,next:n}=s;for(;i!=null;)t.unshift(i),{prev:i}=i;for(;n!=null;)t.push(n),{next:n}=n;return t}function H4(s,e){var t;return(t=s.attribs)===null||t===void 0?void 0:t[e]}function j4(s,e){return s.attribs!=null&&Object.prototype.hasOwnProperty.call(s.attribs,e)&&s.attribs[e]!=null}function $4(s){return s.name}function Ap(s){let{next:e}=s;for(;e!==null&&!Oe(e);)({next:e}=e);return e}function _p(s){let{prev:e}=s;for(;e!==null&&!Oe(e);)({prev:e}=e);return e}function La(s){if(s.prev&&(s.prev.next=s.next),s.next&&(s.next.prev=s.prev),s.parent){const e=s.parent.children,t=e.lastIndexOf(s);t>=0&&e.splice(t,1)}s.next=null,s.prev=null,s.parent=null}function G4(s,e){const t=e.prev=s.prev;t&&(t.next=e);const i=e.next=s.next;i&&(i.prev=e);const n=e.parent=s.parent;if(n){const a=n.children;a[a.lastIndexOf(s)]=e,s.parent=null}}function q4(s,e){if(La(e),e.next=null,e.parent=s,s.children.push(e)>1){const t=s.children[s.children.length-2];t.next=e,e.prev=t}else e.prev=null}function V4(s,e){La(e);const{parent:t}=s,i=s.next;if(e.next=i,e.prev=s,s.next=e,e.parent=t,i){if(i.prev=e,t){const n=t.children;n.splice(n.lastIndexOf(i),0,e)}}else t&&t.children.push(e)}function z4(s,e){if(La(e),e.parent=s,e.prev=null,s.children.unshift(e)!==1){const t=s.children[1];t.prev=e,e.next=t}else e.next=null}function Y4(s,e){La(e);const{parent:t}=s;if(t){const i=t.children;i.splice(i.indexOf(s),0,e)}s.prev&&(s.prev.next=e),e.parent=t,e.prev=s.prev,e.next=s,s.prev=e}function $l(s,e,t=!0,i=1/0){return Lp(s,Array.isArray(e)?e:[e],t,i)}function Lp(s,e,t,i){const n=[],a=[Array.isArray(e)?e:[e]],o=[0];for(;;){if(o[0]>=a[0].length){if(o.length===1)return n;a.shift(),o.shift();continue}const c=a[0][o[0]++];if(s(c)&&(n.push(c),--i<=0))return n;t&&Bt(c)&&c.children.length>0&&(o.unshift(0),a.unshift(c.children))}}function K4(s,e){return e.find(s)}function Rp(s,e,t=!0){const i=Array.isArray(e)?e:[e];for(let n=0;n<i.length;n++){const a=i[n];if(Oe(a)&&s(a))return a;if(t&&Bt(a)&&a.children.length>0){const o=Rp(s,a.children,!0);if(o)return o}}return null}function ES(s,e){return(Array.isArray(e)?e:[e]).some(t=>Oe(t)&&s(t)||Bt(t)&&ES(s,t.children))}function Q4(s,e){const t=[],i=[Array.isArray(e)?e:[e]],n=[0];for(;;){if(n[0]>=i[0].length){if(i.length===1)return t;i.shift(),n.shift();continue}const a=i[0][n[0]++];Oe(a)&&s(a)&&t.push(a),Bt(a)&&a.children.length>0&&(n.unshift(0),i.unshift(a.children))}}const cf={tag_name(s){return typeof s=="function"?e=>Oe(e)&&s(e.name):s==="*"?Oe:e=>Oe(e)&&e.name===s},tag_type(s){return typeof s=="function"?e=>s(e.type):e=>e.type===s},tag_contains(s){return typeof s=="function"?e=>un(e)&&s(e.data):e=>un(e)&&e.data===s}};function Ip(s,e){return typeof e=="function"?t=>Oe(t)&&e(t.attribs[s]):t=>Oe(t)&&t.attribs[s]===e}function X4(s,e){return t=>s(t)||e(t)}function yS(s){const e=Object.keys(s).map(t=>{const i=s[t];return Object.prototype.hasOwnProperty.call(cf,t)?cf[t](i):Ip(t,i)});return e.length===0?null:e.reduce(X4)}function W4(s,e){const t=yS(s);return t?t(e):!0}function Z4(s,e,t,i=1/0){const n=yS(s);return n?$l(n,e,t,i):[]}function J4(s,e,t=!0){return Array.isArray(e)||(e=[e]),Rp(Ip("id",s),e,t)}function Yu(s,e,t=!0,i=1/0){return $l(cf.tag_name(s),e,t,i)}function eD(s,e,t=!0,i=1/0){return $l(Ip("class",s),e,t,i)}function tD(s,e,t=!0,i=1/0){return $l(cf.tag_type(s),e,t,i)}function sD(s){let e=s.length;for(;--e>=0;){const t=s[e];if(e>0&&s.lastIndexOf(t,e-1)>=0){s.splice(e,1);continue}for(let i=t.parent;i;i=i.parent)if(s.includes(i)){s.splice(e,1);break}}return s}var Ai;(function(s){s[s.DISCONNECTED=1]="DISCONNECTED",s[s.PRECEDING=2]="PRECEDING",s[s.FOLLOWING=4]="FOLLOWING",s[s.CONTAINS=8]="CONTAINS",s[s.CONTAINED_BY=16]="CONTAINED_BY"})(Ai||(Ai={}));function xS(s,e){const t=[],i=[];if(s===e)return 0;let n=Bt(s)?s:s.parent;for(;n;)t.unshift(n),n=n.parent;for(n=Bt(e)?e:e.parent;n;)i.unshift(n),n=n.parent;const a=Math.min(t.length,i.length);let o=0;for(;o<a&&t[o]===i[o];)o++;if(o===0)return Ai.DISCONNECTED;const c=t[o-1],f=c.children,d=t[o],m=i[o];return f.indexOf(d)>f.indexOf(m)?c===e?Ai.FOLLOWING|Ai.CONTAINED_BY:Ai.FOLLOWING:c===s?Ai.PRECEDING|Ai.CONTAINS:Ai.PRECEDING}function Ku(s){return s=s.filter((e,t,i)=>!i.includes(e,t+1)),s.sort((e,t)=>{const i=xS(e,t);return i&Ai.PRECEDING?-1:i&Ai.FOLLOWING?1:0}),s}function iD(s){const e=df(oD,s);return e?e.name==="feed"?nD(e):rD(e):null}function nD(s){var e;const t=s.children,i={type:"atom",items:Yu("entry",t).map(o=>{var c;const{children:f}=o,d={media:TS(f)};qs(d,"id","id",f),qs(d,"title","title",f);const m=(c=df("link",f))===null||c===void 0?void 0:c.attribs.href;m&&(d.link=m);const g=Nr("summary",f)||Nr("content",f);g&&(d.description=g);const p=Nr("updated",f);return p&&(d.pubDate=new Date(p)),d})};qs(i,"id","id",t),qs(i,"title","title",t);const n=(e=df("link",t))===null||e===void 0?void 0:e.attribs.href;n&&(i.link=n),qs(i,"description","subtitle",t);const a=Nr("updated",t);return a&&(i.updated=new Date(a)),qs(i,"author","email",t,!0),i}function rD(s){var e,t;const i=(t=(e=df("channel",s.children))===null||e===void 0?void 0:e.children)!==null&&t!==void 0?t:[],n={type:s.name.substr(0,3),id:"",items:Yu("item",s.children).map(o=>{const{children:c}=o,f={media:TS(c)};qs(f,"id","guid",c),qs(f,"title","title",c),qs(f,"link","link",c),qs(f,"description","description",c);const d=Nr("pubDate",c)||Nr("dc:date",c);return d&&(f.pubDate=new Date(d)),f})};qs(n,"title","title",i),qs(n,"link","link",i),qs(n,"description","description",i);const a=Nr("lastBuildDate",i);return a&&(n.updated=new Date(a)),qs(n,"author","managingEditor",i,!0),n}const aD=["url","type","lang"],uD=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function TS(s){return Yu("media:content",s).map(e=>{const{attribs:t}=e,i={medium:t.medium,isDefault:!!t.isDefault};for(const n of aD)t[n]&&(i[n]=t[n]);for(const n of uD)t[n]&&(i[n]=parseInt(t[n],10));return t.expression&&(i.expression=t.expression),i})}function df(s,e){return Yu(s,e,!0,1)[0]}function Nr(s,e,t=!1){return Fu(Yu(s,e,t,1)).trim()}function qs(s,e,t,i,n=!1){const a=Nr(t,i,n);a&&(s[e]=a)}function oD(s){return s==="rss"||s==="feed"||s==="rdf:RDF"}const Vf=Object.freeze(Object.defineProperty({__proto__:null,get DocumentPosition(){return Ai},append:V4,appendChild:q4,compareDocumentPosition:xS,existsOne:ES,filter:$l,find:Lp,findAll:Q4,findOne:Rp,findOneChild:K4,getAttributeValue:H4,getChildren:qf,getElementById:J4,getElements:Z4,getElementsByClassName:eD,getElementsByTagName:Yu,getElementsByTagType:tD,getFeed:iD,getInnerHTML:F4,getName:$4,getOuterHTML:gS,getParent:pS,getSiblings:bS,getText:qd,hasAttrib:j4,hasChildren:Bt,innerText:lf,isCDATA:jf,isComment:$f,isDocument:Ur,isTag:Oe,isText:un,nextElementSibling:Ap,prepend:Y4,prependChild:z4,prevElementSibling:_p,removeElement:La,removeSubsets:sD,replaceElement:G4,testElement:W4,textContent:Fu,uniqueSort:Ku},Symbol.toStringTag,{value:"Module"})),lD={_useHtmlParser2:!1};function Ag(s,e){if(!s)return e??lD;const t={_useHtmlParser2:!!s.xmlMode,...e,...s};return s.xml?(t._useHtmlParser2=!0,t.xmlMode=!0,s.xml!==!0&&Object.assign(t,s.xml)):s.xmlMode&&(t._useHtmlParser2=!0),t}function vS(s,e,t){return s?s(e??s._root.children,null,void 0,t).toString():""}function cD(s,e){return typeof s=="object"&&s!=null&&!("length"in s)&&!("type"in s)}function dD(s,e){const t=cD(s)?(e=s,void 0):s,i={...this===null||this===void 0?void 0:this._options,...Ag(e)};return vS(this,t,i)}function fD(s){const e={...this._options,xmlMode:!0};return vS(this,s,e)}function Tl(s){const e=s??(this?this.root():[]);let t="";for(let i=0;i<e.length;i++)t+=Fu(e[i]);return t}function hD(s,e,t=typeof e=="boolean"?e:!1){if(!s||typeof s!="string")return null;typeof e=="boolean"&&(t=e);const i=this.load(s,this._options,!1);return t||i("script").remove(),[...i.root()[0].children]}function mD(){return this(this._root)}function SS(s,e){if(e===s)return!1;let t=e;for(;t&&t!==t.parent;)if(t=t.parent,t===s)return!0;return!1}function gD(s){return this.root().extract(s)}function pD(s,e){if(!rT(s)||!rT(e))return;let t=s.length;const i=+e.length;for(let n=0;n<i;n++)s[t++]=e[n];return s.length=t,s}function rT(s){if(Array.isArray(s))return!0;if(typeof s!="object"||s===null||!("length"in s)||typeof s.length!="number"||s.length<0)return!1;for(let e=0;e<s.length;e++)if(!(e in s))return!1;return!0}const bD=Object.freeze(Object.defineProperty({__proto__:null,contains:SS,extract:gD,html:dD,merge:pD,parseHTML:hD,root:mD,text:Tl,xml:fD},Symbol.toStringTag,{value:"Module"}));function jn(s){return s.cheerio!=null}function ED(s){return s.replace(/[._-](\w|$)/g,(e,t)=>t.toUpperCase())}function yD(s){return s.replace(/[A-Z]/g,"-$&").toLowerCase()}function Ct(s,e){const t=s.length;for(let i=0;i<t;i++)e(s[i],i);return s}var oa;(function(s){s[s.LowerA=97]="LowerA",s[s.LowerZ=122]="LowerZ",s[s.UpperA=65]="UpperA",s[s.UpperZ=90]="UpperZ",s[s.Exclamation=33]="Exclamation"})(oa||(oa={}));function _g(s){const e=s.indexOf("<");if(e===-1||e>s.length-3)return!1;const t=s.charCodeAt(e+1);return(t>=oa.LowerA&&t<=oa.LowerZ||t>=oa.UpperA&&t<=oa.UpperZ||t===oa.Exclamation)&&s.includes(">",e+2)}const xD=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(s=>s.charCodeAt(0))),TD=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(s=>s.charCodeAt(0)));var Im;const vD=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),aT=(Im=String.fromCodePoint)!==null&&Im!==void 0?Im:function(s){let e="";return s>65535&&(s-=65536,e+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),e+=String.fromCharCode(s),e};function SD(s){var e;return s>=55296&&s<=57343||s>1114111?65533:(e=vD.get(s))!==null&&e!==void 0?e:s}var cs;(function(s){s[s.NUM=35]="NUM",s[s.SEMI=59]="SEMI",s[s.EQUALS=61]="EQUALS",s[s.ZERO=48]="ZERO",s[s.NINE=57]="NINE",s[s.LOWER_A=97]="LOWER_A",s[s.LOWER_F=102]="LOWER_F",s[s.LOWER_X=120]="LOWER_X",s[s.LOWER_Z=122]="LOWER_Z",s[s.UPPER_A=65]="UPPER_A",s[s.UPPER_F=70]="UPPER_F",s[s.UPPER_Z=90]="UPPER_Z"})(cs||(cs={}));const AD=32;var Dr;(function(s){s[s.VALUE_LENGTH=49152]="VALUE_LENGTH",s[s.BRANCH_LENGTH=16256]="BRANCH_LENGTH",s[s.JUMP_TABLE=127]="JUMP_TABLE"})(Dr||(Dr={}));function Lg(s){return s>=cs.ZERO&&s<=cs.NINE}function _D(s){return s>=cs.UPPER_A&&s<=cs.UPPER_F||s>=cs.LOWER_A&&s<=cs.LOWER_F}function LD(s){return s>=cs.UPPER_A&&s<=cs.UPPER_Z||s>=cs.LOWER_A&&s<=cs.LOWER_Z||Lg(s)}function RD(s){return s===cs.EQUALS||LD(s)}var us;(function(s){s[s.EntityStart=0]="EntityStart",s[s.NumericStart=1]="NumericStart",s[s.NumericDecimal=2]="NumericDecimal",s[s.NumericHex=3]="NumericHex",s[s.NamedEntity=4]="NamedEntity"})(us||(us={}));var tn;(function(s){s[s.Legacy=0]="Legacy",s[s.Strict=1]="Strict",s[s.Attribute=2]="Attribute"})(tn||(tn={}));let ID=class{constructor(e,t,i){this.decodeTree=e,this.emitCodePoint=t,this.errors=i,this.state=us.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=tn.Strict}startEntity(e){this.decodeMode=e,this.state=us.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case us.EntityStart:return e.charCodeAt(t)===cs.NUM?(this.state=us.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=us.NamedEntity,this.stateNamedEntity(e,t));case us.NumericStart:return this.stateNumericStart(e,t);case us.NumericDecimal:return this.stateNumericDecimal(e,t);case us.NumericHex:return this.stateNumericHex(e,t);case us.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|AD)===cs.LOWER_X?(this.state=us.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=us.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,i,n){if(t!==i){const a=i-t;this.result=this.result*Math.pow(n,a)+Number.parseInt(e.substr(t,a),n),this.consumed+=a}}stateNumericHex(e,t){const i=t;for(;t<e.length;){const n=e.charCodeAt(t);if(Lg(n)||_D(n))t+=1;else return this.addToNumericResult(e,i,t,16),this.emitNumericEntity(n,3)}return this.addToNumericResult(e,i,t,16),-1}stateNumericDecimal(e,t){const i=t;for(;t<e.length;){const n=e.charCodeAt(t);if(Lg(n))t+=1;else return this.addToNumericResult(e,i,t,10),this.emitNumericEntity(n,2)}return this.addToNumericResult(e,i,t,10),-1}emitNumericEntity(e,t){var i;if(this.consumed<=t)return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===cs.SEMI)this.consumed+=1;else if(this.decodeMode===tn.Strict)return 0;return this.emitCodePoint(SD(this.result),this.consumed),this.errors&&(e!==cs.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:i}=this;let n=i[this.treeIndex],a=(n&Dr.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const o=e.charCodeAt(t);if(this.treeIndex=CD(i,n,this.treeIndex+Math.max(1,a),o),this.treeIndex<0)return this.result===0||this.decodeMode===tn.Attribute&&(a===0||RD(o))?0:this.emitNotTerminatedNamedEntity();if(n=i[this.treeIndex],a=(n&Dr.VALUE_LENGTH)>>14,a!==0){if(o===cs.SEMI)return this.emitNamedEntityData(this.treeIndex,a,this.consumed+this.excess);this.decodeMode!==tn.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:i}=this,n=(i[t]&Dr.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,n,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,i){const{decodeTree:n}=this;return this.emitCodePoint(t===1?n[e]&~Dr.VALUE_LENGTH:n[e+1],i),t===3&&this.emitCodePoint(n[e+2],i),i}end(){var e;switch(this.state){case us.NamedEntity:return this.result!==0&&(this.decodeMode!==tn.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case us.NumericDecimal:return this.emitNumericEntity(0,2);case us.NumericHex:return this.emitNumericEntity(0,3);case us.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case us.EntityStart:return 0}}};function CD(s,e,t,i){const n=(e&Dr.BRANCH_LENGTH)>>7,a=e&Dr.JUMP_TABLE;if(n===0)return a!==0&&i===a?t:-1;if(a){const f=i-a;return f<0||f>=n?-1:s[t+f]-1}let o=t,c=o+n-1;for(;o<=c;){const f=o+c>>>1,d=s[f];if(d<i)o=f+1;else if(d>i)c=f-1;else return s[f+n]}return-1}var we;(function(s){s[s.Tab=9]="Tab",s[s.NewLine=10]="NewLine",s[s.FormFeed=12]="FormFeed",s[s.CarriageReturn=13]="CarriageReturn",s[s.Space=32]="Space",s[s.ExclamationMark=33]="ExclamationMark",s[s.Number=35]="Number",s[s.Amp=38]="Amp",s[s.SingleQuote=39]="SingleQuote",s[s.DoubleQuote=34]="DoubleQuote",s[s.Dash=45]="Dash",s[s.Slash=47]="Slash",s[s.Zero=48]="Zero",s[s.Nine=57]="Nine",s[s.Semi=59]="Semi",s[s.Lt=60]="Lt",s[s.Eq=61]="Eq",s[s.Gt=62]="Gt",s[s.Questionmark=63]="Questionmark",s[s.UpperA=65]="UpperA",s[s.LowerA=97]="LowerA",s[s.UpperF=70]="UpperF",s[s.LowerF=102]="LowerF",s[s.UpperZ=90]="UpperZ",s[s.LowerZ=122]="LowerZ",s[s.LowerX=120]="LowerX",s[s.OpeningSquareBracket=91]="OpeningSquareBracket"})(we||(we={}));var be;(function(s){s[s.Text=1]="Text",s[s.BeforeTagName=2]="BeforeTagName",s[s.InTagName=3]="InTagName",s[s.InSelfClosingTag=4]="InSelfClosingTag",s[s.BeforeClosingTagName=5]="BeforeClosingTagName",s[s.InClosingTagName=6]="InClosingTagName",s[s.AfterClosingTagName=7]="AfterClosingTagName",s[s.BeforeAttributeName=8]="BeforeAttributeName",s[s.InAttributeName=9]="InAttributeName",s[s.AfterAttributeName=10]="AfterAttributeName",s[s.BeforeAttributeValue=11]="BeforeAttributeValue",s[s.InAttributeValueDq=12]="InAttributeValueDq",s[s.InAttributeValueSq=13]="InAttributeValueSq",s[s.InAttributeValueNq=14]="InAttributeValueNq",s[s.BeforeDeclaration=15]="BeforeDeclaration",s[s.InDeclaration=16]="InDeclaration",s[s.InProcessingInstruction=17]="InProcessingInstruction",s[s.BeforeComment=18]="BeforeComment",s[s.CDATASequence=19]="CDATASequence",s[s.InSpecialComment=20]="InSpecialComment",s[s.InCommentLike=21]="InCommentLike",s[s.BeforeSpecialS=22]="BeforeSpecialS",s[s.BeforeSpecialT=23]="BeforeSpecialT",s[s.SpecialStartSequence=24]="SpecialStartSequence",s[s.InSpecialTag=25]="InSpecialTag",s[s.InEntity=26]="InEntity"})(be||(be={}));function On(s){return s===we.Space||s===we.NewLine||s===we.Tab||s===we.FormFeed||s===we.CarriageReturn}function Ed(s){return s===we.Slash||s===we.Gt||On(s)}function ND(s){return s>=we.LowerA&&s<=we.LowerZ||s>=we.UpperA&&s<=we.UpperZ}var sn;(function(s){s[s.NoValue=0]="NoValue",s[s.Unquoted=1]="Unquoted",s[s.Single=2]="Single",s[s.Double=3]="Double"})(sn||(sn={}));const Gt={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101]),TextareaEnd:new Uint8Array([60,47,116,101,120,116,97,114,101,97]),XmpEnd:new Uint8Array([60,47,120,109,112])};let DD=class{constructor({xmlMode:e=!1,decodeEntities:t=!0},i){this.cbs=i,this.state=be.Text,this.buffer="",this.sectionStart=0,this.index=0,this.entityStart=0,this.baseState=be.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.xmlMode=e,this.decodeEntities=t,this.entityDecoder=new ID(e?TD:xD,(n,a)=>this.emitCodePoint(n,a))}reset(){this.state=be.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=be.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(e){this.offset+=this.buffer.length,this.buffer=e,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}stateText(e){e===we.Lt||!this.decodeEntities&&this.fastForwardTo(we.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=be.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&e===we.Amp&&this.startEntity()}stateSpecialStartSequence(e){const t=this.sequenceIndex===this.currentSequence.length;if(!(t?Ed(e):(e|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!t){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=be.InTagName,this.stateInTagName(e)}stateInSpecialTag(e){if(this.sequenceIndex===this.currentSequence.length){if(e===we.Gt||On(e)){const t=this.index-this.currentSequence.length;if(this.sectionStart<t){const i=this.index;this.index=t,this.cbs.ontext(this.sectionStart,t),this.index=i}this.isSpecial=!1,this.sectionStart=t+2,this.stateInClosingTagName(e);return}this.sequenceIndex=0}(e|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===Gt.TitleEnd?this.decodeEntities&&e===we.Amp&&this.startEntity():this.fastForwardTo(we.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(e===we.Lt)}stateCDATASequence(e){e===Gt.Cdata[this.sequenceIndex]?++this.sequenceIndex===Gt.Cdata.length&&(this.state=be.InCommentLike,this.currentSequence=Gt.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=be.InDeclaration,this.stateInDeclaration(e))}fastForwardTo(e){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===e)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(e){e===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===Gt.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=be.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):e!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(e){return this.xmlMode?!Ed(e):ND(e)}startSpecial(e,t){this.isSpecial=!0,this.currentSequence=e,this.sequenceIndex=t,this.state=be.SpecialStartSequence}stateBeforeTagName(e){if(e===we.ExclamationMark)this.state=be.BeforeDeclaration,this.sectionStart=this.index+1;else if(e===we.Questionmark)this.state=be.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(e)){const t=e|32;this.sectionStart=this.index,this.xmlMode?this.state=be.InTagName:t===Gt.ScriptEnd[2]?this.state=be.BeforeSpecialS:t===Gt.TitleEnd[2]||t===Gt.XmpEnd[2]?this.state=be.BeforeSpecialT:this.state=be.InTagName}else e===we.Slash?this.state=be.BeforeClosingTagName:(this.state=be.Text,this.stateText(e))}stateInTagName(e){Ed(e)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=be.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateBeforeClosingTagName(e){On(e)||(e===we.Gt?this.state=be.Text:(this.state=this.isTagStartChar(e)?be.InClosingTagName:be.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(e){(e===we.Gt||On(e))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=be.AfterClosingTagName,this.stateAfterClosingTagName(e))}stateAfterClosingTagName(e){(e===we.Gt||this.fastForwardTo(we.Gt))&&(this.state=be.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(e){e===we.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=be.InSpecialTag,this.sequenceIndex=0):this.state=be.Text,this.sectionStart=this.index+1):e===we.Slash?this.state=be.InSelfClosingTag:On(e)||(this.state=be.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(e){e===we.Gt?(this.cbs.onselfclosingtag(this.index),this.state=be.Text,this.sectionStart=this.index+1,this.isSpecial=!1):On(e)||(this.state=be.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateInAttributeName(e){(e===we.Eq||Ed(e))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=this.index,this.state=be.AfterAttributeName,this.stateAfterAttributeName(e))}stateAfterAttributeName(e){e===we.Eq?this.state=be.BeforeAttributeValue:e===we.Slash||e===we.Gt?(this.cbs.onattribend(sn.NoValue,this.sectionStart),this.sectionStart=-1,this.state=be.BeforeAttributeName,this.stateBeforeAttributeName(e)):On(e)||(this.cbs.onattribend(sn.NoValue,this.sectionStart),this.state=be.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(e){e===we.DoubleQuote?(this.state=be.InAttributeValueDq,this.sectionStart=this.index+1):e===we.SingleQuote?(this.state=be.InAttributeValueSq,this.sectionStart=this.index+1):On(e)||(this.sectionStart=this.index,this.state=be.InAttributeValueNq,this.stateInAttributeValueNoQuotes(e))}handleInAttributeValue(e,t){e===t||!this.decodeEntities&&this.fastForwardTo(t)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(t===we.DoubleQuote?sn.Double:sn.Single,this.index+1),this.state=be.BeforeAttributeName):this.decodeEntities&&e===we.Amp&&this.startEntity()}stateInAttributeValueDoubleQuotes(e){this.handleInAttributeValue(e,we.DoubleQuote)}stateInAttributeValueSingleQuotes(e){this.handleInAttributeValue(e,we.SingleQuote)}stateInAttributeValueNoQuotes(e){On(e)||e===we.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(sn.Unquoted,this.index),this.state=be.BeforeAttributeName,this.stateBeforeAttributeName(e)):this.decodeEntities&&e===we.Amp&&this.startEntity()}stateBeforeDeclaration(e){e===we.OpeningSquareBracket?(this.state=be.CDATASequence,this.sequenceIndex=0):this.state=e===we.Dash?be.BeforeComment:be.InDeclaration}stateInDeclaration(e){(e===we.Gt||this.fastForwardTo(we.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=be.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(e){(e===we.Gt||this.fastForwardTo(we.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=be.Text,this.sectionStart=this.index+1)}stateBeforeComment(e){e===we.Dash?(this.state=be.InCommentLike,this.currentSequence=Gt.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=be.InDeclaration}stateInSpecialComment(e){(e===we.Gt||this.fastForwardTo(we.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=be.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(e){const t=e|32;t===Gt.ScriptEnd[3]?this.startSpecial(Gt.ScriptEnd,4):t===Gt.StyleEnd[3]?this.startSpecial(Gt.StyleEnd,4):(this.state=be.InTagName,this.stateInTagName(e))}stateBeforeSpecialT(e){switch(e|32){case Gt.TitleEnd[3]:{this.startSpecial(Gt.TitleEnd,4);break}case Gt.TextareaEnd[3]:{this.startSpecial(Gt.TextareaEnd,4);break}case Gt.XmpEnd[3]:{this.startSpecial(Gt.XmpEnd,4);break}default:this.state=be.InTagName,this.stateInTagName(e)}}startEntity(){this.baseState=this.state,this.state=be.InEntity,this.entityStart=this.index,this.entityDecoder.startEntity(this.xmlMode?tn.Strict:this.baseState===be.Text||this.baseState===be.InSpecialTag?tn.Legacy:tn.Attribute)}stateInEntity(){const e=this.entityDecoder.write(this.buffer,this.index-this.offset);e>=0?(this.state=this.baseState,e===0&&(this.index=this.entityStart)):this.index=this.offset+this.buffer.length-1}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===be.Text||this.state===be.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===be.InAttributeValueDq||this.state===be.InAttributeValueSq||this.state===be.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const e=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case be.Text:{this.stateText(e);break}case be.SpecialStartSequence:{this.stateSpecialStartSequence(e);break}case be.InSpecialTag:{this.stateInSpecialTag(e);break}case be.CDATASequence:{this.stateCDATASequence(e);break}case be.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(e);break}case be.InAttributeName:{this.stateInAttributeName(e);break}case be.InCommentLike:{this.stateInCommentLike(e);break}case be.InSpecialComment:{this.stateInSpecialComment(e);break}case be.BeforeAttributeName:{this.stateBeforeAttributeName(e);break}case be.InTagName:{this.stateInTagName(e);break}case be.InClosingTagName:{this.stateInClosingTagName(e);break}case be.BeforeTagName:{this.stateBeforeTagName(e);break}case be.AfterAttributeName:{this.stateAfterAttributeName(e);break}case be.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(e);break}case be.BeforeAttributeValue:{this.stateBeforeAttributeValue(e);break}case be.BeforeClosingTagName:{this.stateBeforeClosingTagName(e);break}case be.AfterClosingTagName:{this.stateAfterClosingTagName(e);break}case be.BeforeSpecialS:{this.stateBeforeSpecialS(e);break}case be.BeforeSpecialT:{this.stateBeforeSpecialT(e);break}case be.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(e);break}case be.InSelfClosingTag:{this.stateInSelfClosingTag(e);break}case be.InDeclaration:{this.stateInDeclaration(e);break}case be.BeforeDeclaration:{this.stateBeforeDeclaration(e);break}case be.BeforeComment:{this.stateBeforeComment(e);break}case be.InProcessingInstruction:{this.stateInProcessingInstruction(e);break}case be.InEntity:{this.stateInEntity();break}}this.index++}this.cleanup()}finish(){this.state===be.InEntity&&(this.entityDecoder.end(),this.state=this.baseState),this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const e=this.buffer.length+this.offset;this.sectionStart>=e||(this.state===be.InCommentLike?this.currentSequence===Gt.CdataEnd?this.cbs.oncdata(this.sectionStart,e,0):this.cbs.oncomment(this.sectionStart,e,0):this.state===be.InTagName||this.state===be.BeforeAttributeName||this.state===be.BeforeAttributeValue||this.state===be.AfterAttributeName||this.state===be.InAttributeName||this.state===be.InAttributeValueSq||this.state===be.InAttributeValueDq||this.state===be.InAttributeValueNq||this.state===be.InClosingTagName||this.cbs.ontext(this.sectionStart,e))}emitCodePoint(e,t){this.baseState!==be.Text&&this.baseState!==be.InSpecialTag?(this.sectionStart<this.entityStart&&this.cbs.onattribdata(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+t,this.index=this.sectionStart-1,this.cbs.onattribentity(e)):(this.sectionStart<this.entityStart&&this.cbs.ontext(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+t,this.index=this.sectionStart-1,this.cbs.ontextentity(e,this.sectionStart))}};const mu=new Set(["input","option","optgroup","select","button","datalist","textarea"]),pt=new Set(["p"]),uT=new Set(["thead","tbody"]),oT=new Set(["dd","dt"]),lT=new Set(["rt","rp"]),wD=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",pt],["h1",pt],["h2",pt],["h3",pt],["h4",pt],["h5",pt],["h6",pt],["select",mu],["input",mu],["output",mu],["button",mu],["datalist",mu],["textarea",mu],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",oT],["dt",oT],["address",pt],["article",pt],["aside",pt],["blockquote",pt],["details",pt],["div",pt],["dl",pt],["fieldset",pt],["figcaption",pt],["figure",pt],["footer",pt],["form",pt],["header",pt],["hr",pt],["main",pt],["nav",pt],["ol",pt],["pre",pt],["section",pt],["table",pt],["ul",pt],["rt",lT],["rp",lT],["tbody",uT],["tfoot",uT]]),OD=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),cT=new Set(["math","svg"]),dT=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),kD=/\s|\//;let MD=class{constructor(e,t={}){var i,n,a,o,c,f;this.options=t,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=e??{},this.htmlMode=!this.options.xmlMode,this.lowerCaseTagNames=(i=t.lowerCaseTags)!==null&&i!==void 0?i:this.htmlMode,this.lowerCaseAttributeNames=(n=t.lowerCaseAttributeNames)!==null&&n!==void 0?n:this.htmlMode,this.recognizeSelfClosing=(a=t.recognizeSelfClosing)!==null&&a!==void 0?a:!this.htmlMode,this.tokenizer=new((o=t.Tokenizer)!==null&&o!==void 0?o:DD)(this.options,this),this.foreignContext=[!this.htmlMode],(f=(c=this.cbs).onparserinit)===null||f===void 0||f.call(c,this)}ontext(e,t){var i,n;const a=this.getSlice(e,t);this.endIndex=t-1,(n=(i=this.cbs).ontext)===null||n===void 0||n.call(i,a),this.startIndex=t}ontextentity(e,t){var i,n;this.endIndex=t-1,(n=(i=this.cbs).ontext)===null||n===void 0||n.call(i,aT(e)),this.startIndex=t}isVoidElement(e){return this.htmlMode&&OD.has(e)}onopentagname(e,t){this.endIndex=t;let i=this.getSlice(e,t);this.lowerCaseTagNames&&(i=i.toLowerCase()),this.emitOpenTag(i)}emitOpenTag(e){var t,i,n,a;this.openTagStart=this.startIndex,this.tagname=e;const o=this.htmlMode&&wD.get(e);if(o)for(;this.stack.length>0&&o.has(this.stack[0]);){const c=this.stack.shift();(i=(t=this.cbs).onclosetag)===null||i===void 0||i.call(t,c,!0)}this.isVoidElement(e)||(this.stack.unshift(e),this.htmlMode&&(cT.has(e)?this.foreignContext.unshift(!0):dT.has(e)&&this.foreignContext.unshift(!1))),(a=(n=this.cbs).onopentagname)===null||a===void 0||a.call(n,e),this.cbs.onopentag&&(this.attribs={})}endOpenTag(e){var t,i;this.startIndex=this.openTagStart,this.attribs&&((i=(t=this.cbs).onopentag)===null||i===void 0||i.call(t,this.tagname,this.attribs,e),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(e){this.endIndex=e,this.endOpenTag(!1),this.startIndex=e+1}onclosetag(e,t){var i,n,a,o,c,f,d,m;this.endIndex=t;let g=this.getSlice(e,t);if(this.lowerCaseTagNames&&(g=g.toLowerCase()),this.htmlMode&&(cT.has(g)||dT.has(g))&&this.foreignContext.shift(),this.isVoidElement(g))this.htmlMode&&g==="br"&&((o=(a=this.cbs).onopentagname)===null||o===void 0||o.call(a,"br"),(f=(c=this.cbs).onopentag)===null||f===void 0||f.call(c,"br",{},!0),(m=(d=this.cbs).onclosetag)===null||m===void 0||m.call(d,"br",!1));else{const p=this.stack.indexOf(g);if(p!==-1)for(let T=0;T<=p;T++){const y=this.stack.shift();(n=(i=this.cbs).onclosetag)===null||n===void 0||n.call(i,y,T!==p)}else this.htmlMode&&g==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=t+1}onselfclosingtag(e){this.endIndex=e,this.recognizeSelfClosing||this.foreignContext[0]?(this.closeCurrentTag(!1),this.startIndex=e+1):this.onopentagend(e)}closeCurrentTag(e){var t,i;const n=this.tagname;this.endOpenTag(e),this.stack[0]===n&&((i=(t=this.cbs).onclosetag)===null||i===void 0||i.call(t,n,!e),this.stack.shift())}onattribname(e,t){this.startIndex=e;const i=this.getSlice(e,t);this.attribname=this.lowerCaseAttributeNames?i.toLowerCase():i}onattribdata(e,t){this.attribvalue+=this.getSlice(e,t)}onattribentity(e){this.attribvalue+=aT(e)}onattribend(e,t){var i,n;this.endIndex=t,(n=(i=this.cbs).onattribute)===null||n===void 0||n.call(i,this.attribname,this.attribvalue,e===sn.Double?'"':e===sn.Single?"'":e===sn.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(e){const t=e.search(kD);let i=t<0?e:e.substr(0,t);return this.lowerCaseTagNames&&(i=i.toLowerCase()),i}ondeclaration(e,t){this.endIndex=t;const i=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){const n=this.getInstructionName(i);this.cbs.onprocessinginstruction(`!${n}`,`!${i}`)}this.startIndex=t+1}onprocessinginstruction(e,t){this.endIndex=t;const i=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){const n=this.getInstructionName(i);this.cbs.onprocessinginstruction(`?${n}`,`?${i}`)}this.startIndex=t+1}oncomment(e,t,i){var n,a,o,c;this.endIndex=t,(a=(n=this.cbs).oncomment)===null||a===void 0||a.call(n,this.getSlice(e,t-i)),(c=(o=this.cbs).oncommentend)===null||c===void 0||c.call(o),this.startIndex=t+1}oncdata(e,t,i){var n,a,o,c,f,d,m,g,p,T;this.endIndex=t;const y=this.getSlice(e,t-i);!this.htmlMode||this.options.recognizeCDATA?((a=(n=this.cbs).oncdatastart)===null||a===void 0||a.call(n),(c=(o=this.cbs).ontext)===null||c===void 0||c.call(o,y),(d=(f=this.cbs).oncdataend)===null||d===void 0||d.call(f)):((g=(m=this.cbs).oncomment)===null||g===void 0||g.call(m,`[CDATA[${y}]]`),(T=(p=this.cbs).oncommentend)===null||T===void 0||T.call(p)),this.startIndex=t+1}onend(){var e,t;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let i=0;i<this.stack.length;i++)this.cbs.onclosetag(this.stack[i],!0)}(t=(e=this.cbs).onend)===null||t===void 0||t.call(e)}reset(){var e,t,i,n;(t=(e=this.cbs).onreset)===null||t===void 0||t.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(n=(i=this.cbs).onparserinit)===null||n===void 0||n.call(i,this),this.buffers.length=0,this.foreignContext.length=0,this.foreignContext.unshift(!this.htmlMode),this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(e){this.reset(),this.end(e)}getSlice(e,t){for(;e-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let i=this.buffers[0].slice(e-this.bufferOffset,t-this.bufferOffset);for(;t-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),i+=this.buffers[0].slice(0,t-this.bufferOffset);return i}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(e){var t,i;if(this.ended){(i=(t=this.cbs).onerror)===null||i===void 0||i.call(t,new Error(".write() after done!"));return}this.buffers.push(e),this.tokenizer.running&&(this.tokenizer.write(e),this.writeIndex++)}end(e){var t,i;if(this.ended){(i=(t=this.cbs).onerror)===null||i===void 0||i.call(t,new Error(".end() after done!"));return}e&&this.write(e),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(e){this.write(e)}done(e){this.end(e)}};function PD(s,e){const t=new T4(void 0,e);return new MD(t,e).end(s),t.root}var Cm;const vl=(Cm=Object.hasOwn)!==null&&Cm!==void 0?Cm:((s,e)=>Object.prototype.hasOwnProperty.call(s,e)),Sl=/\s+/,Rg="data-",Cp=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,UD=/^{[^]*}$|^\[[^]*]$/;function ff(s,e,t){var i;if(!(!s||!Oe(s))){if((i=s.attribs)!==null&&i!==void 0||(s.attribs={}),!e)return s.attribs;if(vl(s.attribs,e))return!t&&Cp.test(e)?e:s.attribs[e];if(s.name==="option"&&e==="value")return Tl(s.children);if(s.name==="input"&&(s.attribs.type==="radio"||s.attribs.type==="checkbox")&&e==="value")return"on"}}function Au(s,e,t){t===null?_S(s,e):s.attribs[e]=`${t}`}function BD(s,e){if(typeof s=="object"||e!==void 0){if(typeof e=="function"){if(typeof s!="string")throw new Error("Bad combination of arguments.");return Ct(this,(t,i)=>{Oe(t)&&Au(t,s,e.call(t,i,t.attribs[s]))})}return Ct(this,t=>{if(Oe(t))if(typeof s=="object")for(const i of Object.keys(s)){const n=s[i];Au(t,i,n)}else Au(t,s,e)})}return arguments.length>1?this:ff(this[0],s,this.options.xmlMode)}function fT(s,e,t){return e in s?s[e]:!t&&Cp.test(e)?ff(s,e,!1)!==void 0:ff(s,e,t)}function Nm(s,e,t,i){e in s?s[e]=t:Au(s,e,!i&&Cp.test(e)?t?"":null:`${t}`)}function FD(s,e){var t;if(typeof s=="string"&&e===void 0){const i=this[0];if(!i)return;switch(s){case"style":{const n=this.css(),a=Object.keys(n);for(let o=0;o<a.length;o++)n[o]=a[o];return n.length=a.length,n}case"tagName":case"nodeName":return Oe(i)?i.name.toUpperCase():void 0;case"href":case"src":{if(!Oe(i))return;const n=(t=i.attribs)===null||t===void 0?void 0:t[s];return typeof URL<"u"&&(s==="href"&&(i.tagName==="a"||i.tagName==="link")||s==="src"&&(i.tagName==="img"||i.tagName==="iframe"||i.tagName==="audio"||i.tagName==="video"||i.tagName==="source"))&&n!==void 0&&this.options.baseURI?new URL(n,this.options.baseURI).href:n}case"innerText":return lf(i);case"textContent":return Fu(i);case"outerHTML":return i.type===Ep?this.html():this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return Oe(i)?fT(i,s,this.options.xmlMode):void 0}}if(typeof s=="object"||e!==void 0){if(typeof e=="function"){if(typeof s=="object")throw new TypeError("Bad combination of arguments.");return Ct(this,(i,n)=>{Oe(i)&&Nm(i,s,e.call(i,n,fT(i,s,this.options.xmlMode)),this.options.xmlMode)})}return Ct(this,i=>{if(Oe(i))if(typeof s=="object")for(const n of Object.keys(s)){const a=s[n];Nm(i,n,a,this.options.xmlMode)}else Nm(i,s,e,this.options.xmlMode)})}}function hT(s,e,t){var i;(i=s.data)!==null&&i!==void 0||(s.data={}),typeof e=="object"?Object.assign(s.data,e):typeof e=="string"&&t!==void 0&&(s.data[e]=t)}function HD(s){for(const e of Object.keys(s.attribs)){if(!e.startsWith(Rg))continue;const t=ED(e.slice(Rg.length));vl(s.data,t)||(s.data[t]=AS(s.attribs[e]))}return s.data}function jD(s,e){const t=Rg+yD(e),i=s.data;if(vl(i,e))return i[e];if(vl(s.attribs,t))return i[e]=AS(s.attribs[t])}function AS(s){if(s==="null")return null;if(s==="true")return!0;if(s==="false")return!1;const e=Number(s);if(s===String(e))return e;if(UD.test(s))try{return JSON.parse(s)}catch{}return s}function $D(s,e){var t;const i=this[0];if(!i||!Oe(i))return;const n=i;return(t=n.data)!==null&&t!==void 0||(n.data={}),s==null?HD(n):typeof s=="object"||e!==void 0?(Ct(this,a=>{Oe(a)&&(typeof s=="object"?hT(a,s):hT(a,s,e))}),this):jD(n,s)}function GD(s){const e=arguments.length===0,t=this[0];if(!t||!Oe(t))return e?void 0:this;switch(t.name){case"textarea":return this.text(s);case"select":{const i=this.find("option:selected");if(!e){if(this.attr("multiple")==null&&typeof s=="object")return this;this.find("option").removeAttr("selected");const n=typeof s=="object"?s:[s];for(const a of n)this.find(`option[value="${a}"]`).attr("selected","");return this}return this.attr("multiple")?i.toArray().map(n=>Tl(n.children)):i.attr("value")}case"input":case"option":return e?this.attr("value"):this.attr("value",s)}}function _S(s,e){!s.attribs||!vl(s.attribs,e)||delete s.attribs[e]}function hf(s){return s?s.trim().split(Sl):[]}function qD(s){const e=hf(s);for(const t of e)Ct(this,i=>{Oe(i)&&_S(i,t)});return this}function VD(s){return this.toArray().some(e=>{const t=Oe(e)&&e.attribs.class;let i=-1;if(t&&s.length>0)for(;(i=t.indexOf(s,i+1))>-1;){const n=i+s.length;if((i===0||Sl.test(t[i-1]))&&(n===t.length||Sl.test(t[n])))return!0}return!1})}function LS(s){if(typeof s=="function")return Ct(this,(i,n)=>{if(Oe(i)){const a=i.attribs.class||"";LS.call([i],s.call(i,n,a))}});if(!s||typeof s!="string")return this;const e=s.split(Sl),t=this.length;for(let i=0;i<t;i++){const n=this[i];if(!Oe(n))continue;const a=ff(n,"class",!1);if(a){let o=` ${a} `;for(const c of e){const f=`${c} `;o.includes(` ${f}`)||(o+=f)}Au(n,"class",o.trim())}else Au(n,"class",e.join(" ").trim())}return this}function RS(s){if(typeof s=="function")return Ct(this,(n,a)=>{Oe(n)&&RS.call([n],s.call(n,a,n.attribs.class||""))});const e=hf(s),t=e.length,i=arguments.length===0;return Ct(this,n=>{if(Oe(n))if(i)n.attribs.class="";else{const a=hf(n.attribs.class);let o=!1;for(let c=0;c<t;c++){const f=a.indexOf(e[c]);f!==-1&&(a.splice(f,1),o=!0,c--)}o&&(n.attribs.class=a.join(" "))}})}function IS(s,e){if(typeof s=="function")return Ct(this,(o,c)=>{Oe(o)&&IS.call([o],s.call(o,c,o.attribs.class||"",e),e)});if(!s||typeof s!="string")return this;const t=s.split(Sl),i=t.length,n=typeof e=="boolean"?e?1:-1:0,a=this.length;for(let o=0;o<a;o++){const c=this[o];if(!Oe(c))continue;const f=hf(c.attribs.class);for(let d=0;d<i;d++){const m=f.indexOf(t[d]);n>=0&&m===-1?f.push(t[d]):n<=0&&m!==-1&&f.splice(m,1)}c.attribs.class=f.join(" ")}return this}const zD=Object.freeze(Object.defineProperty({__proto__:null,addClass:LS,attr:BD,data:$D,hasClass:VD,prop:FD,removeAttr:qD,removeClass:RS,toggleClass:IS,val:GD},Symbol.toStringTag,{value:"Module"}));var Ne;(function(s){s.Attribute="attribute",s.Pseudo="pseudo",s.PseudoElement="pseudo-element",s.Tag="tag",s.Universal="universal",s.Adjacent="adjacent",s.Child="child",s.Descendant="descendant",s.Parent="parent",s.Sibling="sibling",s.ColumnCombinator="column-combinator"})(Ne||(Ne={}));var es;(function(s){s.Any="any",s.Element="element",s.End="end",s.Equals="equals",s.Exists="exists",s.Hyphen="hyphen",s.Not="not",s.Start="start"})(es||(es={}));const mT=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,YD=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,KD=new Map([[126,es.Element],[94,es.Start],[36,es.End],[42,es.Any],[33,es.Not],[124,es.Hyphen]]),QD=new Set(["has","not","matches","is","where","host","host-context"]);function rl(s){switch(s.type){case Ne.Adjacent:case Ne.Child:case Ne.Descendant:case Ne.Parent:case Ne.Sibling:case Ne.ColumnCombinator:return!0;default:return!1}}const XD=new Set(["contains","icontains"]);function WD(s,e,t){const i=parseInt(e,16)-65536;return i!==i||t?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,i&1023|56320)}function Wo(s){return s.replace(YD,WD)}function Dm(s){return s===39||s===34}function gT(s){return s===32||s===9||s===10||s===12||s===13}function zf(s){const e=[],t=CS(e,`${s}`,0);if(t<s.length)throw new Error(`Unmatched selector: ${s.slice(t)}`);return e}function CS(s,e,t){let i=[];function n(p){const T=e.slice(t+p).match(mT);if(!T)throw new Error(`Expected name, found ${e.slice(t)}`);const[y]=T;return t+=p+y.length,Wo(y)}function a(p){for(t+=p;t<e.length&&gT(e.charCodeAt(t));)t++}function o(){t+=1;const p=t;let T=1;for(;T>0&&t<e.length;t++)e.charCodeAt(t)===40&&!c(t)?T++:e.charCodeAt(t)===41&&!c(t)&&T--;if(T)throw new Error("Parenthesis not matched");return Wo(e.slice(p,t-1))}function c(p){let T=0;for(;e.charCodeAt(--p)===92;)T++;return(T&1)===1}function f(){if(i.length>0&&rl(i[i.length-1]))throw new Error("Did not expect successive traversals.")}function d(p){if(i.length>0&&i[i.length-1].type===Ne.Descendant){i[i.length-1].type=p;return}f(),i.push({type:p})}function m(p,T){i.push({type:Ne.Attribute,name:p,action:T,value:n(1),namespace:null,ignoreCase:"quirks"})}function g(){if(i.length&&i[i.length-1].type===Ne.Descendant&&i.pop(),i.length===0)throw new Error("Empty sub-selector");s.push(i)}if(a(0),e.length===t)return t;e:for(;t<e.length;){const p=e.charCodeAt(t);switch(p){case 32:case 9:case 10:case 12:case 13:{(i.length===0||i[0].type!==Ne.Descendant)&&(f(),i.push({type:Ne.Descendant})),a(1);break}case 62:{d(Ne.Child),a(1);break}case 60:{d(Ne.Parent),a(1);break}case 126:{d(Ne.Sibling),a(1);break}case 43:{d(Ne.Adjacent),a(1);break}case 46:{m("class",es.Element);break}case 35:{m("id",es.Equals);break}case 91:{a(1);let T,y=null;e.charCodeAt(t)===124?T=n(1):e.startsWith("*|",t)?(y="*",T=n(2)):(T=n(0),e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==61&&(y=T,T=n(1))),a(0);let S=es.Exists;const A=KD.get(e.charCodeAt(t));if(A){if(S=A,e.charCodeAt(t+1)!==61)throw new Error("Expected `=`");a(2)}else e.charCodeAt(t)===61&&(S=es.Equals,a(1));let R="",C=null;if(S!=="exists"){if(Dm(e.charCodeAt(t))){const k=e.charCodeAt(t);let z=t+1;for(;z<e.length&&(e.charCodeAt(z)!==k||c(z));)z+=1;if(e.charCodeAt(z)!==k)throw new Error("Attribute value didn't end");R=Wo(e.slice(t+1,z)),t=z+1}else{const k=t;for(;t<e.length&&(!gT(e.charCodeAt(t))&&e.charCodeAt(t)!==93||c(t));)t+=1;R=Wo(e.slice(k,t))}a(0);const D=e.charCodeAt(t)|32;D===115?(C=!1,a(1)):D===105&&(C=!0,a(1))}if(e.charCodeAt(t)!==93)throw new Error("Attribute selector didn't terminate");t+=1;const I={type:Ne.Attribute,name:T,action:S,value:R,namespace:y,ignoreCase:C};i.push(I);break}case 58:{if(e.charCodeAt(t+1)===58){i.push({type:Ne.PseudoElement,name:n(2).toLowerCase(),data:e.charCodeAt(t)===40?o():null});continue}const T=n(1).toLowerCase();let y=null;if(e.charCodeAt(t)===40)if(QD.has(T)){if(Dm(e.charCodeAt(t+1)))throw new Error(`Pseudo-selector ${T} cannot be quoted`);if(y=[],t=CS(y,e,t+1),e.charCodeAt(t)!==41)throw new Error(`Missing closing parenthesis in :${T} (${e})`);t+=1}else{if(y=o(),XD.has(T)){const S=y.charCodeAt(0);S===y.charCodeAt(y.length-1)&&Dm(S)&&(y=y.slice(1,-1))}y=Wo(y)}i.push({type:Ne.Pseudo,name:T,data:y});break}case 44:{g(),i=[],a(1);break}default:{if(e.startsWith("/*",t)){const S=e.indexOf("*/",t+2);if(S<0)throw new Error("Comment was not terminated");t=S+2,i.length===0&&a(0);break}let T=null,y;if(p===42)t+=1,y="*";else if(p===124){if(y="",e.charCodeAt(t+1)===124){d(Ne.ColumnCombinator),a(2);break}}else if(mT.test(e.slice(t)))y=n(0);else break e;e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==124&&(T=y,e.charCodeAt(t+1)===42?(y="*",t+=2):y=n(1)),i.push(y==="*"?{type:Ne.Universal,namespace:T}:{type:Ne.Tag,name:y,namespace:T})}}}return g(),t}var wm,pT;function ZD(){return pT||(pT=1,wm={trueFunc:function(){return!0},falseFunc:function(){return!1}}),wm}var mf=ZD();const qe=sp(mf),NS=new Map([[Ne.Universal,50],[Ne.Tag,30],[Ne.Attribute,1],[Ne.Pseudo,0]]);function Np(s){return!NS.has(s.type)}const JD=new Map([[es.Exists,10],[es.Equals,8],[es.Not,7],[es.Start,6],[es.End,6],[es.Any,5]]);function e8(s){const e=s.map(DS);for(let t=1;t<s.length;t++){const i=e[t];if(!(i<0))for(let n=t-1;n>=0&&i<e[n];n--){const a=s[n+1];s[n+1]=s[n],s[n]=a,e[n+1]=e[n],e[n]=i}}}function DS(s){var e,t;let i=(e=NS.get(s.type))!==null&&e!==void 0?e:-1;return s.type===Ne.Attribute?(i=(t=JD.get(s.action))!==null&&t!==void 0?t:4,s.action===es.Equals&&s.name==="id"&&(i=9),s.ignoreCase&&(i>>=1)):s.type===Ne.Pseudo&&(s.data?s.name==="has"||s.name==="contains"?i=0:Array.isArray(s.data)?(i=Math.min(...s.data.map(n=>Math.min(...n.map(DS)))),i<0&&(i=0)):i=2:i=3),i}const t8=/[-[\]{}()*+?.,\\^$|#\s]/g;function bT(s){return s.replace(t8,"\\$&")}const s8=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function na(s,e){return typeof s.ignoreCase=="boolean"?s.ignoreCase:s.ignoreCase==="quirks"?!!e.quirksMode:!e.xmlMode&&s8.has(s.name)}const i8={equals(s,e,t){const{adapter:i}=t,{name:n}=e;let{value:a}=e;return na(e,t)?(a=a.toLowerCase(),o=>{const c=i.getAttributeValue(o,n);return c!=null&&c.length===a.length&&c.toLowerCase()===a&&s(o)}):o=>i.getAttributeValue(o,n)===a&&s(o)},hyphen(s,e,t){const{adapter:i}=t,{name:n}=e;let{value:a}=e;const o=a.length;return na(e,t)?(a=a.toLowerCase(),function(f){const d=i.getAttributeValue(f,n);return d!=null&&(d.length===o||d.charAt(o)==="-")&&d.substr(0,o).toLowerCase()===a&&s(f)}):function(f){const d=i.getAttributeValue(f,n);return d!=null&&(d.length===o||d.charAt(o)==="-")&&d.substr(0,o)===a&&s(f)}},element(s,e,t){const{adapter:i}=t,{name:n,value:a}=e;if(/\s/.test(a))return qe.falseFunc;const o=new RegExp(`(?:^|\\s)${bT(a)}(?:$|\\s)`,na(e,t)?"i":"");return function(f){const d=i.getAttributeValue(f,n);return d!=null&&d.length>=a.length&&o.test(d)&&s(f)}},exists(s,{name:e},{adapter:t}){return i=>t.hasAttrib(i,e)&&s(i)},start(s,e,t){const{adapter:i}=t,{name:n}=e;let{value:a}=e;const o=a.length;return o===0?qe.falseFunc:na(e,t)?(a=a.toLowerCase(),c=>{const f=i.getAttributeValue(c,n);return f!=null&&f.length>=o&&f.substr(0,o).toLowerCase()===a&&s(c)}):c=>{var f;return!!(!((f=i.getAttributeValue(c,n))===null||f===void 0)&&f.startsWith(a))&&s(c)}},end(s,e,t){const{adapter:i}=t,{name:n}=e;let{value:a}=e;const o=-a.length;return o===0?qe.falseFunc:na(e,t)?(a=a.toLowerCase(),c=>{var f;return((f=i.getAttributeValue(c,n))===null||f===void 0?void 0:f.substr(o).toLowerCase())===a&&s(c)}):c=>{var f;return!!(!((f=i.getAttributeValue(c,n))===null||f===void 0)&&f.endsWith(a))&&s(c)}},any(s,e,t){const{adapter:i}=t,{name:n,value:a}=e;if(a==="")return qe.falseFunc;if(na(e,t)){const o=new RegExp(bT(a),"i");return function(f){const d=i.getAttributeValue(f,n);return d!=null&&d.length>=a.length&&o.test(d)&&s(f)}}return o=>{var c;return!!(!((c=i.getAttributeValue(o,n))===null||c===void 0)&&c.includes(a))&&s(o)}},not(s,e,t){const{adapter:i}=t,{name:n}=e;let{value:a}=e;return a===""?o=>!!i.getAttributeValue(o,n)&&s(o):na(e,t)?(a=a.toLowerCase(),o=>{const c=i.getAttributeValue(o,n);return(c==null||c.length!==a.length||c.toLowerCase()!==a)&&s(o)}):o=>i.getAttributeValue(o,n)!==a&&s(o)}},n8=new Set([9,10,12,13,32]),ET=48,r8=57;function a8(s){if(s=s.trim().toLowerCase(),s==="even")return[2,0];if(s==="odd")return[2,1];let e=0,t=0,i=a(),n=o();if(e<s.length&&s.charAt(e)==="n"&&(e++,t=i*(n??1),c(),e<s.length?(i=a(),c(),n=o()):i=n=0),n===null||e<s.length)throw new Error(`n-th rule couldn't be parsed ('${s}')`);return[t,i*n];function a(){return s.charAt(e)==="-"?(e++,-1):(s.charAt(e)==="+"&&e++,1)}function o(){const f=e;let d=0;for(;e<s.length&&s.charCodeAt(e)>=ET&&s.charCodeAt(e)<=r8;)d=d*10+(s.charCodeAt(e)-ET),e++;return e===f?null:d}function c(){for(;e<s.length&&n8.has(s.charCodeAt(e));)e++}}function u8(s){const e=s[0],t=s[1]-1;if(t<0&&e<=0)return qe.falseFunc;if(e===-1)return a=>a<=t;if(e===0)return a=>a===t;if(e===1)return t<0?qe.trueFunc:a=>a>=t;const i=Math.abs(e),n=(t%i+i)%i;return e>1?a=>a>=t&&a%i===n:a=>a<=t&&a%i===n}function yd(s){return u8(a8(s))}function xd(s,e){return t=>{const i=e.getParent(t);return i!=null&&e.isTag(i)&&s(t)}}const Ig={contains(s,e,{adapter:t}){return function(n){return s(n)&&t.getText(n).includes(e)}},icontains(s,e,{adapter:t}){const i=e.toLowerCase();return function(a){return s(a)&&t.getText(a).toLowerCase().includes(i)}},"nth-child"(s,e,{adapter:t,equals:i}){const n=yd(e);return n===qe.falseFunc?qe.falseFunc:n===qe.trueFunc?xd(s,t):function(o){const c=t.getSiblings(o);let f=0;for(let d=0;d<c.length&&!i(o,c[d]);d++)t.isTag(c[d])&&f++;return n(f)&&s(o)}},"nth-last-child"(s,e,{adapter:t,equals:i}){const n=yd(e);return n===qe.falseFunc?qe.falseFunc:n===qe.trueFunc?xd(s,t):function(o){const c=t.getSiblings(o);let f=0;for(let d=c.length-1;d>=0&&!i(o,c[d]);d--)t.isTag(c[d])&&f++;return n(f)&&s(o)}},"nth-of-type"(s,e,{adapter:t,equals:i}){const n=yd(e);return n===qe.falseFunc?qe.falseFunc:n===qe.trueFunc?xd(s,t):function(o){const c=t.getSiblings(o);let f=0;for(let d=0;d<c.length;d++){const m=c[d];if(i(o,m))break;t.isTag(m)&&t.getName(m)===t.getName(o)&&f++}return n(f)&&s(o)}},"nth-last-of-type"(s,e,{adapter:t,equals:i}){const n=yd(e);return n===qe.falseFunc?qe.falseFunc:n===qe.trueFunc?xd(s,t):function(o){const c=t.getSiblings(o);let f=0;for(let d=c.length-1;d>=0;d--){const m=c[d];if(i(o,m))break;t.isTag(m)&&t.getName(m)===t.getName(o)&&f++}return n(f)&&s(o)}},root(s,e,{adapter:t}){return i=>{const n=t.getParent(i);return(n==null||!t.isTag(n))&&s(i)}},scope(s,e,t,i){const{equals:n}=t;return!i||i.length===0?Ig.root(s,e,t):i.length===1?a=>n(i[0],a)&&s(a):a=>i.includes(a)&&s(a)},hover:Om("isHovered"),visited:Om("isVisited"),active:Om("isActive")};function Om(s){return function(t,i,{adapter:n}){const a=n[s];return typeof a!="function"?qe.falseFunc:function(c){return a(c)&&t(c)}}}const yT={empty(s,{adapter:e}){return!e.getChildren(s).some(t=>e.isTag(t)||e.getText(t)!=="")},"first-child"(s,{adapter:e,equals:t}){if(e.prevElementSibling)return e.prevElementSibling(s)==null;const i=e.getSiblings(s).find(n=>e.isTag(n));return i!=null&&t(s,i)},"last-child"(s,{adapter:e,equals:t}){const i=e.getSiblings(s);for(let n=i.length-1;n>=0;n--){if(t(s,i[n]))return!0;if(e.isTag(i[n]))break}return!1},"first-of-type"(s,{adapter:e,equals:t}){const i=e.getSiblings(s),n=e.getName(s);for(let a=0;a<i.length;a++){const o=i[a];if(t(s,o))return!0;if(e.isTag(o)&&e.getName(o)===n)break}return!1},"last-of-type"(s,{adapter:e,equals:t}){const i=e.getSiblings(s),n=e.getName(s);for(let a=i.length-1;a>=0;a--){const o=i[a];if(t(s,o))return!0;if(e.isTag(o)&&e.getName(o)===n)break}return!1},"only-of-type"(s,{adapter:e,equals:t}){const i=e.getName(s);return e.getSiblings(s).every(n=>t(s,n)||!e.isTag(n)||e.getName(n)!==i)},"only-child"(s,{adapter:e,equals:t}){return e.getSiblings(s).every(i=>t(s,i)||!e.isTag(i))}};function xT(s,e,t,i){if(t===null){if(s.length>i)throw new Error(`Pseudo-class :${e} requires an argument`)}else if(s.length===i)throw new Error(`Pseudo-class :${e} doesn't have any arguments`)}const o8={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:`:is(
        :is(button, input, select, textarea, optgroup, option)[disabled],
        optgroup[disabled] > option,
        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)
    )`,enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"},wS={};function l8(s,e){return s===qe.falseFunc?qe.falseFunc:t=>e.isTag(t)&&s(t)}function OS(s,e){const t=e.getSiblings(s);if(t.length<=1)return[];const i=t.indexOf(s);return i<0||i===t.length-1?[]:t.slice(i+1).filter(e.isTag)}function Cg(s){return{xmlMode:!!s.xmlMode,lowerCaseAttributeNames:!!s.lowerCaseAttributeNames,lowerCaseTags:!!s.lowerCaseTags,quirksMode:!!s.quirksMode,cacheResults:!!s.cacheResults,pseudos:s.pseudos,adapter:s.adapter,equals:s.equals}}const km=(s,e,t,i,n)=>{const a=n(e,Cg(t),i);return a===qe.trueFunc?s:a===qe.falseFunc?qe.falseFunc:o=>a(o)&&s(o)},Mm={is:km,matches:km,where:km,not(s,e,t,i,n){const a=n(e,Cg(t),i);return a===qe.falseFunc?s:a===qe.trueFunc?qe.falseFunc:o=>!a(o)&&s(o)},has(s,e,t,i,n){const{adapter:a}=t,o=Cg(t);o.relativeSelector=!0;const c=e.some(m=>m.some(Np))?[wS]:void 0,f=n(e,o,c);if(f===qe.falseFunc)return qe.falseFunc;const d=l8(f,a);if(c&&f!==qe.trueFunc){const{shouldTestNextSiblings:m=!1}=f;return g=>{if(!s(g))return!1;c[0]=g;const p=a.getChildren(g),T=m?[...p,...OS(g,a)]:p;return a.existsOne(d,T)}}return m=>s(m)&&a.existsOne(d,a.getChildren(m))}};function c8(s,e,t,i,n){var a;const{name:o,data:c}=e;if(Array.isArray(c)){if(!(o in Mm))throw new Error(`Unknown pseudo-class :${o}(${c})`);return Mm[o](s,c,t,i,n)}const f=(a=t.pseudos)===null||a===void 0?void 0:a[o],d=typeof f=="string"?f:o8[o];if(typeof d=="string"){if(c!=null)throw new Error(`Pseudo ${o} doesn't have any arguments`);const m=zf(d);return Mm.is(s,m,t,i,n)}if(typeof f=="function")return xT(f,o,c,1),m=>f(m,c)&&s(m);if(o in Ig)return Ig[o](s,c,t,i);if(o in yT){const m=yT[o];return xT(m,o,c,2),g=>m(g,t,c)&&s(g)}throw new Error(`Unknown pseudo-class :${o}`)}function Pm(s,e){const t=e.getParent(s);return t&&e.isTag(t)?t:null}function d8(s,e,t,i,n){const{adapter:a,equals:o}=t;switch(e.type){case Ne.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case Ne.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case Ne.Attribute:{if(e.namespace!=null)throw new Error("Namespaced attributes are not yet supported by css-select");return(!t.xmlMode||t.lowerCaseAttributeNames)&&(e.name=e.name.toLowerCase()),i8[e.action](s,e,t)}case Ne.Pseudo:return c8(s,e,t,i,n);case Ne.Tag:{if(e.namespace!=null)throw new Error("Namespaced tag names are not yet supported by css-select");let{name:c}=e;return(!t.xmlMode||t.lowerCaseTags)&&(c=c.toLowerCase()),function(d){return a.getName(d)===c&&s(d)}}case Ne.Descendant:{if(t.cacheResults===!1||typeof WeakSet>"u")return function(d){let m=d;for(;m=Pm(m,a);)if(s(m))return!0;return!1};const c=new WeakSet;return function(d){let m=d;for(;m=Pm(m,a);)if(!c.has(m)){if(a.isTag(m)&&s(m))return!0;c.add(m)}return!1}}case"_flexibleDescendant":return function(f){let d=f;do if(s(d))return!0;while(d=Pm(d,a));return!1};case Ne.Parent:return function(f){return a.getChildren(f).some(d=>a.isTag(d)&&s(d))};case Ne.Child:return function(f){const d=a.getParent(f);return d!=null&&a.isTag(d)&&s(d)};case Ne.Sibling:return function(f){const d=a.getSiblings(f);for(let m=0;m<d.length;m++){const g=d[m];if(o(f,g))break;if(a.isTag(g)&&s(g))return!0}return!1};case Ne.Adjacent:return a.prevElementSibling?function(f){const d=a.prevElementSibling(f);return d!=null&&s(d)}:function(f){const d=a.getSiblings(f);let m;for(let g=0;g<d.length;g++){const p=d[g];if(o(f,p))break;a.isTag(p)&&(m=p)}return!!m&&s(m)};case Ne.Universal:{if(e.namespace!=null&&e.namespace!=="*")throw new Error("Namespaced universal selectors are not yet supported by css-select");return s}}}function kS(s){return s.type===Ne.Pseudo&&(s.name==="scope"||Array.isArray(s.data)&&s.data.some(e=>e.some(kS)))}const f8={type:Ne.Descendant},h8={type:"_flexibleDescendant"},m8={type:Ne.Pseudo,name:"scope",data:null};function g8(s,{adapter:e},t){const i=!!(t!=null&&t.every(n=>{const a=e.isTag(n)&&e.getParent(n);return n===wS||a&&e.isTag(a)}));for(const n of s){if(!(n.length>0&&Np(n[0])&&n[0].type!==Ne.Descendant))if(i&&!n.some(kS))n.unshift(f8);else continue;n.unshift(m8)}}function MS(s,e,t){var i;s.forEach(e8),t=(i=e.context)!==null&&i!==void 0?i:t;const n=Array.isArray(t),a=t&&(Array.isArray(t)?t:[t]);if(e.relativeSelector!==!1)g8(s,e,a);else if(s.some(f=>f.length>0&&Np(f[0])))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");let o=!1;const c=s.map(f=>{if(f.length>=2){const[d,m]=f;d.type!==Ne.Pseudo||d.name!=="scope"||(n&&m.type===Ne.Descendant?f[1]=h8:(m.type===Ne.Adjacent||m.type===Ne.Sibling)&&(o=!0))}return p8(f,e,a)}).reduce(b8,qe.falseFunc);return c.shouldTestNextSiblings=o,c}function p8(s,e,t){var i;return s.reduce((n,a)=>n===qe.falseFunc?qe.falseFunc:d8(n,a,e,t,MS),(i=e.rootFunc)!==null&&i!==void 0?i:qe.trueFunc)}function b8(s,e){return e===qe.falseFunc||s===qe.trueFunc?s:s===qe.falseFunc||e===qe.trueFunc?e:function(i){return s(i)||e(i)}}const PS=(s,e)=>s===e,E8={adapter:Vf,equals:PS};function y8(s){var e,t,i,n;const a=s??E8;return(e=a.adapter)!==null&&e!==void 0||(a.adapter=Vf),(t=a.equals)!==null&&t!==void 0||(a.equals=(n=(i=a.adapter)===null||i===void 0?void 0:i.equals)!==null&&n!==void 0?n:PS),a}function x8(s){return function(t,i,n){const a=y8(i);return s(t,a,n)}}const Dp=x8(MS);function US(s,e,t=!1){return t&&(s=T8(s,e)),Array.isArray(s)?e.removeSubsets(s):e.getChildren(s)}function T8(s,e){const t=Array.isArray(s)?s.slice(0):[s],i=t.length;for(let n=0;n<i;n++){const a=OS(t[n],e);t.push(...a)}return t}const v8=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function gf(s){return s.type!=="pseudo"?!1:v8.has(s.name)?!0:s.name==="not"&&Array.isArray(s.data)?s.data.some(e=>e.some(gf)):!1}function S8(s,e,t){const i=e!=null?parseInt(e,10):NaN;switch(s){case"first":return 1;case"nth":case"eq":return isFinite(i)?i>=0?i+1:1/0:0;case"lt":return isFinite(i)?i>=0?Math.min(i,t):1/0:0;case"gt":return isFinite(i)?1/0:0;case"odd":return 2*t;case"even":return 2*t-1;case"last":case"not":return 1/0}}function A8(s){for(;s.parent;)s=s.parent;return s}function wp(s){const e=[],t=[];for(const i of s)i.some(gf)?e.push(i):t.push(i);return[t,e]}const _8={type:Ne.Universal,namespace:null},L8={type:Ne.Pseudo,name:"scope",data:null};function BS(s,e,t={}){return FS([s],e,t)}function FS(s,e,t={}){if(typeof e=="function")return s.some(e);const[i,n]=wp(zf(e));return i.length>0&&s.some(Dp(i,t))||n.some(a=>$S(a,s,t).length>0)}function R8(s,e,t,i){const n=typeof t=="string"?parseInt(t,10):NaN;switch(s){case"first":case"lt":return e;case"last":return e.length>0?[e[e.length-1]]:e;case"nth":case"eq":return isFinite(n)&&Math.abs(n)<e.length?[n<0?e[e.length+n]:e[n]]:[];case"gt":return isFinite(n)?e.slice(n+1):[];case"even":return e.filter((a,o)=>o%2===0);case"odd":return e.filter((a,o)=>o%2===1);case"not":{const a=new Set(jS(t,e,i));return e.filter(o=>!a.has(o))}}}function HS(s,e,t={}){return jS(zf(s),e,t)}function jS(s,e,t){if(e.length===0)return[];const[i,n]=wp(s);let a;if(i.length){const o=Dg(e,i,t);if(n.length===0)return o;o.length&&(a=new Set(o))}for(let o=0;o<n.length&&(a==null?void 0:a.size)!==e.length;o++){const c=n[o];if((a?e.filter(m=>Oe(m)&&!a.has(m)):e).length===0)break;const d=$S(c,e,t);if(d.length)if(a)d.forEach(m=>a.add(m));else{if(o===n.length-1)return d;a=new Set(d)}}return typeof a<"u"?a.size===e.length?e:e.filter(o=>a.has(o)):[]}function $S(s,e,t){var i;if(s.some(rl)){const n=(i=t.root)!==null&&i!==void 0?i:A8(e[0]),a={...t,context:e,relativeSelector:!1};return s.push(L8),pf(n,s,a,!0,e.length)}return pf(e,s,t,!1,e.length)}function I8(s,e,t={},i=1/0){if(typeof s=="function")return GS(e,s);const[n,a]=wp(zf(s)),o=a.map(c=>pf(e,c,t,!0,i));return n.length&&o.push(Ng(e,n,t,i)),o.length===0?[]:o.length===1?o[0]:Ku(o.reduce((c,f)=>[...c,...f]))}function pf(s,e,t,i,n){const a=e.findIndex(gf),o=e.slice(0,a),c=e[a],f=e.length-1===a?n:1/0,d=S8(c.name,c.data,f);if(d===0)return[];const g=(o.length===0&&!Array.isArray(s)?qf(s).filter(Oe):o.length===0?(Array.isArray(s)?s:[s]).filter(Oe):i||o.some(rl)?Ng(s,[o],t,d):Dg(s,[o],t)).slice(0,d);let p=R8(c.name,g,c.data,t);if(p.length===0||e.length===a+1)return p;const T=e.slice(a+1),y=T.some(rl);if(y){if(rl(T[0])){const{type:S}=T[0];(S===Ne.Sibling||S===Ne.Adjacent)&&(p=US(p,Vf,!0)),T.unshift(_8)}t={...t,relativeSelector:!1,rootFunc:S=>p.includes(S)}}else t.rootFunc&&t.rootFunc!==mf.trueFunc&&(t={...t,rootFunc:mf.trueFunc});return T.some(gf)?pf(p,T,t,!1,n):y?Ng(p,[T],t,n):Dg(p,[T],t)}function Ng(s,e,t,i){const n=Dp(e,t,s);return GS(s,n,i)}function GS(s,e,t=1/0){const i=US(s,Vf,e.shouldTestNextSiblings);return Lp(n=>Oe(n)&&e(n),i,!0,t)}function Dg(s,e,t){const i=(Array.isArray(s)?s:[s]).filter(Oe);if(i.length===0)return i;const n=Dp(e,t);return n===mf.trueFunc?i:i.filter(n)}const C8=/^\s*[+~]/;function N8(s){if(!s)return this._make([]);if(typeof s!="string"){const e=jn(s)?s.toArray():[s],t=this.toArray();return this._make(e.filter(i=>t.some(n=>SS(n,i))))}return this._findBySelector(s,Number.POSITIVE_INFINITY)}function D8(s,e){var t;const i=this.toArray(),n=C8.test(s)?i:this.children().toArray(),a={context:i,root:(t=this._root)===null||t===void 0?void 0:t[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(I8(s,n,a,e))}function Op(s){return function(e,...t){return function(i){var n;let a=s(e,this);return i&&(a=Pp(a,i,this.options.xmlMode,(n=this._root)===null||n===void 0?void 0:n[0])),this._make(this.length>1&&a.length>1?t.reduce((o,c)=>c(o),a):a)}}}const Gl=Op((s,e)=>{let t=[];for(let i=0;i<e.length;i++){const n=s(e[i]);n.length>0&&(t=t.concat(n))}return t}),kp=Op((s,e)=>{const t=[];for(let i=0;i<e.length;i++){const n=s(e[i]);n!==null&&t.push(n)}return t});function Mp(s,...e){let t=null;const i=Op((n,a)=>{const o=[];return Ct(a,c=>{for(let f;(f=n(c))&&!(t!=null&&t(f,o.length));c=f)o.push(f)}),o})(s,...e);return function(n,a){t=typeof n=="string"?c=>BS(c,n,this.options):n?ql(n):null;const o=i.call(this,a);return t=null,o}}function Qu(s){return s.length>1?Array.from(new Set(s)):s}const w8=kp(({parent:s})=>s&&!Ur(s)?s:null,Qu),O8=Gl(s=>{const e=[];for(;s.parent&&!Ur(s.parent);)e.push(s.parent),s=s.parent;return e},Ku,s=>s.reverse()),k8=Mp(({parent:s})=>s&&!Ur(s)?s:null,Ku,s=>s.reverse());function M8(s){var e;const t=[];if(!s)return this._make(t);const i={xmlMode:this.options.xmlMode,root:(e=this._root)===null||e===void 0?void 0:e[0]},n=typeof s=="string"?a=>BS(a,s,i):ql(s);return Ct(this,a=>{for(a&&!Ur(a)&&!Oe(a)&&(a=a.parent);a&&Oe(a);){if(n(a,0)){t.includes(a)||t.push(a);break}a=a.parent}}),this._make(t)}const P8=kp(s=>Ap(s)),U8=Gl(s=>{const e=[];for(;s.next;)s=s.next,Oe(s)&&e.push(s);return e},Qu),B8=Mp(s=>Ap(s),Qu),F8=kp(s=>_p(s)),H8=Gl(s=>{const e=[];for(;s.prev;)s=s.prev,Oe(s)&&e.push(s);return e},Qu),j8=Mp(s=>_p(s),Qu),$8=Gl(s=>bS(s).filter(e=>Oe(e)&&e!==s),Ku),G8=Gl(s=>qf(s).filter(Oe),Qu);function q8(){const s=this.toArray().reduce((e,t)=>Bt(t)?e.concat(t.children):e,[]);return this._make(s)}function V8(s){let e=0;const t=this.length;for(;e<t&&s.call(this[e],e,this[e])!==!1;)++e;return this}function z8(s){let e=[];for(let t=0;t<this.length;t++){const i=this[t],n=s.call(i,t,i);n!=null&&(e=e.concat(n))}return this._make(e)}function ql(s){return typeof s=="function"?(e,t)=>s.call(e,t,e):jn(s)?e=>Array.prototype.includes.call(s,e):function(e){return s===e}}function Y8(s){var e;return this._make(Pp(this.toArray(),s,this.options.xmlMode,(e=this._root)===null||e===void 0?void 0:e[0]))}function Pp(s,e,t,i){return typeof e=="string"?HS(e,s,{xmlMode:t,root:i}):s.filter(ql(e))}function K8(s){const e=this.toArray();return typeof s=="string"?FS(e.filter(Oe),s,this.options):s?e.some(ql(s)):!1}function Q8(s){let e=this.toArray();if(typeof s=="string"){const t=new Set(HS(s,e,this.options));e=e.filter(i=>!t.has(i))}else{const t=ql(s);e=e.filter((i,n)=>!t(i,n))}return this._make(e)}function X8(s){return this.filter(typeof s=="string"?`:has(${s})`:(e,t)=>this._make(t).find(s).length>0)}function W8(){return this.length>1?this._make(this[0]):this}function Z8(){return this.length>0?this._make(this[this.length-1]):this}function J8(s){var e;return s=+s,s===0&&this.length<=1?this:(s<0&&(s=this.length+s),this._make((e=this[s])!==null&&e!==void 0?e:[]))}function ew(s){return s==null?this.toArray():this[s<0?this.length+s:s]}function tw(){return Array.prototype.slice.call(this)}function sw(s){let e,t;return s==null?(e=this.parent().children(),t=this[0]):typeof s=="string"?(e=this._make(s),t=this[0]):(e=this,t=jn(s)?s[0]:s),Array.prototype.indexOf.call(e,t)}function iw(s,e){return this._make(Array.prototype.slice.call(this,s,e))}function nw(){var s;return(s=this.prevObject)!==null&&s!==void 0?s:this._make([])}function rw(s,e){const t=this._make(s,e),i=Ku([...this.get(),...t.get()]);return this._make(i)}function aw(s){return this.prevObject?this.add(s?this.prevObject.filter(s):this.prevObject):this}const uw=Object.freeze(Object.defineProperty({__proto__:null,_findBySelector:D8,add:rw,addBack:aw,children:G8,closest:M8,contents:q8,each:V8,end:nw,eq:J8,filter:Y8,filterArray:Pp,find:N8,first:W8,get:ew,has:X8,index:sw,is:K8,last:Z8,map:z8,next:P8,nextAll:U8,nextUntil:B8,not:Q8,parent:w8,parents:O8,parentsUntil:k8,prev:F8,prevAll:H8,prevUntil:j8,siblings:$8,slice:iw,toArray:tw},Symbol.toStringTag,{value:"Module"}));function ow(s){return function(t,i,n,a){if(typeof Buffer<"u"&&Buffer.isBuffer(t)&&(t=t.toString()),typeof t=="string")return s(t,i,n,a);const o=t;if(!Array.isArray(o)&&Ur(o))return o;const c=new Ta([]);return va(o,c),c}}function va(s,e){const t=Array.isArray(s)?s:[s];e?e.children=t:e=null;for(let i=0;i<t.length;i++){const n=t[i];n.parent&&n.parent.children!==t&&La(n),e?(n.prev=t[i-1]||null,n.next=t[i+1]||null):n.prev=n.next=null,n.parent=e}return e}function lw(s,e){if(s==null)return[];if(typeof s=="string")return this._parse(s,this.options,!1,null).children.slice(0);if("length"in s){if(s.length===1)return this._makeDomArray(s[0],e);const t=[];for(let i=0;i<s.length;i++){const n=s[i];if(typeof n=="object"){if(n==null)continue;if(!("length"in n)){t.push(e?xl(n,!0):n);continue}}t.push(...this._makeDomArray(n,e))}return t}return[e?xl(s,!0):s]}function qS(s){return function(...e){const t=this.length-1;return Ct(this,(i,n)=>{if(!Bt(i))return;const a=typeof e[0]=="function"?e[0].call(i,n,this._render(i.children)):e,o=this._makeDomArray(a,n<t);s(o,i.children,i)})}}function Br(s,e,t,i,n){var a,o;const c=[e,t,...i],f=e===0?null:s[e-1],d=e+t>=s.length?null:s[e+t];for(let m=0;m<i.length;++m){const g=i[m],p=g.parent;if(p){const y=p.children.indexOf(g);y!==-1&&(p.children.splice(y,1),n===p&&e>y&&c[0]--)}g.parent=n,g.prev&&(g.prev.next=(a=g.next)!==null&&a!==void 0?a:null),g.next&&(g.next.prev=(o=g.prev)!==null&&o!==void 0?o:null),g.prev=m===0?f:i[m-1],g.next=m===i.length-1?d:i[m+1]}return f&&(f.next=i[0]),d&&(d.prev=i[i.length-1]),s.splice(...c)}function cw(s){return(jn(s)?s:this._make(s)).append(this),this}function dw(s){return(jn(s)?s:this._make(s)).prepend(this),this}const fw=qS((s,e,t)=>{Br(e,e.length,0,s,t)}),hw=qS((s,e,t)=>{Br(e,0,0,s,t)});function VS(s){return function(e){const t=this.length-1,i=this.parents().last();for(let n=0;n<this.length;n++){const a=this[n],o=typeof e=="function"?e.call(a,n,a):typeof e=="string"&&!_g(e)?i.find(e).clone():e,[c]=this._makeDomArray(o,n<t);if(!c||!Bt(c))continue;let f=c,d=0;for(;d<f.children.length;){const m=f.children[d];Oe(m)?(f=m,d=0):d++}s(a,f,[c])}return this}}const mw=VS((s,e,t)=>{const{parent:i}=s;if(!i)return;const n=i.children,a=n.indexOf(s);va([s],e),Br(n,a,0,t,i)}),gw=VS((s,e,t)=>{Bt(s)&&(va(s.children,e),va(t,s))});function pw(s){return this.parent(s).not("body").each((e,t)=>{this._make(t).replaceWith(t.children)}),this}function bw(s){const e=this[0];if(e){const t=this._make(typeof s=="function"?s.call(e,0,e):s).insertBefore(e);let i;for(let a=0;a<t.length;a++)t[a].type===vg&&(i=t[a]);let n=0;for(;i&&n<i.children.length;){const a=i.children[n];a.type===vg?(i=a,n=0):n++}i&&this._make(i).append(this)}return this}function Ew(...s){const e=this.length-1;return Ct(this,(t,i)=>{if(!Bt(t)||!t.parent)return;const n=t.parent.children,a=n.indexOf(t);if(a===-1)return;const o=typeof s[0]=="function"?s[0].call(t,i,this._render(t.children)):s,c=this._makeDomArray(o,i<e);Br(n,a+1,0,c,t.parent)})}function yw(s){typeof s=="string"&&(s=this._make(s)),this.remove();const e=[];for(const t of this._makeDomArray(s)){const i=this.clone().toArray(),{parent:n}=t;if(!n)continue;const a=n.children,o=a.indexOf(t);o!==-1&&(Br(a,o+1,0,i,n),e.push(...i))}return this._make(e)}function xw(...s){const e=this.length-1;return Ct(this,(t,i)=>{if(!Bt(t)||!t.parent)return;const n=t.parent.children,a=n.indexOf(t);if(a===-1)return;const o=typeof s[0]=="function"?s[0].call(t,i,this._render(t.children)):s,c=this._makeDomArray(o,i<e);Br(n,a,0,c,t.parent)})}function Tw(s){const e=this._make(s);this.remove();const t=[];return Ct(e,i=>{const n=this.clone().toArray(),{parent:a}=i;if(!a)return;const o=a.children,c=o.indexOf(i);c!==-1&&(Br(o,c,0,n,a),t.push(...n))}),this._make(t)}function vw(s){const e=s?this.filter(s):this;return Ct(e,t=>{La(t),t.prev=t.next=t.parent=null}),this}function Sw(s){return Ct(this,(e,t)=>{const{parent:i}=e;if(!i)return;const n=i.children,a=typeof s=="function"?s.call(e,t,e):s,o=this._makeDomArray(a);va(o,null);const c=n.indexOf(e);Br(n,c,1,o,i),o.includes(e)||(e.parent=e.prev=e.next=null)})}function Aw(){return Ct(this,s=>{if(Bt(s)){for(const e of s.children)e.next=e.prev=e.parent=null;s.children.length=0}})}function _w(s){if(s===void 0){const e=this[0];return!e||!Bt(e)?null:this._render(e.children)}return Ct(this,e=>{if(!Bt(e))return;for(const i of e.children)i.next=i.prev=i.parent=null;const t=jn(s)?s.toArray():this._parse(`${s}`,this.options,!1,e).children;va(t,e)})}function Lw(){return this._render(this)}function Rw(s){return s===void 0?Tl(this):typeof s=="function"?Ct(this,(e,t)=>this._make(e).text(s.call(e,t,Tl([e])))):Ct(this,e=>{if(!Bt(e))return;for(const i of e.children)i.next=i.prev=i.parent=null;const t=new yl(`${s}`);va(t,e)})}function Iw(){const s=Array.prototype.map.call(this.get(),t=>xl(t,!0)),e=new Ta(s);for(const t of s)t.parent=e;return this._make(s)}const Cw=Object.freeze(Object.defineProperty({__proto__:null,_makeDomArray:lw,after:Ew,append:fw,appendTo:cw,before:xw,clone:Iw,empty:Aw,html:_w,insertAfter:yw,insertBefore:Tw,prepend:hw,prependTo:dw,remove:vw,replaceWith:Sw,text:Rw,toString:Lw,unwrap:pw,wrap:mw,wrapAll:bw,wrapInner:gw},Symbol.toStringTag,{value:"Module"}));function Nw(s,e){if(s!=null&&e!=null||typeof s=="object"&&!Array.isArray(s))return Ct(this,(t,i)=>{Oe(t)&&zS(t,s,e,i)});if(this.length!==0)return YS(this[0],s)}function zS(s,e,t,i){if(typeof e=="string"){const n=YS(s),a=typeof t=="function"?t.call(s,i,n[e]):t;a===""?delete n[e]:a!=null&&(n[e]=a),s.attribs.style=Dw(n)}else if(typeof e=="object"){const n=Object.keys(e);for(let a=0;a<n.length;a++){const o=n[a];zS(s,o,e[o],a)}}}function YS(s,e){if(!s||!Oe(s))return;const t=ww(s.attribs.style);if(typeof e=="string")return t[e];if(Array.isArray(e)){const i={};for(const n of e)t[n]!=null&&(i[n]=t[n]);return i}return t}function Dw(s){return Object.keys(s).reduce((e,t)=>`${e}${e?" ":""}${t}: ${s[t]};`,"")}function ww(s){if(s=(s||"").trim(),!s)return{};const e={};let t;for(const i of s.split(";")){const n=i.indexOf(":");if(n<1||n===i.length-1){const a=i.trimEnd();a.length>0&&t!==void 0&&(e[t]+=`;${a}`)}else t=i.slice(0,n).trim(),e[t]=i.slice(n+1).trim()}return e}const Ow=Object.freeze(Object.defineProperty({__proto__:null,css:Nw},Symbol.toStringTag,{value:"Module"})),TT="input,select,textarea,keygen",kw=/%20/g,vT=/\r?\n/g;function Mw(){return this.serializeArray().map(t=>`${encodeURIComponent(t.name)}=${encodeURIComponent(t.value)}`).join("&").replace(kw,"+")}function Pw(){return this.map((s,e)=>{const t=this._make(e);return Oe(e)&&e.name==="form"?t.find(TT).toArray():t.filter(TT).toArray()}).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((s,e)=>{var t;const i=this._make(e),n=i.attr("name"),a=(t=i.val())!==null&&t!==void 0?t:"";return Array.isArray(a)?a.map(o=>({name:n,value:o.replace(vT,`\r
`)})):{name:n,value:a.replace(vT,`\r
`)}}).toArray()}const Uw=Object.freeze(Object.defineProperty({__proto__:null,serialize:Mw,serializeArray:Pw},Symbol.toStringTag,{value:"Module"}));function Bw(s){var e;return typeof s=="string"?{selector:s,value:"textContent"}:{selector:s.selector,value:(e=s.value)!==null&&e!==void 0?e:"textContent"}}function Fw(s){const e={};for(const t in s){const i=s[t],n=Array.isArray(i),{selector:a,value:o}=Bw(n?i[0]:i),c=typeof o=="function"?o:typeof o=="string"?f=>this._make(f).prop(o):f=>this._make(f).extract(o);if(n)e[t]=this._findBySelector(a,Number.POSITIVE_INFINITY).map((f,d)=>c(d,t,e)).get();else{const f=this._findBySelector(a,1);e[t]=f.length>0?c(f[0],t,e):void 0}}return e}const Hw=Object.freeze(Object.defineProperty({__proto__:null,extract:Fw},Symbol.toStringTag,{value:"Module"}));class Vl{constructor(e,t,i){if(this.length=0,this.options=i,this._root=t,e){for(let n=0;n<e.length;n++)this[n]=e[n];this.length=e.length}}}Vl.prototype.cheerio="[cheerio object]";Vl.prototype.splice=Array.prototype.splice;Vl.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(Vl.prototype,zD,uw,Cw,Ow,Uw,Hw);function jw(s,e){return function t(i,n,a=!0){if(i==null)throw new Error("cheerio.load() expects a string");const o=Ag(n),c=s(i,o,a,null);class f extends Vl{_make(g,p){const T=d(g,p);return T.prevObject=this,T}_parse(g,p,T,y){return s(g,p,T,y)}_render(g){return e(g,this.options)}}function d(m,g,p=c,T){if(m&&jn(m))return m;const y=Ag(T,o),S=typeof p=="string"?[s(p,y,!1,null)]:"length"in p?p:[p],A=jn(S)?S:new f(S,null,y);if(A._root=A,!m)return new f(void 0,A,y);const R=typeof m=="string"&&_g(m)?s(m,y,!1,null).children:$w(m)?[m]:Array.isArray(m)?m:void 0,C=new f(R,A,y);if(R)return C;if(typeof m!="string")throw new TypeError("Unexpected type of selector");let I=m;const D=g?typeof g=="string"?_g(g)?new f([s(g,y,!1,null)],A,y):(I=`${g} ${I}`,A):jn(g)?g:new f(Array.isArray(g)?g:[g],A,y):A;return D?D.find(I):C}return Object.assign(d,bD,{load:t,_root:c,_options:o,fn:f.prototype,prototype:f.prototype}),d}}function $w(s){return!!s.name||s.type===Ep||s.type===lS||s.type===cS}const Gw=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),_t="";var w;(function(s){s[s.EOF=-1]="EOF",s[s.NULL=0]="NULL",s[s.TABULATION=9]="TABULATION",s[s.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",s[s.LINE_FEED=10]="LINE_FEED",s[s.FORM_FEED=12]="FORM_FEED",s[s.SPACE=32]="SPACE",s[s.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",s[s.QUOTATION_MARK=34]="QUOTATION_MARK",s[s.AMPERSAND=38]="AMPERSAND",s[s.APOSTROPHE=39]="APOSTROPHE",s[s.HYPHEN_MINUS=45]="HYPHEN_MINUS",s[s.SOLIDUS=47]="SOLIDUS",s[s.DIGIT_0=48]="DIGIT_0",s[s.DIGIT_9=57]="DIGIT_9",s[s.SEMICOLON=59]="SEMICOLON",s[s.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",s[s.EQUALS_SIGN=61]="EQUALS_SIGN",s[s.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",s[s.QUESTION_MARK=63]="QUESTION_MARK",s[s.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",s[s.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",s[s.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",s[s.GRAVE_ACCENT=96]="GRAVE_ACCENT",s[s.LATIN_SMALL_A=97]="LATIN_SMALL_A",s[s.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(w||(w={}));const js={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function KS(s){return s>=55296&&s<=57343}function qw(s){return s>=56320&&s<=57343}function Vw(s,e){return(s-55296)*1024+9216+e}function QS(s){return s!==32&&s!==10&&s!==13&&s!==9&&s!==12&&s>=1&&s<=31||s>=127&&s<=159}function XS(s){return s>=64976&&s<=65007||Gw.has(s)}var ae;(function(s){s.controlCharacterInInputStream="control-character-in-input-stream",s.noncharacterInInputStream="noncharacter-in-input-stream",s.surrogateInInputStream="surrogate-in-input-stream",s.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",s.endTagWithAttributes="end-tag-with-attributes",s.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",s.unexpectedSolidusInTag="unexpected-solidus-in-tag",s.unexpectedNullCharacter="unexpected-null-character",s.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",s.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",s.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",s.missingEndTagName="missing-end-tag-name",s.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",s.unknownNamedCharacterReference="unknown-named-character-reference",s.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",s.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",s.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",s.eofBeforeTagName="eof-before-tag-name",s.eofInTag="eof-in-tag",s.missingAttributeValue="missing-attribute-value",s.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",s.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",s.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",s.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",s.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",s.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",s.missingDoctypePublicIdentifier="missing-doctype-public-identifier",s.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",s.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",s.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",s.cdataInHtmlContent="cdata-in-html-content",s.incorrectlyOpenedComment="incorrectly-opened-comment",s.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",s.eofInDoctype="eof-in-doctype",s.nestedComment="nested-comment",s.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",s.eofInComment="eof-in-comment",s.incorrectlyClosedComment="incorrectly-closed-comment",s.eofInCdata="eof-in-cdata",s.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",s.nullCharacterReference="null-character-reference",s.surrogateCharacterReference="surrogate-character-reference",s.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",s.controlCharacterReference="control-character-reference",s.noncharacterCharacterReference="noncharacter-character-reference",s.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",s.missingDoctypeName="missing-doctype-name",s.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",s.duplicateAttribute="duplicate-attribute",s.nonConformingDoctype="non-conforming-doctype",s.missingDoctype="missing-doctype",s.misplacedDoctype="misplaced-doctype",s.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",s.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",s.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",s.openElementsLeftAfterEof="open-elements-left-after-eof",s.abandonedHeadElementChild="abandoned-head-element-child",s.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",s.nestedNoscriptInHead="nested-noscript-in-head",s.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(ae||(ae={}));const zw=65536;class Yw{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=zw,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e,t){const{line:i,col:n,offset:a}=this,o=n+t,c=a+t;return{code:e,startLine:i,endLine:i,startCol:o,endCol:o,startOffset:c,endOffset:c}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const t=this.html.charCodeAt(this.pos+1);if(qw(t))return this.pos++,this._addGap(),Vw(e,t)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,w.EOF;return this._err(ae.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,t){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=t}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,t){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(t)return this.html.startsWith(e,this.pos);for(let i=0;i<e.length;i++)if((this.html.charCodeAt(this.pos+i)|32)!==e.charCodeAt(i))return!1;return!0}peek(e){const t=this.pos+e;if(t>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,w.EOF;const i=this.html.charCodeAt(t);return i===w.CARRIAGE_RETURN?w.LINE_FEED:i}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,w.EOF;let e=this.html.charCodeAt(this.pos);return e===w.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,w.LINE_FEED):e===w.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,KS(e)&&(e=this._processSurrogate(e)),this.handler.onParseError===null||e>31&&e<127||e===w.LINE_FEED||e===w.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){QS(e)?this._err(ae.controlCharacterInInputStream):XS(e)&&this._err(ae.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var it;(function(s){s[s.CHARACTER=0]="CHARACTER",s[s.NULL_CHARACTER=1]="NULL_CHARACTER",s[s.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",s[s.START_TAG=3]="START_TAG",s[s.END_TAG=4]="END_TAG",s[s.COMMENT=5]="COMMENT",s[s.DOCTYPE=6]="DOCTYPE",s[s.EOF=7]="EOF",s[s.HIBERNATION=8]="HIBERNATION"})(it||(it={}));function WS(s,e){for(let t=s.attrs.length-1;t>=0;t--)if(s.attrs[t].name===e)return s.attrs[t].value;return null}const Kw=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(s=>s.charCodeAt(0))),Qw=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function Xw(s){var e;return s>=55296&&s<=57343||s>1114111?65533:(e=Qw.get(s))!==null&&e!==void 0?e:s}var ds;(function(s){s[s.NUM=35]="NUM",s[s.SEMI=59]="SEMI",s[s.EQUALS=61]="EQUALS",s[s.ZERO=48]="ZERO",s[s.NINE=57]="NINE",s[s.LOWER_A=97]="LOWER_A",s[s.LOWER_F=102]="LOWER_F",s[s.LOWER_X=120]="LOWER_X",s[s.LOWER_Z=122]="LOWER_Z",s[s.UPPER_A=65]="UPPER_A",s[s.UPPER_F=70]="UPPER_F",s[s.UPPER_Z=90]="UPPER_Z"})(ds||(ds={}));const Ww=32;var wr;(function(s){s[s.VALUE_LENGTH=49152]="VALUE_LENGTH",s[s.BRANCH_LENGTH=16256]="BRANCH_LENGTH",s[s.JUMP_TABLE=127]="JUMP_TABLE"})(wr||(wr={}));function wg(s){return s>=ds.ZERO&&s<=ds.NINE}function Zw(s){return s>=ds.UPPER_A&&s<=ds.UPPER_F||s>=ds.LOWER_A&&s<=ds.LOWER_F}function Jw(s){return s>=ds.UPPER_A&&s<=ds.UPPER_Z||s>=ds.LOWER_A&&s<=ds.LOWER_Z||wg(s)}function eO(s){return s===ds.EQUALS||Jw(s)}var os;(function(s){s[s.EntityStart=0]="EntityStart",s[s.NumericStart=1]="NumericStart",s[s.NumericDecimal=2]="NumericDecimal",s[s.NumericHex=3]="NumericHex",s[s.NamedEntity=4]="NamedEntity"})(os||(os={}));var Bn;(function(s){s[s.Legacy=0]="Legacy",s[s.Strict=1]="Strict",s[s.Attribute=2]="Attribute"})(Bn||(Bn={}));class tO{constructor(e,t,i){this.decodeTree=e,this.emitCodePoint=t,this.errors=i,this.state=os.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Bn.Strict}startEntity(e){this.decodeMode=e,this.state=os.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case os.EntityStart:return e.charCodeAt(t)===ds.NUM?(this.state=os.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=os.NamedEntity,this.stateNamedEntity(e,t));case os.NumericStart:return this.stateNumericStart(e,t);case os.NumericDecimal:return this.stateNumericDecimal(e,t);case os.NumericHex:return this.stateNumericHex(e,t);case os.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|Ww)===ds.LOWER_X?(this.state=os.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=os.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,i,n){if(t!==i){const a=i-t;this.result=this.result*Math.pow(n,a)+Number.parseInt(e.substr(t,a),n),this.consumed+=a}}stateNumericHex(e,t){const i=t;for(;t<e.length;){const n=e.charCodeAt(t);if(wg(n)||Zw(n))t+=1;else return this.addToNumericResult(e,i,t,16),this.emitNumericEntity(n,3)}return this.addToNumericResult(e,i,t,16),-1}stateNumericDecimal(e,t){const i=t;for(;t<e.length;){const n=e.charCodeAt(t);if(wg(n))t+=1;else return this.addToNumericResult(e,i,t,10),this.emitNumericEntity(n,2)}return this.addToNumericResult(e,i,t,10),-1}emitNumericEntity(e,t){var i;if(this.consumed<=t)return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===ds.SEMI)this.consumed+=1;else if(this.decodeMode===Bn.Strict)return 0;return this.emitCodePoint(Xw(this.result),this.consumed),this.errors&&(e!==ds.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:i}=this;let n=i[this.treeIndex],a=(n&wr.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const o=e.charCodeAt(t);if(this.treeIndex=sO(i,n,this.treeIndex+Math.max(1,a),o),this.treeIndex<0)return this.result===0||this.decodeMode===Bn.Attribute&&(a===0||eO(o))?0:this.emitNotTerminatedNamedEntity();if(n=i[this.treeIndex],a=(n&wr.VALUE_LENGTH)>>14,a!==0){if(o===ds.SEMI)return this.emitNamedEntityData(this.treeIndex,a,this.consumed+this.excess);this.decodeMode!==Bn.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:i}=this,n=(i[t]&wr.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,n,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,i){const{decodeTree:n}=this;return this.emitCodePoint(t===1?n[e]&~wr.VALUE_LENGTH:n[e+1],i),t===3&&this.emitCodePoint(n[e+2],i),i}end(){var e;switch(this.state){case os.NamedEntity:return this.result!==0&&(this.decodeMode!==Bn.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case os.NumericDecimal:return this.emitNumericEntity(0,2);case os.NumericHex:return this.emitNumericEntity(0,3);case os.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case os.EntityStart:return 0}}}function sO(s,e,t,i){const n=(e&wr.BRANCH_LENGTH)>>7,a=e&wr.JUMP_TABLE;if(n===0)return a!==0&&i===a?t:-1;if(a){const f=i-a;return f<0||f>=n?-1:s[t+f]-1}let o=t,c=o+n-1;for(;o<=c;){const f=o+c>>>1,d=s[f];if(d<i)o=f+1;else if(d>i)c=f-1;else return s[f+n]}return-1}var me;(function(s){s.HTML="http://www.w3.org/1999/xhtml",s.MATHML="http://www.w3.org/1998/Math/MathML",s.SVG="http://www.w3.org/2000/svg",s.XLINK="http://www.w3.org/1999/xlink",s.XML="http://www.w3.org/XML/1998/namespace",s.XMLNS="http://www.w3.org/2000/xmlns/"})(me||(me={}));var ba;(function(s){s.TYPE="type",s.ACTION="action",s.ENCODING="encoding",s.PROMPT="prompt",s.NAME="name",s.COLOR="color",s.FACE="face",s.SIZE="size"})(ba||(ba={}));var oi;(function(s){s.NO_QUIRKS="no-quirks",s.QUIRKS="quirks",s.LIMITED_QUIRKS="limited-quirks"})(oi||(oi={}));var X;(function(s){s.A="a",s.ADDRESS="address",s.ANNOTATION_XML="annotation-xml",s.APPLET="applet",s.AREA="area",s.ARTICLE="article",s.ASIDE="aside",s.B="b",s.BASE="base",s.BASEFONT="basefont",s.BGSOUND="bgsound",s.BIG="big",s.BLOCKQUOTE="blockquote",s.BODY="body",s.BR="br",s.BUTTON="button",s.CAPTION="caption",s.CENTER="center",s.CODE="code",s.COL="col",s.COLGROUP="colgroup",s.DD="dd",s.DESC="desc",s.DETAILS="details",s.DIALOG="dialog",s.DIR="dir",s.DIV="div",s.DL="dl",s.DT="dt",s.EM="em",s.EMBED="embed",s.FIELDSET="fieldset",s.FIGCAPTION="figcaption",s.FIGURE="figure",s.FONT="font",s.FOOTER="footer",s.FOREIGN_OBJECT="foreignObject",s.FORM="form",s.FRAME="frame",s.FRAMESET="frameset",s.H1="h1",s.H2="h2",s.H3="h3",s.H4="h4",s.H5="h5",s.H6="h6",s.HEAD="head",s.HEADER="header",s.HGROUP="hgroup",s.HR="hr",s.HTML="html",s.I="i",s.IMG="img",s.IMAGE="image",s.INPUT="input",s.IFRAME="iframe",s.KEYGEN="keygen",s.LABEL="label",s.LI="li",s.LINK="link",s.LISTING="listing",s.MAIN="main",s.MALIGNMARK="malignmark",s.MARQUEE="marquee",s.MATH="math",s.MENU="menu",s.META="meta",s.MGLYPH="mglyph",s.MI="mi",s.MO="mo",s.MN="mn",s.MS="ms",s.MTEXT="mtext",s.NAV="nav",s.NOBR="nobr",s.NOFRAMES="noframes",s.NOEMBED="noembed",s.NOSCRIPT="noscript",s.OBJECT="object",s.OL="ol",s.OPTGROUP="optgroup",s.OPTION="option",s.P="p",s.PARAM="param",s.PLAINTEXT="plaintext",s.PRE="pre",s.RB="rb",s.RP="rp",s.RT="rt",s.RTC="rtc",s.RUBY="ruby",s.S="s",s.SCRIPT="script",s.SEARCH="search",s.SECTION="section",s.SELECT="select",s.SOURCE="source",s.SMALL="small",s.SPAN="span",s.STRIKE="strike",s.STRONG="strong",s.STYLE="style",s.SUB="sub",s.SUMMARY="summary",s.SUP="sup",s.TABLE="table",s.TBODY="tbody",s.TEMPLATE="template",s.TEXTAREA="textarea",s.TFOOT="tfoot",s.TD="td",s.TH="th",s.THEAD="thead",s.TITLE="title",s.TR="tr",s.TRACK="track",s.TT="tt",s.U="u",s.UL="ul",s.SVG="svg",s.VAR="var",s.WBR="wbr",s.XMP="xmp"})(X||(X={}));var v;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.A=1]="A",s[s.ADDRESS=2]="ADDRESS",s[s.ANNOTATION_XML=3]="ANNOTATION_XML",s[s.APPLET=4]="APPLET",s[s.AREA=5]="AREA",s[s.ARTICLE=6]="ARTICLE",s[s.ASIDE=7]="ASIDE",s[s.B=8]="B",s[s.BASE=9]="BASE",s[s.BASEFONT=10]="BASEFONT",s[s.BGSOUND=11]="BGSOUND",s[s.BIG=12]="BIG",s[s.BLOCKQUOTE=13]="BLOCKQUOTE",s[s.BODY=14]="BODY",s[s.BR=15]="BR",s[s.BUTTON=16]="BUTTON",s[s.CAPTION=17]="CAPTION",s[s.CENTER=18]="CENTER",s[s.CODE=19]="CODE",s[s.COL=20]="COL",s[s.COLGROUP=21]="COLGROUP",s[s.DD=22]="DD",s[s.DESC=23]="DESC",s[s.DETAILS=24]="DETAILS",s[s.DIALOG=25]="DIALOG",s[s.DIR=26]="DIR",s[s.DIV=27]="DIV",s[s.DL=28]="DL",s[s.DT=29]="DT",s[s.EM=30]="EM",s[s.EMBED=31]="EMBED",s[s.FIELDSET=32]="FIELDSET",s[s.FIGCAPTION=33]="FIGCAPTION",s[s.FIGURE=34]="FIGURE",s[s.FONT=35]="FONT",s[s.FOOTER=36]="FOOTER",s[s.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",s[s.FORM=38]="FORM",s[s.FRAME=39]="FRAME",s[s.FRAMESET=40]="FRAMESET",s[s.H1=41]="H1",s[s.H2=42]="H2",s[s.H3=43]="H3",s[s.H4=44]="H4",s[s.H5=45]="H5",s[s.H6=46]="H6",s[s.HEAD=47]="HEAD",s[s.HEADER=48]="HEADER",s[s.HGROUP=49]="HGROUP",s[s.HR=50]="HR",s[s.HTML=51]="HTML",s[s.I=52]="I",s[s.IMG=53]="IMG",s[s.IMAGE=54]="IMAGE",s[s.INPUT=55]="INPUT",s[s.IFRAME=56]="IFRAME",s[s.KEYGEN=57]="KEYGEN",s[s.LABEL=58]="LABEL",s[s.LI=59]="LI",s[s.LINK=60]="LINK",s[s.LISTING=61]="LISTING",s[s.MAIN=62]="MAIN",s[s.MALIGNMARK=63]="MALIGNMARK",s[s.MARQUEE=64]="MARQUEE",s[s.MATH=65]="MATH",s[s.MENU=66]="MENU",s[s.META=67]="META",s[s.MGLYPH=68]="MGLYPH",s[s.MI=69]="MI",s[s.MO=70]="MO",s[s.MN=71]="MN",s[s.MS=72]="MS",s[s.MTEXT=73]="MTEXT",s[s.NAV=74]="NAV",s[s.NOBR=75]="NOBR",s[s.NOFRAMES=76]="NOFRAMES",s[s.NOEMBED=77]="NOEMBED",s[s.NOSCRIPT=78]="NOSCRIPT",s[s.OBJECT=79]="OBJECT",s[s.OL=80]="OL",s[s.OPTGROUP=81]="OPTGROUP",s[s.OPTION=82]="OPTION",s[s.P=83]="P",s[s.PARAM=84]="PARAM",s[s.PLAINTEXT=85]="PLAINTEXT",s[s.PRE=86]="PRE",s[s.RB=87]="RB",s[s.RP=88]="RP",s[s.RT=89]="RT",s[s.RTC=90]="RTC",s[s.RUBY=91]="RUBY",s[s.S=92]="S",s[s.SCRIPT=93]="SCRIPT",s[s.SEARCH=94]="SEARCH",s[s.SECTION=95]="SECTION",s[s.SELECT=96]="SELECT",s[s.SOURCE=97]="SOURCE",s[s.SMALL=98]="SMALL",s[s.SPAN=99]="SPAN",s[s.STRIKE=100]="STRIKE",s[s.STRONG=101]="STRONG",s[s.STYLE=102]="STYLE",s[s.SUB=103]="SUB",s[s.SUMMARY=104]="SUMMARY",s[s.SUP=105]="SUP",s[s.TABLE=106]="TABLE",s[s.TBODY=107]="TBODY",s[s.TEMPLATE=108]="TEMPLATE",s[s.TEXTAREA=109]="TEXTAREA",s[s.TFOOT=110]="TFOOT",s[s.TD=111]="TD",s[s.TH=112]="TH",s[s.THEAD=113]="THEAD",s[s.TITLE=114]="TITLE",s[s.TR=115]="TR",s[s.TRACK=116]="TRACK",s[s.TT=117]="TT",s[s.U=118]="U",s[s.UL=119]="UL",s[s.SVG=120]="SVG",s[s.VAR=121]="VAR",s[s.WBR=122]="WBR",s[s.XMP=123]="XMP"})(v||(v={}));const iO=new Map([[X.A,v.A],[X.ADDRESS,v.ADDRESS],[X.ANNOTATION_XML,v.ANNOTATION_XML],[X.APPLET,v.APPLET],[X.AREA,v.AREA],[X.ARTICLE,v.ARTICLE],[X.ASIDE,v.ASIDE],[X.B,v.B],[X.BASE,v.BASE],[X.BASEFONT,v.BASEFONT],[X.BGSOUND,v.BGSOUND],[X.BIG,v.BIG],[X.BLOCKQUOTE,v.BLOCKQUOTE],[X.BODY,v.BODY],[X.BR,v.BR],[X.BUTTON,v.BUTTON],[X.CAPTION,v.CAPTION],[X.CENTER,v.CENTER],[X.CODE,v.CODE],[X.COL,v.COL],[X.COLGROUP,v.COLGROUP],[X.DD,v.DD],[X.DESC,v.DESC],[X.DETAILS,v.DETAILS],[X.DIALOG,v.DIALOG],[X.DIR,v.DIR],[X.DIV,v.DIV],[X.DL,v.DL],[X.DT,v.DT],[X.EM,v.EM],[X.EMBED,v.EMBED],[X.FIELDSET,v.FIELDSET],[X.FIGCAPTION,v.FIGCAPTION],[X.FIGURE,v.FIGURE],[X.FONT,v.FONT],[X.FOOTER,v.FOOTER],[X.FOREIGN_OBJECT,v.FOREIGN_OBJECT],[X.FORM,v.FORM],[X.FRAME,v.FRAME],[X.FRAMESET,v.FRAMESET],[X.H1,v.H1],[X.H2,v.H2],[X.H3,v.H3],[X.H4,v.H4],[X.H5,v.H5],[X.H6,v.H6],[X.HEAD,v.HEAD],[X.HEADER,v.HEADER],[X.HGROUP,v.HGROUP],[X.HR,v.HR],[X.HTML,v.HTML],[X.I,v.I],[X.IMG,v.IMG],[X.IMAGE,v.IMAGE],[X.INPUT,v.INPUT],[X.IFRAME,v.IFRAME],[X.KEYGEN,v.KEYGEN],[X.LABEL,v.LABEL],[X.LI,v.LI],[X.LINK,v.LINK],[X.LISTING,v.LISTING],[X.MAIN,v.MAIN],[X.MALIGNMARK,v.MALIGNMARK],[X.MARQUEE,v.MARQUEE],[X.MATH,v.MATH],[X.MENU,v.MENU],[X.META,v.META],[X.MGLYPH,v.MGLYPH],[X.MI,v.MI],[X.MO,v.MO],[X.MN,v.MN],[X.MS,v.MS],[X.MTEXT,v.MTEXT],[X.NAV,v.NAV],[X.NOBR,v.NOBR],[X.NOFRAMES,v.NOFRAMES],[X.NOEMBED,v.NOEMBED],[X.NOSCRIPT,v.NOSCRIPT],[X.OBJECT,v.OBJECT],[X.OL,v.OL],[X.OPTGROUP,v.OPTGROUP],[X.OPTION,v.OPTION],[X.P,v.P],[X.PARAM,v.PARAM],[X.PLAINTEXT,v.PLAINTEXT],[X.PRE,v.PRE],[X.RB,v.RB],[X.RP,v.RP],[X.RT,v.RT],[X.RTC,v.RTC],[X.RUBY,v.RUBY],[X.S,v.S],[X.SCRIPT,v.SCRIPT],[X.SEARCH,v.SEARCH],[X.SECTION,v.SECTION],[X.SELECT,v.SELECT],[X.SOURCE,v.SOURCE],[X.SMALL,v.SMALL],[X.SPAN,v.SPAN],[X.STRIKE,v.STRIKE],[X.STRONG,v.STRONG],[X.STYLE,v.STYLE],[X.SUB,v.SUB],[X.SUMMARY,v.SUMMARY],[X.SUP,v.SUP],[X.TABLE,v.TABLE],[X.TBODY,v.TBODY],[X.TEMPLATE,v.TEMPLATE],[X.TEXTAREA,v.TEXTAREA],[X.TFOOT,v.TFOOT],[X.TD,v.TD],[X.TH,v.TH],[X.THEAD,v.THEAD],[X.TITLE,v.TITLE],[X.TR,v.TR],[X.TRACK,v.TRACK],[X.TT,v.TT],[X.U,v.U],[X.UL,v.UL],[X.SVG,v.SVG],[X.VAR,v.VAR],[X.WBR,v.WBR],[X.XMP,v.XMP]]);function Yf(s){var e;return(e=iO.get(s))!==null&&e!==void 0?e:v.UNKNOWN}const Ee=v,nO={[me.HTML]:new Set([Ee.ADDRESS,Ee.APPLET,Ee.AREA,Ee.ARTICLE,Ee.ASIDE,Ee.BASE,Ee.BASEFONT,Ee.BGSOUND,Ee.BLOCKQUOTE,Ee.BODY,Ee.BR,Ee.BUTTON,Ee.CAPTION,Ee.CENTER,Ee.COL,Ee.COLGROUP,Ee.DD,Ee.DETAILS,Ee.DIR,Ee.DIV,Ee.DL,Ee.DT,Ee.EMBED,Ee.FIELDSET,Ee.FIGCAPTION,Ee.FIGURE,Ee.FOOTER,Ee.FORM,Ee.FRAME,Ee.FRAMESET,Ee.H1,Ee.H2,Ee.H3,Ee.H4,Ee.H5,Ee.H6,Ee.HEAD,Ee.HEADER,Ee.HGROUP,Ee.HR,Ee.HTML,Ee.IFRAME,Ee.IMG,Ee.INPUT,Ee.LI,Ee.LINK,Ee.LISTING,Ee.MAIN,Ee.MARQUEE,Ee.MENU,Ee.META,Ee.NAV,Ee.NOEMBED,Ee.NOFRAMES,Ee.NOSCRIPT,Ee.OBJECT,Ee.OL,Ee.P,Ee.PARAM,Ee.PLAINTEXT,Ee.PRE,Ee.SCRIPT,Ee.SECTION,Ee.SELECT,Ee.SOURCE,Ee.STYLE,Ee.SUMMARY,Ee.TABLE,Ee.TBODY,Ee.TD,Ee.TEMPLATE,Ee.TEXTAREA,Ee.TFOOT,Ee.TH,Ee.THEAD,Ee.TITLE,Ee.TR,Ee.TRACK,Ee.UL,Ee.WBR,Ee.XMP]),[me.MATHML]:new Set([Ee.MI,Ee.MO,Ee.MN,Ee.MS,Ee.MTEXT,Ee.ANNOTATION_XML]),[me.SVG]:new Set([Ee.TITLE,Ee.FOREIGN_OBJECT,Ee.DESC]),[me.XLINK]:new Set,[me.XML]:new Set,[me.XMLNS]:new Set},Og=new Set([Ee.H1,Ee.H2,Ee.H3,Ee.H4,Ee.H5,Ee.H6]),rO=new Set([X.STYLE,X.SCRIPT,X.XMP,X.IFRAME,X.NOEMBED,X.NOFRAMES,X.PLAINTEXT]);function aO(s,e){return rO.has(s)||e&&s===X.NOSCRIPT}var M;(function(s){s[s.DATA=0]="DATA",s[s.RCDATA=1]="RCDATA",s[s.RAWTEXT=2]="RAWTEXT",s[s.SCRIPT_DATA=3]="SCRIPT_DATA",s[s.PLAINTEXT=4]="PLAINTEXT",s[s.TAG_OPEN=5]="TAG_OPEN",s[s.END_TAG_OPEN=6]="END_TAG_OPEN",s[s.TAG_NAME=7]="TAG_NAME",s[s.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",s[s.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",s[s.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",s[s.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",s[s.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",s[s.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",s[s.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",s[s.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",s[s.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",s[s.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",s[s.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",s[s.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",s[s.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",s[s.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",s[s.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",s[s.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",s[s.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",s[s.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",s[s.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",s[s.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",s[s.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",s[s.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",s[s.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",s[s.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",s[s.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",s[s.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",s[s.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",s[s.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",s[s.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",s[s.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",s[s.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",s[s.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",s[s.BOGUS_COMMENT=40]="BOGUS_COMMENT",s[s.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",s[s.COMMENT_START=42]="COMMENT_START",s[s.COMMENT_START_DASH=43]="COMMENT_START_DASH",s[s.COMMENT=44]="COMMENT",s[s.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",s[s.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",s[s.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",s[s.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",s[s.COMMENT_END_DASH=49]="COMMENT_END_DASH",s[s.COMMENT_END=50]="COMMENT_END",s[s.COMMENT_END_BANG=51]="COMMENT_END_BANG",s[s.DOCTYPE=52]="DOCTYPE",s[s.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",s[s.DOCTYPE_NAME=54]="DOCTYPE_NAME",s[s.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",s[s.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",s[s.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",s[s.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",s[s.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",s[s.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",s[s.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",s[s.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",s[s.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",s[s.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",s[s.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",s[s.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",s[s.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",s[s.CDATA_SECTION=68]="CDATA_SECTION",s[s.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",s[s.CDATA_SECTION_END=70]="CDATA_SECTION_END",s[s.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",s[s.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(M||(M={}));const Vs={DATA:M.DATA,RCDATA:M.RCDATA,RAWTEXT:M.RAWTEXT,SCRIPT_DATA:M.SCRIPT_DATA,PLAINTEXT:M.PLAINTEXT,CDATA_SECTION:M.CDATA_SECTION};function uO(s){return s>=w.DIGIT_0&&s<=w.DIGIT_9}function tl(s){return s>=w.LATIN_CAPITAL_A&&s<=w.LATIN_CAPITAL_Z}function oO(s){return s>=w.LATIN_SMALL_A&&s<=w.LATIN_SMALL_Z}function yr(s){return oO(s)||tl(s)}function ST(s){return yr(s)||uO(s)}function Td(s){return s+32}function ZS(s){return s===w.SPACE||s===w.LINE_FEED||s===w.TABULATION||s===w.FORM_FEED}function AT(s){return ZS(s)||s===w.SOLIDUS||s===w.GREATER_THAN_SIGN}function lO(s){return s===w.NULL?ae.nullCharacterReference:s>1114111?ae.characterReferenceOutsideUnicodeRange:KS(s)?ae.surrogateCharacterReference:XS(s)?ae.noncharacterCharacterReference:QS(s)||s===w.CARRIAGE_RETURN?ae.controlCharacterReference:null}class cO{constructor(e,t){this.options=e,this.handler=t,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=M.DATA,this.returnState=M.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new Yw(t),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new tO(Kw,(i,n)=>{this.preprocessor.pos=this.entityStartPos+n-1,this._flushCodePointConsumedAsCharacterReference(i)},t.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(ae.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:i=>{this._err(ae.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+i)},validateNumericCharacterReference:i=>{const n=lO(i);n&&this._err(n,1)}}:void 0)}_err(e,t=0){var i,n;(n=(i=this.handler).onParseError)===null||n===void 0||n.call(i,this.preprocessor.getError(e,t))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||e==null||e())}write(e,t,i){this.active=!0,this.preprocessor.write(e,t),this._runParsingLoop(),this.paused||i==null||i()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let t=0;t<e;t++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,t){return this.preprocessor.startsWith(e,t)?(this._advanceBy(e.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:it.START_TAG,tagName:"",tagID:v.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:it.END_TAG,tagName:"",tagID:v.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:it.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:it.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,t){this.currentCharacterToken={type:e,chars:t,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,t;const i=this.currentToken;if(WS(i,this.currentAttr.name)===null){if(i.attrs.push(this.currentAttr),i.location&&this.currentLocation){const n=(e=(t=i.location).attrs)!==null&&e!==void 0?e:t.attrs=Object.create(null);n[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(ae.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e),e.tagID=Yf(e.tagName),e.type===it.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(ae.endTagWithAttributes),e.selfClosing&&this._err(ae.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case it.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case it.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case it.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:it.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,t){if(this.currentCharacterToken)if(this.currentCharacterToken.type===e){this.currentCharacterToken.chars+=t;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(e,t)}_emitCodePoint(e){const t=ZS(e)?it.WHITESPACE_CHARACTER:e===w.NULL?it.NULL_CHARACTER:it.CHARACTER;this._appendCharToCurrentCharacterToken(t,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(it.CHARACTER,e)}_startCharacterReference(){this.returnState=this.state,this.state=M.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?Bn.Attribute:Bn.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===M.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===M.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===M.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case M.DATA:{this._stateData(e);break}case M.RCDATA:{this._stateRcdata(e);break}case M.RAWTEXT:{this._stateRawtext(e);break}case M.SCRIPT_DATA:{this._stateScriptData(e);break}case M.PLAINTEXT:{this._statePlaintext(e);break}case M.TAG_OPEN:{this._stateTagOpen(e);break}case M.END_TAG_OPEN:{this._stateEndTagOpen(e);break}case M.TAG_NAME:{this._stateTagName(e);break}case M.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(e);break}case M.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(e);break}case M.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(e);break}case M.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(e);break}case M.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(e);break}case M.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(e);break}case M.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(e);break}case M.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(e);break}case M.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(e);break}case M.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(e);break}case M.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(e);break}case M.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(e);break}case M.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(e);break}case M.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(e);break}case M.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(e);break}case M.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(e);break}case M.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(e);break}case M.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(e);break}case M.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(e);break}case M.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(e);break}case M.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(e);break}case M.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(e);break}case M.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(e);break}case M.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(e);break}case M.ATTRIBUTE_NAME:{this._stateAttributeName(e);break}case M.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(e);break}case M.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(e);break}case M.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(e);break}case M.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(e);break}case M.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(e);break}case M.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(e);break}case M.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(e);break}case M.BOGUS_COMMENT:{this._stateBogusComment(e);break}case M.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(e);break}case M.COMMENT_START:{this._stateCommentStart(e);break}case M.COMMENT_START_DASH:{this._stateCommentStartDash(e);break}case M.COMMENT:{this._stateComment(e);break}case M.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(e);break}case M.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(e);break}case M.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(e);break}case M.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(e);break}case M.COMMENT_END_DASH:{this._stateCommentEndDash(e);break}case M.COMMENT_END:{this._stateCommentEnd(e);break}case M.COMMENT_END_BANG:{this._stateCommentEndBang(e);break}case M.DOCTYPE:{this._stateDoctype(e);break}case M.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(e);break}case M.DOCTYPE_NAME:{this._stateDoctypeName(e);break}case M.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(e);break}case M.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(e);break}case M.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(e);break}case M.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(e);break}case M.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(e);break}case M.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(e);break}case M.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break}case M.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(e);break}case M.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(e);break}case M.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(e);break}case M.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(e);break}case M.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(e);break}case M.BOGUS_DOCTYPE:{this._stateBogusDoctype(e);break}case M.CDATA_SECTION:{this._stateCdataSection(e);break}case M.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(e);break}case M.CDATA_SECTION_END:{this._stateCdataSectionEnd(e);break}case M.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case M.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(e);break}default:throw new Error("Unknown state")}}_stateData(e){switch(e){case w.LESS_THAN_SIGN:{this.state=M.TAG_OPEN;break}case w.AMPERSAND:{this._startCharacterReference();break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this._emitCodePoint(e);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case w.AMPERSAND:{this._startCharacterReference();break}case w.LESS_THAN_SIGN:{this.state=M.RCDATA_LESS_THAN_SIGN;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this._emitChars(_t);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case w.LESS_THAN_SIGN:{this.state=M.RAWTEXT_LESS_THAN_SIGN;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this._emitChars(_t);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case w.LESS_THAN_SIGN:{this.state=M.SCRIPT_DATA_LESS_THAN_SIGN;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this._emitChars(_t);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case w.NULL:{this._err(ae.unexpectedNullCharacter),this._emitChars(_t);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateTagOpen(e){if(yr(e))this._createStartTagToken(),this.state=M.TAG_NAME,this._stateTagName(e);else switch(e){case w.EXCLAMATION_MARK:{this.state=M.MARKUP_DECLARATION_OPEN;break}case w.SOLIDUS:{this.state=M.END_TAG_OPEN;break}case w.QUESTION_MARK:{this._err(ae.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=M.BOGUS_COMMENT,this._stateBogusComment(e);break}case w.EOF:{this._err(ae.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(ae.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=M.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(yr(e))this._createEndTagToken(),this.state=M.TAG_NAME,this._stateTagName(e);else switch(e){case w.GREATER_THAN_SIGN:{this._err(ae.missingEndTagName),this.state=M.DATA;break}case w.EOF:{this._err(ae.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(ae.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=M.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=M.BEFORE_ATTRIBUTE_NAME;break}case w.SOLIDUS:{this.state=M.SELF_CLOSING_START_TAG;break}case w.GREATER_THAN_SIGN:{this.state=M.DATA,this.emitCurrentTagToken();break}case w.NULL:{this._err(ae.unexpectedNullCharacter),t.tagName+=_t;break}case w.EOF:{this._err(ae.eofInTag),this._emitEOFToken();break}default:t.tagName+=String.fromCodePoint(tl(e)?Td(e):e)}}_stateRcdataLessThanSign(e){e===w.SOLIDUS?this.state=M.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=M.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){yr(e)?(this.state=M.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=M.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const t=this.currentToken;switch(t.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=M.BEFORE_ATTRIBUTE_NAME,!1;case w.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=M.SELF_CLOSING_START_TAG,!1;case w.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=M.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=M.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===w.SOLIDUS?this.state=M.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=M.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){yr(e)?(this.state=M.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=M.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=M.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case w.SOLIDUS:{this.state=M.SCRIPT_DATA_END_TAG_OPEN;break}case w.EXCLAMATION_MARK:{this.state=M.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=M.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){yr(e)?(this.state=M.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=M.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=M.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===w.HYPHEN_MINUS?(this.state=M.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=M.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===w.HYPHEN_MINUS?(this.state=M.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=M.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case w.HYPHEN_MINUS:{this.state=M.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=M.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this._emitChars(_t);break}case w.EOF:{this._err(ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case w.HYPHEN_MINUS:{this.state=M.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=M.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this.state=M.SCRIPT_DATA_ESCAPED,this._emitChars(_t);break}case w.EOF:{this._err(ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=M.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case w.HYPHEN_MINUS:{this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=M.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.GREATER_THAN_SIGN:{this.state=M.SCRIPT_DATA,this._emitChars(">");break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this.state=M.SCRIPT_DATA_ESCAPED,this._emitChars(_t);break}case w.EOF:{this._err(ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=M.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===w.SOLIDUS?this.state=M.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:yr(e)?(this._emitChars("<"),this.state=M.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=M.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){yr(e)?(this.state=M.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=M.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=M.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(js.SCRIPT,!1)&&AT(this.preprocessor.peek(js.SCRIPT.length))){this._emitCodePoint(e);for(let t=0;t<js.SCRIPT.length;t++)this._emitCodePoint(this._consume());this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=M.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case w.HYPHEN_MINUS:{this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this._emitChars(_t);break}case w.EOF:{this._err(ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case w.HYPHEN_MINUS:{this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(_t);break}case w.EOF:{this._err(ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case w.HYPHEN_MINUS:{this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.GREATER_THAN_SIGN:{this.state=M.SCRIPT_DATA,this._emitChars(">");break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(_t);break}case w.EOF:{this._err(ae.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===w.SOLIDUS?(this.state=M.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(js.SCRIPT,!1)&&AT(this.preprocessor.peek(js.SCRIPT.length))){this._emitCodePoint(e);for(let t=0;t<js.SCRIPT.length;t++)this._emitCodePoint(this._consume());this.state=M.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=M.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.SOLIDUS:case w.GREATER_THAN_SIGN:case w.EOF:{this.state=M.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case w.EQUALS_SIGN:{this._err(ae.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=M.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=M.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:case w.SOLIDUS:case w.GREATER_THAN_SIGN:case w.EOF:{this._leaveAttrName(),this.state=M.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case w.EQUALS_SIGN:{this._leaveAttrName(),this.state=M.BEFORE_ATTRIBUTE_VALUE;break}case w.QUOTATION_MARK:case w.APOSTROPHE:case w.LESS_THAN_SIGN:{this._err(ae.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this.currentAttr.name+=_t;break}default:this.currentAttr.name+=String.fromCodePoint(tl(e)?Td(e):e)}}_stateAfterAttributeName(e){switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.SOLIDUS:{this.state=M.SELF_CLOSING_START_TAG;break}case w.EQUALS_SIGN:{this.state=M.BEFORE_ATTRIBUTE_VALUE;break}case w.GREATER_THAN_SIGN:{this.state=M.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(ae.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=M.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{this.state=M.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this.state=M.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(ae.missingAttributeValue),this.state=M.DATA,this.emitCurrentTagToken();break}default:this.state=M.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case w.QUOTATION_MARK:{this.state=M.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case w.AMPERSAND:{this._startCharacterReference();break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this.currentAttr.value+=_t;break}case w.EOF:{this._err(ae.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case w.APOSTROPHE:{this.state=M.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case w.AMPERSAND:{this._startCharacterReference();break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this.currentAttr.value+=_t;break}case w.EOF:{this._err(ae.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this._leaveAttrValue(),this.state=M.BEFORE_ATTRIBUTE_NAME;break}case w.AMPERSAND:{this._startCharacterReference();break}case w.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=M.DATA,this.emitCurrentTagToken();break}case w.NULL:{this._err(ae.unexpectedNullCharacter),this.currentAttr.value+=_t;break}case w.QUOTATION_MARK:case w.APOSTROPHE:case w.LESS_THAN_SIGN:case w.EQUALS_SIGN:case w.GRAVE_ACCENT:{this._err(ae.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break}case w.EOF:{this._err(ae.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this._leaveAttrValue(),this.state=M.BEFORE_ATTRIBUTE_NAME;break}case w.SOLIDUS:{this._leaveAttrValue(),this.state=M.SELF_CLOSING_START_TAG;break}case w.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=M.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(ae.eofInTag),this._emitEOFToken();break}default:this._err(ae.missingWhitespaceBetweenAttributes),this.state=M.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case w.GREATER_THAN_SIGN:{const t=this.currentToken;t.selfClosing=!0,this.state=M.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(ae.eofInTag),this._emitEOFToken();break}default:this._err(ae.unexpectedSolidusInTag),this.state=M.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const t=this.currentToken;switch(e){case w.GREATER_THAN_SIGN:{this.state=M.DATA,this.emitCurrentComment(t);break}case w.EOF:{this.emitCurrentComment(t),this._emitEOFToken();break}case w.NULL:{this._err(ae.unexpectedNullCharacter),t.data+=_t;break}default:t.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(js.DASH_DASH,!0)?(this._createCommentToken(js.DASH_DASH.length+1),this.state=M.COMMENT_START):this._consumeSequenceIfMatch(js.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(js.DOCTYPE.length+1),this.state=M.DOCTYPE):this._consumeSequenceIfMatch(js.CDATA_START,!0)?this.inForeignNode?this.state=M.CDATA_SECTION:(this._err(ae.cdataInHtmlContent),this._createCommentToken(js.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=M.BOGUS_COMMENT):this._ensureHibernation()||(this._err(ae.incorrectlyOpenedComment),this._createCommentToken(2),this.state=M.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case w.HYPHEN_MINUS:{this.state=M.COMMENT_START_DASH;break}case w.GREATER_THAN_SIGN:{this._err(ae.abruptClosingOfEmptyComment),this.state=M.DATA;const t=this.currentToken;this.emitCurrentComment(t);break}default:this.state=M.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){const t=this.currentToken;switch(e){case w.HYPHEN_MINUS:{this.state=M.COMMENT_END;break}case w.GREATER_THAN_SIGN:{this._err(ae.abruptClosingOfEmptyComment),this.state=M.DATA,this.emitCurrentComment(t);break}case w.EOF:{this._err(ae.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break}default:t.data+="-",this.state=M.COMMENT,this._stateComment(e)}}_stateComment(e){const t=this.currentToken;switch(e){case w.HYPHEN_MINUS:{this.state=M.COMMENT_END_DASH;break}case w.LESS_THAN_SIGN:{t.data+="<",this.state=M.COMMENT_LESS_THAN_SIGN;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),t.data+=_t;break}case w.EOF:{this._err(ae.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break}default:t.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const t=this.currentToken;switch(e){case w.EXCLAMATION_MARK:{t.data+="!",this.state=M.COMMENT_LESS_THAN_SIGN_BANG;break}case w.LESS_THAN_SIGN:{t.data+="<";break}default:this.state=M.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===w.HYPHEN_MINUS?this.state=M.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=M.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===w.HYPHEN_MINUS?this.state=M.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=M.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==w.GREATER_THAN_SIGN&&e!==w.EOF&&this._err(ae.nestedComment),this.state=M.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){const t=this.currentToken;switch(e){case w.HYPHEN_MINUS:{this.state=M.COMMENT_END;break}case w.EOF:{this._err(ae.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break}default:t.data+="-",this.state=M.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){const t=this.currentToken;switch(e){case w.GREATER_THAN_SIGN:{this.state=M.DATA,this.emitCurrentComment(t);break}case w.EXCLAMATION_MARK:{this.state=M.COMMENT_END_BANG;break}case w.HYPHEN_MINUS:{t.data+="-";break}case w.EOF:{this._err(ae.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break}default:t.data+="--",this.state=M.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){const t=this.currentToken;switch(e){case w.HYPHEN_MINUS:{t.data+="--!",this.state=M.COMMENT_END_DASH;break}case w.GREATER_THAN_SIGN:{this._err(ae.incorrectlyClosedComment),this.state=M.DATA,this.emitCurrentComment(t);break}case w.EOF:{this._err(ae.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break}default:t.data+="--!",this.state=M.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=M.BEFORE_DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this.state=M.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break}case w.EOF:{this._err(ae.eofInDoctype),this._createDoctypeToken(null);const t=this.currentToken;t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._err(ae.missingWhitespaceBeforeDoctypeName),this.state=M.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(tl(e))this._createDoctypeToken(String.fromCharCode(Td(e))),this.state=M.DOCTYPE_NAME;else switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.NULL:{this._err(ae.unexpectedNullCharacter),this._createDoctypeToken(_t),this.state=M.DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this._err(ae.missingDoctypeName),this._createDoctypeToken(null);const t=this.currentToken;t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=M.DATA;break}case w.EOF:{this._err(ae.eofInDoctype),this._createDoctypeToken(null);const t=this.currentToken;t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=M.DOCTYPE_NAME}}_stateDoctypeName(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=M.AFTER_DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this.state=M.DATA,this.emitCurrentDoctype(t);break}case w.NULL:{this._err(ae.unexpectedNullCharacter),t.name+=_t;break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:t.name+=String.fromCodePoint(tl(e)?Td(e):e)}}_stateAfterDoctypeName(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.state=M.DATA,this.emitCurrentDoctype(t);break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(js.PUBLIC,!1)?this.state=M.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(js.SYSTEM,!1)?this.state=M.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(ae.invalidCharacterSequenceAfterDoctypeName),t.forceQuirks=!0,this.state=M.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=M.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.QUOTATION_MARK:{this._err(ae.missingWhitespaceAfterDoctypePublicKeyword),t.publicId="",this.state=M.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(ae.missingWhitespaceAfterDoctypePublicKeyword),t.publicId="",this.state=M.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(ae.missingDoctypePublicIdentifier),t.forceQuirks=!0,this.state=M.DATA,this.emitCurrentDoctype(t);break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._err(ae.missingQuoteBeforeDoctypePublicIdentifier),t.forceQuirks=!0,this.state=M.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{t.publicId="",this.state=M.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{t.publicId="",this.state=M.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(ae.missingDoctypePublicIdentifier),t.forceQuirks=!0,this.state=M.DATA,this.emitCurrentDoctype(t);break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._err(ae.missingQuoteBeforeDoctypePublicIdentifier),t.forceQuirks=!0,this.state=M.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const t=this.currentToken;switch(e){case w.QUOTATION_MARK:{this.state=M.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),t.publicId+=_t;break}case w.GREATER_THAN_SIGN:{this._err(ae.abruptDoctypePublicIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=M.DATA;break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:t.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const t=this.currentToken;switch(e){case w.APOSTROPHE:{this.state=M.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),t.publicId+=_t;break}case w.GREATER_THAN_SIGN:{this._err(ae.abruptDoctypePublicIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=M.DATA;break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:t.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=M.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case w.GREATER_THAN_SIGN:{this.state=M.DATA,this.emitCurrentDoctype(t);break}case w.QUOTATION_MARK:{this._err(ae.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),t.systemId="",this.state=M.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(ae.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),t.systemId="",this.state=M.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._err(ae.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=M.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(t),this.state=M.DATA;break}case w.QUOTATION_MARK:{t.systemId="",this.state=M.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{t.systemId="",this.state=M.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._err(ae.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=M.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=M.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.QUOTATION_MARK:{this._err(ae.missingWhitespaceAfterDoctypeSystemKeyword),t.systemId="",this.state=M.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(ae.missingWhitespaceAfterDoctypeSystemKeyword),t.systemId="",this.state=M.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(ae.missingDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=M.DATA,this.emitCurrentDoctype(t);break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._err(ae.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=M.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{t.systemId="",this.state=M.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{t.systemId="",this.state=M.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(ae.missingDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=M.DATA,this.emitCurrentDoctype(t);break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._err(ae.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=M.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const t=this.currentToken;switch(e){case w.QUOTATION_MARK:{this.state=M.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),t.systemId+=_t;break}case w.GREATER_THAN_SIGN:{this._err(ae.abruptDoctypeSystemIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=M.DATA;break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:t.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const t=this.currentToken;switch(e){case w.APOSTROPHE:{this.state=M.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.NULL:{this._err(ae.unexpectedNullCharacter),t.systemId+=_t;break}case w.GREATER_THAN_SIGN:{this._err(ae.abruptDoctypeSystemIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=M.DATA;break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:t.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const t=this.currentToken;switch(e){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(t),this.state=M.DATA;break}case w.EOF:{this._err(ae.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break}default:this._err(ae.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=M.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const t=this.currentToken;switch(e){case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(t),this.state=M.DATA;break}case w.NULL:{this._err(ae.unexpectedNullCharacter);break}case w.EOF:{this.emitCurrentDoctype(t),this._emitEOFToken();break}}}_stateCdataSection(e){switch(e){case w.RIGHT_SQUARE_BRACKET:{this.state=M.CDATA_SECTION_BRACKET;break}case w.EOF:{this._err(ae.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===w.RIGHT_SQUARE_BRACKET?this.state=M.CDATA_SECTION_END:(this._emitChars("]"),this.state=M.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case w.GREATER_THAN_SIGN:{this.state=M.DATA;break}case w.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=M.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(){let e=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(e<0)if(this.preprocessor.lastChunkWritten)e=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}e===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(w.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&ST(this.preprocessor.peek(1))?M.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(e){ST(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===w.SEMICOLON&&this._err(ae.unknownNamedCharacterReference),this.state=this.returnState,this._callState(e))}}const JS=new Set([v.DD,v.DT,v.LI,v.OPTGROUP,v.OPTION,v.P,v.RB,v.RP,v.RT,v.RTC]),_T=new Set([...JS,v.CAPTION,v.COLGROUP,v.TBODY,v.TD,v.TFOOT,v.TH,v.THEAD,v.TR]),bf=new Set([v.APPLET,v.CAPTION,v.HTML,v.MARQUEE,v.OBJECT,v.TABLE,v.TD,v.TEMPLATE,v.TH]),dO=new Set([...bf,v.OL,v.UL]),fO=new Set([...bf,v.BUTTON]),LT=new Set([v.ANNOTATION_XML,v.MI,v.MN,v.MO,v.MS,v.MTEXT]),RT=new Set([v.DESC,v.FOREIGN_OBJECT,v.TITLE]),hO=new Set([v.TR,v.TEMPLATE,v.HTML]),mO=new Set([v.TBODY,v.TFOOT,v.THEAD,v.TEMPLATE,v.HTML]),gO=new Set([v.TABLE,v.TEMPLATE,v.HTML]),pO=new Set([v.TD,v.TH]);class bO{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,t,i){this.treeAdapter=t,this.handler=i,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=v.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===v.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===me.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,t){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=t,this.currentTagId=t,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,t,!0)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,t){const i=this._indexOf(e);this.items[i]=t,i===this.stackTop&&(this.current=t)}insertAfter(e,t,i){const n=this._indexOf(e)+1;this.items.splice(n,0,t),this.tagIDs.splice(n,0,i),this.stackTop++,n===this.stackTop&&this._updateCurrentElement(),this.current&&this.currentTagId!==void 0&&this.handler.onItemPush(this.current,this.currentTagId,n===this.stackTop)}popUntilTagNamePopped(e){let t=this.stackTop+1;do t=this.tagIDs.lastIndexOf(e,t-1);while(t>0&&this.treeAdapter.getNamespaceURI(this.items[t])!==me.HTML);this.shortenToLength(Math.max(t,0))}shortenToLength(e){for(;this.stackTop>=e;){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,this.stackTop<e)}}popUntilElementPopped(e){const t=this._indexOf(e);this.shortenToLength(Math.max(t,0))}popUntilPopped(e,t){const i=this._indexOfTagNames(e,t);this.shortenToLength(Math.max(i,0))}popUntilNumberedHeaderPopped(){this.popUntilPopped(Og,me.HTML)}popUntilTableCellPopped(){this.popUntilPopped(pO,me.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,t){for(let i=this.stackTop;i>=0;i--)if(e.has(this.tagIDs[i])&&this.treeAdapter.getNamespaceURI(this.items[i])===t)return i;return-1}clearBackTo(e,t){const i=this._indexOfTagNames(e,t);this.shortenToLength(i+1)}clearBackToTableContext(){this.clearBackTo(gO,me.HTML)}clearBackToTableBodyContext(){this.clearBackTo(mO,me.HTML)}clearBackToTableRowContext(){this.clearBackTo(hO,me.HTML)}remove(e){const t=this._indexOf(e);t>=0&&(t===this.stackTop?this.pop():(this.items.splice(t,1),this.tagIDs.splice(t,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===v.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const t=this._indexOf(e)-1;return t>=0?this.items[t]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===v.HTML}hasInDynamicScope(e,t){for(let i=this.stackTop;i>=0;i--){const n=this.tagIDs[i];switch(this.treeAdapter.getNamespaceURI(this.items[i])){case me.HTML:{if(n===e)return!0;if(t.has(n))return!1;break}case me.SVG:{if(RT.has(n))return!1;break}case me.MATHML:{if(LT.has(n))return!1;break}}}return!0}hasInScope(e){return this.hasInDynamicScope(e,bf)}hasInListItemScope(e){return this.hasInDynamicScope(e,dO)}hasInButtonScope(e){return this.hasInDynamicScope(e,fO)}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const t=this.tagIDs[e];switch(this.treeAdapter.getNamespaceURI(this.items[e])){case me.HTML:{if(Og.has(t))return!0;if(bf.has(t))return!1;break}case me.SVG:{if(RT.has(t))return!1;break}case me.MATHML:{if(LT.has(t))return!1;break}}}return!0}hasInTableScope(e){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===me.HTML)switch(this.tagIDs[t]){case e:return!0;case v.TABLE:case v.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--)if(this.treeAdapter.getNamespaceURI(this.items[e])===me.HTML)switch(this.tagIDs[e]){case v.TBODY:case v.THEAD:case v.TFOOT:return!0;case v.TABLE:case v.HTML:return!1}return!0}hasInSelectScope(e){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===me.HTML)switch(this.tagIDs[t]){case e:return!0;case v.OPTION:case v.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;this.currentTagId!==void 0&&JS.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;this.currentTagId!==void 0&&_T.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==void 0&&this.currentTagId!==e&&_T.has(this.currentTagId);)this.pop()}}const Um=3;var Ji;(function(s){s[s.Marker=0]="Marker",s[s.Element=1]="Element"})(Ji||(Ji={}));const IT={type:Ji.Marker};class EO{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,t){const i=[],n=t.length,a=this.treeAdapter.getTagName(e),o=this.treeAdapter.getNamespaceURI(e);for(let c=0;c<this.entries.length;c++){const f=this.entries[c];if(f.type===Ji.Marker)break;const{element:d}=f;if(this.treeAdapter.getTagName(d)===a&&this.treeAdapter.getNamespaceURI(d)===o){const m=this.treeAdapter.getAttrList(d);m.length===n&&i.push({idx:c,attrs:m})}}return i}_ensureNoahArkCondition(e){if(this.entries.length<Um)return;const t=this.treeAdapter.getAttrList(e),i=this._getNoahArkConditionCandidates(e,t);if(i.length<Um)return;const n=new Map(t.map(o=>[o.name,o.value]));let a=0;for(let o=0;o<i.length;o++){const c=i[o];c.attrs.every(f=>n.get(f.name)===f.value)&&(a+=1,a>=Um&&this.entries.splice(c.idx,1))}}insertMarker(){this.entries.unshift(IT)}pushElement(e,t){this._ensureNoahArkCondition(e),this.entries.unshift({type:Ji.Element,element:e,token:t})}insertElementAfterBookmark(e,t){const i=this.entries.indexOf(this.bookmark);this.entries.splice(i,0,{type:Ji.Element,element:e,token:t})}removeEntry(e){const t=this.entries.indexOf(e);t!==-1&&this.entries.splice(t,1)}clearToLastMarker(){const e=this.entries.indexOf(IT);e===-1?this.entries.length=0:this.entries.splice(0,e+1)}getElementEntryInScopeWithTagName(e){const t=this.entries.find(i=>i.type===Ji.Marker||this.treeAdapter.getTagName(i.element)===e);return t&&t.type===Ji.Element?t:null}getElementEntry(e){return this.entries.find(t=>t.type===Ji.Element&&t.element===e)}}const kn={createDocument(){return{nodeName:"#document",mode:oi.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(s,e,t){return{nodeName:s,tagName:s,attrs:t,namespaceURI:e,childNodes:[],parentNode:null}},createCommentNode(s){return{nodeName:"#comment",data:s,parentNode:null}},createTextNode(s){return{nodeName:"#text",value:s,parentNode:null}},appendChild(s,e){s.childNodes.push(e),e.parentNode=s},insertBefore(s,e,t){const i=s.childNodes.indexOf(t);s.childNodes.splice(i,0,e),e.parentNode=s},setTemplateContent(s,e){s.content=e},getTemplateContent(s){return s.content},setDocumentType(s,e,t,i){const n=s.childNodes.find(a=>a.nodeName==="#documentType");if(n)n.name=e,n.publicId=t,n.systemId=i;else{const a={nodeName:"#documentType",name:e,publicId:t,systemId:i,parentNode:null};kn.appendChild(s,a)}},setDocumentMode(s,e){s.mode=e},getDocumentMode(s){return s.mode},detachNode(s){if(s.parentNode){const e=s.parentNode.childNodes.indexOf(s);s.parentNode.childNodes.splice(e,1),s.parentNode=null}},insertText(s,e){if(s.childNodes.length>0){const t=s.childNodes[s.childNodes.length-1];if(kn.isTextNode(t)){t.value+=e;return}}kn.appendChild(s,kn.createTextNode(e))},insertTextBefore(s,e,t){const i=s.childNodes[s.childNodes.indexOf(t)-1];i&&kn.isTextNode(i)?i.value+=e:kn.insertBefore(s,kn.createTextNode(e),t)},adoptAttributes(s,e){const t=new Set(s.attrs.map(i=>i.name));for(let i=0;i<e.length;i++)t.has(e[i].name)||s.attrs.push(e[i])},getFirstChild(s){return s.childNodes[0]},getChildNodes(s){return s.childNodes},getParentNode(s){return s.parentNode},getAttrList(s){return s.attrs},getTagName(s){return s.tagName},getNamespaceURI(s){return s.namespaceURI},getTextNodeContent(s){return s.value},getCommentNodeContent(s){return s.data},getDocumentTypeNodeName(s){return s.name},getDocumentTypeNodePublicId(s){return s.publicId},getDocumentTypeNodeSystemId(s){return s.systemId},isTextNode(s){return s.nodeName==="#text"},isCommentNode(s){return s.nodeName==="#comment"},isDocumentTypeNode(s){return s.nodeName==="#documentType"},isElementNode(s){return Object.prototype.hasOwnProperty.call(s,"tagName")},setNodeSourceCodeLocation(s,e){s.sourceCodeLocation=e},getNodeSourceCodeLocation(s){return s.sourceCodeLocation},updateNodeSourceCodeLocation(s,e){s.sourceCodeLocation={...s.sourceCodeLocation,...e}}},eA="html",yO="about:legacy-compat",xO="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",tA=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],TO=[...tA,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],vO=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),sA=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],SO=[...sA,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function CT(s,e){return e.some(t=>s.startsWith(t))}function AO(s){return s.name===eA&&s.publicId===null&&(s.systemId===null||s.systemId===yO)}function _O(s){if(s.name!==eA)return oi.QUIRKS;const{systemId:e}=s;if(e&&e.toLowerCase()===xO)return oi.QUIRKS;let{publicId:t}=s;if(t!==null){if(t=t.toLowerCase(),vO.has(t))return oi.QUIRKS;let i=e===null?TO:tA;if(CT(t,i))return oi.QUIRKS;if(i=e===null?sA:SO,CT(t,i))return oi.LIMITED_QUIRKS}return oi.NO_QUIRKS}const NT={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},LO="definitionurl",RO="definitionURL",IO=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(s=>[s.toLowerCase(),s])),CO=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:me.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:me.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:me.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:me.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:me.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:me.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:me.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:me.XML}],["xml:space",{prefix:"xml",name:"space",namespace:me.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:me.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:me.XMLNS}]]),NO=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(s=>[s.toLowerCase(),s])),DO=new Set([v.B,v.BIG,v.BLOCKQUOTE,v.BODY,v.BR,v.CENTER,v.CODE,v.DD,v.DIV,v.DL,v.DT,v.EM,v.EMBED,v.H1,v.H2,v.H3,v.H4,v.H5,v.H6,v.HEAD,v.HR,v.I,v.IMG,v.LI,v.LISTING,v.MENU,v.META,v.NOBR,v.OL,v.P,v.PRE,v.RUBY,v.S,v.SMALL,v.SPAN,v.STRONG,v.STRIKE,v.SUB,v.SUP,v.TABLE,v.TT,v.U,v.UL,v.VAR]);function wO(s){const e=s.tagID;return e===v.FONT&&s.attrs.some(({name:i})=>i===ba.COLOR||i===ba.SIZE||i===ba.FACE)||DO.has(e)}function iA(s){for(let e=0;e<s.attrs.length;e++)if(s.attrs[e].name===LO){s.attrs[e].name=RO;break}}function nA(s){for(let e=0;e<s.attrs.length;e++){const t=IO.get(s.attrs[e].name);t!=null&&(s.attrs[e].name=t)}}function Up(s){for(let e=0;e<s.attrs.length;e++){const t=CO.get(s.attrs[e].name);t&&(s.attrs[e].prefix=t.prefix,s.attrs[e].name=t.name,s.attrs[e].namespace=t.namespace)}}function OO(s){const e=NO.get(s.tagName);e!=null&&(s.tagName=e,s.tagID=Yf(s.tagName))}function kO(s,e){return e===me.MATHML&&(s===v.MI||s===v.MO||s===v.MN||s===v.MS||s===v.MTEXT)}function MO(s,e,t){if(e===me.MATHML&&s===v.ANNOTATION_XML){for(let i=0;i<t.length;i++)if(t[i].name===ba.ENCODING){const n=t[i].value.toLowerCase();return n===NT.TEXT_HTML||n===NT.APPLICATION_XML}}return e===me.SVG&&(s===v.FOREIGN_OBJECT||s===v.DESC||s===v.TITLE)}function PO(s,e,t,i){return(!i||i===me.HTML)&&MO(s,e,t)||(!i||i===me.MATHML)&&kO(s,e)}const UO="hidden",BO=8,FO=3;var B;(function(s){s[s.INITIAL=0]="INITIAL",s[s.BEFORE_HTML=1]="BEFORE_HTML",s[s.BEFORE_HEAD=2]="BEFORE_HEAD",s[s.IN_HEAD=3]="IN_HEAD",s[s.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",s[s.AFTER_HEAD=5]="AFTER_HEAD",s[s.IN_BODY=6]="IN_BODY",s[s.TEXT=7]="TEXT",s[s.IN_TABLE=8]="IN_TABLE",s[s.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",s[s.IN_CAPTION=10]="IN_CAPTION",s[s.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",s[s.IN_TABLE_BODY=12]="IN_TABLE_BODY",s[s.IN_ROW=13]="IN_ROW",s[s.IN_CELL=14]="IN_CELL",s[s.IN_SELECT=15]="IN_SELECT",s[s.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",s[s.IN_TEMPLATE=17]="IN_TEMPLATE",s[s.AFTER_BODY=18]="AFTER_BODY",s[s.IN_FRAMESET=19]="IN_FRAMESET",s[s.AFTER_FRAMESET=20]="AFTER_FRAMESET",s[s.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",s[s.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(B||(B={}));const HO={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},rA=new Set([v.TABLE,v.TBODY,v.TFOOT,v.THEAD,v.TR]),DT={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:kn,onParseError:null};class aA{constructor(e,t,i=null,n=null){this.fragmentContext=i,this.scriptHandler=n,this.currentToken=null,this.stopped=!1,this.insertionMode=B.INITIAL,this.originalInsertionMode=B.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...DT,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=t??this.treeAdapter.createDocument(),this.tokenizer=new cO(this.options,this),this.activeFormattingElements=new EO(this.treeAdapter),this.fragmentContextID=i?Yf(this.treeAdapter.getTagName(i)):v.UNKNOWN,this._setContextModes(i??this.document,this.fragmentContextID),this.openElements=new bO(this.document,this.treeAdapter,this)}static parse(e,t){const i=new this(t);return i.tokenizer.write(e,!0),i.document}static getFragmentParser(e,t){const i={...DT,...t};e??(e=i.treeAdapter.createElement(X.TEMPLATE,me.HTML,[]));const n=i.treeAdapter.createElement("documentmock",me.HTML,[]),a=new this(i,n,e);return a.fragmentContextID===v.TEMPLATE&&a.tmplInsertionModeStack.unshift(B.IN_TEMPLATE),a._initTokenizerForFragmentParsing(),a._insertFakeRootElement(),a._resetInsertionMode(),a._findFormInFragmentContext(),a}getFragment(){const e=this.treeAdapter.getFirstChild(this.document),t=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,t),t}_err(e,t,i){var n;if(!this.onParseError)return;const a=(n=e.location)!==null&&n!==void 0?n:HO,o={code:t,startLine:a.startLine,startCol:a.startCol,startOffset:a.startOffset,endLine:i?a.startLine:a.endLine,endCol:i?a.startCol:a.endCol,endOffset:i?a.startOffset:a.endOffset};this.onParseError(o)}onItemPush(e,t,i){var n,a;(a=(n=this.treeAdapter).onItemPush)===null||a===void 0||a.call(n,e),i&&this.openElements.stackTop>0&&this._setContextModes(e,t)}onItemPop(e,t){var i,n;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),(n=(i=this.treeAdapter).onItemPop)===null||n===void 0||n.call(i,e,this.openElements.current),t){let a,o;this.openElements.stackTop===0&&this.fragmentContext?(a=this.fragmentContext,o=this.fragmentContextID):{current:a,currentTagId:o}=this.openElements,this._setContextModes(a,o)}}_setContextModes(e,t){const i=e===this.document||e&&this.treeAdapter.getNamespaceURI(e)===me.HTML;this.currentNotInHTML=!i,this.tokenizer.inForeignNode=!i&&e!==void 0&&t!==void 0&&!this._isIntegrationPoint(t,e)}_switchToTextParsing(e,t){this._insertElement(e,me.HTML),this.tokenizer.state=t,this.originalInsertionMode=this.insertionMode,this.insertionMode=B.TEXT}switchToPlaintextParsing(){this.insertionMode=B.TEXT,this.originalInsertionMode=B.IN_BODY,this.tokenizer.state=Vs.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===X.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==me.HTML))switch(this.fragmentContextID){case v.TITLE:case v.TEXTAREA:{this.tokenizer.state=Vs.RCDATA;break}case v.STYLE:case v.XMP:case v.IFRAME:case v.NOEMBED:case v.NOFRAMES:case v.NOSCRIPT:{this.tokenizer.state=Vs.RAWTEXT;break}case v.SCRIPT:{this.tokenizer.state=Vs.SCRIPT_DATA;break}case v.PLAINTEXT:{this.tokenizer.state=Vs.PLAINTEXT;break}}}_setDocumentType(e){const t=e.name||"",i=e.publicId||"",n=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,t,i,n),e.location){const o=this.treeAdapter.getChildNodes(this.document).find(c=>this.treeAdapter.isDocumentTypeNode(c));o&&this.treeAdapter.setNodeSourceCodeLocation(o,e.location)}}_attachElementToTree(e,t){if(this.options.sourceCodeLocationInfo){const i=t&&{...t,startTag:t};this.treeAdapter.setNodeSourceCodeLocation(e,i)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const i=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(i??this.document,e)}}_appendElement(e,t){const i=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(i,e.location)}_insertElement(e,t){const i=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(i,e.location),this.openElements.push(i,e.tagID)}_insertFakeElement(e,t){const i=this.treeAdapter.createElement(e,me.HTML,[]);this._attachElementToTree(i,null),this.openElements.push(i,t)}_insertTemplate(e){const t=this.treeAdapter.createElement(e.tagName,me.HTML,e.attrs),i=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(t,i),this._attachElementToTree(t,e.location),this.openElements.push(t,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(X.HTML,me.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,v.HTML)}_appendCommentNode(e,t){const i=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(t,i),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,e.location)}_insertCharacters(e){let t,i;if(this._shouldFosterParentOnInsertion()?({parent:t,beforeElement:i}=this._findFosterParentingLocation(),i?this.treeAdapter.insertTextBefore(t,e.chars,i):this.treeAdapter.insertText(t,e.chars)):(t=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(t,e.chars)),!e.location)return;const n=this.treeAdapter.getChildNodes(t),a=i?n.lastIndexOf(i):n.length,o=n[a-1];if(this.treeAdapter.getNodeSourceCodeLocation(o)){const{endLine:f,endCol:d,endOffset:m}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(o,{endLine:f,endCol:d,endOffset:m})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(o,e.location)}_adoptNodes(e,t){for(let i=this.treeAdapter.getFirstChild(e);i;i=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(i),this.treeAdapter.appendChild(t,i)}_setEndLocation(e,t){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&t.location){const i=t.location,n=this.treeAdapter.getTagName(e),a=t.type===it.END_TAG&&n===t.tagName?{endTag:{...i},endLine:i.endLine,endCol:i.endCol,endOffset:i.endOffset}:{endLine:i.startLine,endCol:i.startCol,endOffset:i.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,a)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let t,i;return this.openElements.stackTop===0&&this.fragmentContext?(t=this.fragmentContext,i=this.fragmentContextID):{current:t,currentTagId:i}=this.openElements,e.tagID===v.SVG&&this.treeAdapter.getTagName(t)===X.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(t)===me.MATHML?!1:this.tokenizer.inForeignNode||(e.tagID===v.MGLYPH||e.tagID===v.MALIGNMARK)&&i!==void 0&&!this._isIntegrationPoint(i,t,me.HTML)}_processToken(e){switch(e.type){case it.CHARACTER:{this.onCharacter(e);break}case it.NULL_CHARACTER:{this.onNullCharacter(e);break}case it.COMMENT:{this.onComment(e);break}case it.DOCTYPE:{this.onDoctype(e);break}case it.START_TAG:{this._processStartTag(e);break}case it.END_TAG:{this.onEndTag(e);break}case it.EOF:{this.onEof(e);break}case it.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(e);break}}}_isIntegrationPoint(e,t,i){const n=this.treeAdapter.getNamespaceURI(t),a=this.treeAdapter.getAttrList(t);return PO(e,n,a,i)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const t=this.activeFormattingElements.entries.findIndex(n=>n.type===Ji.Marker||this.openElements.contains(n.element)),i=t===-1?e-1:t-1;for(let n=i;n>=0;n--){const a=this.activeFormattingElements.entries[n];this._insertElement(a.token,this.treeAdapter.getNamespaceURI(a.element)),a.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=B.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(v.P),this.openElements.popUntilTagNamePopped(v.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case v.TR:{this.insertionMode=B.IN_ROW;return}case v.TBODY:case v.THEAD:case v.TFOOT:{this.insertionMode=B.IN_TABLE_BODY;return}case v.CAPTION:{this.insertionMode=B.IN_CAPTION;return}case v.COLGROUP:{this.insertionMode=B.IN_COLUMN_GROUP;return}case v.TABLE:{this.insertionMode=B.IN_TABLE;return}case v.BODY:{this.insertionMode=B.IN_BODY;return}case v.FRAMESET:{this.insertionMode=B.IN_FRAMESET;return}case v.SELECT:{this._resetInsertionModeForSelect(e);return}case v.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case v.HTML:{this.insertionMode=this.headElement?B.AFTER_HEAD:B.BEFORE_HEAD;return}case v.TD:case v.TH:{if(e>0){this.insertionMode=B.IN_CELL;return}break}case v.HEAD:{if(e>0){this.insertionMode=B.IN_HEAD;return}break}}this.insertionMode=B.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let t=e-1;t>0;t--){const i=this.openElements.tagIDs[t];if(i===v.TEMPLATE)break;if(i===v.TABLE){this.insertionMode=B.IN_SELECT_IN_TABLE;return}}this.insertionMode=B.IN_SELECT}_isElementCausesFosterParenting(e){return rA.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this.openElements.currentTagId!==void 0&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const t=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case v.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(t)===me.HTML)return{parent:this.treeAdapter.getTemplateContent(t),beforeElement:null};break}case v.TABLE:{const i=this.treeAdapter.getParentNode(t);return i?{parent:i,beforeElement:t}:{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const t=this._findFosterParentingLocation();t.beforeElement?this.treeAdapter.insertBefore(t.parent,e,t.beforeElement):this.treeAdapter.appendChild(t.parent,e)}_isSpecialElement(e,t){const i=this.treeAdapter.getNamespaceURI(e);return nO[i].has(t)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){pk(this,e);return}switch(this.insertionMode){case B.INITIAL:{Zo(this,e);break}case B.BEFORE_HTML:{al(this,e);break}case B.BEFORE_HEAD:{ul(this,e);break}case B.IN_HEAD:{ol(this,e);break}case B.IN_HEAD_NO_SCRIPT:{ll(this,e);break}case B.AFTER_HEAD:{cl(this,e);break}case B.IN_BODY:case B.IN_CAPTION:case B.IN_CELL:case B.IN_TEMPLATE:{oA(this,e);break}case B.TEXT:case B.IN_SELECT:case B.IN_SELECT_IN_TABLE:{this._insertCharacters(e);break}case B.IN_TABLE:case B.IN_TABLE_BODY:case B.IN_ROW:{Bm(this,e);break}case B.IN_TABLE_TEXT:{mA(this,e);break}case B.IN_COLUMN_GROUP:{Ef(this,e);break}case B.AFTER_BODY:{yf(this,e);break}case B.AFTER_AFTER_BODY:{Vd(this,e);break}}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){gk(this,e);return}switch(this.insertionMode){case B.INITIAL:{Zo(this,e);break}case B.BEFORE_HTML:{al(this,e);break}case B.BEFORE_HEAD:{ul(this,e);break}case B.IN_HEAD:{ol(this,e);break}case B.IN_HEAD_NO_SCRIPT:{ll(this,e);break}case B.AFTER_HEAD:{cl(this,e);break}case B.TEXT:{this._insertCharacters(e);break}case B.IN_TABLE:case B.IN_TABLE_BODY:case B.IN_ROW:{Bm(this,e);break}case B.IN_COLUMN_GROUP:{Ef(this,e);break}case B.AFTER_BODY:{yf(this,e);break}case B.AFTER_AFTER_BODY:{Vd(this,e);break}}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML){kg(this,e);return}switch(this.insertionMode){case B.INITIAL:case B.BEFORE_HTML:case B.BEFORE_HEAD:case B.IN_HEAD:case B.IN_HEAD_NO_SCRIPT:case B.AFTER_HEAD:case B.IN_BODY:case B.IN_TABLE:case B.IN_CAPTION:case B.IN_COLUMN_GROUP:case B.IN_TABLE_BODY:case B.IN_ROW:case B.IN_CELL:case B.IN_SELECT:case B.IN_SELECT_IN_TABLE:case B.IN_TEMPLATE:case B.IN_FRAMESET:case B.AFTER_FRAMESET:{kg(this,e);break}case B.IN_TABLE_TEXT:{Jo(this,e);break}case B.AFTER_BODY:{YO(this,e);break}case B.AFTER_AFTER_BODY:case B.AFTER_AFTER_FRAMESET:{KO(this,e);break}}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case B.INITIAL:{QO(this,e);break}case B.BEFORE_HEAD:case B.IN_HEAD:case B.IN_HEAD_NO_SCRIPT:case B.AFTER_HEAD:{this._err(e,ae.misplacedDoctype);break}case B.IN_TABLE_TEXT:{Jo(this,e);break}}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,ae.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?bk(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case B.INITIAL:{Zo(this,e);break}case B.BEFORE_HTML:{XO(this,e);break}case B.BEFORE_HEAD:{ZO(this,e);break}case B.IN_HEAD:{Hi(this,e);break}case B.IN_HEAD_NO_SCRIPT:{t5(this,e);break}case B.AFTER_HEAD:{i5(this,e);break}case B.IN_BODY:{As(this,e);break}case B.IN_TABLE:{Hu(this,e);break}case B.IN_TABLE_TEXT:{Jo(this,e);break}case B.IN_CAPTION:{J5(this,e);break}case B.IN_COLUMN_GROUP:{Hp(this,e);break}case B.IN_TABLE_BODY:{Xf(this,e);break}case B.IN_ROW:{Wf(this,e);break}case B.IN_CELL:{sk(this,e);break}case B.IN_SELECT:{bA(this,e);break}case B.IN_SELECT_IN_TABLE:{nk(this,e);break}case B.IN_TEMPLATE:{ak(this,e);break}case B.AFTER_BODY:{ok(this,e);break}case B.IN_FRAMESET:{lk(this,e);break}case B.AFTER_FRAMESET:{dk(this,e);break}case B.AFTER_AFTER_BODY:{hk(this,e);break}case B.AFTER_AFTER_FRAMESET:{mk(this,e);break}}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?Ek(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case B.INITIAL:{Zo(this,e);break}case B.BEFORE_HTML:{WO(this,e);break}case B.BEFORE_HEAD:{JO(this,e);break}case B.IN_HEAD:{e5(this,e);break}case B.IN_HEAD_NO_SCRIPT:{s5(this,e);break}case B.AFTER_HEAD:{n5(this,e);break}case B.IN_BODY:{Qf(this,e);break}case B.TEXT:{G5(this,e);break}case B.IN_TABLE:{Al(this,e);break}case B.IN_TABLE_TEXT:{Jo(this,e);break}case B.IN_CAPTION:{ek(this,e);break}case B.IN_COLUMN_GROUP:{tk(this,e);break}case B.IN_TABLE_BODY:{Mg(this,e);break}case B.IN_ROW:{pA(this,e);break}case B.IN_CELL:{ik(this,e);break}case B.IN_SELECT:{EA(this,e);break}case B.IN_SELECT_IN_TABLE:{rk(this,e);break}case B.IN_TEMPLATE:{uk(this,e);break}case B.AFTER_BODY:{xA(this,e);break}case B.IN_FRAMESET:{ck(this,e);break}case B.AFTER_FRAMESET:{fk(this,e);break}case B.AFTER_AFTER_BODY:{Vd(this,e);break}}}onEof(e){switch(this.insertionMode){case B.INITIAL:{Zo(this,e);break}case B.BEFORE_HTML:{al(this,e);break}case B.BEFORE_HEAD:{ul(this,e);break}case B.IN_HEAD:{ol(this,e);break}case B.IN_HEAD_NO_SCRIPT:{ll(this,e);break}case B.AFTER_HEAD:{cl(this,e);break}case B.IN_BODY:case B.IN_TABLE:case B.IN_CAPTION:case B.IN_COLUMN_GROUP:case B.IN_TABLE_BODY:case B.IN_ROW:case B.IN_CELL:case B.IN_SELECT:case B.IN_SELECT_IN_TABLE:{fA(this,e);break}case B.TEXT:{q5(this,e);break}case B.IN_TABLE_TEXT:{Jo(this,e);break}case B.IN_TEMPLATE:{yA(this,e);break}case B.AFTER_BODY:case B.IN_FRAMESET:case B.AFTER_FRAMESET:case B.AFTER_AFTER_BODY:case B.AFTER_AFTER_FRAMESET:{Fp(this,e);break}}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===w.LINE_FEED)){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(e);return}switch(this.insertionMode){case B.IN_HEAD:case B.IN_HEAD_NO_SCRIPT:case B.AFTER_HEAD:case B.TEXT:case B.IN_COLUMN_GROUP:case B.IN_SELECT:case B.IN_SELECT_IN_TABLE:case B.IN_FRAMESET:case B.AFTER_FRAMESET:{this._insertCharacters(e);break}case B.IN_BODY:case B.IN_CAPTION:case B.IN_CELL:case B.IN_TEMPLATE:case B.AFTER_BODY:case B.AFTER_AFTER_BODY:case B.AFTER_AFTER_FRAMESET:{uA(this,e);break}case B.IN_TABLE:case B.IN_TABLE_BODY:case B.IN_ROW:{Bm(this,e);break}case B.IN_TABLE_TEXT:{hA(this,e);break}}}}function jO(s,e){let t=s.activeFormattingElements.getElementEntryInScopeWithTagName(e.tagName);return t?s.openElements.contains(t.element)?s.openElements.hasInScope(e.tagID)||(t=null):(s.activeFormattingElements.removeEntry(t),t=null):dA(s,e),t}function $O(s,e){let t=null,i=s.openElements.stackTop;for(;i>=0;i--){const n=s.openElements.items[i];if(n===e.element)break;s._isSpecialElement(n,s.openElements.tagIDs[i])&&(t=n)}return t||(s.openElements.shortenToLength(Math.max(i,0)),s.activeFormattingElements.removeEntry(e)),t}function GO(s,e,t){let i=e,n=s.openElements.getCommonAncestor(e);for(let a=0,o=n;o!==t;a++,o=n){n=s.openElements.getCommonAncestor(o);const c=s.activeFormattingElements.getElementEntry(o),f=c&&a>=FO;!c||f?(f&&s.activeFormattingElements.removeEntry(c),s.openElements.remove(o)):(o=qO(s,c),i===e&&(s.activeFormattingElements.bookmark=c),s.treeAdapter.detachNode(i),s.treeAdapter.appendChild(o,i),i=o)}return i}function qO(s,e){const t=s.treeAdapter.getNamespaceURI(e.element),i=s.treeAdapter.createElement(e.token.tagName,t,e.token.attrs);return s.openElements.replace(e.element,i),e.element=i,i}function VO(s,e,t){const i=s.treeAdapter.getTagName(e),n=Yf(i);if(s._isElementCausesFosterParenting(n))s._fosterParentElement(t);else{const a=s.treeAdapter.getNamespaceURI(e);n===v.TEMPLATE&&a===me.HTML&&(e=s.treeAdapter.getTemplateContent(e)),s.treeAdapter.appendChild(e,t)}}function zO(s,e,t){const i=s.treeAdapter.getNamespaceURI(t.element),{token:n}=t,a=s.treeAdapter.createElement(n.tagName,i,n.attrs);s._adoptNodes(e,a),s.treeAdapter.appendChild(e,a),s.activeFormattingElements.insertElementAfterBookmark(a,n),s.activeFormattingElements.removeEntry(t),s.openElements.remove(t.element),s.openElements.insertAfter(e,a,n.tagID)}function Bp(s,e){for(let t=0;t<BO;t++){const i=jO(s,e);if(!i)break;const n=$O(s,i);if(!n)break;s.activeFormattingElements.bookmark=i;const a=GO(s,n,i.element),o=s.openElements.getCommonAncestor(i.element);s.treeAdapter.detachNode(a),o&&VO(s,o,a),zO(s,n,i)}}function kg(s,e){s._appendCommentNode(e,s.openElements.currentTmplContentOrNode)}function YO(s,e){s._appendCommentNode(e,s.openElements.items[0])}function KO(s,e){s._appendCommentNode(e,s.document)}function Fp(s,e){if(s.stopped=!0,e.location){const t=s.fragmentContext?0:2;for(let i=s.openElements.stackTop;i>=t;i--)s._setEndLocation(s.openElements.items[i],e);if(!s.fragmentContext&&s.openElements.stackTop>=0){const i=s.openElements.items[0],n=s.treeAdapter.getNodeSourceCodeLocation(i);if(n&&!n.endTag&&(s._setEndLocation(i,e),s.openElements.stackTop>=1)){const a=s.openElements.items[1],o=s.treeAdapter.getNodeSourceCodeLocation(a);o&&!o.endTag&&s._setEndLocation(a,e)}}}}function QO(s,e){s._setDocumentType(e);const t=e.forceQuirks?oi.QUIRKS:_O(e);AO(e)||s._err(e,ae.nonConformingDoctype),s.treeAdapter.setDocumentMode(s.document,t),s.insertionMode=B.BEFORE_HTML}function Zo(s,e){s._err(e,ae.missingDoctype,!0),s.treeAdapter.setDocumentMode(s.document,oi.QUIRKS),s.insertionMode=B.BEFORE_HTML,s._processToken(e)}function XO(s,e){e.tagID===v.HTML?(s._insertElement(e,me.HTML),s.insertionMode=B.BEFORE_HEAD):al(s,e)}function WO(s,e){const t=e.tagID;(t===v.HTML||t===v.HEAD||t===v.BODY||t===v.BR)&&al(s,e)}function al(s,e){s._insertFakeRootElement(),s.insertionMode=B.BEFORE_HEAD,s._processToken(e)}function ZO(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.HEAD:{s._insertElement(e,me.HTML),s.headElement=s.openElements.current,s.insertionMode=B.IN_HEAD;break}default:ul(s,e)}}function JO(s,e){const t=e.tagID;t===v.HEAD||t===v.BODY||t===v.HTML||t===v.BR?ul(s,e):s._err(e,ae.endTagWithoutMatchingOpenElement)}function ul(s,e){s._insertFakeElement(X.HEAD,v.HEAD),s.headElement=s.openElements.current,s.insertionMode=B.IN_HEAD,s._processToken(e)}function Hi(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.BASE:case v.BASEFONT:case v.BGSOUND:case v.LINK:case v.META:{s._appendElement(e,me.HTML),e.ackSelfClosing=!0;break}case v.TITLE:{s._switchToTextParsing(e,Vs.RCDATA);break}case v.NOSCRIPT:{s.options.scriptingEnabled?s._switchToTextParsing(e,Vs.RAWTEXT):(s._insertElement(e,me.HTML),s.insertionMode=B.IN_HEAD_NO_SCRIPT);break}case v.NOFRAMES:case v.STYLE:{s._switchToTextParsing(e,Vs.RAWTEXT);break}case v.SCRIPT:{s._switchToTextParsing(e,Vs.SCRIPT_DATA);break}case v.TEMPLATE:{s._insertTemplate(e),s.activeFormattingElements.insertMarker(),s.framesetOk=!1,s.insertionMode=B.IN_TEMPLATE,s.tmplInsertionModeStack.unshift(B.IN_TEMPLATE);break}case v.HEAD:{s._err(e,ae.misplacedStartTagForHeadElement);break}default:ol(s,e)}}function e5(s,e){switch(e.tagID){case v.HEAD:{s.openElements.pop(),s.insertionMode=B.AFTER_HEAD;break}case v.BODY:case v.BR:case v.HTML:{ol(s,e);break}case v.TEMPLATE:{Ra(s,e);break}default:s._err(e,ae.endTagWithoutMatchingOpenElement)}}function Ra(s,e){s.openElements.tmplCount>0?(s.openElements.generateImpliedEndTagsThoroughly(),s.openElements.currentTagId!==v.TEMPLATE&&s._err(e,ae.closingOfElementWithOpenChildElements),s.openElements.popUntilTagNamePopped(v.TEMPLATE),s.activeFormattingElements.clearToLastMarker(),s.tmplInsertionModeStack.shift(),s._resetInsertionMode()):s._err(e,ae.endTagWithoutMatchingOpenElement)}function ol(s,e){s.openElements.pop(),s.insertionMode=B.AFTER_HEAD,s._processToken(e)}function t5(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.BASEFONT:case v.BGSOUND:case v.HEAD:case v.LINK:case v.META:case v.NOFRAMES:case v.STYLE:{Hi(s,e);break}case v.NOSCRIPT:{s._err(e,ae.nestedNoscriptInHead);break}default:ll(s,e)}}function s5(s,e){switch(e.tagID){case v.NOSCRIPT:{s.openElements.pop(),s.insertionMode=B.IN_HEAD;break}case v.BR:{ll(s,e);break}default:s._err(e,ae.endTagWithoutMatchingOpenElement)}}function ll(s,e){const t=e.type===it.EOF?ae.openElementsLeftAfterEof:ae.disallowedContentInNoscriptInHead;s._err(e,t),s.openElements.pop(),s.insertionMode=B.IN_HEAD,s._processToken(e)}function i5(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.BODY:{s._insertElement(e,me.HTML),s.framesetOk=!1,s.insertionMode=B.IN_BODY;break}case v.FRAMESET:{s._insertElement(e,me.HTML),s.insertionMode=B.IN_FRAMESET;break}case v.BASE:case v.BASEFONT:case v.BGSOUND:case v.LINK:case v.META:case v.NOFRAMES:case v.SCRIPT:case v.STYLE:case v.TEMPLATE:case v.TITLE:{s._err(e,ae.abandonedHeadElementChild),s.openElements.push(s.headElement,v.HEAD),Hi(s,e),s.openElements.remove(s.headElement);break}case v.HEAD:{s._err(e,ae.misplacedStartTagForHeadElement);break}default:cl(s,e)}}function n5(s,e){switch(e.tagID){case v.BODY:case v.HTML:case v.BR:{cl(s,e);break}case v.TEMPLATE:{Ra(s,e);break}default:s._err(e,ae.endTagWithoutMatchingOpenElement)}}function cl(s,e){s._insertFakeElement(X.BODY,v.BODY),s.insertionMode=B.IN_BODY,Kf(s,e)}function Kf(s,e){switch(e.type){case it.CHARACTER:{oA(s,e);break}case it.WHITESPACE_CHARACTER:{uA(s,e);break}case it.COMMENT:{kg(s,e);break}case it.START_TAG:{As(s,e);break}case it.END_TAG:{Qf(s,e);break}case it.EOF:{fA(s,e);break}}}function uA(s,e){s._reconstructActiveFormattingElements(),s._insertCharacters(e)}function oA(s,e){s._reconstructActiveFormattingElements(),s._insertCharacters(e),s.framesetOk=!1}function r5(s,e){s.openElements.tmplCount===0&&s.treeAdapter.adoptAttributes(s.openElements.items[0],e.attrs)}function a5(s,e){const t=s.openElements.tryPeekProperlyNestedBodyElement();t&&s.openElements.tmplCount===0&&(s.framesetOk=!1,s.treeAdapter.adoptAttributes(t,e.attrs))}function u5(s,e){const t=s.openElements.tryPeekProperlyNestedBodyElement();s.framesetOk&&t&&(s.treeAdapter.detachNode(t),s.openElements.popAllUpToHtmlElement(),s._insertElement(e,me.HTML),s.insertionMode=B.IN_FRAMESET)}function o5(s,e){s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s._insertElement(e,me.HTML)}function l5(s,e){s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s.openElements.currentTagId!==void 0&&Og.has(s.openElements.currentTagId)&&s.openElements.pop(),s._insertElement(e,me.HTML)}function c5(s,e){s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s._insertElement(e,me.HTML),s.skipNextNewLine=!0,s.framesetOk=!1}function d5(s,e){const t=s.openElements.tmplCount>0;(!s.formElement||t)&&(s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s._insertElement(e,me.HTML),t||(s.formElement=s.openElements.current))}function f5(s,e){s.framesetOk=!1;const t=e.tagID;for(let i=s.openElements.stackTop;i>=0;i--){const n=s.openElements.tagIDs[i];if(t===v.LI&&n===v.LI||(t===v.DD||t===v.DT)&&(n===v.DD||n===v.DT)){s.openElements.generateImpliedEndTagsWithExclusion(n),s.openElements.popUntilTagNamePopped(n);break}if(n!==v.ADDRESS&&n!==v.DIV&&n!==v.P&&s._isSpecialElement(s.openElements.items[i],n))break}s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s._insertElement(e,me.HTML)}function h5(s,e){s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s._insertElement(e,me.HTML),s.tokenizer.state=Vs.PLAINTEXT}function m5(s,e){s.openElements.hasInScope(v.BUTTON)&&(s.openElements.generateImpliedEndTags(),s.openElements.popUntilTagNamePopped(v.BUTTON)),s._reconstructActiveFormattingElements(),s._insertElement(e,me.HTML),s.framesetOk=!1}function g5(s,e){const t=s.activeFormattingElements.getElementEntryInScopeWithTagName(X.A);t&&(Bp(s,e),s.openElements.remove(t.element),s.activeFormattingElements.removeEntry(t)),s._reconstructActiveFormattingElements(),s._insertElement(e,me.HTML),s.activeFormattingElements.pushElement(s.openElements.current,e)}function p5(s,e){s._reconstructActiveFormattingElements(),s._insertElement(e,me.HTML),s.activeFormattingElements.pushElement(s.openElements.current,e)}function b5(s,e){s._reconstructActiveFormattingElements(),s.openElements.hasInScope(v.NOBR)&&(Bp(s,e),s._reconstructActiveFormattingElements()),s._insertElement(e,me.HTML),s.activeFormattingElements.pushElement(s.openElements.current,e)}function E5(s,e){s._reconstructActiveFormattingElements(),s._insertElement(e,me.HTML),s.activeFormattingElements.insertMarker(),s.framesetOk=!1}function y5(s,e){s.treeAdapter.getDocumentMode(s.document)!==oi.QUIRKS&&s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s._insertElement(e,me.HTML),s.framesetOk=!1,s.insertionMode=B.IN_TABLE}function lA(s,e){s._reconstructActiveFormattingElements(),s._appendElement(e,me.HTML),s.framesetOk=!1,e.ackSelfClosing=!0}function cA(s){const e=WS(s,ba.TYPE);return e!=null&&e.toLowerCase()===UO}function x5(s,e){s._reconstructActiveFormattingElements(),s._appendElement(e,me.HTML),cA(e)||(s.framesetOk=!1),e.ackSelfClosing=!0}function T5(s,e){s._appendElement(e,me.HTML),e.ackSelfClosing=!0}function v5(s,e){s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s._appendElement(e,me.HTML),s.framesetOk=!1,e.ackSelfClosing=!0}function S5(s,e){e.tagName=X.IMG,e.tagID=v.IMG,lA(s,e)}function A5(s,e){s._insertElement(e,me.HTML),s.skipNextNewLine=!0,s.tokenizer.state=Vs.RCDATA,s.originalInsertionMode=s.insertionMode,s.framesetOk=!1,s.insertionMode=B.TEXT}function _5(s,e){s.openElements.hasInButtonScope(v.P)&&s._closePElement(),s._reconstructActiveFormattingElements(),s.framesetOk=!1,s._switchToTextParsing(e,Vs.RAWTEXT)}function L5(s,e){s.framesetOk=!1,s._switchToTextParsing(e,Vs.RAWTEXT)}function wT(s,e){s._switchToTextParsing(e,Vs.RAWTEXT)}function R5(s,e){s._reconstructActiveFormattingElements(),s._insertElement(e,me.HTML),s.framesetOk=!1,s.insertionMode=s.insertionMode===B.IN_TABLE||s.insertionMode===B.IN_CAPTION||s.insertionMode===B.IN_TABLE_BODY||s.insertionMode===B.IN_ROW||s.insertionMode===B.IN_CELL?B.IN_SELECT_IN_TABLE:B.IN_SELECT}function I5(s,e){s.openElements.currentTagId===v.OPTION&&s.openElements.pop(),s._reconstructActiveFormattingElements(),s._insertElement(e,me.HTML)}function C5(s,e){s.openElements.hasInScope(v.RUBY)&&s.openElements.generateImpliedEndTags(),s._insertElement(e,me.HTML)}function N5(s,e){s.openElements.hasInScope(v.RUBY)&&s.openElements.generateImpliedEndTagsWithExclusion(v.RTC),s._insertElement(e,me.HTML)}function D5(s,e){s._reconstructActiveFormattingElements(),iA(e),Up(e),e.selfClosing?s._appendElement(e,me.MATHML):s._insertElement(e,me.MATHML),e.ackSelfClosing=!0}function w5(s,e){s._reconstructActiveFormattingElements(),nA(e),Up(e),e.selfClosing?s._appendElement(e,me.SVG):s._insertElement(e,me.SVG),e.ackSelfClosing=!0}function OT(s,e){s._reconstructActiveFormattingElements(),s._insertElement(e,me.HTML)}function As(s,e){switch(e.tagID){case v.I:case v.S:case v.B:case v.U:case v.EM:case v.TT:case v.BIG:case v.CODE:case v.FONT:case v.SMALL:case v.STRIKE:case v.STRONG:{p5(s,e);break}case v.A:{g5(s,e);break}case v.H1:case v.H2:case v.H3:case v.H4:case v.H5:case v.H6:{l5(s,e);break}case v.P:case v.DL:case v.OL:case v.UL:case v.DIV:case v.DIR:case v.NAV:case v.MAIN:case v.MENU:case v.ASIDE:case v.CENTER:case v.FIGURE:case v.FOOTER:case v.HEADER:case v.HGROUP:case v.DIALOG:case v.DETAILS:case v.ADDRESS:case v.ARTICLE:case v.SEARCH:case v.SECTION:case v.SUMMARY:case v.FIELDSET:case v.BLOCKQUOTE:case v.FIGCAPTION:{o5(s,e);break}case v.LI:case v.DD:case v.DT:{f5(s,e);break}case v.BR:case v.IMG:case v.WBR:case v.AREA:case v.EMBED:case v.KEYGEN:{lA(s,e);break}case v.HR:{v5(s,e);break}case v.RB:case v.RTC:{C5(s,e);break}case v.RT:case v.RP:{N5(s,e);break}case v.PRE:case v.LISTING:{c5(s,e);break}case v.XMP:{_5(s,e);break}case v.SVG:{w5(s,e);break}case v.HTML:{r5(s,e);break}case v.BASE:case v.LINK:case v.META:case v.STYLE:case v.TITLE:case v.SCRIPT:case v.BGSOUND:case v.BASEFONT:case v.TEMPLATE:{Hi(s,e);break}case v.BODY:{a5(s,e);break}case v.FORM:{d5(s,e);break}case v.NOBR:{b5(s,e);break}case v.MATH:{D5(s,e);break}case v.TABLE:{y5(s,e);break}case v.INPUT:{x5(s,e);break}case v.PARAM:case v.TRACK:case v.SOURCE:{T5(s,e);break}case v.IMAGE:{S5(s,e);break}case v.BUTTON:{m5(s,e);break}case v.APPLET:case v.OBJECT:case v.MARQUEE:{E5(s,e);break}case v.IFRAME:{L5(s,e);break}case v.SELECT:{R5(s,e);break}case v.OPTION:case v.OPTGROUP:{I5(s,e);break}case v.NOEMBED:case v.NOFRAMES:{wT(s,e);break}case v.FRAMESET:{u5(s,e);break}case v.TEXTAREA:{A5(s,e);break}case v.NOSCRIPT:{s.options.scriptingEnabled?wT(s,e):OT(s,e);break}case v.PLAINTEXT:{h5(s,e);break}case v.COL:case v.TH:case v.TD:case v.TR:case v.HEAD:case v.FRAME:case v.TBODY:case v.TFOOT:case v.THEAD:case v.CAPTION:case v.COLGROUP:break;default:OT(s,e)}}function O5(s,e){if(s.openElements.hasInScope(v.BODY)&&(s.insertionMode=B.AFTER_BODY,s.options.sourceCodeLocationInfo)){const t=s.openElements.tryPeekProperlyNestedBodyElement();t&&s._setEndLocation(t,e)}}function k5(s,e){s.openElements.hasInScope(v.BODY)&&(s.insertionMode=B.AFTER_BODY,xA(s,e))}function M5(s,e){const t=e.tagID;s.openElements.hasInScope(t)&&(s.openElements.generateImpliedEndTags(),s.openElements.popUntilTagNamePopped(t))}function P5(s){const e=s.openElements.tmplCount>0,{formElement:t}=s;e||(s.formElement=null),(t||e)&&s.openElements.hasInScope(v.FORM)&&(s.openElements.generateImpliedEndTags(),e?s.openElements.popUntilTagNamePopped(v.FORM):t&&s.openElements.remove(t))}function U5(s){s.openElements.hasInButtonScope(v.P)||s._insertFakeElement(X.P,v.P),s._closePElement()}function B5(s){s.openElements.hasInListItemScope(v.LI)&&(s.openElements.generateImpliedEndTagsWithExclusion(v.LI),s.openElements.popUntilTagNamePopped(v.LI))}function F5(s,e){const t=e.tagID;s.openElements.hasInScope(t)&&(s.openElements.generateImpliedEndTagsWithExclusion(t),s.openElements.popUntilTagNamePopped(t))}function H5(s){s.openElements.hasNumberedHeaderInScope()&&(s.openElements.generateImpliedEndTags(),s.openElements.popUntilNumberedHeaderPopped())}function j5(s,e){const t=e.tagID;s.openElements.hasInScope(t)&&(s.openElements.generateImpliedEndTags(),s.openElements.popUntilTagNamePopped(t),s.activeFormattingElements.clearToLastMarker())}function $5(s){s._reconstructActiveFormattingElements(),s._insertFakeElement(X.BR,v.BR),s.openElements.pop(),s.framesetOk=!1}function dA(s,e){const t=e.tagName,i=e.tagID;for(let n=s.openElements.stackTop;n>0;n--){const a=s.openElements.items[n],o=s.openElements.tagIDs[n];if(i===o&&(i!==v.UNKNOWN||s.treeAdapter.getTagName(a)===t)){s.openElements.generateImpliedEndTagsWithExclusion(i),s.openElements.stackTop>=n&&s.openElements.shortenToLength(n);break}if(s._isSpecialElement(a,o))break}}function Qf(s,e){switch(e.tagID){case v.A:case v.B:case v.I:case v.S:case v.U:case v.EM:case v.TT:case v.BIG:case v.CODE:case v.FONT:case v.NOBR:case v.SMALL:case v.STRIKE:case v.STRONG:{Bp(s,e);break}case v.P:{U5(s);break}case v.DL:case v.UL:case v.OL:case v.DIR:case v.DIV:case v.NAV:case v.PRE:case v.MAIN:case v.MENU:case v.ASIDE:case v.BUTTON:case v.CENTER:case v.FIGURE:case v.FOOTER:case v.HEADER:case v.HGROUP:case v.DIALOG:case v.ADDRESS:case v.ARTICLE:case v.DETAILS:case v.SEARCH:case v.SECTION:case v.SUMMARY:case v.LISTING:case v.FIELDSET:case v.BLOCKQUOTE:case v.FIGCAPTION:{M5(s,e);break}case v.LI:{B5(s);break}case v.DD:case v.DT:{F5(s,e);break}case v.H1:case v.H2:case v.H3:case v.H4:case v.H5:case v.H6:{H5(s);break}case v.BR:{$5(s);break}case v.BODY:{O5(s,e);break}case v.HTML:{k5(s,e);break}case v.FORM:{P5(s);break}case v.APPLET:case v.OBJECT:case v.MARQUEE:{j5(s,e);break}case v.TEMPLATE:{Ra(s,e);break}default:dA(s,e)}}function fA(s,e){s.tmplInsertionModeStack.length>0?yA(s,e):Fp(s,e)}function G5(s,e){var t;e.tagID===v.SCRIPT&&((t=s.scriptHandler)===null||t===void 0||t.call(s,s.openElements.current)),s.openElements.pop(),s.insertionMode=s.originalInsertionMode}function q5(s,e){s._err(e,ae.eofInElementThatCanContainOnlyText),s.openElements.pop(),s.insertionMode=s.originalInsertionMode,s.onEof(e)}function Bm(s,e){if(s.openElements.currentTagId!==void 0&&rA.has(s.openElements.currentTagId))switch(s.pendingCharacterTokens.length=0,s.hasNonWhitespacePendingCharacterToken=!1,s.originalInsertionMode=s.insertionMode,s.insertionMode=B.IN_TABLE_TEXT,e.type){case it.CHARACTER:{mA(s,e);break}case it.WHITESPACE_CHARACTER:{hA(s,e);break}}else zl(s,e)}function V5(s,e){s.openElements.clearBackToTableContext(),s.activeFormattingElements.insertMarker(),s._insertElement(e,me.HTML),s.insertionMode=B.IN_CAPTION}function z5(s,e){s.openElements.clearBackToTableContext(),s._insertElement(e,me.HTML),s.insertionMode=B.IN_COLUMN_GROUP}function Y5(s,e){s.openElements.clearBackToTableContext(),s._insertFakeElement(X.COLGROUP,v.COLGROUP),s.insertionMode=B.IN_COLUMN_GROUP,Hp(s,e)}function K5(s,e){s.openElements.clearBackToTableContext(),s._insertElement(e,me.HTML),s.insertionMode=B.IN_TABLE_BODY}function Q5(s,e){s.openElements.clearBackToTableContext(),s._insertFakeElement(X.TBODY,v.TBODY),s.insertionMode=B.IN_TABLE_BODY,Xf(s,e)}function X5(s,e){s.openElements.hasInTableScope(v.TABLE)&&(s.openElements.popUntilTagNamePopped(v.TABLE),s._resetInsertionMode(),s._processStartTag(e))}function W5(s,e){cA(e)?s._appendElement(e,me.HTML):zl(s,e),e.ackSelfClosing=!0}function Z5(s,e){!s.formElement&&s.openElements.tmplCount===0&&(s._insertElement(e,me.HTML),s.formElement=s.openElements.current,s.openElements.pop())}function Hu(s,e){switch(e.tagID){case v.TD:case v.TH:case v.TR:{Q5(s,e);break}case v.STYLE:case v.SCRIPT:case v.TEMPLATE:{Hi(s,e);break}case v.COL:{Y5(s,e);break}case v.FORM:{Z5(s,e);break}case v.TABLE:{X5(s,e);break}case v.TBODY:case v.TFOOT:case v.THEAD:{K5(s,e);break}case v.INPUT:{W5(s,e);break}case v.CAPTION:{V5(s,e);break}case v.COLGROUP:{z5(s,e);break}default:zl(s,e)}}function Al(s,e){switch(e.tagID){case v.TABLE:{s.openElements.hasInTableScope(v.TABLE)&&(s.openElements.popUntilTagNamePopped(v.TABLE),s._resetInsertionMode());break}case v.TEMPLATE:{Ra(s,e);break}case v.BODY:case v.CAPTION:case v.COL:case v.COLGROUP:case v.HTML:case v.TBODY:case v.TD:case v.TFOOT:case v.TH:case v.THEAD:case v.TR:break;default:zl(s,e)}}function zl(s,e){const t=s.fosterParentingEnabled;s.fosterParentingEnabled=!0,Kf(s,e),s.fosterParentingEnabled=t}function hA(s,e){s.pendingCharacterTokens.push(e)}function mA(s,e){s.pendingCharacterTokens.push(e),s.hasNonWhitespacePendingCharacterToken=!0}function Jo(s,e){let t=0;if(s.hasNonWhitespacePendingCharacterToken)for(;t<s.pendingCharacterTokens.length;t++)zl(s,s.pendingCharacterTokens[t]);else for(;t<s.pendingCharacterTokens.length;t++)s._insertCharacters(s.pendingCharacterTokens[t]);s.insertionMode=s.originalInsertionMode,s._processToken(e)}const gA=new Set([v.CAPTION,v.COL,v.COLGROUP,v.TBODY,v.TD,v.TFOOT,v.TH,v.THEAD,v.TR]);function J5(s,e){const t=e.tagID;gA.has(t)?s.openElements.hasInTableScope(v.CAPTION)&&(s.openElements.generateImpliedEndTags(),s.openElements.popUntilTagNamePopped(v.CAPTION),s.activeFormattingElements.clearToLastMarker(),s.insertionMode=B.IN_TABLE,Hu(s,e)):As(s,e)}function ek(s,e){const t=e.tagID;switch(t){case v.CAPTION:case v.TABLE:{s.openElements.hasInTableScope(v.CAPTION)&&(s.openElements.generateImpliedEndTags(),s.openElements.popUntilTagNamePopped(v.CAPTION),s.activeFormattingElements.clearToLastMarker(),s.insertionMode=B.IN_TABLE,t===v.TABLE&&Al(s,e));break}case v.BODY:case v.COL:case v.COLGROUP:case v.HTML:case v.TBODY:case v.TD:case v.TFOOT:case v.TH:case v.THEAD:case v.TR:break;default:Qf(s,e)}}function Hp(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.COL:{s._appendElement(e,me.HTML),e.ackSelfClosing=!0;break}case v.TEMPLATE:{Hi(s,e);break}default:Ef(s,e)}}function tk(s,e){switch(e.tagID){case v.COLGROUP:{s.openElements.currentTagId===v.COLGROUP&&(s.openElements.pop(),s.insertionMode=B.IN_TABLE);break}case v.TEMPLATE:{Ra(s,e);break}case v.COL:break;default:Ef(s,e)}}function Ef(s,e){s.openElements.currentTagId===v.COLGROUP&&(s.openElements.pop(),s.insertionMode=B.IN_TABLE,s._processToken(e))}function Xf(s,e){switch(e.tagID){case v.TR:{s.openElements.clearBackToTableBodyContext(),s._insertElement(e,me.HTML),s.insertionMode=B.IN_ROW;break}case v.TH:case v.TD:{s.openElements.clearBackToTableBodyContext(),s._insertFakeElement(X.TR,v.TR),s.insertionMode=B.IN_ROW,Wf(s,e);break}case v.CAPTION:case v.COL:case v.COLGROUP:case v.TBODY:case v.TFOOT:case v.THEAD:{s.openElements.hasTableBodyContextInTableScope()&&(s.openElements.clearBackToTableBodyContext(),s.openElements.pop(),s.insertionMode=B.IN_TABLE,Hu(s,e));break}default:Hu(s,e)}}function Mg(s,e){const t=e.tagID;switch(e.tagID){case v.TBODY:case v.TFOOT:case v.THEAD:{s.openElements.hasInTableScope(t)&&(s.openElements.clearBackToTableBodyContext(),s.openElements.pop(),s.insertionMode=B.IN_TABLE);break}case v.TABLE:{s.openElements.hasTableBodyContextInTableScope()&&(s.openElements.clearBackToTableBodyContext(),s.openElements.pop(),s.insertionMode=B.IN_TABLE,Al(s,e));break}case v.BODY:case v.CAPTION:case v.COL:case v.COLGROUP:case v.HTML:case v.TD:case v.TH:case v.TR:break;default:Al(s,e)}}function Wf(s,e){switch(e.tagID){case v.TH:case v.TD:{s.openElements.clearBackToTableRowContext(),s._insertElement(e,me.HTML),s.insertionMode=B.IN_CELL,s.activeFormattingElements.insertMarker();break}case v.CAPTION:case v.COL:case v.COLGROUP:case v.TBODY:case v.TFOOT:case v.THEAD:case v.TR:{s.openElements.hasInTableScope(v.TR)&&(s.openElements.clearBackToTableRowContext(),s.openElements.pop(),s.insertionMode=B.IN_TABLE_BODY,Xf(s,e));break}default:Hu(s,e)}}function pA(s,e){switch(e.tagID){case v.TR:{s.openElements.hasInTableScope(v.TR)&&(s.openElements.clearBackToTableRowContext(),s.openElements.pop(),s.insertionMode=B.IN_TABLE_BODY);break}case v.TABLE:{s.openElements.hasInTableScope(v.TR)&&(s.openElements.clearBackToTableRowContext(),s.openElements.pop(),s.insertionMode=B.IN_TABLE_BODY,Mg(s,e));break}case v.TBODY:case v.TFOOT:case v.THEAD:{(s.openElements.hasInTableScope(e.tagID)||s.openElements.hasInTableScope(v.TR))&&(s.openElements.clearBackToTableRowContext(),s.openElements.pop(),s.insertionMode=B.IN_TABLE_BODY,Mg(s,e));break}case v.BODY:case v.CAPTION:case v.COL:case v.COLGROUP:case v.HTML:case v.TD:case v.TH:break;default:Al(s,e)}}function sk(s,e){const t=e.tagID;gA.has(t)?(s.openElements.hasInTableScope(v.TD)||s.openElements.hasInTableScope(v.TH))&&(s._closeTableCell(),Wf(s,e)):As(s,e)}function ik(s,e){const t=e.tagID;switch(t){case v.TD:case v.TH:{s.openElements.hasInTableScope(t)&&(s.openElements.generateImpliedEndTags(),s.openElements.popUntilTagNamePopped(t),s.activeFormattingElements.clearToLastMarker(),s.insertionMode=B.IN_ROW);break}case v.TABLE:case v.TBODY:case v.TFOOT:case v.THEAD:case v.TR:{s.openElements.hasInTableScope(t)&&(s._closeTableCell(),pA(s,e));break}case v.BODY:case v.CAPTION:case v.COL:case v.COLGROUP:case v.HTML:break;default:Qf(s,e)}}function bA(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.OPTION:{s.openElements.currentTagId===v.OPTION&&s.openElements.pop(),s._insertElement(e,me.HTML);break}case v.OPTGROUP:{s.openElements.currentTagId===v.OPTION&&s.openElements.pop(),s.openElements.currentTagId===v.OPTGROUP&&s.openElements.pop(),s._insertElement(e,me.HTML);break}case v.HR:{s.openElements.currentTagId===v.OPTION&&s.openElements.pop(),s.openElements.currentTagId===v.OPTGROUP&&s.openElements.pop(),s._appendElement(e,me.HTML),e.ackSelfClosing=!0;break}case v.INPUT:case v.KEYGEN:case v.TEXTAREA:case v.SELECT:{s.openElements.hasInSelectScope(v.SELECT)&&(s.openElements.popUntilTagNamePopped(v.SELECT),s._resetInsertionMode(),e.tagID!==v.SELECT&&s._processStartTag(e));break}case v.SCRIPT:case v.TEMPLATE:{Hi(s,e);break}}}function EA(s,e){switch(e.tagID){case v.OPTGROUP:{s.openElements.stackTop>0&&s.openElements.currentTagId===v.OPTION&&s.openElements.tagIDs[s.openElements.stackTop-1]===v.OPTGROUP&&s.openElements.pop(),s.openElements.currentTagId===v.OPTGROUP&&s.openElements.pop();break}case v.OPTION:{s.openElements.currentTagId===v.OPTION&&s.openElements.pop();break}case v.SELECT:{s.openElements.hasInSelectScope(v.SELECT)&&(s.openElements.popUntilTagNamePopped(v.SELECT),s._resetInsertionMode());break}case v.TEMPLATE:{Ra(s,e);break}}}function nk(s,e){const t=e.tagID;t===v.CAPTION||t===v.TABLE||t===v.TBODY||t===v.TFOOT||t===v.THEAD||t===v.TR||t===v.TD||t===v.TH?(s.openElements.popUntilTagNamePopped(v.SELECT),s._resetInsertionMode(),s._processStartTag(e)):bA(s,e)}function rk(s,e){const t=e.tagID;t===v.CAPTION||t===v.TABLE||t===v.TBODY||t===v.TFOOT||t===v.THEAD||t===v.TR||t===v.TD||t===v.TH?s.openElements.hasInTableScope(t)&&(s.openElements.popUntilTagNamePopped(v.SELECT),s._resetInsertionMode(),s.onEndTag(e)):EA(s,e)}function ak(s,e){switch(e.tagID){case v.BASE:case v.BASEFONT:case v.BGSOUND:case v.LINK:case v.META:case v.NOFRAMES:case v.SCRIPT:case v.STYLE:case v.TEMPLATE:case v.TITLE:{Hi(s,e);break}case v.CAPTION:case v.COLGROUP:case v.TBODY:case v.TFOOT:case v.THEAD:{s.tmplInsertionModeStack[0]=B.IN_TABLE,s.insertionMode=B.IN_TABLE,Hu(s,e);break}case v.COL:{s.tmplInsertionModeStack[0]=B.IN_COLUMN_GROUP,s.insertionMode=B.IN_COLUMN_GROUP,Hp(s,e);break}case v.TR:{s.tmplInsertionModeStack[0]=B.IN_TABLE_BODY,s.insertionMode=B.IN_TABLE_BODY,Xf(s,e);break}case v.TD:case v.TH:{s.tmplInsertionModeStack[0]=B.IN_ROW,s.insertionMode=B.IN_ROW,Wf(s,e);break}default:s.tmplInsertionModeStack[0]=B.IN_BODY,s.insertionMode=B.IN_BODY,As(s,e)}}function uk(s,e){e.tagID===v.TEMPLATE&&Ra(s,e)}function yA(s,e){s.openElements.tmplCount>0?(s.openElements.popUntilTagNamePopped(v.TEMPLATE),s.activeFormattingElements.clearToLastMarker(),s.tmplInsertionModeStack.shift(),s._resetInsertionMode(),s.onEof(e)):Fp(s,e)}function ok(s,e){e.tagID===v.HTML?As(s,e):yf(s,e)}function xA(s,e){var t;if(e.tagID===v.HTML){if(s.fragmentContext||(s.insertionMode=B.AFTER_AFTER_BODY),s.options.sourceCodeLocationInfo&&s.openElements.tagIDs[0]===v.HTML){s._setEndLocation(s.openElements.items[0],e);const i=s.openElements.items[1];i&&!(!((t=s.treeAdapter.getNodeSourceCodeLocation(i))===null||t===void 0)&&t.endTag)&&s._setEndLocation(i,e)}}else yf(s,e)}function yf(s,e){s.insertionMode=B.IN_BODY,Kf(s,e)}function lk(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.FRAMESET:{s._insertElement(e,me.HTML);break}case v.FRAME:{s._appendElement(e,me.HTML),e.ackSelfClosing=!0;break}case v.NOFRAMES:{Hi(s,e);break}}}function ck(s,e){e.tagID===v.FRAMESET&&!s.openElements.isRootHtmlElementCurrent()&&(s.openElements.pop(),!s.fragmentContext&&s.openElements.currentTagId!==v.FRAMESET&&(s.insertionMode=B.AFTER_FRAMESET))}function dk(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.NOFRAMES:{Hi(s,e);break}}}function fk(s,e){e.tagID===v.HTML&&(s.insertionMode=B.AFTER_AFTER_FRAMESET)}function hk(s,e){e.tagID===v.HTML?As(s,e):Vd(s,e)}function Vd(s,e){s.insertionMode=B.IN_BODY,Kf(s,e)}function mk(s,e){switch(e.tagID){case v.HTML:{As(s,e);break}case v.NOFRAMES:{Hi(s,e);break}}}function gk(s,e){e.chars=_t,s._insertCharacters(e)}function pk(s,e){s._insertCharacters(e),s.framesetOk=!1}function TA(s){for(;s.treeAdapter.getNamespaceURI(s.openElements.current)!==me.HTML&&s.openElements.currentTagId!==void 0&&!s._isIntegrationPoint(s.openElements.currentTagId,s.openElements.current);)s.openElements.pop()}function bk(s,e){if(wO(e))TA(s),s._startTagOutsideForeignContent(e);else{const t=s._getAdjustedCurrentElement(),i=s.treeAdapter.getNamespaceURI(t);i===me.MATHML?iA(e):i===me.SVG&&(OO(e),nA(e)),Up(e),e.selfClosing?s._appendElement(e,i):s._insertElement(e,i),e.ackSelfClosing=!0}}function Ek(s,e){if(e.tagID===v.P||e.tagID===v.BR){TA(s),s._endTagOutsideForeignContent(e);return}for(let t=s.openElements.stackTop;t>0;t--){const i=s.openElements.items[t];if(s.treeAdapter.getNamespaceURI(i)===me.HTML){s._endTagOutsideForeignContent(e);break}const n=s.treeAdapter.getTagName(i);if(n.toLowerCase()===e.tagName){e.tagName=n,s.openElements.shortenToLength(t);break}}}function vA(s,e){return function(i){let n,a=0,o="";for(;n=s.exec(i);)a!==n.index&&(o+=i.substring(a,n.index)),o+=e.get(n[0].charCodeAt(0)),a=n.index+1;return o+i.substring(a)}}const yk=vA(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),xk=vA(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),Tk=new Set([X.AREA,X.BASE,X.BASEFONT,X.BGSOUND,X.BR,X.COL,X.EMBED,X.FRAME,X.HR,X.IMG,X.INPUT,X.KEYGEN,X.LINK,X.META,X.PARAM,X.SOURCE,X.TRACK,X.WBR]);function vk(s,e){return e.treeAdapter.isElementNode(s)&&e.treeAdapter.getNamespaceURI(s)===me.HTML&&Tk.has(e.treeAdapter.getTagName(s))}const Sk={treeAdapter:kn,scriptingEnabled:!0};function Ak(s,e){const t={...Sk,...e};return SA(s,t)}function _k(s,e){let t="";const i=e.treeAdapter.isElementNode(s)&&e.treeAdapter.getTagName(s)===X.TEMPLATE&&e.treeAdapter.getNamespaceURI(s)===me.HTML?e.treeAdapter.getTemplateContent(s):s,n=e.treeAdapter.getChildNodes(i);if(n)for(const a of n)t+=SA(a,e);return t}function SA(s,e){return e.treeAdapter.isElementNode(s)?Lk(s,e):e.treeAdapter.isTextNode(s)?Ik(s,e):e.treeAdapter.isCommentNode(s)?Ck(s,e):e.treeAdapter.isDocumentTypeNode(s)?Nk(s,e):""}function Lk(s,e){const t=e.treeAdapter.getTagName(s);return`<${t}${Rk(s,e)}>${vk(s,e)?"":`${_k(s,e)}</${t}>`}`}function Rk(s,{treeAdapter:e}){let t="";for(const i of e.getAttrList(s)){if(t+=" ",i.namespace)switch(i.namespace){case me.XML:{t+=`xml:${i.name}`;break}case me.XMLNS:{i.name!=="xmlns"&&(t+="xmlns:"),t+=i.name;break}case me.XLINK:{t+=`xlink:${i.name}`;break}default:t+=`${i.prefix}:${i.name}`}else t+=i.name;t+=`="${yk(i.value)}"`}return t}function Ik(s,e){const{treeAdapter:t}=e,i=t.getTextNodeContent(s),n=t.getParentNode(s),a=n&&t.isElementNode(n)&&t.getTagName(n);return a&&t.getNamespaceURI(n)===me.HTML&&aO(a,e.scriptingEnabled)?i:xk(i)}function Ck(s,{treeAdapter:e}){return`<!--${e.getCommentNodeContent(s)}-->`}function Nk(s,{treeAdapter:e}){return`<!DOCTYPE ${e.getDocumentTypeNodeName(s)}>`}function Dk(s,e){return aA.parse(s,e)}function wk(s,e,t){typeof s=="string"&&(t=e,e=s,s=null);const i=aA.getFragmentParser(s,t);return i.tokenizer.write(e,!0),i.getFragment()}function kT(s){const e=s.includes('"')?"'":'"';return e+s+e}function Ok(s,e,t){let i="!DOCTYPE ";return s&&(i+=s),e?i+=` PUBLIC ${kT(e)}`:t&&(i+=" SYSTEM"),t&&(i+=` ${kT(t)}`),i}const Tr={isCommentNode:$f,isElementNode:Oe,isTextNode:un,createDocument(){const s=new Ta([]);return s["x-mode"]=oi.NO_QUIRKS,s},createDocumentFragment(){return new Ta([])},createElement(s,e,t){const i=Object.create(null),n=Object.create(null),a=Object.create(null);for(let c=0;c<t.length;c++){const f=t[c].name;i[f]=t[c].value,n[f]=t[c].namespace,a[f]=t[c].prefix}const o=new Sp(s,i,[]);return o.namespace=e,o["x-attribsNamespace"]=n,o["x-attribsPrefix"]=a,o},createCommentNode(s){return new xp(s)},createTextNode(s){return new yl(s)},appendChild(s,e){const t=s.children[s.children.length-1];t&&(t.next=e,e.prev=t),s.children.push(e),e.parent=s},insertBefore(s,e,t){const i=s.children.indexOf(t),{prev:n}=t;n&&(n.next=e,e.prev=n),t.prev=e,e.next=t,s.children.splice(i,0,e),e.parent=s},setTemplateContent(s,e){Tr.appendChild(s,e)},getTemplateContent(s){return s.children[0]},setDocumentType(s,e,t,i){const n=Ok(e,t,i);let a=s.children.find(o=>Sg(o)&&o.name==="!doctype");a?a.data=n??null:(a=new Tp("!doctype",n),Tr.appendChild(s,a)),a["x-name"]=e,a["x-publicId"]=t,a["x-systemId"]=i},setDocumentMode(s,e){s["x-mode"]=e},getDocumentMode(s){return s["x-mode"]},detachNode(s){if(s.parent){const e=s.parent.children.indexOf(s),{prev:t,next:i}=s;s.prev=null,s.next=null,t&&(t.next=i),i&&(i.prev=t),s.parent.children.splice(e,1),s.parent=null}},insertText(s,e){const t=s.children[s.children.length-1];t&&un(t)?t.data+=e:Tr.appendChild(s,Tr.createTextNode(e))},insertTextBefore(s,e,t){const i=s.children[s.children.indexOf(t)-1];i&&un(i)?i.data+=e:Tr.insertBefore(s,Tr.createTextNode(e),t)},adoptAttributes(s,e){for(let t=0;t<e.length;t++){const i=e[t].name;s.attribs[i]===void 0&&(s.attribs[i]=e[t].value,s["x-attribsNamespace"][i]=e[t].namespace,s["x-attribsPrefix"][i]=e[t].prefix)}},getFirstChild(s){return s.children[0]},getChildNodes(s){return s.children},getParentNode(s){return s.parent},getAttrList(s){return s.attributes},getTagName(s){return s.name},getNamespaceURI(s){return s.namespace},getTextNodeContent(s){return s.data},getCommentNodeContent(s){return s.data},getDocumentTypeNodeName(s){var e;return(e=s["x-name"])!==null&&e!==void 0?e:""},getDocumentTypeNodePublicId(s){var e;return(e=s["x-publicId"])!==null&&e!==void 0?e:""},getDocumentTypeNodeSystemId(s){var e;return(e=s["x-systemId"])!==null&&e!==void 0?e:""},isDocumentTypeNode(s){return Sg(s)&&s.name==="!doctype"},setNodeSourceCodeLocation(s,e){e&&(s.startIndex=e.startOffset,s.endIndex=e.endOffset),s.sourceCodeLocation=e},getNodeSourceCodeLocation(s){return s.sourceCodeLocation},updateNodeSourceCodeLocation(s,e){e.endOffset!=null&&(s.endIndex=e.endOffset),s.sourceCodeLocation={...s.sourceCodeLocation,...e}}};function kk(s,e,t,i){var n;return(n=e.treeAdapter)!==null&&n!==void 0||(e.treeAdapter=Tr),e.scriptingEnabled!==!1&&(e.scriptingEnabled=!0),t?Dk(s,e):wk(i,s,e)}const Mk={treeAdapter:Tr};function Pk(s){const e="length"in s?s:[s];for(let i=0;i<e.length;i+=1){const n=e[i];Ur(n)&&Array.prototype.splice.call(e,i,1,...n.children)}let t="";for(let i=0;i<e.length;i+=1){const n=e[i];t+=Ak(n,Mk)}return t}const Uk=ow((s,e,t,i)=>e._useHtmlParser2?PD(s,e):kk(s,e,t,i)),Zf=jw(Uk,(s,e)=>e._useHtmlParser2?Gf(s,e):Pk(s)),Bk={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Cache-Control":"no-store","Accept-Language":"en-US,en;q=0.9",DNT:"1","sec-ch-ua":'"Not_A Brand";v="8", "Chromium";v="120", "Microsoft Edge";v="120"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1","Upgrade-Insecure-Requests":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0"},Fk=async({filter:s,page:e,providerContext:t,signal:i})=>{const n=t.baseUrl,a=`${n}/${s}/page/${e}/`;return AA(n,a,i)},Hk=async({searchQuery:s,page:e,providerContext:t,signal:i})=>{const n=t.baseUrl,a=`${n}/page/${e}/?s=${s}`;return AA(n,a,i)};async function AA(s,e,t){try{const i=await ut.get(e,{headers:{...Bk,Referer:s},signal:t}),n=Zf(i.data),a=[];return n(".blog-items, .post-list").children("article").each((o,c)=>{const f=n(c),d=f.find("a").first();let m=d.attr("title")||f.find(".post-title").text()||"";m=m.replace("Download","").trim();const g=m.match(/^(.*?)\s*\((\d{4})\)|^(.*?)\s*\((Season \d+)\)/);g&&(m=(g[1]||g[3]||m).trim());const p=d.attr("href")||"";let T=f.find("img").attr("data-lazy-src")||f.find("img").attr("data-src")||f.find("img").attr("src")||"";T.startsWith("//")&&(T="https:"+T),m&&p&&a.push({id:p,title:m,link:p,image:T,type:m.toLowerCase().includes("season")?"tv":"movie",provider:"vega"})}),a}catch(i){return console.error("Vega posts error:",i),[]}}const jk={hubcloudExtracter:async(s,e)=>{var t;try{const i=[],n=await ut.get(s,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",Referer:s},signal:e}),a=Zf(n.data);a("source").each((p,T)=>{const y=a(T).attr("src"),S=a(T).attr("type");y&&i.push({server:"HubCloud Direct",link:y.startsWith("http")?y:`https:${y}`,type:S!=null&&S.includes("m3u8")?"m3u8":"direct",quality:"1080"})}),a("video").each((p,T)=>{const y=a(T).attr("src");y&&i.push({server:"HubCloud Video",link:y.startsWith("http")?y:`https:${y}`,type:"direct",quality:"1080"})}),a("iframe").each((p,T)=>{const y=a(T).attr("src");y&&(y.includes("cloud")||y.includes("hub"))&&i.push({server:"HubCloud Embed",link:y.startsWith("http")?y:`https:${y}`,type:"iframe",quality:"720"})});const o=n.data,c=/(https?:\/\/[^\s"']+\.m3u8[^\s"']*)/g,f=o.match(c);f&&f.forEach(p=>{i.push({server:"HubCloud M3U8",link:p,type:"m3u8",quality:"1080"})});const d=/(https?:\/\/[^\s"']+\.mp4[^\s"']*)/g,m=o.match(d);m&&m.forEach(p=>{i.push({server:"HubCloud MP4",link:p,type:"direct",quality:"720"})});const g=i.filter((p,T,y)=>T===y.findIndex(S=>S.link===p.link));return console.log(`HubCloud extractor found ${g.length} streams from ${s}`),g}catch(i){return(t=i.message)!=null&&t.includes("aborted")?(console.log("HubCloud extraction aborted"),[]):(console.error("HubCloud extractor error:",i.message),[])}}},$k={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Cache-Control":"no-store","Accept-Language":"en-US,en;q=0.9",DNT:"1","sec-ch-ua":'"Not_A Brand";v="8", "Chromium";v="120", "Microsoft Edge";v="120"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1","Upgrade-Insecure-Requests":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0"},Gk=async({link:s,type:e,signal:t,providerContext:i})=>{var o,c,f,d;const{hubcloudExtracter:n}=jk,a=[];try{if(e==="movie"){const g=(await ut.get(s,{headers:$k,signal:t})).data,p=g.match(/<a\s+href="([^"]*cloud\.[^"]*)"/i);let T=p?p[1]:null;try{const S=Zf(g)('.btn.btn-sm.btn-outline[style="background:linear-gradient(135deg,rgb(252,185,0) 0%,rgb(0,0,0)); color: #fdf8f2;"]').parent().attr("href");if(S){const A=S.split("/").pop(),R=S.split("/").slice(0,-2).join("/"),C=await ut.post(`${R}/api/file/downlaod/`,{id:A,method:"indexDownlaod",captchaValue:null},{headers:{"Content-Type":"application/json",Referer:R}});if((o=C.data)!=null&&o.status){const I=C.data.data,D=await ut.post(`${R}/api/file/downlaod2/`,{id:I,method:"indexDownlaod",captchaValue:null},{headers:{"Content-Type":"application/json",Referer:R}});(f=(c=D.data)==null?void 0:c.data)!=null&&f[0]&&a.push({server:"filepress",link:D.data.data[0],type:"direct",quality:"720",headers:{Referer:R}})}}}catch(y){console.error("FilePress extraction failed:",y)}if(T){const y=await n(T,t);a.push(...y)}}return a}catch(m){return(d=m.message)!=null&&d.includes("Aborted")?[]:(console.error("Vega stream error:",m),[])}},qk={config:{id:"vega",name:"VegaMovies",baseUrl:"https://vegamovies.dad",enabled:!0,priority:25,type:"scraper",catalog:[{title:"Latest",filter:"",type:"both"},{title:"Movies",filter:"category/movies",type:"movie"},{title:"Web Series",filter:"category/web-series",type:"tv"},{title:"Bollywood",filter:"category/bollywood-movies",type:"movie"},{title:"Hollywood",filter:"category/hollywood-movies",type:"movie"},{title:"South Indian",filter:"category/south-indian-movies",type:"movie"},{title:"Dual Audio",filter:"category/dual-audio-movies",type:"movie"},{title:"4K Movies",filter:"category/4k-movies",type:"movie"}],genres:[]},getPosts:Fk,getSearchPosts:Hk,getStream:Gk,getMeta:async({link:s,providerContext:e})=>{try{const t=await ut.get(s,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"}}),i=Zf(t.data),n=i("h1.entry-title").text().trim()||"Unknown Title",a=i("div.entry-content p").first().text().trim()||"",o=i("div.entry-content img").first().attr("src")||"",c=[];return i('strong:contains("Cast:")').parent().text().replace("Cast:","").split(",").forEach(f=>c.push(f.trim())),{title:n,synopsis:a,image:o,provider:"vega",cast:c,linkList:[]}}catch(t){return console.error("Vega getMeta error:",t),{title:"Error",synopsis:"Failed to load metadata",image:"",provider:"vega"}}}},kt=[];kt.push({config:{id:"vidsrc",name:"VidSrc",baseUrl:"https://vidsrc.xyz",enabled:!0,priority:1,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("VidSrc",Xt.vidsrc),getSearchPosts:Yt});kt.push({config:{id:"embedapi",name:"Embed-API",baseUrl:"https://player.embed-api.stream",enabled:!0,priority:2,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Embed-API",Xt.embedapi),getSearchPosts:Yt});kt.push({config:{id:"superembed",name:"SuperEmbed",baseUrl:"https://multiembed.mov",enabled:!0,priority:3,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("SuperEmbed",Xt.superembed),getSearchPosts:Yt});kt.push({config:{id:"2embed",name:"2Embed",baseUrl:"https://www.2embed.cc",enabled:!0,priority:4,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("2Embed",Xt["2embed"]),getSearchPosts:Yt});kt.push({config:{id:"godriveplayer",name:"GoDrivePlayer",baseUrl:"https://godriveplayer.com",enabled:!0,priority:5,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("GoDrivePlayer",Xt.godriveplayer),getSearchPosts:Yt});kt.push({config:{id:"embedsu",name:"Embed.su",baseUrl:"https://embed.su",enabled:!0,priority:6,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Embed.su",Xt.embedsu),getSearchPosts:Yt});kt.push({config:{id:"nontongo",name:"NontonGo",baseUrl:"https://www.nontongo.win",enabled:!0,priority:7,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("NontonGo",Xt.nontongo),getSearchPosts:Yt});kt.push({config:{id:"autoembed",name:"Autoembed",baseUrl:"https://autoembed.co",enabled:!0,priority:8,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Autoembed",Xt.autoembed),getSearchPosts:Yt});kt.push({config:{id:"vidlink",name:"VidLink",baseUrl:"https://vidlink.pro",enabled:!0,priority:9,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("VidLink",Xt.vidlink),getSearchPosts:Yt});kt.push({config:{id:"smashystream",name:"Smashystream",baseUrl:"https://player.smashy.stream",enabled:!0,priority:10,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Smashystream",Xt.smashystream),getSearchPosts:Yt});kt.push({config:{id:"moviesapi",name:"MoviesAPI",baseUrl:"https://moviesapi.club",enabled:!0,priority:11,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("MoviesAPI",Xt.moviesapi),getSearchPosts:Yt});kt.push({config:{id:"embedsoap",name:"Embedsoap",baseUrl:"https://www.embedsoap.com",enabled:!0,priority:12,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Embedsoap",Xt.embedsoap),getSearchPosts:Yt});kt.push({config:{id:"embedflix",name:"Embedflix",baseUrl:"https://embedflix.net",enabled:!0,priority:13,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Embedflix",Xt.embedflix),getSearchPosts:Yt});kt.push({config:{id:"frembed",name:"Frembed",baseUrl:"https://frembed.com",enabled:!0,priority:14,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Frembed",Xt.frembed),getSearchPosts:Yt});kt.push({config:{id:"embedplayer",name:"Embedplayer",baseUrl:"https://embedplayer.site",enabled:!0,priority:15,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Embedplayer",Xt.embedplayer),getSearchPosts:Yt});kt.push({config:{id:"vidbinge",name:"Vidbinge",baseUrl:"https://vidbinge.com",enabled:!0,priority:16,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Vidbinge",Xt.vidbinge),getSearchPosts:Yt});kt.push({config:{id:"vidfast",name:"VidFast",baseUrl:"https://vidfast.to",enabled:!0,priority:17,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("VidFast",Xt.vidfast),getSearchPosts:Yt});kt.push({config:{id:"moviee",name:"Moviee",baseUrl:"https://moviee.tv",enabled:!0,priority:18,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("Moviee",Xt.moviee),getSearchPosts:Yt});kt.push({config:{id:"warezcdn",name:"WarezCDN",baseUrl:"https://embed.warezcdn.com",enabled:!0,priority:19,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("WarezCDN",Xt.warezcdn),getSearchPosts:Yt});kt.push({config:{id:"embedv",name:"EmbedV",baseUrl:"https://www.embedv.net",enabled:!0,priority:20,type:"api",catalog:qt,genres:Vt},getPosts:zt,getMeta:Kt,getStream:Qt("EmbedV",Xt.embedv),getSearchPosts:Yt});kt.push(qk);const Vk=kt,zk=3600*1e3,Yk="/providers/config/providerUrls.json";let sl=null,_A=0;async function Kk(){try{const s=await fetch(Yk);if(!s.ok)throw new Error(`Failed to fetch provider URLs: ${s.statusText}`);return await s.json()}catch(s){return console.error("Error fetching provider URLs:",s),{}}}function Qk(){return sl!==null&&Date.now()-_A<zk}async function Xk(){return Qk()&&sl||(sl=await Kk(),_A=Date.now()),sl}async function Wk(){try{await Xk(),console.log(" Provider URLs prefetched successfully")}catch(s){console.error("Failed to prefetch provider URLs:",s)}}class tt{constructor(e,t){this.config=e,this.embedUrlPattern=t}async getStream(e){try{const{link:t,type:i}=e,n=this.extractTmdbId(t);if(!n)return[];const a=this.embedUrlPattern.replace("{type}",i).replace("{tmdbId}",n);return[{server:this.config.name,link:a,type:"iframe",quality:"auto"}]}catch(t){return console.error(`${this.config.name} error:`,t),[]}}extractTmdbId(e){const t=e.match(/(?:movie|tv)\/(\d+)|^(\d+)$/);return t?t[1]||t[2]:null}async getPosts(){return[]}async getMeta(){return{title:"",image:"",synopsis:"",provider:this.config.id,linkList:[]}}async getSearchPosts(){return[]}}const Zk=new tt({id:"vidplay",name:"Vidplay",baseUrl:"https://vidplay.online",enabled:!0,priority:50,type:"scraper",catalog:[]},"https://vidplay.online/embed/{type}/{tmdbId}"),Jk=new tt({id:"filemoon",name:"Filemoon",baseUrl:"https://filemoon.sx",enabled:!0,priority:51,type:"scraper",catalog:[]},"https://filemoon.sx/e/{tmdbId}"),eM=new tt({id:"doodstream",name:"Doodstream",baseUrl:"https://dood.wf",enabled:!0,priority:52,type:"scraper",catalog:[]},"https://dood.wf/e/{tmdbId}"),tM=new tt({id:"streamtape",name:"Streamtape",baseUrl:"https://streamtape.com",enabled:!0,priority:53,type:"scraper",catalog:[]},"https://streamtape.com/e/{tmdbId}"),sM=new tt({id:"mixdrop",name:"Mixdrop",baseUrl:"https://mixdrop.co",enabled:!0,priority:54,type:"scraper",catalog:[]},"https://mixdrop.co/e/{tmdbId}"),iM=new tt({id:"upstream",name:"Upstream",baseUrl:"https://upstream.to",enabled:!0,priority:55,type:"scraper",catalog:[]},"https://upstream.to/embed-{tmdbId}.html"),nM=new tt({id:"streamwish",name:"Streamwish",baseUrl:"https://streamwish.to",enabled:!0,priority:56,type:"scraper",catalog:[]},"https://streamwish.to/e/{tmdbId}"),rM=new tt({id:"voe",name:"Voe",baseUrl:"https://voe.sx",enabled:!0,priority:57,type:"scraper",catalog:[]},"https://voe.sx/e/{tmdbId}"),aM=new tt({id:"streamsb",name:"StreamSB",baseUrl:"https://streamsb.net",enabled:!0,priority:58,type:"scraper",catalog:[]},"https://streamsb.net/e/{tmdbId}"),uM=new tt({id:"fembed",name:"Fembed",baseUrl:"https://fembed.com",enabled:!0,priority:59,type:"scraper",catalog:[]},"https://fembed.com/v/{tmdbId}"),oM=new tt({id:"vidoza",name:"Vidoza",baseUrl:"https://vidoza.net",enabled:!0,priority:60,type:"scraper",catalog:[]},"https://vidoza.net/embed-{tmdbId}.html"),lM=new tt({id:"streamlare",name:"Streamlare",baseUrl:"https://streamlare.com",enabled:!0,priority:61,type:"scraper",catalog:[]},"https://streamlare.com/e/{tmdbId}"),cM=new tt({id:"vidmoly",name:"Vidmoly",baseUrl:"https://vidmoly.to",enabled:!0,priority:62,type:"scraper",catalog:[]},"https://vidmoly.to/embed-{tmdbId}.html"),dM=new tt({id:"upcloud",name:"UpCloud",baseUrl:"https://upcloud.to",enabled:!0,priority:63,type:"scraper",catalog:[]},"https://upcloud.to/embed-{tmdbId}.html"),fM=new tt({id:"videovard",name:"VideoVard",baseUrl:"https://videovard.sx",enabled:!0,priority:64,type:"scraper",catalog:[]},"https://videovard.sx/v/{tmdbId}"),hM=new tt({id:"superembed2",name:"SuperEmbed",baseUrl:"https://superembed.stream",enabled:!0,priority:65,type:"scraper",catalog:[]},"https://multiembed.mov/?video_id={tmdbId}&tmdb=1"),mM=new tt({id:"godriveplayer",name:"GoDrivePlayer",baseUrl:"https://database.gdriveplayer.us",enabled:!0,priority:66,type:"scraper",catalog:[]},"https://database.gdriveplayer.us/player.php?type={type}&tmdb={tmdbId}"),gM=new tt({id:"embedsu2",name:"Embed.su",baseUrl:"https://embed.su",enabled:!0,priority:67,type:"scraper",catalog:[]},"https://embed.su/embed/{type}/{tmdbId}"),pM=new tt({id:"autoembed2",name:"Autoembed",baseUrl:"https://player.autoembed.cc",enabled:!0,priority:68,type:"scraper",catalog:[]},"https://player.autoembed.cc/embed/{type}/{tmdbId}"),bM=new tt({id:"vidlink",name:"VidLink",baseUrl:"https://vidlink.pro",enabled:!0,priority:69,type:"scraper",catalog:[]},"https://vidlink.pro/embed/{type}/{tmdbId}"),EM=new tt({id:"smashystream",name:"Smashy Stream",baseUrl:"https://player.smashy.stream",enabled:!0,priority:70,type:"scraper",catalog:[]},"https://player.smashy.stream/{type}/{tmdbId}"),yM=new tt({id:"moviesapi2",name:"MoviesAPI",baseUrl:"https://moviesapi.club",enabled:!0,priority:71,type:"scraper",catalog:[]},"https://moviesapi.club/{type}/{tmdbId}"),xM=new tt({id:"vidfast",name:"VidFast",baseUrl:"https://vidfast.to",enabled:!0,priority:72,type:"scraper",catalog:[]},"https://vidfast.to/embed/{type}/{tmdbId}"),TM=new tt({id:"nontongo",name:"NontonGo",baseUrl:"https://nontongo.win",enabled:!0,priority:73,type:"scraper",catalog:[]},"https://nontongo.win/embed/{type}/{tmdbId}"),vM=new tt({id:"warezcdn",name:"WarezCDN",baseUrl:"https://embed.warezcdn.com",enabled:!0,priority:74,type:"scraper",catalog:[]},"https://embed.warezcdn.com/filme/{tmdbId}"),SM=new tt({id:"embedsoap",name:"EmbedSoap",baseUrl:"https://www.embedsoap.com",enabled:!0,priority:75,type:"scraper",catalog:[]},"https://www.embedsoap.com/embed/{type}/{tmdbId}"),AM=new tt({id:"frembed",name:"Frembed",baseUrl:"https://frembed.com",enabled:!0,priority:76,type:"scraper",catalog:[]},"https://frembed.com/api/film.php?id={tmdbId}"),_M=new tt({id:"embedplayer",name:"EmbedPlayer",baseUrl:"https://embedplayer.site",enabled:!0,priority:77,type:"scraper",catalog:[]},"https://embedplayer.site/e/{tmdbId}"),LM=new tt({id:"vidbinge",name:"Vidbinge",baseUrl:"https://vidbinge.com",enabled:!0,priority:78,type:"scraper",catalog:[]},"https://vidbinge.com/embed/{type}/{tmdbId}"),RM=new tt({id:"vidzee",name:"VidZee",baseUrl:"https://vidzee.cc",enabled:!0,priority:79,type:"scraper",catalog:[]},"https://vidzee.cc/embed/{type}/{tmdbId}"),IM=new tt({id:"vixsrc",name:"Vixsrc",baseUrl:"https://vixsrc.com",enabled:!0,priority:80,type:"scraper",catalog:[]},"https://vixsrc.com/embed/{type}/{tmdbId}"),CM=new tt({id:"mp4hydra",name:"MP4Hydra",baseUrl:"https://mp4hydra.com",enabled:!0,priority:81,type:"scraper",catalog:[]},"https://mp4hydra.com/embed/{type}/{tmdbId}"),NM=new tt({id:"4khdhub2",name:"4KHDHub",baseUrl:"https://4khdhub.com",enabled:!0,priority:82,type:"scraper",catalog:[]},"https://4khdhub.com/embed/{type}/{tmdbId}"),DM=new tt({id:"showbox2",name:"Showbox",baseUrl:"https://showbox.media",enabled:!0,priority:83,type:"scraper",catalog:[]},"https://showbox.media/embed/{type}/{tmdbId}"),jp=[Zk,Jk,eM,tM,sM,iM,nM,rM,aM,uM,oM,lM,cM,dM,fM,hM,mM,gM,pM,bM,EM,yM,xM,TM,vM,SM,AM,_M,LM,RM,IM,CM,NM,DM];console.log(` ${jp.length} real embed providers ready`);const wM=["Moviesmod","UhdMovies","Vega","lux","drive","multi","w4u","extra","hdhub","kat","dooflix","filmyfly","4khdhub","moviezwap","9xflix","movieBox","cinevood","kmmovies","zeefliz","katmoviefix","movies4u","joya9tv","skymovieshd","1cinevood","protonMovies","ridomovies","moviesapi","filepress"],OM=["dc","aed","kissKh","dramafull"],kM=["autoEmbed","embedsu","nfMirror","primewire","rive","vadapav","cinemaLuxe","consumet","showbox"],MM=[...wM,...OM,...kM],LA=[...jp];console.log(` Provider Registry: ${MM.length} providers configured`);console.log(` ${LA.length} NEW providers ready (${jp.length} embed)`);async function RA(){Wk().catch(s=>{console.error("Failed to prefetch provider URLs:",s)}),Vk.forEach(s=>{Gd.register(s)}),LA.forEach(s=>{Gd.register(s)}),Gd.getStats()}const vd="watch_history",IA=()=>{const[s,e]=U.useState([]);return U.useEffect(()=>{const a=localStorage.getItem(vd);if(a)try{e(JSON.parse(a))}catch(o){console.error("Failed to parse watch history",o)}},[]),{history:s,addToHistory:a=>{e(o=>{const c=o.filter(m=>m.id!==a.id),d=[{...a,lastWatched:Date.now()},...c].slice(0,100);return localStorage.setItem(vd,JSON.stringify(d)),d})},clearHistory:()=>{e([]),localStorage.removeItem(vd)},removeFromHistory:a=>{e(o=>{const c=o.filter(f=>f.id!==a);return localStorage.setItem(vd,JSON.stringify(c)),c})}}},PM=()=>{const{movieId:s}=wf(),e=_a(),[t,i]=U.useState(null),[n,a]=U.useState(!0),[o,c]=U.useState([]),[f,d]=U.useState(0),[m,g]=U.useState(!0),[p,T]=U.useState(!1),{saveProgress:y}=oS(),{addToHistory:S}=IA();if(U.useEffect(()=>{RA()},[]),U.useEffect(()=>{(async()=>{if(s){a(!0);try{const C=await Ve.getDetails(s,"movie");i(C),y({id:C.id.toString(),tmdbId:C.id.toString(),title:C.title||C.name||"Unknown",poster_path:C.poster_path||"",backdrop_path:C.backdrop_path||"",progress:0,timestamp:Date.now(),type:"movie"}),S({id:C.id.toString(),tmdbId:C.id.toString(),title:C.title||C.name||"Unknown",poster_path:C.poster_path||"",backdrop_path:C.backdrop_path||"",progress:0,timestamp:Date.now(),type:"movie"});const I=await Gd.getStreamsFromAll(`/movie/${s}`,"movie");c(I)}catch(C){console.error("Failed to fetch movie details:",C)}finally{a(!1)}}})()},[s]),U.useEffect(()=>{g(!0),T(!1)},[f]),n)return E.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:E.jsxs("div",{className:"flex flex-col items-center gap-4",children:[E.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin"}),E.jsx("p",{className:"text-primary text-xl font-medium",children:"Loading player..."})]})});if(!t||!s)return E.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center gap-4",children:[E.jsx("p",{className:"text-red-500 text-xl",children:"Movie not found"}),E.jsx(xt,{to:"/",className:"px-6 py-3 bg-primary text-black font-bold rounded-lg hover:bg-blue-400 transition-all",children:"Go Home"})]});const A=o[f]||o[0];return E.jsxs("div",{className:"min-h-screen bg-background",children:[E.jsx("div",{className:"bg-surface/80 backdrop-blur-xl border-b border-white/10 sticky top-0 z-50",children:E.jsx("div",{className:"max-w-[1800px] mx-auto px-4 md:px-8 py-4",children:E.jsxs("div",{className:"flex items-center justify-between gap-4",children:[E.jsxs("div",{className:"flex items-center gap-3 md:gap-4 flex-1 min-w-0",children:[E.jsx("button",{onClick:()=>e(-1),className:"flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-lg bg-white/5 hover:bg-white/10 text-text hover:text-primary transition-all border border-white/10","aria-label":"Go back",children:E.jsx(nS,{size:20})}),E.jsxs("div",{className:"min-w-0 flex-1",children:[E.jsx("h1",{className:"text-lg md:text-xl font-bold text-text truncate",children:t.title||t.name}),E.jsxs("div",{className:"flex items-center gap-3 text-xs md:text-sm text-text-muted",children:[E.jsxs("span",{className:"flex items-center gap-1",children:[E.jsx(nf,{size:14}),new Date(t.release_date||t.first_air_date||"").getFullYear()]}),t.runtime&&E.jsxs("span",{className:"flex items-center gap-1",children:[E.jsx(Or,{size:14}),t.runtime," min"]}),E.jsxs("span",{className:"flex items-center gap-1",children:[E.jsx(Ns,{size:14,className:"fill-yellow-500 text-yellow-500"}),t.vote_average.toFixed(1)]})]})]})]}),E.jsxs(xt,{to:`/movies/${s}`,className:"flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white/90 dark:bg-white/10 text-gray-900 dark:text-white rounded-lg hover:bg-white dark:hover:bg-white/20 transition-all border border-black/10 dark:border-white/10 font-medium text-sm",children:[E.jsx(rf,{size:16}),E.jsx("span",{className:"hidden sm:inline",children:"Details"})]})]})})}),E.jsxs("div",{className:"max-w-[1800px] mx-auto px-4 md:px-8 py-6 md:py-8",children:[o.length>0&&E.jsx("div",{className:"mb-6",children:E.jsxs("div",{className:"bg-surface/50 backdrop-blur-sm border border-white/10 rounded-xl p-4",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[E.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:E.jsx(Zx,{size:16,className:"text-primary"})}),E.jsxs("h3",{className:"text-sm font-semibold text-text",children:["Select Server (",o.length," available)"]})]}),E.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:o.map((R,C)=>E.jsx("button",{onClick:()=>d(C),className:`px-4 py-2.5 rounded-lg text-sm font-medium transition-all ${f===C?"bg-primary text-black shadow-lg shadow-primary/20 scale-105":"bg-white/5 text-text hover:bg-white/10 border border-white/10 hover:border-white/20"}`,children:R.server},C))})]})}),E.jsxs("div",{className:"relative w-full aspect-video bg-black rounded-2xl overflow-hidden shadow-2xl border border-white/10 mb-8",children:[m&&!p&&E.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-br from-black via-gray-900 to-black z-10",children:E.jsxs("div",{className:"flex flex-col items-center gap-4",children:[E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"w-20 h-20 border-4 border-primary/20 rounded-full"}),E.jsx("div",{className:"w-20 h-20 border-4 border-primary border-t-transparent rounded-full animate-spin absolute top-0"})]}),E.jsxs("div",{className:"text-center",children:[E.jsxs("p",{className:"text-white text-base font-medium mb-1",children:["Loading ",(A==null?void 0:A.server)||"player"]}),E.jsx("p",{className:"text-gray-400 text-sm",children:"Please wait..."})]})]})}),p&&E.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-br from-black via-gray-900 to-black z-10",children:E.jsxs("div",{className:"flex flex-col items-center gap-4 text-center px-4 max-w-md",children:[E.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center",children:E.jsx(Zx,{size:32,className:"text-red-500"})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-red-500 text-lg font-bold mb-2",children:"Failed to load video player"}),E.jsxs("p",{className:"text-gray-400 text-sm",children:["The ",(A==null?void 0:A.server)||"selected"," server is currently unavailable. Please try a different server."]})]}),E.jsx("button",{onClick:()=>{T(!1),g(!0)},className:"px-6 py-3 bg-primary text-black font-bold rounded-lg hover:bg-blue-400 transition-all shadow-lg",children:"Retry"})]})}),A&&E.jsx("iframe",{src:A.link,className:"w-full h-full",frameBorder:"0",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",title:t.title||t.name,onLoad:()=>g(!1),onError:()=>{g(!1),T(!0)}})]}),E.jsxs("div",{className:"bg-surface/50 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8 mb-8",children:[E.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-text mb-4 flex items-center gap-3",children:[E.jsx("div",{className:"w-1 h-8 bg-primary rounded-full"}),"About This Movie"]}),E.jsx("p",{className:"text-text-muted leading-relaxed mb-6 text-base",children:t.overview}),E.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[E.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[E.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-1",children:[E.jsx(Ns,{size:16,className:"text-yellow-500"}),E.jsx("span",{children:"Rating"})]}),E.jsxs("p",{className:"text-text font-bold text-xl",children:[t.vote_average.toFixed(1),E.jsx("span",{className:"text-text-muted text-base font-normal",children:"/10"})]})]}),E.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[E.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-1",children:[E.jsx(nf,{size:16}),E.jsx("span",{children:"Release Date"})]}),E.jsx("p",{className:"text-text font-bold text-lg",children:new Date(t.release_date||t.first_air_date||"").toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),t.runtime&&E.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[E.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-1",children:[E.jsx(Or,{size:16}),E.jsx("span",{children:"Runtime"})]}),E.jsxs("p",{className:"text-text font-bold text-lg",children:[t.runtime," min"]})]}),E.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[E.jsx("div",{className:"text-text-muted text-sm mb-1",children:"Genres"}),E.jsx("div",{className:"flex flex-wrap gap-1",children:t.genres.slice(0,3).map(R=>E.jsx("span",{className:"text-text font-medium text-sm bg-primary/10 px-2 py-1 rounded",children:R.name},R.id))})]})]})]}),t.similar&&t.similar.results.length>0&&E.jsxs("div",{children:[E.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-text mb-6 flex items-center gap-3",children:[E.jsx("div",{className:"w-1 h-8 bg-primary rounded-full"}),"You May Also Like"]}),E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:t.similar.results.slice(0,6).map(R=>E.jsxs(xt,{to:`/watch/${R.id}`,className:"group",children:[E.jsx("div",{className:"aspect-[2/3] rounded-xl overflow-hidden mb-2 bg-surface border border-white/10 group-hover:border-primary/50 transition-all",children:E.jsx("img",{src:Ve.getImageUrl(R.poster_path),alt:R.title||R.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"})}),E.jsx("p",{className:"text-sm font-medium text-text truncate group-hover:text-primary transition-colors",children:R.title||R.name}),E.jsxs("div",{className:"flex items-center gap-1 text-xs text-text-muted",children:[E.jsx(Ns,{size:12,className:"fill-yellow-500 text-yellow-500"}),R.vote_average.toFixed(1)]})]},R.id))})]})]})]})},Yl=(s,e)=>{const t=U.useRef(null);return U.useCallback(n=>{e||(t.current&&t.current.disconnect(),t.current=new IntersectionObserver(a=>{a[0].isIntersecting&&s()}),n&&t.current.observe(n))},[e,s])},UM=()=>{const[s,e]=U.useState(!1),[t,i]=U.useState([]),[n,a]=U.useState(!1),[o,c]=U.useState(1),[f,d]=U.useState(!0),[m,g]=U.useState(!1),[p,T]=U.useState(""),[y,S]=U.useState("top-weekly"),[A,R]=U.useState(null),[C,I]=U.useState(null),[D,k]=U.useState(!1),z=_a(),P=[{id:"top-weekly",name:"Top Weekly",icon:nl},{id:"top-monthly",name:"Top Monthly",icon:Ns},{id:"top-rated",name:"Top Rated",icon:Ns},{id:"most-viewed",name:"Most Viewed",icon:xu},{id:"latest-updates",name:"Latest",icon:Or},{id:"jav",name:"JAV",icon:nl}];U.useEffect(()=>{localStorage.getItem("is18PlusConfirmed")==="true"&&(e(!0),V(1,y,p))},[]),U.useEffect(()=>{s&&(c(1),d(!0),i([]),V(1,y,p))},[y,s]);const V=async(ne,xe,O)=>{try{ne===1?a(!0):g(!0);const G=await f4.getVideos(O,ne,20,xe);G.length===0?d(!1):(i(de=>ne===1?G:[...de,...G]),ne===1&&G.length>0&&R(G[0]))}catch(G){console.error("Failed to load videos",G)}finally{a(!1),g(!1)}},$=U.useCallback(()=>{if(!m&&f){const ne=o+1;c(ne),V(ne,y,p)}},[m,f,o,y,p]),j=Yl($,m),te=ne=>{ne.preventDefault(),c(1),d(!0),i([]),V(1,y,p)},ge=ne=>{S(ne)},ye=ne=>{I(ne),k(!0)},ve=()=>{k(!1),setTimeout(()=>I(null),300)},ue=()=>{localStorage.setItem("is18PlusConfirmed","true"),e(!0),V(1,y,p)},F=()=>{z("/")},J=()=>C?t.filter(ne=>ne.id!==C.id):[];if(!s)return E.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-black p-4",children:E.jsxs("div",{className:"max-w-md w-full glass-panel p-8 rounded-2xl border border-secondary/50 text-center space-y-6 animate-fade-in",children:[E.jsx("div",{className:"w-20 h-20 bg-secondary/20 rounded-full flex items-center justify-center mx-auto animate-pulse",children:E.jsx(Su,{className:"w-10 h-10 text-secondary"})}),E.jsx("h1",{className:"text-3xl font-bold text-secondary",children:"Restricted Access"}),E.jsx("p",{className:"text-gray-300",children:"The following content contains material of an adult nature and is intended for viewers 18 years of age or older."}),E.jsxs("div",{className:"bg-secondary/10 p-4 rounded-lg border border-secondary/20 flex gap-3 text-left",children:[E.jsx(VN,{className:"text-secondary shrink-0"}),E.jsx("span",{className:"text-xs text-gray-400",children:"By entering, you confirm you are at least 18 years old and consent to viewing sexually explicit content."})]}),E.jsxs("div",{className:"flex flex-col gap-3",children:[E.jsx("button",{onClick:ue,className:"w-full bg-secondary hover:bg-red-600 text-white font-bold py-3 rounded-lg transition-all transform hover:scale-105",children:"I am 18+ - Enter"}),E.jsx("button",{onClick:F,className:"w-full bg-white/10 hover:bg-white/20 text-white font-medium py-3 rounded-lg transition-colors",children:"Exit to Safe Home"})]})]})});const se=J();return E.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[D&&C&&E.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/95 p-4 overflow-y-auto animate-fade-in",children:E.jsxs("div",{className:"relative w-full max-w-7xl my-8",children:[E.jsx("button",{onClick:ve,className:"absolute top-4 right-4 z-10 w-10 h-10 bg-black/50 hover:bg-black/70 rounded-full flex items-center justify-center transition-colors",children:E.jsx(El,{className:"text-white",size:24})}),E.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[E.jsx("div",{className:"lg:col-span-2 space-y-6",children:E.jsxs("div",{className:"bg-surface rounded-2xl overflow-hidden shadow-2xl",children:[E.jsx("div",{className:"aspect-video w-full bg-black",children:E.jsx("iframe",{src:C.embed||C.url,className:"w-full h-full",frameBorder:"0",referrerPolicy:"no-referrer",allowFullScreen:!0,allow:"autoplay; encrypted-media",title:C.title})}),E.jsxs("div",{className:"p-6 space-y-4",children:[E.jsx("h2",{className:"text-2xl font-bold text-text",children:C.title}),E.jsxs("div",{className:"flex items-center gap-6 text-sm text-text-muted",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(xu,{size:16}),E.jsxs("span",{children:[C.views.toLocaleString()," views"]})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Or,{size:16}),E.jsx("span",{children:C.length_min})]}),C.rate&&E.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[E.jsx(Ns,{size:16,className:"fill-current"}),E.jsx("span",{children:C.rate})]})]})]})]})}),E.jsx("div",{className:"lg:col-span-1",children:E.jsxs("div",{className:"bg-surface/50 backdrop-blur-xl border border-white/10 rounded-2xl p-4 sticky top-4",children:[E.jsxs("h3",{className:"text-lg font-bold text-text mb-4 flex items-center gap-2",children:[E.jsx(nl,{size:20,className:"text-secondary"}),"Suggested Videos"]}),E.jsx("div",{className:"space-y-3 max-h-[calc(100vh-200px)] overflow-y-auto pr-2 custom-scrollbar",children:se.map(ne=>E.jsxs("button",{onClick:()=>ye(ne),className:"group w-full bg-white/5 hover:bg-white/10 rounded-lg overflow-hidden transition-all flex gap-3 p-2",children:[E.jsxs("div",{className:"relative w-32 h-20 flex-shrink-0 rounded overflow-hidden",children:[E.jsx("img",{src:ne.default_thumb.src,alt:ne.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),E.jsx("div",{className:"absolute bottom-1 right-1 bg-black/80 text-white text-xs px-1 py-0.5 rounded",children:ne.length_min}),E.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-colors flex items-center justify-center",children:E.jsx(an,{size:20,className:"text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"white"})})]}),E.jsxs("div",{className:"flex-1 text-left min-w-0",children:[E.jsx("h4",{className:"text-sm font-medium text-text line-clamp-2 group-hover:text-primary transition-colors",children:ne.title}),E.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-text-muted",children:[E.jsxs("span",{className:"flex items-center gap-1",children:[E.jsx(xu,{size:10}),(ne.views/1e3).toFixed(0),"K"]}),E.jsx("span",{className:"text-green-400",children:ne.rate})]})]})]},ne.id))})]})})]})]})}),A&&E.jsxs("div",{className:"relative h-[70vh] md:h-[80vh] w-full overflow-hidden",children:[E.jsxs("div",{className:"absolute inset-0",children:[E.jsx("img",{src:A.default_thumb.src,alt:A.title,className:"w-full h-full object-cover scale-105 blur-sm"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-background/60 to-transparent"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-background/90 via-background/40 to-transparent"})]}),E.jsx("div",{className:"absolute bottom-0 left-0 w-full p-6 md:p-12 lg:p-16 z-30",children:E.jsxs("div",{className:"max-w-4xl space-y-6 animate-fade-in",children:[E.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[E.jsxs("span",{className:"px-4 py-1.5 bg-secondary/20 backdrop-blur-md border border-secondary/30 rounded-full text-secondary text-xs font-bold uppercase tracking-wider flex items-center gap-2",children:[E.jsx("span",{className:"bg-secondary text-black text-xs px-2 py-0.5 rounded font-black",children:"18+"}),"Adult Content"]}),A.rate&&E.jsxs("span",{className:"px-4 py-1.5 bg-green-500/20 backdrop-blur-md border border-green-500/30 rounded-full text-green-400 text-xs font-bold flex items-center gap-2",children:[E.jsx(Ns,{size:14,className:"fill-current"}),A.rate," Rating"]})]}),E.jsx("h1",{className:"text-4xl md:text-6xl lg:text-7xl font-black drop-shadow-2xl leading-tight line-clamp-2",style:{color:"var(--color-hero-text)"},children:A.title}),E.jsxs("div",{className:"flex items-center gap-6 text-sm",style:{color:"var(--color-text-muted)"},children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(xu,{size:16}),E.jsxs("span",{children:[A.views.toLocaleString()," views"]})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Or,{size:16}),E.jsx("span",{children:A.length_min})]})]}),E.jsx("div",{className:"flex items-center gap-4 pt-4 flex-wrap",children:E.jsxs("button",{onClick:()=>ye(A),className:"group bg-secondary text-white font-bold px-8 py-4 rounded-xl flex items-center gap-3 hover:bg-red-600 transition-all transform hover:scale-105 hover:shadow-2xl hover:shadow-secondary/50",children:[E.jsx(an,{size:22,fill:"currentColor"}),E.jsx("span",{className:"text-lg",children:"Watch Now"})]})})]})})]}),E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8 mt-8 md:-mt-12 relative z-10",children:[E.jsxs("div",{className:"backdrop-blur-xl rounded-2xl p-6 mb-8 bg-surface border border-border",children:[E.jsxs("form",{onSubmit:te,className:"flex flex-col md:flex-row gap-4",children:[E.jsxs("div",{className:"flex-1 relative",children:[E.jsx(Bu,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-text-muted",size:20}),E.jsx("input",{type:"text",placeholder:"Search videos...",value:p,onChange:ne=>T(ne.target.value),className:"w-full rounded-xl pl-12 pr-4 py-3 focus:outline-none focus:border-secondary/50 transition-all bg-input-bg border border-input-border text-text"})]}),E.jsx("button",{type:"submit",className:"bg-secondary hover:bg-red-600 text-white font-bold px-8 py-3 rounded-xl transition-all transform hover:scale-105",children:"Search"})]}),E.jsxs("div",{className:"mt-6",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[E.jsx(aS,{size:18,className:"text-text-muted"}),E.jsx("span",{className:"text-sm font-medium text-text-muted",children:"Filter by:"})]}),E.jsx("div",{className:"flex items-center gap-3 flex-wrap",children:P.map(ne=>{const xe=ne.icon;return E.jsxs("button",{onClick:()=>ge(ne.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-all flex items-center gap-2 ${y===ne.id?"bg-secondary text-white shadow-lg shadow-secondary/30":"bg-white/5 text-text-muted hover:bg-white/10 hover:text-text"}`,children:[E.jsx(xe,{size:16}),ne.name]},ne.id)})})]})]}),n?E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[E.jsx("div",{className:"w-16 h-16 border-4 border-secondary border-t-transparent rounded-full animate-spin"}),E.jsx("p",{className:"text-secondary font-medium",children:"Loading content..."})]}):E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6",children:t.map((ne,xe)=>E.jsxs("div",{ref:xe===t.length-1?j:null,className:"group relative rounded-xl overflow-hidden hover:border-secondary/50 transition-all transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-secondary/20 cursor-pointer bg-card-bg border border-border",onClick:()=>ye(ne),children:[E.jsxs("div",{className:"block aspect-video overflow-hidden relative",children:[E.jsx("img",{src:ne.default_thumb.src,alt:ne.title,loading:"lazy",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),E.jsx("div",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-xs px-2 py-1 rounded font-mono",children:ne.length_min}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:E.jsx("div",{className:"w-16 h-16 bg-secondary/90 rounded-full flex items-center justify-center transform scale-0 group-hover:scale-100 transition-transform duration-300",children:E.jsx(an,{size:28,fill:"white",className:"text-white ml-1"})})})]}),E.jsxs("div",{className:"p-3",children:[E.jsx("h3",{className:"text-sm font-medium line-clamp-2 group-hover:text-secondary transition-colors text-text",children:ne.title}),E.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-text-muted",children:[E.jsxs("span",{className:"flex items-center gap-1",children:[E.jsx(xu,{size:12}),ne.views.toLocaleString()]}),E.jsxs("span",{className:"text-green-400 flex items-center gap-1",children:[E.jsx(Ns,{size:12,className:"fill-current"}),ne.rate]})]})]})]},`${ne.id}-${xe}`))}),m&&E.jsx("div",{className:"flex justify-center py-8",children:E.jsx("div",{className:"w-12 h-12 border-4 border-secondary border-t-transparent rounded-full animate-spin"})}),!f&&t.length>0&&E.jsx("div",{className:"text-center py-8 text-text-muted",children:E.jsx("p",{children:"No more videos to load"})})]}),E.jsxs("div",{className:"mt-12 py-8 border-t border-white/5 text-center text-xs text-text-muted space-y-4",children:[E.jsx("p",{children:"Compliance Notice: All adult content is provided via 3rd party public APIs. We do not host any files."}),E.jsx("p",{className:"text-text-muted",children:"Provider: Eporner API"}),E.jsx("button",{onClick:()=>{localStorage.removeItem("is18PlusConfirmed"),e(!1)},className:"mt-2 text-secondary underline hover:text-red-400 transition-colors",children:"Reset Age Gate"})]})]}),E.jsx("div",{className:"fixed top-1/4 left-0 w-96 h-96 bg-secondary/3 rounded-full blur-3xl pointer-events-none -z-10"}),E.jsx("div",{className:"fixed bottom-1/4 right-0 w-96 h-96 bg-secondary/3 rounded-full blur-3xl pointer-events-none -z-10"})]})},BM=()=>{const[s]=tI(),e=s.get("q")||"",[t,i]=U.useState([]),[n,a]=U.useState(!1),[o,c]=U.useState(1),[f,d]=U.useState(!0),[m,g]=U.useState(!1),p=U.useCallback(async(S,A)=>{if(!A){i([]);return}try{S===1?a(!0):g(!0);const C=(await Ve.search(A,S)).filter(I=>I.media_type!=="person"&&(I.poster_path||I.backdrop_path));C.length===0?d(!1):i(I=>S===1?C:[...I,...C])}catch(R){console.error("Search failed",R)}finally{a(!1),g(!1)}},[]);U.useEffect(()=>{c(1),i([]),d(!0);const S=setTimeout(()=>{p(1,e)},500);return()=>clearTimeout(S)},[e,p]);const T=U.useCallback(()=>{if(!m&&f){const S=o+1;c(S),p(S,e)}},[m,f,o,e,p]),y=Yl(T,m);return E.jsx("div",{className:"min-h-screen bg-background pt-24 pb-20 px-4",children:E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[E.jsx(Bu,{className:"text-primary w-8 h-8"}),E.jsxs("h1",{className:"text-3xl font-bold text-text",children:["Search Results for ",E.jsxs("span",{className:"text-primary",children:['"',e,'"']})]})]}),n&&o===1?E.jsx("div",{className:"flex justify-center py-20",children:E.jsx(Gn,{className:"animate-spin text-primary w-10 h-10"})}):t.length>0?E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6",children:t.map((S,A)=>E.jsx("div",{ref:A===t.length-1?y:null,children:E.jsx(xa,{movie:S})},`${S.id}-${A}`))}),m&&E.jsx("div",{className:"flex justify-center py-8",children:E.jsx(Gn,{className:"animate-spin text-primary w-8 h-8"})})]}):E.jsxs("div",{className:"text-center py-20 text-text-muted",children:[E.jsxs("p",{className:"text-xl",children:['No results found for "',e,'"']}),E.jsx("p",{className:"mt-2",children:"Try searching for a different movie or TV show."})]})]})})},MT=[{id:28,name:"Action"},{id:12,name:"Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:99,name:"Documentary"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:14,name:"Fantasy"},{id:36,name:"History"},{id:27,name:"Horror"},{id:10402,name:"Music"},{id:9648,name:"Mystery"},{id:10749,name:"Romance"},{id:878,name:"Sci-Fi"},{id:53,name:"Thriller"},{id:10752,name:"War"},{id:37,name:"Western"}],PT=()=>{var R;const{genreId:s}=wf(),e=_a(),[t,i]=U.useState([]),[n,a]=U.useState(!0),[o,c]=U.useState(1),[f,d]=U.useState(!0),[m,g]=U.useState(!1),p=s||"28",T=((R=MT.find(C=>C.id.toString()===p))==null?void 0:R.name)||"Unknown",y=U.useCallback(async(C,I)=>{try{C===1?a(!0):g(!0);const D=await Ve.getMoviesByGenre(I,C);D.length===0?d(!1):i(k=>C===1?D:[...k,...D])}catch(D){console.error("Failed to fetch genre movies",D)}finally{a(!1),g(!1)}},[]);U.useEffect(()=>{c(1),i([]),d(!0),y(1,p)},[p,y]);const S=U.useCallback(()=>{if(!m&&f){const C=o+1;c(C),y(C,p)}},[m,f,o,p,y]),A=Yl(S,m);return E.jsx("div",{className:"min-h-screen bg-background pt-24 pb-20 px-4",children:E.jsx("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8",children:E.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[E.jsx("div",{className:"w-full md:w-64 flex-shrink-0",children:E.jsxs("div",{className:"bg-surface p-4 rounded-xl border border-white/10 sticky top-24",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-4 text-primary font-bold",children:[E.jsx(aS,{size:20}),E.jsx("h2",{children:"Select Genre"})]}),E.jsx("div",{className:"flex flex-wrap md:flex-col gap-2",children:MT.map(C=>E.jsx("button",{onClick:()=>e(`/genres/${C.id}`),className:`px-3 py-2 rounded-lg text-sm text-left transition-colors ${p===C.id.toString()?"bg-primary text-black font-bold":"bg-surface text-text-muted hover:bg-white/10 hover:text-text"}`,children:C.name},C.id))})]})}),E.jsxs("div",{className:"flex-1",children:[E.jsxs("h1",{className:"text-3xl font-bold text-text mb-6 border-l-4 border-primary pl-4",children:[T," Movies"]}),n&&o===1?E.jsx("div",{className:"flex justify-center py-20",children:E.jsx(Gn,{className:"animate-spin text-primary w-10 h-10"})}):E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:t.map((C,I)=>E.jsx("div",{ref:I===t.length-1?A:null,children:E.jsx(xa,{movie:C})},`${C.id}-${I}`))}),m&&E.jsx("div",{className:"flex justify-center py-8",children:E.jsx(Gn,{className:"animate-spin text-primary w-8 h-8"})})]})]})]})})})},FM=()=>{const[s,e]=U.useState([]),[t,i]=U.useState(!0),[n,a]=U.useState(1),[o,c]=U.useState(!0),[f,d]=U.useState(!1),m=U.useCallback(async T=>{try{T===1?i(!0):d(!0);const y=await Ve.getPopular("movie",T);y.length===0?c(!1):e(S=>T===1?y:[...S,...y])}catch(y){console.error("Failed to fetch movies",y)}finally{i(!1),d(!1)}},[]);U.useEffect(()=>{m(1)},[m]);const g=U.useCallback(()=>{if(!f&&o){const T=n+1;a(T),m(T)}},[f,o,n,m]),p=Yl(g,f);return E.jsx("div",{className:"min-h-screen bg-background pt-24 pb-20 px-4",children:E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[E.jsx(xg,{className:"text-primary w-8 h-8"}),E.jsx("h1",{className:"text-3xl font-bold text-text",children:"Movies"})]}),t&&n===1?E.jsx("div",{className:"flex justify-center py-20",children:E.jsx(Gn,{className:"animate-spin text-primary w-10 h-10"})}):E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-7 min-[1800px]:grid-cols-8 gap-4 md:gap-6",children:s.map((T,y)=>E.jsx("div",{ref:y===s.length-1?p:null,children:E.jsx(xa,{movie:T})},`${T.id}-${y}`))}),f&&E.jsx("div",{className:"flex justify-center py-8",children:E.jsx(Gn,{className:"animate-spin text-primary w-8 h-8"})})]})]})})},HM=()=>{const[s,e]=U.useState([]),[t,i]=U.useState(!0),[n,a]=U.useState(1),[o,c]=U.useState(!0),[f,d]=U.useState(!1),m=U.useCallback(async T=>{try{T===1?i(!0):d(!0);const y=await Ve.getDiscoverTV(T);y.length===0?c(!1):e(S=>T===1?y:[...S,...y])}catch(y){console.error("Failed to fetch TV shows",y)}finally{i(!1),d(!1)}},[]);U.useEffect(()=>{m(1)},[m]);const g=U.useCallback(()=>{if(!f&&o){const T=n+1;a(T),m(T)}},[f,o,n,m]),p=Yl(g,f);return E.jsx("div",{className:"min-h-screen bg-background pt-24 pb-20 px-4",children:E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[E.jsx(bl,{className:"text-primary w-8 h-8"}),E.jsx("h1",{className:"text-3xl font-bold text-text",children:"Web Series & TV Shows"})]}),t&&n===1?E.jsx("div",{className:"flex justify-center py-20",children:E.jsx(Gn,{className:"animate-spin text-primary w-10 h-10"})}):E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6",children:s.map((T,y)=>E.jsx("div",{ref:y===s.length-1?p:null,children:E.jsx(xa,{movie:T})},`${T.id}-${y}`))}),f&&E.jsx("div",{className:"flex justify-center py-8",children:E.jsx(Gn,{className:"animate-spin text-primary w-8 h-8"})})]})]})})},jM=()=>{const[s,e]=U.useState([]);U.useEffect(()=>{const i=localStorage.getItem("watchlist");i&&e(JSON.parse(i))},[]);const t=i=>{const n=s.filter(a=>a.id!==i);e(n),localStorage.setItem("watchlist",JSON.stringify(n))};return E.jsx("div",{className:"min-h-screen bg-background pt-24 pb-20 px-4",children:E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[E.jsx(Tg,{className:"text-red-500 w-8 h-8",fill:"currentColor"}),E.jsx("h1",{className:"text-3xl font-bold text-text",children:"My Watchlist"})]}),s.length>0?E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6",children:s.map(i=>E.jsxs("div",{className:"relative group",children:[E.jsx(xa,{movie:i}),E.jsx("button",{onClick:n=>{n.preventDefault(),t(i.id)},className:"absolute top-2 right-2 bg-black/60 p-2 rounded-full text-red-500 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white",title:"Remove from Watchlist",children:E.jsx(uf,{size:16})})]},i.id))}):E.jsxs("div",{className:"text-center py-20 text-text-muted",children:[E.jsx(Tg,{size:64,className:"mx-auto mb-4 opacity-20"}),E.jsx("p",{className:"text-xl font-medium text-text-muted",children:"Your watchlist is empty"}),E.jsx("p",{className:"mt-2 mb-6",children:"Start adding movies and shows you want to watch!"}),E.jsx(xt,{to:"/",className:"bg-primary text-black font-bold px-6 py-2 rounded-lg hover:bg-blue-400 transition-colors",children:"Browse Movies"})]})]})})},$M=()=>{const{history:s,clearHistory:e,removeFromHistory:t}=IA();return E.jsx("div",{className:"min-h-screen bg-background pt-24 px-4 md:px-8 pb-20",children:E.jsxs("div",{className:"max-w-[1800px] mx-auto",children:[E.jsxs("div",{className:"flex items-center justify-between mb-8",children:[E.jsxs("h1",{className:"text-3xl font-bold text-text flex items-center gap-3",children:[E.jsx(Or,{className:"text-primary"}),"Watch History"]}),s.length>0&&E.jsxs("button",{onClick:()=>{window.confirm("Are you sure you want to clear your watch history?")&&e()},className:"flex items-center gap-2 px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 rounded-lg transition-colors",children:[E.jsx(uf,{size:16}),"Clear History"]})]}),s.length===0?E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-text-muted",children:[E.jsx(Or,{size:64,className:"mb-4 opacity-20"}),E.jsx("p",{className:"text-xl",children:"Your watch history is empty"}),E.jsx(xt,{to:"/",className:"mt-4 text-primary hover:underline",children:"Start watching something!"})]}):E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:s.map(i=>E.jsxs("div",{className:"group relative",children:[E.jsx("button",{onClick:n=>{n.preventDefault(),n.stopPropagation(),t(i.id)},className:"absolute top-2 right-2 z-20 w-8 h-8 bg-black/80 hover:bg-red-500 rounded-full flex items-center justify-center transition-all opacity-0 group-hover:opacity-100 border border-white/20 hover:border-red-500",title:"Remove from History",children:E.jsx(uf,{size:14,className:"text-white"})}),E.jsxs(xt,{to:`/watch/${i.tmdbId}`,className:"block bg-surface rounded-xl overflow-hidden border border-white/10 hover:border-primary/50 transition-all",children:[E.jsxs("div",{className:"aspect-[2/3] relative",children:[E.jsx("img",{src:Ve.getImageUrl(i.poster_path),alt:i.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),E.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:E.jsx(an,{className:"w-12 h-12 text-white fill-current"})})]}),E.jsxs("div",{className:"p-3",children:[E.jsx("h3",{className:"text-sm font-medium text-text truncate group-hover:text-primary transition-colors",children:i.title}),E.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Watched ",new Date(i.lastWatched).toLocaleDateString()]})]})]})]},`${i.id}-${i.lastWatched}`))})]})})},Se=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},GM=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=qM},qM=Number.MAX_SAFE_INTEGER||9007199254740991;let Ie=(function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s})({}),Q=(function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",s.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",s.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.ASSET_LIST_LOAD_ERROR="assetListLoadError",s.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",s.ASSET_LIST_PARSING_ERROR="assetListParsingError",s.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.ATTACH_MEDIA_ERROR="attachMediaError",s.UNKNOWN="unknown",s})({}),L=(function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.MEDIA_ENDED="hlsMediaEnded",s.STALL_RESOLVED="hlsStallResolved",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFERED_TO_END="hlsBufferedToEnd",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s.ASSET_LIST_LOADING="hlsAssetListLoading",s.ASSET_LIST_LOADED="hlsAssetListLoaded",s.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",s.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",s.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",s.INTERSTITIAL_STARTED="hlsInterstitialStarted",s.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",s.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",s.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",s.INTERSTITIAL_ENDED="hlsInterstitialEnded",s.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",s.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",s.EVENT_CUE_ENTER="hlsEventCueEnter",s})({});var Ge={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},_e={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class gu{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class VM{constructor(e,t,i,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new gu(e),this.fast_=new gu(t),this.defaultTTFB_=n,this.ttfb_=new gu(e)}update(e,t){const{slow_:i,fast_:n,ttfb_:a}=this;i.halfLife!==e&&(this.slow_=new gu(e,i.getEstimate(),i.getTotalWeight())),n.halfLife!==t&&(this.fast_=new gu(t,n.getEstimate(),n.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new gu(e,a.getEstimate(),a.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const i=8*t,n=e/1e3,a=i/n;this.fast_.sample(n,a),this.slow_.sample(n,a)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function zM(s,e,t){return(e=KM(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function bt(){return bt=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},bt.apply(null,arguments)}function UT(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function dt(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?UT(Object(t),!0).forEach(function(i){zM(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):UT(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function YM(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var i=t.call(s,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function KM(s){var e=YM(s,"string");return typeof e=="symbol"?e:e+""}class Li{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${e}]:`;this.trace=vr,this.debug=t.debug.bind(null,i),this.log=t.log.bind(null,i),this.warn=t.warn.bind(null,i),this.info=t.info.bind(null,i),this.error=t.error.bind(null,i)}}const vr=function(){},QM={trace:vr,debug:vr,log:vr,warn:vr,info:vr,error:vr};function Pg(){return bt({},QM)}function XM(s,e){const t=self.console[s];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${s}] >`):vr}function BT(s,e,t){return e[s]?e[s].bind(e):XM(s,t)}const Ug=Pg();function WM(s,e,t){const i=Pg();if(typeof console=="object"&&s===!0||typeof s=="object"){const n=["debug","log","info","warn","error"];n.forEach(a=>{i[a]=BT(a,s,t)});try{i.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return Pg()}n.forEach(a=>{Ug[a]=BT(a,s)})}else bt(Ug,i);return i}const ft=Ug;function Mr(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function ZM(s){return typeof self<"u"&&s===self.ManagedMediaSource}function CA(s,e){const t=Object.keys(s),i=Object.keys(e),n=t.length,a=i.length;return!n||!a||n===a&&!t.some(o=>i.indexOf(o)===-1)}function ci(s,e=!1){if(typeof TextDecoder<"u"){const d=new TextDecoder("utf-8").decode(s);if(e){const m=d.indexOf("\0");return m!==-1?d.substring(0,m):d}return d.replace(/\0/g,"")}const t=s.length;let i,n,a,o="",c=0;for(;c<t;){if(i=s[c++],i===0&&e)return o;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:n=s[c++],o+=String.fromCharCode((i&31)<<6|n&63);break;case 14:n=s[c++],a=s[c++],o+=String.fromCharCode((i&15)<<12|(n&63)<<6|(a&63)<<0);break}}return o}function Es(s){let e="";for(let t=0;t<s.length;t++){let i=s[t].toString(16);i.length<2&&(i="0"+i),e+=i}return e}function NA(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function JM(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Fm={exports:{}},FT;function eP(){return FT||(FT=1,(function(s,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(f,d,m){if(m=m||{},f=f.trim(),d=d.trim(),!d){if(!m.alwaysNormalize)return f;var g=c.parseURL(f);if(!g)throw new Error("Error trying to parse base URL.");return g.path=c.normalizePath(g.path),c.buildURLFromParts(g)}var p=c.parseURL(d);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return m.alwaysNormalize?(p.path=c.normalizePath(p.path),c.buildURLFromParts(p)):d;var T=c.parseURL(f);if(!T)throw new Error("Error trying to parse base URL.");if(!T.netLoc&&T.path&&T.path[0]!=="/"){var y=n.exec(T.path);T.netLoc=y[1],T.path=y[2]}T.netLoc&&!T.path&&(T.path="/");var S={scheme:T.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(S.netLoc=T.netLoc,p.path[0]!=="/"))if(!p.path)S.path=T.path,p.params||(S.params=T.params,p.query||(S.query=T.query));else{var A=T.path,R=A.substring(0,A.lastIndexOf("/")+1)+p.path;S.path=c.normalizePath(R)}return S.path===null&&(S.path=m.alwaysNormalize?c.normalizePath(p.path):p.path),c.buildURLFromParts(S)},parseURL:function(f){var d=i.exec(f);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(a,"");f.length!==(f=f.replace(o,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};s.exports=c})()})(Fm)),Fm.exports}var $p=eP();class Gp{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var yt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class DA{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,sP(this,"stats")}setByteRange(e,t){const i=e.split("@",2);let n;i.length===1?n=(t==null?void 0:t.byteRangeEndOffset)||0:n=parseInt(i[1]),this._byteRange=[n,parseInt(i[0])+n]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[yt.AUDIO]:null,[yt.VIDEO]:null,[yt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Gp),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=$p.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[yt.AUDIO]=null,e[yt.VIDEO]=null,e[yt.AUDIOVIDEO]=null}}function Ut(s){return s.sn!=="initSegment"}class Hm extends DA{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(Se(e)&&Se(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const i=Object.keys(t);if(i.length===1){const n=this._decryptdata=t[i[0]]||null;n&&(this._decryptdata=n.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Se(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const i=Object.keys(this.levelkeys),n=i.length;if(n>1||n===1&&(t=this.levelkeys[i[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Se(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Ut(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var i;const n=t[e];n&&!((i=this._decryptdata)!=null&&i.keyId)&&(this._decryptdata=n.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,i,n,a,o=!1){const{elementaryStreams:c}=this,f=c[e];if(!f){c[e]={startPTS:t,endPTS:i,startDTS:n,endDTS:a,partial:o};return}f.startPTS=Math.min(f.startPTS,t),f.endPTS=Math.max(f.endPTS,i),f.startDTS=Math.min(f.startDTS,n),f.endDTS=Math.max(f.endDTS,a)}}class tP extends DA{constructor(e,t,i,n,a){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=n;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function wA(s,e){const t=Object.getPrototypeOf(s);if(t){const i=Object.getOwnPropertyDescriptor(t,e);return i||wA(t,e)}}function sP(s,e){const t=wA(s,e);t&&(t.enumerable=!0,Object.defineProperty(s,e,t))}const HT=Math.pow(2,32)-1,iP=[].push,OA={video:1,audio:2,id3:3,text:4};function Zt(s){return String.fromCharCode.apply(null,s)}function kA(s,e){const t=s[e]<<8|s[e+1];return t<0?65536+t:t}function Me(s,e){const t=MA(s,e);return t<0?4294967296+t:t}function jT(s,e){let t=Me(s,e);return t*=Math.pow(2,32),t+=Me(s,e+4),t}function MA(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function nP(s){const e=s.byteLength;for(let t=0;t<e;){const i=Me(s,t);if(i>8&&s[t+4]===109&&s[t+5]===111&&s[t+6]===111&&s[t+7]===102)return!0;t=i>1?t+i:e}return!1}function $e(s,e){const t=[];if(!e.length)return t;const i=s.byteLength;for(let n=0;n<i;){const a=Me(s,n),o=Zt(s.subarray(n+4,n+8)),c=a>1?n+a:i;if(o===e[0])if(e.length===1)t.push(s.subarray(n+8,c));else{const f=$e(s.subarray(n+8,c),e.slice(1));f.length&&iP.apply(t,f)}n=c}return t}function rP(s){const e=[],t=s[0];let i=8;const n=Me(s,i);i+=4;let a=0,o=0;t===0?(a=Me(s,i),o=Me(s,i+4),i+=8):(a=jT(s,i),o=jT(s,i+8),i+=16),i+=2;let c=s.length+o;const f=kA(s,i);i+=2;for(let d=0;d<f;d++){let m=i;const g=Me(s,m);m+=4;const p=g&2147483647;if((g&2147483648)>>>31===1)return ft.warn("SIDX has hierarchical references (not supported)"),null;const y=Me(s,m);m+=4,e.push({referenceSize:p,subsegmentDuration:y,info:{duration:y/n,start:c,end:c+p-1}}),c+=p,m+=4,i=m}return{earliestPresentationTime:a,timescale:n,version:t,referencesCount:f,references:e}}function PA(s){const e=[],t=$e(s,["moov","trak"]);for(let n=0;n<t.length;n++){const a=t[n],o=$e(a,["tkhd"])[0];if(o){let c=o[0];const f=Me(o,c===0?12:20),d=$e(a,["mdia","mdhd"])[0];if(d){c=d[0];const m=Me(d,c===0?12:20),g=$e(a,["mdia","hdlr"])[0];if(g){const p=Zt(g.subarray(8,12)),T={soun:yt.AUDIO,vide:yt.VIDEO}[p],y=$e(a,["mdia","minf","stbl","stsd"])[0],S=aP(y);T?(e[f]={timescale:m,type:T,stsd:S},e[T]=dt({timescale:m,id:f},S)):e[f]={timescale:m,type:p,stsd:S}}}}}return $e(s,["moov","mvex","trex"]).forEach(n=>{const a=Me(n,4),o=e[a];o&&(o.default={duration:Me(n,12),flags:Me(n,20)})}),e}function aP(s){const e=s.subarray(8),t=e.subarray(86),i=Zt(e.subarray(4,8));let n=i,a;const o=i==="enca"||i==="encv";if(o){const d=$e(e,[i])[0].subarray(i==="enca"?28:78);$e(d,["sinf"]).forEach(g=>{const p=$e(g,["schm"])[0];if(p){const T=Zt(p.subarray(4,8));if(T==="cbcs"||T==="cenc"){const y=$e(g,["frma"])[0];y&&(n=Zt(y))}}})}const c=n;switch(n){case"avc1":case"avc2":case"avc3":case"avc4":{const f=$e(t,["avcC"])[0];f&&f.length>3&&(n+="."+Ad(f[1])+Ad(f[2])+Ad(f[3]),a=Sd(c==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const f=$e(e,[i])[0],d=$e(f.subarray(28),["esds"])[0];if(d&&d.length>7){let m=4;if(d[m++]!==3)break;m=jm(d,m),m+=2;const g=d[m++];if(g&128&&(m+=2),g&64&&(m+=d[m++]),d[m++]!==4)break;m=jm(d,m);const p=d[m++];if(p===64)n+="."+Ad(p);else break;if(m+=12,d[m++]!==5)break;m=jm(d,m);const T=d[m++];let y=(T&248)>>3;y===31&&(y+=1+((T&7)<<3)+((d[m]&224)>>5)),n+="."+y}break}case"hvc1":case"hev1":{const f=$e(t,["hvcC"])[0];if(f&&f.length>12){const d=f[1],m=["","A","B","C"][d>>6],g=d&31,p=Me(f,2),T=(d&32)>>5?"H":"L",y=f[12],S=f.subarray(6,12);n+="."+m+g,n+="."+uP(p).toString(16).toUpperCase(),n+="."+T+y;let A="";for(let R=S.length;R--;){const C=S[R];(C||A)&&(A="."+C.toString(16).toUpperCase()+A)}n+=A}a=Sd(c=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{n=Sd(n,t)||n;break}case"vp09":{const f=$e(t,["vpcC"])[0];if(f&&f.length>6){const d=f[4],m=f[5],g=f[6]>>4&15;n+="."+Qi(d)+"."+Qi(m)+"."+Qi(g)}break}case"av01":{const f=$e(t,["av1C"])[0];if(f&&f.length>2){const d=f[1]>>>5,m=f[1]&31,g=f[2]>>>7?"H":"M",p=(f[2]&64)>>6,T=(f[2]&32)>>5,y=d===2&&p?T?12:10:p?10:8,S=(f[2]&16)>>4,A=(f[2]&8)>>3,R=(f[2]&4)>>2,C=f[2]&3;n+="."+d+"."+Qi(m)+g+"."+Qi(y)+"."+S+"."+A+R+C+"."+Qi(1)+"."+Qi(1)+"."+Qi(1)+"."+0,a=Sd("dav1",t)}break}}return{codec:n,encrypted:o,supplemental:a}}function Sd(s,e){const t=$e(e,["dvvC"]),i=t.length?t[0]:$e(e,["dvcC"])[0];if(i){const n=i[2]>>1&127,a=i[2]<<5&32|i[3]>>3&31;return s+"."+Qi(n)+"."+Qi(a)}}function uP(s){let e=0;for(let t=0;t<32;t++)e|=(s>>t&1)<<31-t;return e>>>0}function jm(s,e){const t=e+5;for(;s[e++]&128&&e<t;);return e}function Ad(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function Qi(s){return(s<10?"0":"")+s}function oP(s,e){if(!s||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&UA(s,(i,n)=>{const a=i.subarray(8,24);a.some(o=>o!==0)||(ft.log(`[eme] Patching keyId in 'enc${n?"a":"v"}>sinf>>tenc' box: ${Es(a)} -> ${Es(t)}`),i.set(t,8))})}function lP(s){const e=[];return UA(s,t=>e.push(t.subarray(8,24))),e}function UA(s,e){$e(s,["moov","trak"]).forEach(i=>{const n=$e(i,["mdia","minf","stbl","stsd"])[0];if(!n)return;const a=n.subarray(8);let o=$e(a,["enca"]);const c=o.length>0;c||(o=$e(a,["encv"])),o.forEach(f=>{const d=c?f.subarray(28):f.subarray(78);$e(d,["sinf"]).forEach(g=>{const p=BA(g);p&&e(p,c)})})})}function BA(s){const e=$e(s,["schm"])[0];if(e){const t=Zt(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const i=$e(s,["schi","tenc"])[0];if(i)return i}}}function cP(s,e,t){const i={},n=$e(s,["moof","traf"]);for(let a=0;a<n.length;a++){const o=n[a],c=$e(o,["tfhd"])[0],f=Me(c,4),d=e[f];if(!d)continue;i[f]||(i[f]={start:NaN,duration:0,sampleCount:0,timescale:d.timescale,type:d.type});const m=i[f],g=$e(o,["tfdt"])[0];if(g){const I=g[0];let D=Me(g,4);I===1&&(D===HT?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(D*=HT+1,D+=Me(g,8))),Se(D)&&(!Se(m.start)||D<m.start)&&(m.start=D)}const p=d.default,T=Me(c,0)|(p==null?void 0:p.flags);let y=(p==null?void 0:p.duration)||0;T&8&&(T&2?y=Me(c,12):y=Me(c,8));const S=$e(o,["trun"]);let A=m.start||0,R=0,C=y;for(let I=0;I<S.length;I++){const D=S[I],k=Me(D,4),z=m.sampleCount;m.sampleCount+=k;const P=D[3]&1,V=D[3]&4,$=D[2]&1,j=D[2]&2,te=D[2]&4,ge=D[2]&8;let ye=8,ve=k;for(P&&(ye+=4),V&&k&&(!(D[ye+1]&1)&&m.keyFrameIndex===void 0&&(m.keyFrameIndex=z),ye+=4,$?(C=Me(D,ye),ye+=4):C=y,j&&(ye+=4),ge&&(ye+=4),A+=C,R+=C,ve--);ve--;)$?(C=Me(D,ye),ye+=4):C=y,j&&(ye+=4),te&&(D[ye+1]&1||m.keyFrameIndex===void 0&&(m.keyFrameIndex=m.sampleCount-(ve+1),m.keyFrameStart=A),ye+=4),ge&&(ye+=4),A+=C,R+=C;!R&&y&&(R+=y*k)}m.duration+=R}if(!Object.keys(i).some(a=>i[a].duration)){let a=1/0,o=0;const c=$e(s,["sidx"]);for(let f=0;f<c.length;f++){const d=rP(c[f]);if(d!=null&&d.references){a=Math.min(a,d.earliestPresentationTime/d.timescale);const m=d.references.reduce((g,p)=>g+p.info.duration||0,0);o=Math.max(o,m+d.earliestPresentationTime/d.timescale)}}o&&Se(o)&&Object.keys(i).forEach(f=>{i[f].duration||(i[f].duration=o*i[f].timescale-i[f].start)})}return i}function dP(s){const e={valid:null,remainder:null},t=$e(s,["moof"]);if(t.length<2)return e.remainder=s,e;const i=t[t.length-1];return e.valid=s.slice(0,i.byteOffset-8),e.remainder=s.slice(i.byteOffset-8),e}function _i(s,e){const t=new Uint8Array(s.length+e.length);return t.set(s),t.set(e,s.length),t}function $T(s,e){const t=[],i=e.samples,n=e.timescale,a=e.id;let o=!1;return $e(i,["moof"]).map(f=>{const d=f.byteOffset-8;$e(f,["traf"]).map(g=>{const p=$e(g,["tfdt"]).map(T=>{const y=T[0];let S=Me(T,4);return y===1&&(S*=Math.pow(2,32),S+=Me(T,8)),S/n})[0];return p!==void 0&&(s=p),$e(g,["tfhd"]).map(T=>{const y=Me(T,4),S=Me(T,0)&16777215,A=(S&1)!==0,R=(S&2)!==0,C=(S&8)!==0;let I=0;const D=(S&16)!==0;let k=0;const z=(S&32)!==0;let P=8;y===a&&(A&&(P+=8),R&&(P+=4),C&&(I=Me(T,P),P+=4),D&&(k=Me(T,P),P+=4),z&&(P+=4),e.type==="video"&&(o=Jf(e.codec)),$e(g,["trun"]).map(V=>{const $=V[0],j=Me(V,0)&16777215,te=(j&1)!==0;let ge=0;const ye=(j&4)!==0,ve=(j&256)!==0;let ue=0;const F=(j&512)!==0;let J=0;const se=(j&1024)!==0,ne=(j&2048)!==0;let xe=0;const O=Me(V,4);let G=8;te&&(ge=Me(V,G),G+=4),ye&&(G+=4);let de=ge+d;for(let pe=0;pe<O;pe++){if(ve?(ue=Me(V,G),G+=4):ue=I,F?(J=Me(V,G),G+=4):J=k,se&&(G+=4),ne&&($===0?xe=Me(V,G):xe=MA(V,G),G+=4),e.type===yt.VIDEO){let Te=0;for(;Te<J;){const Ae=Me(i,de);if(de+=4,fP(o,i[de])){const ke=i.subarray(de,de+Ae);qp(ke,o?2:1,s+xe/n,t)}de+=Ae,Te+=Ae+4}}s+=ue/n}}))})})}),t}function Jf(s){if(!s)return!1;const e=s.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function fP(s,e){if(s){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function qp(s,e,t,i){const n=FA(s);let a=0;a+=e;let o=0,c=0,f=0;for(;a<n.length;){o=0;do{if(a>=n.length)break;f=n[a++],o+=f}while(f===255);c=0;do{if(a>=n.length)break;f=n[a++],c+=f}while(f===255);const d=n.length-a;let m=a;if(c<d)a+=c;else if(c>d){ft.error(`Malformed SEI payload. ${c} is too small, only ${d} bytes left to parse.`);break}if(o===4){if(n[m++]===181){const p=kA(n,m);if(m+=2,p===49){const T=Me(n,m);if(m+=4,T===1195456820){const y=n[m++];if(y===3){const S=n[m++],A=31&S,R=64&S,C=R?2+A*3:0,I=new Uint8Array(C);if(R){I[0]=S;for(let D=1;D<C;D++)I[D]=n[m++]}i.push({type:y,payloadType:o,pts:t,bytes:I})}}}}}else if(o===5&&c>16){const g=[];for(let y=0;y<16;y++){const S=n[m++].toString(16);g.push(S.length==1?"0"+S:S),(y===3||y===5||y===7||y===9)&&g.push("-")}const p=c-16,T=new Uint8Array(p);for(let y=0;y<p;y++)T[y]=n[m++];i.push({payloadType:o,pts:t,uuid:g.join(""),userData:ci(T),userDataBytes:T})}}}function FA(s){const e=s.byteLength,t=[];let i=1;for(;i<e-2;)s[i]===0&&s[i+1]===0&&s[i+2]===3?(t.push(i+2),i+=2):i++;if(t.length===0)return s;const n=e-t.length,a=new Uint8Array(n);let o=0;for(i=0;i<n;o++,i++)o===t[0]&&(o++,t.shift()),a[i]=s[o];return a}function hP(s){const e=s[0];let t="",i="",n=0,a=0,o=0,c=0,f=0,d=0;if(e===0){for(;Zt(s.subarray(d,d+1))!=="\0";)t+=Zt(s.subarray(d,d+1)),d+=1;for(t+=Zt(s.subarray(d,d+1)),d+=1;Zt(s.subarray(d,d+1))!=="\0";)i+=Zt(s.subarray(d,d+1)),d+=1;i+=Zt(s.subarray(d,d+1)),d+=1,n=Me(s,12),a=Me(s,16),c=Me(s,20),f=Me(s,24),d=28}else if(e===1){d+=4,n=Me(s,d),d+=4;const g=Me(s,d);d+=4;const p=Me(s,d);for(d+=4,o=2**32*g+p,GM(o)||(o=Number.MAX_SAFE_INTEGER,ft.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=Me(s,d),d+=4,f=Me(s,d),d+=4;Zt(s.subarray(d,d+1))!=="\0";)t+=Zt(s.subarray(d,d+1)),d+=1;for(t+=Zt(s.subarray(d,d+1)),d+=1;Zt(s.subarray(d,d+1))!=="\0";)i+=Zt(s.subarray(d,d+1)),d+=1;i+=Zt(s.subarray(d,d+1)),d+=1}const m=s.subarray(d,s.byteLength);return{schemeIdUri:t,value:i,timeScale:n,presentationTime:o,presentationTimeDelta:a,eventDuration:c,id:f,payload:m}}function mP(s,...e){const t=e.length;let i=8,n=t;for(;n--;)i+=e[n].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(s,4),n=0,i=8;n<t;n++)a.set(e[n],i),i+=e[n].byteLength;return a}function gP(s,e,t){if(s.byteLength!==16)throw new RangeError("Invalid system id");let i,n;i=0,n=new Uint8Array;let a;i>0?(a=new Uint8Array(4),e.length>0&&new DataView(a.buffer).setUint32(0,e.length,!1)):a=new Uint8Array;const o=new Uint8Array(4);return t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),mP([112,115,115,104],new Uint8Array([i,0,0,0]),s,a,n,o,t)}function pP(s){const e=[];if(s instanceof ArrayBuffer){const t=s.byteLength;let i=0;for(;i+32<t;){const n=new DataView(s,i),a=bP(n);e.push(a),i+=a.size}}return e}function bP(s){const e=s.getUint32(0),t=s.byteOffset,i=s.byteLength;if(i<e)return{offset:t,size:i};if(s.getUint32(4)!==1886614376)return{offset:t,size:e};const a=s.getUint32(8)>>>24;if(a!==0&&a!==1)return{offset:t,size:e};const o=s.buffer,c=Es(new Uint8Array(o,t+12,16));let f=null,d=null,m=0;if(a===0)m=28;else{const p=s.getUint32(28);if(!p||i<32+p*16)return{offset:t,size:e};f=[];for(let T=0;T<p;T++)f.push(new Uint8Array(o,t+32+T*16,16));m=32+p*16}if(!m)return{offset:t,size:e};const g=s.getUint32(m);return e-32<g?{offset:t,size:e}:(d=new Uint8Array(o,t+m+4,g),{version:a,systemId:c,kids:f,data:d,offset:t,size:e})}const HA=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),ju={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Vp(s,e){const t=ju[e];return!!t&&!!t[s.slice(0,4)]}function _l(s,e,t=!0){return!s.split(",").some(i=>!zp(i,e,t))}function zp(s,e,t=!0){var i;const n=Mr(t);return(i=n==null?void 0:n.isTypeSupported(Ll(s,e)))!=null?i:!1}function Ll(s,e){return`${e}/mp4;codecs=${s}`}function GT(s){if(s){const e=s.substring(0,4);return ju.video[e]}return 2}function xf(s){const e=HA();return s.split(",").reduce((t,i)=>{const a=e&&Jf(i)?9:ju.video[i];return a?(a*2+t)/(t?3:2):(ju.audio[i]+t)/(t?2:1)},0)}const $m={};function EP(s,e=!0){if($m[s])return $m[s];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[s];for(let n=0;n<t.length;n++){var i;if(zp(t[n],"audio",e))return $m[s]=t[n],t[n];if(t[n]==="mp3"&&(i=Mr(e))!=null&&i.isTypeSupported("audio/mpeg"))return""}return s}const yP=/flac|opus|mp4a\.40\.34/i;function Tf(s,e=!0){return s.replace(yP,t=>EP(t.toLowerCase(),e))}function xP(s,e){const t=[];if(s){const i=s.split(",");for(let n=0;n<i.length;n++)Vp(i[n],"video")||t.push(i[n])}return e&&t.push(e),t.join(",")}function zd(s,e){if(s&&(s.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(s)!==-1)&&(qT(s,"audio")||qT(s,"video")))return s;if(e){const t=e.split(",");if(t.length>1){if(s){for(let i=t.length;i--;)if(t[i].substring(0,4)===s.substring(0,4))return t[i]}return t[0]}}return e||s}function qT(s,e){return Vp(s,e)&&zp(s,e)}function TP(s){const e=s.split(",");for(let t=0;t<e.length;t++){const i=e[t].split(".");i.length>2&&i[0]==="avc1"&&(e[t]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return e.join(",")}function vP(s){if(s.startsWith("av01.")){const e=s.split("."),t=["0","111","01","01","01","0"];for(let i=e.length;i>4&&i<10;i++)e[i]=t[i-4];return e.join(".")}return s}function VT(s){const e=Mr(s)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Bg(s){return s.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const SP={supported:!0,powerEfficient:!0,smooth:!0},AP={supported:!1,smooth:!1,powerEfficient:!1},jA={supported:!0,configurations:[],decodingInfoResults:[SP]};function $A(s,e){return{supported:!1,configurations:e,decodingInfoResults:[AP],error:s}}function _P(s,e,t,i,n,a){const o=s.videoCodec,c=s.audioCodec?s.audioGroups:null,f=a==null?void 0:a.audioCodec,d=a==null?void 0:a.channels,m=d?parseInt(d):f?1/0:2;let g=null;if(c!=null&&c.length)try{c.length===1&&c[0]?g=e.groups[c[0]].channels:g=c.reduce((p,T)=>{if(T){const y=e.groups[T];if(!y)throw new Error(`Audio track group ${T} not found`);Object.keys(y.channels).forEach(S=>{p[S]=(p[S]||0)+y.channels[S]})}return p},{2:0})}catch{return!0}return o!==void 0&&(o.split(",").some(p=>Jf(p))||s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(i,30)||s.videoRange!=="SDR"&&s.videoRange!==t||s.bitrate>Math.max(n,8e6))||!!g&&Se(m)&&Object.keys(g).some(p=>parseInt(p)>m)}function GA(s,e,t,i={}){const n=s.videoCodec;if(!n&&!s.audioCodec||!t)return Promise.resolve(jA);const a=[],o=LP(s),c=o.length,f=RP(s,e,c>0),d=f.length;for(let m=c||1*d||1;m--;){const g={type:"media-source"};if(c&&(g.video=o[m%c]),d){g.audio=f[m%d];const p=g.audio.bitrate;g.video&&p&&(g.video.bitrate-=p)}a.push(g)}if(n){const m=navigator.userAgent;if(n.split(",").some(g=>Jf(g))&&HA())return Promise.resolve($A(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${m})`),a))}return Promise.all(a.map(m=>{const g=CP(m);return i[g]||(i[g]=t.decodingInfo(m))})).then(m=>({supported:!m.some(g=>!g.supported),configurations:a,decodingInfoResults:m})).catch(m=>({supported:!1,configurations:a,decodingInfoResults:[],error:m}))}function LP(s){var e;const t=(e=s.videoCodec)==null?void 0:e.split(","),i=qA(s),n=s.width||640,a=s.height||480,o=s.frameRate||30,c=s.videoRange.toLowerCase();return t?t.map(f=>{const d={contentType:Ll(vP(f),"video"),width:n,height:a,bitrate:i,framerate:o};return c!=="sdr"&&(d.transferFunction=c),d}):[]}function RP(s,e,t){var i;const n=(i=s.audioCodec)==null?void 0:i.split(","),a=qA(s);return n&&s.audioGroups?s.audioGroups.reduce((o,c)=>{var f;const d=c?(f=e.groups[c])==null?void 0:f.tracks:null;return d?d.reduce((m,g)=>{if(g.groupId===c){const p=parseFloat(g.channels||"");n.forEach(T=>{const y={contentType:Ll(T,"audio"),bitrate:t?IP(T,a):a};p&&(y.channels=""+p),m.push(y)})}return m},o):o},[]):[]}function IP(s,e){if(e<=1)return 1;let t=128e3;return s==="ec-3"?t=768e3:s==="ac-3"&&(t=64e4),Math.min(e/2,t)}function qA(s){return Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)/1e3)*1e3||1}function CP(s){let e="";const{audio:t,video:i}=s;if(i){const n=Bg(i.contentType);e+=`${n}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`}if(t){const n=Bg(t.contentType);e+=`${i?"_":""}${n}_c${t.channels}`}return e}const Fg=["NONE","TYPE-0","TYPE-1",null];function NP(s){return Fg.indexOf(s)>-1}const vf=["SDR","PQ","HLG"];function DP(s){return!!s&&vf.indexOf(s)>-1}var Yd={No:"",Yes:"YES",v2:"v2"};function zT(s){const{canSkipUntil:e,canSkipDateRanges:t,age:i}=s,n=i<e/2;return e&&n?t?Yd.v2:Yd.Yes:Yd.No}class YT{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Rl{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const i=(t=e.supplemental)==null?void 0:t.videoCodec;i&&i!==e.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return KT(this._audioGroups,e)}hasSubtitleGroup(e){return KT(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(t)===-1&&i.push(t)}else if(e==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(t)===-1&&i.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function KT(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function wP(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function OP(s,e){let t=!1,i=[];if(s&&(t=s!=="SDR",i=[s]),e){i=e.allowedVideoRanges||vf.slice(0);const n=i.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:n&&wP(),t||(i=["SDR"])}return{preferHDR:t,allowedVideoRanges:i}}const kP=s=>{const e=new WeakSet;return(t,i)=>{if(s&&(i=s(t,i)),typeof i=="object"&&i!==null){if(e.has(i))return;e.add(i)}return i}},Tt=(s,e)=>JSON.stringify(s,kP(e));function MP(s,e,t,i,n){const a=Object.keys(s),o=i==null?void 0:i.channels,c=i==null?void 0:i.audioCodec,f=n==null?void 0:n.videoCodec,d=o&&parseInt(o)===2;let m=!1,g=!1,p=1/0,T=1/0,y=1/0,S=1/0,A=0,R=[];const{preferHDR:C,allowedVideoRanges:I}=OP(e,n);for(let V=a.length;V--;){const $=s[a[V]];m||(m=$.channels[2]>0),p=Math.min(p,$.minHeight),T=Math.min(T,$.minFramerate),y=Math.min(y,$.minBitrate),I.filter(te=>$.videoRanges[te]>0).length>0&&(g=!0)}p=Se(p)?p:0,T=Se(T)?T:0;const D=Math.max(1080,p),k=Math.max(30,T);y=Se(y)?y:t,t=Math.max(y,t),g||(e=void 0);const z=a.length>1;return{codecSet:a.reduce((V,$)=>{const j=s[$];if($===V)return V;if(R=g?I.filter(te=>j.videoRanges[te]>0):[],z){if(j.minBitrate>t)return Yi($,`min bitrate of ${j.minBitrate} > current estimate of ${t}`),V;if(!j.hasDefaultAudio)return Yi($,"no renditions with default or auto-select sound found"),V;if(c&&$.indexOf(c.substring(0,4))%5!==0)return Yi($,`audio codec preference "${c}" not found`),V;if(o&&!d){if(!j.channels[o])return Yi($,`no renditions with ${o} channel sound found (channels options: ${Object.keys(j.channels)})`),V}else if((!c||d)&&m&&j.channels[2]===0)return Yi($,"no renditions with stereo sound found"),V;if(j.minHeight>D)return Yi($,`min resolution of ${j.minHeight} > maximum of ${D}`),V;if(j.minFramerate>k)return Yi($,`min framerate of ${j.minFramerate} > maximum of ${k}`),V;if(!R.some(te=>j.videoRanges[te]>0))return Yi($,`no variants with VIDEO-RANGE of ${Tt(R)} found`),V;if(f&&$.indexOf(f.substring(0,4))%5!==0)return Yi($,`video codec preference "${f}" not found`),V;if(j.maxScore<A)return Yi($,`max score of ${j.maxScore} < selected max of ${A}`),V}return V&&(xf($)>=xf(V)||j.fragmentError>s[V].fragmentError)?V:(S=j.minIndex,A=j.maxScore,$)},void 0),videoRanges:R,preferHDR:C,minFramerate:T,minBitrate:y,minIndex:S}}function Yi(s,e){ft.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function VA(s){return s.reduce((e,t)=>{let i=e.groups[t.groupId];i||(i=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(t);const n=t.channels||"2";return i.channels[n]=(i.channels[n]||0)+1,i.hasDefault=i.hasDefault||t.default,i.hasAutoSelect=i.hasAutoSelect||t.autoselect,i.hasDefault&&(e.hasDefaultAudio=!0),i.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function PP(s,e,t,i){return s.slice(t,i+1).reduce((n,a,o)=>{if(!a.codecSet)return n;const c=a.audioGroups;let f=n[a.codecSet];f||(n[a.codecSet]=f={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!c,fragmentError:0}),f.minBitrate=Math.min(f.minBitrate,a.bitrate);const d=Math.min(a.height,a.width);return f.minHeight=Math.min(f.minHeight,d),f.minFramerate=Math.min(f.minFramerate,a.frameRate),f.minIndex=Math.min(f.minIndex,o),f.maxScore=Math.max(f.maxScore,a.score),f.fragmentError+=a.fragmentError,f.videoRanges[a.videoRange]=(f.videoRanges[a.videoRange]||0)+1,c&&c.forEach(m=>{if(!m)return;const g=e.groups[m];g&&(f.hasDefaultAudio=f.hasDefaultAudio||e.hasDefaultAudio?g.hasDefault:g.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(g.channels).forEach(p=>{f.channels[p]=(f.channels[p]||0)+g.channels[p]}))}),n},{})}function QT(s){if(!s)return s;const{lang:e,assocLang:t,characteristics:i,channels:n,audioCodec:a}=s;return{lang:e,assocLang:t,characteristics:i,channels:n,audioCodec:a}}function nn(s,e,t){if("attrs"in s){const i=e.indexOf(s);if(i!==-1)return i}for(let i=0;i<e.length;i++){const n=e[i];if(Ea(s,n,t))return i}return-1}function Ea(s,e,t){const{groupId:i,name:n,lang:a,assocLang:o,default:c}=s,f=s.forced;return(i===void 0||e.groupId===i)&&(n===void 0||e.name===n)&&(a===void 0||UP(a,e.lang))&&(a===void 0||e.assocLang===o)&&(c===void 0||e.default===c)&&(f===void 0||e.forced===f)&&(!("characteristics"in s)||BP(s.characteristics||"",e.characteristics))&&(t===void 0||t(s,e))}function UP(s,e="--"){return s.length===e.length?s===e:s.startsWith(e)||e.startsWith(s)}function BP(s,e=""){const t=s.split(","),i=e.split(",");return t.length===i.length&&!t.some(n=>i.indexOf(n)===-1)}function ua(s,e){const{audioCodec:t,channels:i}=s;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(i===void 0||i===(e.channels||"2"))}function FP(s,e,t,i,n){const a=e[i],c=e.reduce((p,T,y)=>{const S=T.uri;return(p[S]||(p[S]=[])).push(y),p},{})[a.uri];c.length>1&&(i=Math.max.apply(Math,c));const f=a.videoRange,d=a.frameRate,m=a.codecSet.substring(0,4),g=XT(e,i,p=>{if(p.videoRange!==f||p.frameRate!==d||p.codecSet.substring(0,4)!==m)return!1;const T=p.audioGroups,y=t.filter(S=>!T||T.indexOf(S.groupId)!==-1);return nn(s,y,n)>-1});return g>-1?g:XT(e,i,p=>{const T=p.audioGroups,y=t.filter(S=>!T||T.indexOf(S.groupId)!==-1);return nn(s,y,n)>-1})}function XT(s,e,t){for(let i=e;i>-1;i--)if(t(s[i]))return i;for(let i=e+1;i<s.length;i++)if(t(s[i]))return i;return-1}function Sf(s,e){var t;return!!s&&s!==((t=e.loadLevelObj)==null?void 0:t.uri)}class HP extends Li{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var i;const{fragCurrent:n,partCurrent:a,hls:o}=this,{autoLevelEnabled:c,media:f}=o;if(!n||!f)return;const d=performance.now(),m=a?a.stats:n.stats,g=a?a.duration:n.duration,p=d-m.loading.start,T=o.minAutoLevel,y=n.level,S=this._nextAutoLevel;if(m.aborted||m.loaded&&m.loaded===m.total||y<=T){this.clearTimer(),this._nextAutoLevel=-1;return}if(!c)return;const A=S>-1&&S!==y,R=!!t||A;if(!R&&(f.paused||!f.playbackRate||!f.readyState))return;const C=o.mainForwardBufferInfo;if(!R&&C===null)return;const I=this.bwEstimator.getEstimateTTFB(),D=Math.abs(f.playbackRate);if(p<=Math.max(I,1e3*(g/(D*2))))return;const k=C?C.len/D:0,z=m.loading.first?m.loading.first-m.loading.start:-1,P=m.loaded&&z>-1,V=this.getBwEstimate(),$=o.levels,j=$[y],te=Math.max(m.loaded,Math.round(g*(n.bitrate||j.averageBitrate)/8));let ge=P?p-z:p;ge<1&&P&&(ge=Math.min(p,m.loaded*8/V));const ye=P?m.loaded*1e3/ge:0,ve=I/1e3,ue=ye?(te-m.loaded)/ye:te*8/V+ve;if(ue<=k)return;const F=ye?ye*8:V,J=((i=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,se=this.hls.config.abrBandWidthUpFactor;let ne=Number.POSITIVE_INFINITY,xe;for(xe=y-1;xe>T;xe--){const pe=$[xe].maxBitrate,Te=!$[xe].details||J;if(ne=this.getTimeToLoadFrag(ve,F,g*pe,Te),ne<Math.min(k,g+ve))break}if(ne>=ue||ne>g*10)return;P?this.bwEstimator.sample(p-Math.min(I,z),m.loaded):this.bwEstimator.sampleTTFB(p);const O=$[xe].maxBitrate;this.getBwEstimate()*se>O&&this.resetEstimator(O);const G=this.findBestLevel(O,T,xe,0,k,1,1);G>-1&&(xe=G),this.warn(`Fragment ${n.sn}${a?" part "+a.index:""} of level ${y} is loading too slowly;
      Fragment duration: ${n.duration.toFixed(3)}
      Time to underbuffer: ${k.toFixed(3)} s
      Estimated load time for current fragment: ${ue.toFixed(3)} s
      Estimated load time for down switch fragment: ${ne.toFixed(3)} s
      TTFB estimate: ${z|0} ms
      Current BW estimate: ${Se(V)?V|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${xe} @ ${O|0} bps`),o.nextLoadLevel=o.nextAutoLevel=xe,this.clearTimer();const de=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===xe&&xe>0){const pe=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${xe>0?"and switching down":""}
      Fragment duration: ${n.duration.toFixed(3)} s
      Time to underbuffer: ${pe.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,xe>T){let Te=this.findBestLevel(this.hls.levels[T].bitrate,T,xe,0,pe,1,1);Te===-1&&(Te=T),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Te,this.resetEstimator(this.hls.levels[Te].bitrate)}}};A||ue>ne*2?de():this.timer=self.setInterval(de,ne*1e3),o.trigger(L.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:a,stats:m})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new VM(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(L.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const i=t.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var n;this.fragCurrent=i,this.partCurrent=(n=t.part)!=null?n:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Q.FRAG_LOAD_TIMEOUT:{const i=t.frag,{fragCurrent:n,partCurrent:a}=this;if(i&&n&&i.sn===n.sn&&i.level===n.level){const o=performance.now(),c=a?a.stats:i.stats,f=o-c.loading.start,d=c.loading.first?c.loading.first-c.loading.start:-1;if(c.loaded&&d>-1){const g=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(f-Math.min(g,d),c.loaded)}else this.bwEstimator.sampleTTFB(f)}break}}}getTimeToLoadFrag(e,t,i,n){const a=e+i/t,o=n?e+this.lastLevelLoadSec:0;return a+o}onLevelLoaded(e,t){const i=this.hls.config,{loading:n}=t.stats,a=n.end-n.first;Se(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:i}){const n=i?i.stats:t.stats;if(t.type===_e.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const a=i?i.duration:t.duration,o=this.hls.levels[t.level],c=(o.loaded?o.loaded.bytes:0)+n.loaded,f=(o.loaded?o.loaded.duration:0)+a;o.loaded={bytes:c,duration:f},o.realBitrate=Math.round(8*c/f)}if(t.bitrateTest){const a={stats:n,frag:t,part:i,id:t.type};this.onFragBuffered(L.FRAG_BUFFERED,a),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:i,part:n}=t,a=n!=null&&n.stats.loaded?n.stats:i.stats;if(a.aborted||this.ignoreFragment(i))return;const o=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,a.loaded),a.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==_e.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,i=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,a=this.findBestLevel(i,t,e,0,n,1,1);if(a>-1)return a;const o=this.hls.firstLevel,c=Math.min(Math.max(o,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${c}`),c}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(e!==-1&&(!i||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const a=i&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,a)&&o[e].loadError<=o[a].loadError)return e}return this._nextAutoLevel=a,this.nextAutoLevelKey=this.getAutoLevelKey(),a}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:n,config:a,minAutoLevel:o}=i,c=t?t.duration:e?e.duration:0,f=this.getBwEstimate(),d=this.getStarvationDelay();let m=a.abrBandWidthFactor,g=a.abrBandWidthUpFactor;if(d){const A=this.findBestLevel(f,o,n,d,0,m,g);if(A>=0)return this.rebufferNotice=-1,A}let p=c?Math.min(c,a.maxStarvationDelay):a.maxStarvationDelay;if(!d){const A=this.bitrateTestDelay;A&&(p=(c?Math.min(c,a.maxLoadingDelay):a.maxLoadingDelay)-A,this.info(`bitrate test took ${Math.round(1e3*A)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),m=g=1)}const T=this.findBestLevel(f,o,n,d,p,m,g);if(this.rebufferNotice!==T&&(this.rebufferNotice=T,this.info(`${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${T}`)),T>-1)return T;const y=i.levels[o],S=i.loadLevelObj;return S&&(y==null?void 0:y.bitrate)<S.bitrate?o:i.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const i=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,i,n,a,o,c){var f;const d=n+a,m=this.lastLoadedFragLevel,g=m===-1?this.hls.firstLevel:m,{fragCurrent:p,partCurrent:T}=this,{levels:y,allAudioTracks:S,loadLevel:A,config:R}=this.hls;if(y.length===1)return 0;const C=y[g],I=!!((f=this.hls.latestLevelDetails)!=null&&f.live),D=A===-1||m===-1;let k,z="SDR",P=(C==null?void 0:C.frameRate)||0;const{audioPreference:V,videoPreference:$}=R,j=this.audioTracksByGroup||(this.audioTracksByGroup=VA(S));let te=-1;if(D){if(this.firstSelection!==-1)return this.firstSelection;const F=this.codecTiers||(this.codecTiers=PP(y,j,t,i)),J=MP(F,z,e,V,$),{codecSet:se,videoRanges:ne,minFramerate:xe,minBitrate:O,minIndex:G,preferHDR:de}=J;te=G,k=se,z=de?ne[ne.length-1]:ne[0],P=xe,e=Math.max(e,O),this.log(`picked start tier ${Tt(J)}`)}else k=C==null?void 0:C.codecSet,z=C==null?void 0:C.videoRange;const ge=T?T.duration:p?p.duration:0,ye=this.bwEstimator.getEstimateTTFB()/1e3,ve=[];for(let F=i;F>=t;F--){var ue;const J=y[F],se=F>g;if(!J)continue;if(R.useMediaCapabilities&&!J.supportedResult&&!J.supportedPromise){const Te=navigator.mediaCapabilities;typeof(Te==null?void 0:Te.decodingInfo)=="function"&&_P(J,j,z,P,e,V)?(J.supportedPromise=GA(J,j,Te,this.supportedCache),J.supportedPromise.then(Ae=>{if(!this.hls)return;J.supportedResult=Ae;const ke=this.hls.levels,st=ke.indexOf(J);Ae.error?this.warn(`MediaCapabilities decodingInfo error: "${Ae.error}" for level ${st} ${Tt(Ae)}`):Ae.supported?Ae.decodingInfoResults.some(Je=>Je.smooth===!1||Je.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${st} not smooth or powerEfficient: ${Tt(Ae)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${st} ${Tt(Ae)}`),st>-1&&ke.length>1&&(this.log(`Removing unsupported level ${st}`),this.hls.removeLevel(st),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(Ae=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${Ae}`)})):J.supportedResult=jA}if((k&&J.codecSet!==k||z&&J.videoRange!==z||se&&P>J.frameRate||!se&&P>0&&P<J.frameRate||(ue=J.supportedResult)!=null&&(ue=ue.decodingInfoResults)!=null&&ue.some(Te=>Te.smooth===!1))&&(!D||F!==te)){ve.push(F);continue}const ne=J.details,xe=(T?ne==null?void 0:ne.partTarget:ne==null?void 0:ne.averagetargetduration)||ge;let O;se?O=c*e:O=o*e;const G=ge&&n>=ge*2&&a===0?J.averageBitrate:J.maxBitrate,de=this.getTimeToLoadFrag(ye,O,G*xe,ne===void 0);if(O>=G&&(F===m||J.loadError===0&&J.fragmentError===0)&&(de<=ye||!Se(de)||I&&!this.bitrateTestDelay||de<d)){const Te=this.forcedAutoLevel;return F!==A&&(Te===-1||Te!==A)&&(ve.length&&this.trace(`Skipped level(s) ${ve.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${y[ve[0]].codecs}" ${y[ve[0]].videoRange}; not compatible with "${k}" ${z}`),this.info(`switch candidate:${g}->${F} adjustedbw(${Math.round(O)})-bitrate=${Math.round(O-G)} ttfb:${ye.toFixed(1)} avgDuration:${xe.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${de.toFixed(1)} firstSelection:${D} codecSet:${J.codecSet} videoRange:${J.videoRange} hls.loadLevel:${A}`)),D&&(this.firstSelection=F),F}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:i}=this.hls;return Math.min(Math.max(e,i),t)}}const zA={search:function(s,e){let t=0,i=s.length-1,n=null,a=null;for(;t<=i;){n=(t+i)/2|0,a=s[n];const o=e(a);if(o>0)t=n+1;else if(o<0)i=n-1;else return a}return null}};function jP(s,e,t){if(e===null||!Array.isArray(s)||!s.length||!Se(e))return null;const i=s[0].programDateTime;if(e<(i||0))return null;const n=s[s.length-1].endProgramDateTime;if(e>=(n||0))return null;for(let a=0;a<s.length;++a){const o=s[a];if(GP(e,t,o))return o}return null}function Sa(s,e,t=0,i=0,n=.005){let a=null;if(s){a=e[1+s.sn-e[0].sn]||null;const c=s.endDTS-t;c>0&&c<15e-7&&(t+=15e-7),a&&s.level!==a.level&&a.end<=s.end&&(a=e[2+s.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(a=e[0]);if(a&&((!s||s.level===a.level)&&WT(t,i,a)===0||$P(a,s,Math.min(n,i))))return a;const o=zA.search(e,WT.bind(null,t,i));return o&&(o!==s||!a)?o:a}function $P(s,e,t){if(e&&e.start===0&&e.level<s.level&&(e.endPTS||0)>0){const i=e.tagList.reduce((n,a)=>(a[0]==="INF"&&(n+=parseFloat(a[1])),n),t);return s.start<=i}return!1}function WT(s=0,e=0,t){if(t.start<=s&&t.start+t.duration>s)return 0;const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-i<=s?1:t.start-i>s&&t.start?-1:0}function GP(s,e,t){const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-i>s}function YA(s,e,t){if(s&&s.startCC<=e&&s.endCC>=e){let i=s.fragments;const{fragmentHint:n}=s;n&&(i=i.concat(n));let a;return zA.search(i,o=>o.cc<e?1:o.cc>e?-1:(a=o,o.end<=t?1:o.start>t?-1:0)),a||null}return null}function Af(s){switch(s.details){case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_TIMEOUT:case Q.LEVEL_LOAD_TIMEOUT:case Q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function KA(s){return s.details.startsWith("key")}function QA(s){return KA(s)&&!!s.frag&&!s.frag.decryptdata}function ZT(s,e){const t=Af(e);return s.default[`${t?"timeout":"error"}Retry`]}function Yp(s,e){const t=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function JT(s){return dt(dt({},s),{errorRetry:null,timeoutRetry:null})}function _f(s,e,t,i){if(!s)return!1;const n=i==null?void 0:i.code,a=e<s.maxNumRetry&&(qP(n)||!!t);return s.shouldRetry?s.shouldRetry(s,e,t,i,a):a}function qP(s){return Hg(s)||!!s&&(s<400||s>499)}function Hg(s){return s===0&&navigator.onLine===!1}var bs={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},ai={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class VP extends Li{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(L.ERROR,this.onError,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(L.ERROR,this.onError,this),e.off(L.ERROR,this.onErrorOut,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===_e.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,i=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||i===-1?t.loadLevel:i}variantHasKey(e,t){if(e){var i;if((i=e.details)!=null&&i.hasKey(t))return!0;const n=e.audioGroups;if(n)return this.hls.allAudioTracks.filter(o=>n.indexOf(o.groupId)>=0).some(o=>{var c;return(c=o.details)==null?void 0:c.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var i;if(t.fatal)return;const n=this.hls,a=t.context;switch(t.details){case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Q.FRAG_PARSING_ERROR:if((i=t.frag)!=null&&i.gap){t.errorAction=_u();return}case Q.FRAG_GAP:case Q.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=bs.SendAlternateToPenaltyBox;return}case Q.LEVEL_EMPTY_ERROR:case Q.LEVEL_PARSING_ERROR:{var o;const f=t.parent===_e.MAIN?t.level:n.loadLevel;t.details===Q.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(o=o.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,f):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,f))}return;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.SUBTITLE_LOAD_ERROR:case Q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const f=n.loadLevelObj;if(f&&(a.type===Ge.AUDIO_TRACK&&f.hasAudioGroup(a.groupId)||a.type===Ge.SUBTITLE_TRACK&&f.hasSubtitleGroup(a.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.loadLevel),t.errorAction.action=bs.SendAlternateToPenaltyBox,t.errorAction.flags=ai.MoveAllAlternatesMatchingHost;return}}return;case Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:bs.SendAlternateToPenaltyBox,flags:ai.MoveAllAlternatesMatchingHDCP};return;case Q.KEY_SYSTEM_SESSION_UPDATE_FAILED:case Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case Q.KEY_SYSTEM_NO_SESSION:t.errorAction={action:bs.SendAlternateToPenaltyBox,flags:ai.MoveAllAlternatesMatchingKey};return;case Q.BUFFER_ADD_CODEC_ERROR:case Q.REMUX_ALLOC_ERROR:case Q.BUFFER_APPEND_ERROR:if(!t.errorAction){var c;t.errorAction=this.getLevelSwitchAction(t,(c=t.level)!=null?c:n.loadLevel)}return;case Q.INTERNAL_EXCEPTION:case Q.BUFFER_APPENDING_ERROR:case Q.BUFFER_FULL_ERROR:case Q.LEVEL_SWITCH_ERROR:case Q.BUFFER_STALLED_ERROR:case Q.BUFFER_SEEK_OVER_HOLE:case Q.BUFFER_NUDGE_ON_STALL:t.errorAction=_u();return}t.type===Ie.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=_u())}getPlaylistRetryOrSwitchAction(e,t){const i=this.hls,n=ZT(i.config.playlistLoadPolicy,e),a=this.playlistError++;if(_f(n,a,Af(e),e.response))return{action:bs.RetryRequest,flags:ai.None,retryConfig:n,retryCount:a};const c=this.getLevelSwitchAction(e,t);return n&&(c.retryConfig=n,c.retryCount=a),c}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),n=t.levels[i],{fragLoadPolicy:a,keyLoadPolicy:o}=t.config,c=ZT(KA(e)?o:a,e),f=t.levels.reduce((m,g)=>m+g.fragmentError,0);if(n&&(e.details!==Q.FRAG_GAP&&n.fragmentError++,!QA(e)&&_f(c,f,Af(e),e.response)))return{action:bs.RetryRequest,flags:ai.None,retryConfig:c,retryCount:f};const d=this.getLevelSwitchAction(e,i);return c&&(d.retryConfig=c,d.retryCount=f),d}getLevelSwitchAction(e,t){const i=this.hls;t==null&&(t=i.loadLevel);const n=this.hls.levels[t];if(n){var a,o;const d=e.details;n.loadError++,d===Q.BUFFER_APPEND_ERROR&&n.fragmentError++;let m=-1;const{levels:g,loadLevel:p,minAutoLevel:T,maxAutoLevel:y}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const S=(a=e.frag)==null?void 0:a.type,R=(S===_e.AUDIO&&d===Q.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===Q.BUFFER_ADD_CODEC_ERROR||d===Q.BUFFER_APPEND_ERROR))&&g.some(({audioCodec:z})=>n.audioCodec!==z),I=e.sourceBufferName==="video"&&(d===Q.BUFFER_ADD_CODEC_ERROR||d===Q.BUFFER_APPEND_ERROR)&&g.some(({codecSet:z,audioCodec:P})=>n.codecSet!==z&&n.audioCodec===P),{type:D,groupId:k}=(o=e.context)!=null?o:{};for(let z=g.length;z--;){const P=(z+p)%g.length;if(P!==p&&P>=T&&P<=y&&g[P].loadError===0){var c,f;const V=g[P];if(d===Q.FRAG_GAP&&S===_e.MAIN&&e.frag){const $=g[P].details;if($){const j=Sa(e.frag,$.fragments,e.frag.start);if(j!=null&&j.gap)continue}}else{if(D===Ge.AUDIO_TRACK&&V.hasAudioGroup(k)||D===Ge.SUBTITLE_TRACK&&V.hasSubtitleGroup(k))continue;if(S===_e.AUDIO&&(c=n.audioGroups)!=null&&c.some($=>V.hasAudioGroup($))||S===_e.SUBTITLE&&(f=n.subtitleGroups)!=null&&f.some($=>V.hasSubtitleGroup($))||R&&n.audioCodec===V.audioCodec||I&&n.codecSet===V.codecSet||!R&&n.codecSet!==V.codecSet)continue}m=P;break}}if(m>-1&&i.loadLevel!==m)return e.levelRetry=!0,this.playlistError=0,{action:bs.SendAlternateToPenaltyBox,flags:ai.None,nextAutoLevel:m}}return{action:bs.SendAlternateToPenaltyBox,flags:ai.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var i;switch((i=t.errorAction)==null?void 0:i.action){case bs.DoNothing:break;case bs.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Q.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:n}=i,a=i.nextAutoLevel;switch(n){case ai.None:this.switchLevel(e,a);break;case ai.MoveAllAlternatesMatchingHDCP:{const f=this.getVariantLevelIndex(e.frag),d=t.levels[f],m=d==null?void 0:d.attrs["HDCP-LEVEL"];if(i.hdcpLevel=m,m==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(m){t.maxHdcpLevel=Fg[Fg.indexOf(m)-1],i.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case ai.MoveAllAlternatesMatchingKey:{const f=e.decryptdata;if(f){const d=this.hls.levels,m=d.length;for(let p=m;p--;)if(this.variantHasKey(d[p],f)){var o,c;this.log(`Banned key found in level ${p} (${d[p].bitrate}bps) or audio group "${(o=d[p].audioGroups)==null?void 0:o.join(",")}" (${(c=e.frag)==null?void 0:c.type} fragment) ${Es(f.keyId||[])}`),d[p].fragmentError++,d[p].loadError++,this.log(`Removing level ${p} with key error (${e.error})`),this.hls.removeLevel(p)}const g=e.frag;if(this.hls.levels.length<m)i.resolved=!0;else if(g&&g.type!==_e.MAIN){const p=g.decryptdata;p&&!f.matches(p)&&(i.resolved=!0)}}break}}i.resolved||this.switchLevel(e,a)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Q.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const i=Bg(e.mimeType),n=this.hls.levels;for(let a=n.length;a--;)n[a][`${e.sourceBufferName}Codec`]===i&&(this.log(`Removing level ${a} for ${e.details} ("${i}" not supported)`),this.hls.removeLevel(a))}}}function _u(s){const e={action:bs.DoNothing,flags:ai.None};return s&&(e.resolved=!0),e}var Jt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class zP{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let n=i.length;n--;){const a=i[n];if(!a)break;if(a.start<=e&&e<=a.end&&a.loaded)return a}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,i){const{fragments:n}=this,a=Object.keys(n);for(let o=a.length;o--;){const c=n[a[o]];if((c==null?void 0:c.body.type)===t&&(!i||c.buffered)){const f=c.body;if(f.start<=e&&e<=f.end)return f}}return null}detectEvictedFragments(e,t,i,n,a){this.timeRanges&&(this.timeRanges[e]=t);const o=(n==null?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach(c=>{const f=this.fragments[c];if(!f||o>=f.body.sn)return;if(!f.buffered&&(!f.loaded||a)){f.body.type===i&&this.removeFragment(f.body);return}const d=f.range[e];if(d){if(d.time.length===0){this.removeFragment(f.body);return}d.time.some(m=>{const g=!this.isTimeBuffered(m.startPTS,m.endPTS,t);return g&&this.removeFragment(f.body),g})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const i=e.frag,n=pu(i),a=this.fragments[n];if(!a||a.buffered&&i.gap)return;const o=!i.relurl;Object.keys(t).forEach(c=>{const f=i.elementaryStreams[c];if(!f)return;const d=t[c],m=o||f.partial===!0;a.range[c]=this.getBufferedTimes(i,e.part,m,d)}),a.loaded=null,Object.keys(a.range).length?(this.bufferedEnd(a,i),_d(a)||this.removeParts(i.sn-1,i.type)):this.removeFragment(a.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=e2(i,n=>n.fragment.sn>=e))}fragBuffered(e,t){const i=pu(e);let n=this.fragments[i];!n&&t&&(n=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,this.bufferedEnd(n,e))}getBufferedTimes(e,t,i,n){const a={time:[],partial:i},o=e.start,c=e.end,f=e.minEndPTS||c,d=e.maxStartPTS||o;for(let m=0;m<n.length;m++){const g=n.start(m)-this.bufferPadding,p=n.end(m)+this.bufferPadding;if(d>=g&&f<=p){a.time.push({startPTS:Math.max(o,n.start(m)),endPTS:Math.min(c,n.end(m))});break}else if(o<p&&c>g){const T=Math.max(o,n.start(m)),y=Math.min(c,n.end(m));y>T&&(a.partial=!0,a.time.push({startPTS:T,endPTS:y}))}else if(c<=g)break}return a}getPartialFragment(e){let t=null,i,n,a,o=0;const{bufferPadding:c,fragments:f}=this;return Object.keys(f).forEach(d=>{const m=f[d];m&&_d(m)&&(n=m.body.start-c,a=m.body.end+c,e>=n&&e<=a&&(i=Math.min(e-n,a-e),o<=i&&(t=m.body,o=i)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||_d(t))}getState(e){const t=pu(e),i=this.fragments[t];return i?i.buffered?_d(i)?Jt.PARTIAL:Jt.OK:Jt.APPENDING:Jt.NOT_LOADED}isTimeBuffered(e,t,i){let n,a;for(let o=0;o<i.length;o++){if(n=i.start(o)-this.bufferPadding,a=i.end(o)+this.bufferPadding,e>=n&&t<=a)return!0;if(t<=n)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const i=t.frag,n=t.part?null:t,a=pu(i);this.fragments[a]={body:i,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:n,timeRanges:a,type:o}=t;if(i.sn==="initSegment")return;const c=i.type;if(n){let d=this.activePartLists[c];d||(this.activePartLists[c]=d=[]),d.push(n)}this.timeRanges=a;const f=a[o];this.detectEvictedFragments(o,f,c,n)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=pu(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,i=Object.keys(t);if(!e)return i.length>0;for(let n=i.length;n--;){const a=t[i[n]];if((a==null?void 0:a.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,i,n,a){n&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const c=this.fragments[o];if(!c)return;const f=c.body;f.type!==i||n&&!f.gap||f.start<t&&f.end>e&&(c.buffered||a)&&this.removeFragment(f)})}removeFragment(e){const t=pu(e);e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const n=e.sn;this.activePartLists[e.type]=e2(i,a=>a.fragment.sn!==n)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(i=>i.clearElementaryStreamInfo())}}function _d(s){var e,t,i;return s.buffered&&!!(s.body.gap||(e=s.range.video)!=null&&e.partial||(t=s.range.audio)!=null&&t.partial||(i=s.range.audiovideo)!=null&&i.partial)}function pu(s){return`${s.type}_${s.level}_${s.sn}`}function e2(s,e){return s.filter(t=>{const i=e(t);return i||t.clearElementaryStreamInfo(),i})}var Pr={cbc:0,ctr:1};class YP{constructor(e,t,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=i}decrypt(e,t){switch(this.aesMode){case Pr.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Pr.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function KP(s){const e=s.byteLength,t=e&&new DataView(s.buffer).getUint8(e-1);return t?s.slice(0,e-t):s}class QP{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let n=0;n<4;n++)i[n]=t.getUint32(n*4);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,n=i[0],a=i[1],o=i[2],c=i[3],f=this.invSubMix,d=f[0],m=f[1],g=f[2],p=f[3],T=new Uint32Array(256);let y=0,S=0,A=0;for(A=0;A<256;A++)A<128?T[A]=A<<1:T[A]=A<<1^283;for(A=0;A<256;A++){let R=S^S<<1^S<<2^S<<3^S<<4;R=R>>>8^R&255^99,e[y]=R,t[R]=y;const C=T[y],I=T[C],D=T[I];let k=T[R]*257^R*16843008;n[y]=k<<24|k>>>8,a[y]=k<<16|k>>>16,o[y]=k<<8|k>>>24,c[y]=k,k=D*16843009^I*65537^C*257^y*16843008,d[R]=k<<24|k>>>8,m[R]=k<<16|k>>>16,g[R]=k<<8|k>>>24,p[R]=k,y?(y=C^T[T[T[D^C]]],S^=T[T[S]]):y=S=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,n=0;for(;n<t.length&&i;)i=t[n]===this.key[n],n++;if(i)return;this.key=t;const a=this.keySize=t.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const o=this.ksRows=(a+6+1)*4;let c,f;const d=this.keySchedule=new Uint32Array(o),m=this.invKeySchedule=new Uint32Array(o),g=this.sBox,p=this.rcon,T=this.invSubMix,y=T[0],S=T[1],A=T[2],R=T[3];let C,I;for(c=0;c<o;c++){if(c<a){C=d[c]=t[c];continue}I=C,c%a===0?(I=I<<8|I>>>24,I=g[I>>>24]<<24|g[I>>>16&255]<<16|g[I>>>8&255]<<8|g[I&255],I^=p[c/a|0]<<24):a>6&&c%a===4&&(I=g[I>>>24]<<24|g[I>>>16&255]<<16|g[I>>>8&255]<<8|g[I&255]),d[c]=C=(d[c-a]^I)>>>0}for(f=0;f<o;f++)c=o-f,f&3?I=d[c]:I=d[c-4],f<4||c<=4?m[f]=I:m[f]=y[g[I>>>24]]^S[g[I>>>16&255]]^A[g[I>>>8&255]]^R[g[I&255]],m[f]=m[f]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,i){const n=this.keySize+6,a=this.invKeySchedule,o=this.invSBox,c=this.invSubMix,f=c[0],d=c[1],m=c[2],g=c[3],p=this.uint8ArrayToUint32Array_(i);let T=p[0],y=p[1],S=p[2],A=p[3];const R=new Int32Array(e),C=new Int32Array(R.length);let I,D,k,z,P,V,$,j,te,ge,ye,ve,ue,F;const J=this.networkToHostOrderSwap;for(;t<R.length;){for(te=J(R[t]),ge=J(R[t+1]),ye=J(R[t+2]),ve=J(R[t+3]),P=te^a[0],V=ve^a[1],$=ye^a[2],j=ge^a[3],ue=4,F=1;F<n;F++)I=f[P>>>24]^d[V>>16&255]^m[$>>8&255]^g[j&255]^a[ue],D=f[V>>>24]^d[$>>16&255]^m[j>>8&255]^g[P&255]^a[ue+1],k=f[$>>>24]^d[j>>16&255]^m[P>>8&255]^g[V&255]^a[ue+2],z=f[j>>>24]^d[P>>16&255]^m[V>>8&255]^g[$&255]^a[ue+3],P=I,V=D,$=k,j=z,ue=ue+4;I=o[P>>>24]<<24^o[V>>16&255]<<16^o[$>>8&255]<<8^o[j&255]^a[ue],D=o[V>>>24]<<24^o[$>>16&255]<<16^o[j>>8&255]<<8^o[P&255]^a[ue+1],k=o[$>>>24]<<24^o[j>>16&255]<<16^o[P>>8&255]<<8^o[V&255]^a[ue+2],z=o[j>>>24]<<24^o[P>>16&255]<<16^o[V>>8&255]<<8^o[$&255]^a[ue+3],C[t]=J(I^T),C[t+1]=J(z^y),C[t+2]=J(k^S),C[t+3]=J(D^A),T=te,y=ge,S=ye,A=ve,t=t+4}return C.buffer}}class XP{constructor(e,t,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=i}expandKey(){const e=WP(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function WP(s){switch(s){case Pr.cbc:return"AES-CBC";case Pr.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${s}`)}}const ZP=16;class Kp{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?KP(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i,n){return this.useSoftware?new Promise((a,o)=>{const c=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(c,t,i,n);const f=this.flush();f?a(f.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i,n)}softwareDecrypt(e,t,i,n){const{currentIV:a,currentResult:o,remainderData:c}=this;if(n!==Pr.cbc||t.byteLength!==16)return ft.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),c&&(e=_i(c,e),this.remainderData=null);const f=this.getValidChunk(e);if(!f.length)return null;a&&(i=a);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new QP),d.expandKey(t);const m=o;return this.currentResult=d.decrypt(f.buffer,0,i),this.currentIV=f.slice(-16).buffer,m||null}webCryptoDecrypt(e,t,i,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,i,n));this.key=t,this.fastAesKey=new XP(this.subtle,t,n)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new YP(this.subtle,new Uint8Array(i),n).decrypt(e.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(ft.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,i,n)))}onWebCryptoError(e,t,i,n){const a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i,n);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%ZP;return i!==e.length&&(t=e.slice(0,i),this.remainderData=e.slice(i)),t}logOnce(e){this.logEnabled&&(ft.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const t2=Math.pow(2,17);class JP{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new Mn({type:Ie.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const n=this.config,a=n.fLoader,o=n.loader;return new Promise((c,f)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(y=>y[0]==="GAP")){f(i2(e));return}else e.gap=!1;const d=this.loader=a?new a(n):new o(n),m=s2(e);e.loader=d;const g=JT(n.fragLoadPolicy.default),p={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:t2};e.stats=d.stats;const T={onSuccess:(y,S,A,R)=>{this.resetLoader(e,d);let C=y.data;A.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(C.slice(0,16)),C=C.slice(16)),c({frag:e,part:null,payload:C,networkDetails:R})},onError:(y,S,A,R)=>{this.resetLoader(e,d),f(new Mn({type:Ie.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:dt({url:i,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:A,stats:R}))},onAbort:(y,S,A)=>{this.resetLoader(e,d),f(new Mn({type:Ie.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:A,stats:y}))},onTimeout:(y,S,A)=>{this.resetLoader(e,d),f(new Mn({type:Ie.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:A,stats:y}))}};t&&(T.onProgress=(y,S,A,R)=>t({frag:e,part:null,payload:A,networkDetails:R})),d.load(m,p,T)})}loadPart(e,t,i){this.abort();const n=this.config,a=n.fLoader,o=n.loader;return new Promise((c,f)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){f(i2(e,t));return}const d=this.loader=a?new a(n):new o(n),m=s2(e,t);e.loader=d;const g=JT(n.fragLoadPolicy.default),p={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t2};t.stats=d.stats,d.load(m,p,{onSuccess:(T,y,S,A)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const R={frag:e,part:t,payload:T.data,networkDetails:A};i(R),c(R)},onError:(T,y,S,A)=>{this.resetLoader(e,d),f(new Mn({type:Ie.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:dt({url:m.url,data:void 0},T),error:new Error(`HTTP Error ${T.code} ${T.text}`),networkDetails:S,stats:A}))},onAbort:(T,y,S)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),f(new Mn({type:Ie.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:S,stats:T}))},onTimeout:(T,y,S)=>{this.resetLoader(e,d),f(new Mn({type:Ie.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:S,stats:T}))}})})}updateStatsFromPart(e,t){const i=e.stats,n=t.stats,a=n.total;if(i.loaded+=n.loaded,a){const f=Math.round(e.duration/t.duration),d=Math.min(Math.round(i.loaded/a),f),g=(f-d)*Math.round(i.loaded/d);i.total=i.loaded+g}else i.total=Math.max(i.loaded,i.total);const o=i.loading,c=n.loading;o.start?o.first+=c.first-c.start:(o.start=c.start,o.first=c.first),o.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function s2(s,e=null){const t=e||s,i={frag:s,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},n=t.byteRangeStartOffset,a=t.byteRangeEndOffset;if(Se(n)&&Se(a)){var o;let c=n,f=a;if(s.sn==="initSegment"&&e9((o=s.decryptdata)==null?void 0:o.method)){const d=a-n;d%16&&(f=a+(16-d%16)),n!==0&&(i.resetIV=!0,c=n-16)}i.rangeStart=c,i.rangeEnd=f}return i}function i2(s,e){const t=new Error(`GAP ${s.gap?"tag":"attribute"} found`),i={type:Ie.MEDIA_ERROR,details:Q.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return e&&(i.part=e),(e||s).stats.aborted=!0,new Mn(i)}function e9(s){return s==="AES-128"||s==="AES-256"}class Mn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class XA extends Li{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Qp{constructor(e,t,i,n=0,a=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Ld(),this.buffering={audio:Ld(),video:Ld(),audiovideo:Ld()},this.level=e,this.sn=t,this.id=i,this.size=n,this.part=a,this.partial=o}}function Ld(){return{start:0,executeStart:0,executeEnd:0,end:0}}const n2={length:0,start:()=>0,end:()=>0};class Ue{static isBuffered(e,t){if(e){const i=Ue.getBuffered(e);for(let n=i.length;n--;)if(t>=i.start(n)&&t<=i.end(n))return!0}return!1}static bufferedRanges(e){if(e){const t=Ue.getBuffered(e);return Ue.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}static bufferInfo(e,t,i){if(e){const n=Ue.bufferedRanges(e);if(n.length)return Ue.bufferedInfo(n,t,i)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.length>1&&e.sort((m,g)=>m.start-g.start||g.end-m.end);let n=-1,a=[];if(i)for(let m=0;m<e.length;m++){t>=e[m].start&&t<=e[m].end&&(n=m);const g=a.length;if(g){const p=a[g-1].end;e[m].start-p<i?e[m].end>p&&(a[g-1].end=e[m].end):a.push(e[m])}else a.push(e[m])}else a=e;let o=0,c,f=t,d=t;for(let m=0;m<a.length;m++){const g=a[m].start,p=a[m].end;if(n===-1&&t>=g&&t<=p&&(n=m),t+i>=g&&t<p)f=g,d=p,o=d-t;else if(t+i<g){c=g;break}}return{len:o,start:f||0,end:d||0,nextStart:c,buffered:e,bufferedIndex:n}}static getBuffered(e){try{return e.buffered||n2}catch(t){return ft.log("failed to get media.buffered",t),n2}}}const WA=/\{\$([a-zA-Z0-9-_]+)\}/g;function r2(s){return WA.test(s)}function jg(s,e){if(s.variableList!==null||s.hasVariableRefs){const t=s.variableList;return e.replace(WA,i=>{const n=i.substring(2,i.length-1),a=t==null?void 0:t[n];return a===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),i):a})}return e}function a2(s,e,t){let i=s.variableList;i||(s.variableList=i={});let n,a;if("QUERYPARAM"in e){n=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(n))a=o.get(n);else throw new Error(`"${n}" does not match any query parameter in URI: "${t}"`)}catch(o){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else n=e.NAME,a=e.VALUE;n in i?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):i[n]=a||""}function t9(s,e,t){const i=e.IMPORT;if(t&&i in t){let n=s.variableList;n||(s.variableList=n={}),n[i]=t[i]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const s9=/^(\d+)x(\d+)$/,u2=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Rt{constructor(e,t){typeof e=="string"&&(e=Rt.parseAttrList(e,t)),bt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const i=new Uint8Array(t.length/2);for(let n=0;n<t.length/2;n++)i[n]=parseInt(t.slice(n*2,n*2+2),16);return i}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const i=this[e];return(i?i.split(/[ ,]+/):[]).reduce((n,a)=>(n[a.toLowerCase()]=!0,n),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=s9.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let i;const n={};for(u2.lastIndex=0;(i=u2.exec(e))!==null;){const o=i[1].trim();let c=i[2];const f=c.indexOf('"')===0&&c.lastIndexOf('"')===c.length-1;let d=!1;if(f)c=c.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":d=!0}if(t&&(f||d))c=jg(t,c);else if(!d&&!f)switch(o){case"CLOSED-CAPTIONS":if(c==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":ft.warn(`${e}: attribute ${o} is missing quotes`)}n[o]=c}return n}}const i9="com.apple.hls.interstitial";function n9(s){return s!=="ID"&&s!=="CLASS"&&s!=="CUE"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function r9(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"||s==="SCTE35-CMD"}class ZA{constructor(e,t,i=0){var n;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(n=t==null?void 0:t.tagOrder)!=null?n:i,t){const a=t.attr;for(const o in a)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==a[o]){ft.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=bt(new Rt({}),a,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const a=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Se(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(ft.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Se(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===i9}get isValid(){return!!this.id&&!this._badValueForSameId&&Se(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const a9=10;class u9{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let i=t.decryptdata;return i||(t.setKeyFormat(e.keyFormat),i=t.decryptdata),!!i&&e.matches(i)})}get hasProgramDateTime(){return this.fragments.length?Se(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||a9}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let i=e.length;i--;)if(e[i].index>t)return e[i].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Lf(s,e){return s.length===e.length?!s.some((t,i)=>t!==e[i]):!1}function o2(s,e){return!s&&!e?!0:!s||!e?!1:Lf(s,e)}function Lu(s){return s==="AES-128"||s==="AES-256"||s==="AES-256-CTR"}function Xp(s){switch(s){case"AES-128":case"AES-256":return Pr.cbc;case"AES-256-CTR":return Pr.ctr;default:throw new Error(`invalid full segment method ${s}`)}}function Wp(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function $g(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}function o9(s){const e=$g(s).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function JA(s){const e=function(i,n,a){const o=i[n];i[n]=i[a],i[a]=o};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function e3(s){const e=s.split(":");let t=null;if(e[0]==="data"&&e.length===2){const i=e[1].split(";"),n=i[i.length-1].split(",");if(n.length===2){const a=n[0]==="base64",o=n[1];a?(i.splice(-1,1),t=Wp(o)):t=o9(o)}}return t}const Rf=typeof self<"u"?self:void 0;var It={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ys={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Kd(s){switch(s){case ys.FAIRPLAY:return It.FAIRPLAY;case ys.PLAYREADY:return It.PLAYREADY;case ys.WIDEVINE:return It.WIDEVINE;case ys.CLEARKEY:return It.CLEARKEY}}function Gm(s){switch(s){case It.FAIRPLAY:return ys.FAIRPLAY;case It.PLAYREADY:return ys.PLAYREADY;case It.WIDEVINE:return ys.WIDEVINE;case It.CLEARKEY:return ys.CLEARKEY}}function il(s){const{drmSystems:e,widevineLicenseUrl:t}=s,i=e?[It.FAIRPLAY,It.WIDEVINE,It.PLAYREADY,It.CLEARKEY].filter(n=>!!e[n]):[];return!i[It.WIDEVINE]&&t&&i.push(It.WIDEVINE),i}const t3=(function(s){return Rf!=null&&(s=Rf.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function l9(s,e,t,i){let n;switch(s){case It.FAIRPLAY:n=["cenc","sinf"];break;case It.WIDEVINE:case It.PLAYREADY:n=["cenc"];break;case It.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return c9(n,e,t,i)}function c9(s,e,t,i){return[{initDataTypes:s,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(a=>({contentType:`audio/mp4; codecs=${a}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:t.map(a=>({contentType:`video/mp4; codecs=${a}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function d9(s){var e;return!!s&&(s.sessionType==="persistent-license"||!!((e=s.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function s3(s){const e=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),i=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(o){const c=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(c){const f=Wp(c).subarray(0,16);return JA(f),f}}return null}let bu={};class kr{static clearKeyUriToKeyIdMap(){bu={}}static setKeyIdForUri(e,t){bu[e]=t}static addKeyIdForUri(e){const t=Object.keys(bu).length%Number.MAX_SAFE_INTEGER,i=new Uint8Array(16);return new DataView(i.buffer,12,4).setUint32(0,t),bu[e]=i,i}constructor(e,t,i,n=[1],a=null,o){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=n,this.iv=a,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Lu(e),o!=null&&o.startsWith("0x")&&(this.keyId=new Uint8Array(NA(o)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Lf(e.keyFormatVersions,this.keyFormatVersions)&&o2(e.iv,this.iv)&&o2(e.keyId,this.keyId)}isSupported(){if(this.method){if(Lu(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case ys.FAIRPLAY:case ys.WIDEVINE:case ys.PLAYREADY:case ys.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(Lu(this.method)){let a=this.iv;return a||(typeof e!="number"&&(ft.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),a=h9(e)),new kr(this.method,this.uri,"identity",this.keyFormatVersions,a)}if(this.keyId){const a=bu[this.uri];if(a&&!Lf(this.keyId,a)&&kr.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const i=e3(this.uri);if(i)switch(this.keyFormat){case ys.WIDEVINE:if(this.pssh=i,!this.keyId){const a=pP(i.buffer);if(a.length){var n;const o=a[0];this.keyId=(n=o.kids)!=null&&n.length?o.kids[0]:null}}this.keyId||(this.keyId=l2(t));break;case ys.PLAYREADY:{const a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=gP(a,null,i),this.keyId=s3(i);break}default:{let a=i.subarray(0,16);if(a.length!==16){const o=new Uint8Array(16);o.set(a,16-a.length),a=o}this.keyId=a;break}}if(!this.keyId||this.keyId.byteLength!==16){let a;a=f9(t),a||(a=l2(t),a||(a=bu[this.uri])),a&&(this.keyId=a,kr.setKeyIdForUri(this.uri,a))}return this}}function f9(s){const e=s==null?void 0:s[ys.WIDEVINE];return e?e.keyId:null}function l2(s){const e=s==null?void 0:s[ys.PLAYREADY];if(e){const t=e3(e.uri);if(t)return s3(t)}return null}function h9(s){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=s>>8*(15-t)&255;return e}const c2=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,d2=/#EXT-X-MEDIA:(.*)/g,m9=/^#EXT(?:INF|-X-TARGETDURATION):/m,qm=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),g9=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class rn{static findGroup(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n.id===t)return n}}static resolve(e,t){return $p.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return m9.test(e)}static parseMasterPlaylist(e,t){const i=r2(e),n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},a=[];if(c2.lastIndex=0,!e.startsWith("#EXTM3U"))return n.playlistParsingError=new Error("no EXTM3U delimiter"),n;let o;for(;(o=c2.exec(e))!=null;)if(o[1]){var c;const d=new Rt(o[1],n),m=jg(n,o[2]),g={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:rn.resolve(m,t)},p=d.decimalResolution("RESOLUTION");p&&(g.width=p.width,g.height=p.height),m2(d.CODECS,g);const T=d["SUPPLEMENTAL-CODECS"];T&&(g.supplemental={},m2(T,g.supplemental)),(c=g.unknownCodecs)!=null&&c.length||a.push(g),n.levels.push(g)}else if(o[3]){const d=o[3],m=o[4];switch(d){case"SESSION-DATA":{const g=new Rt(m,n),p=g["DATA-ID"];p&&(n.sessionData===null&&(n.sessionData={}),n.sessionData[p]=g);break}case"SESSION-KEY":{const g=f2(m,t,n);g.encrypted&&g.isSupported()?(n.sessionKeys===null&&(n.sessionKeys=[]),n.sessionKeys.push(g)):ft.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const g=new Rt(m,n);a2(n,g,t)}break}case"CONTENT-STEERING":{const g=new Rt(m,n);n.contentSteering={uri:rn.resolve(g["SERVER-URI"],t),pathwayId:g["PATHWAY-ID"]||"."};break}case"START":{n.startTimeOffset=h2(m);break}}}const f=a.length>0&&a.length<n.levels.length;return n.levels=f?a:n.levels,n.levels.length===0&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,i){let n;const a={},o=i.levels,c={AUDIO:o.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:o.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let f=0;for(d2.lastIndex=0;(n=d2.exec(e))!==null;){const d=new Rt(n[1],i),m=d.TYPE;if(m){const g=c[m],p=a[m]||[];a[m]=p;const T=d.LANGUAGE,y=d["ASSOC-LANGUAGE"],S=d.CHANNELS,A=d.CHARACTERISTICS,R=d["INSTREAM-ID"],C={attrs:d,bitrate:0,id:f++,groupId:d["GROUP-ID"]||"",name:d.NAME||T||"",type:m,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:T,url:d.URI?rn.resolve(d.URI,t):""};if(y&&(C.assocLang=y),S&&(C.channels=S),A&&(C.characteristics=A),R&&(C.instreamId=R),g!=null&&g.length){const I=rn.findGroup(g,C.groupId)||g[0];g2(C,I,"audioCodec"),g2(C,I,"textCodec")}p.push(C)}}return a}static parseLevelPlaylist(e,t,i,n,a,o){var c;const f={url:t},d=new u9(t),m=d.fragments,g=[];let p=null,T=0,y=0,S=0,A=0,R=0,C=null,I=new Hm(n,f),D,k,z,P=-1,V=!1,$=null,j;if(qm.lastIndex=0,d.m3u8=e,d.hasVariableRefs=r2(e),((c=qm.exec(e))==null?void 0:c[0])!=="#EXTM3U")return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;(D=qm.exec(e))!==null;){V&&(V=!1,I=new Hm(n,f),I.playlistOffset=S,I.setStart(S),I.sn=T,I.cc=A,R&&(I.bitrate=R),I.level=i,p&&(I.initSegment=p,p.rawProgramDateTime&&(I.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null),$&&(I.setByteRange($),$=null)));const ve=D[1];if(ve){I.duration=parseFloat(ve);const ue=(" "+D[2]).slice(1);I.title=ue||null,I.tagList.push(ue?["INF",ve,ue]:["INF",ve])}else if(D[3]){if(Se(I.duration)){I.playlistOffset=S,I.setStart(S),z&&b2(I,z,d),I.sn=T,I.level=i,I.cc=A,m.push(I);const ue=(" "+D[3]).slice(1);I.relurl=jg(d,ue),Gg(I,C,g),C=I,S+=I.duration,T++,y=0,V=!0}}else{if(D=D[0].match(g9),!D){ft.warn("No matches on slow regex match for level playlist!");continue}for(k=1;k<D.length&&D[k]===void 0;k++);const ue=(" "+D[k]).slice(1),F=(" "+D[k+1]).slice(1),J=D[k+2]?(" "+D[k+2]).slice(1):null;switch(ue){case"BYTERANGE":C?I.setByteRange(F,C):I.setByteRange(F);break;case"PROGRAM-DATE-TIME":I.rawProgramDateTime=F,I.tagList.push(["PROGRAM-DATE-TIME",F]),P===-1&&(P=m.length);break;case"PLAYLIST-TYPE":d.type&&Nn(d,ue,D),d.type=F.toUpperCase();break;case"MEDIA-SEQUENCE":d.startSN!==0?Nn(d,ue,D):m.length>0&&E2(d,ue,D),T=d.startSN=parseInt(F);break;case"SKIP":{d.skippedSegments&&Nn(d,ue,D);const se=new Rt(F,d),ne=se.decimalInteger("SKIPPED-SEGMENTS");if(Se(ne)){d.skippedSegments+=ne;for(let O=ne;O--;)m.push(null);T+=ne}const xe=se.enumeratedString("RECENTLY-REMOVED-DATERANGES");xe&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(xe.split("	")));break}case"TARGETDURATION":d.targetduration!==0&&Nn(d,ue,D),d.targetduration=Math.max(parseInt(F),1);break;case"VERSION":d.version!==null&&Nn(d,ue,D),d.version=parseInt(F);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||Nn(d,ue,D),d.live=!1;break;case"#":(F||J)&&I.tagList.push(J?[F,J]:[F]);break;case"DISCONTINUITY":A++,I.tagList.push(["DIS"]);break;case"GAP":I.gap=!0,I.tagList.push([ue]);break;case"BITRATE":I.tagList.push([ue,F]),R=parseInt(F)*1e3,Se(R)?I.bitrate=R:R=0;break;case"DATERANGE":{const se=new Rt(F,d),ne=new ZA(se,d.dateRanges[se.ID],d.dateRangeTagCount);d.dateRangeTagCount++,ne.isValid||d.skippedSegments?d.dateRanges[ne.id]=ne:ft.warn(`Ignoring invalid DATERANGE tag: "${F}"`),I.tagList.push(["EXT-X-DATERANGE",F]);break}case"DEFINE":{{const se=new Rt(F,d);"IMPORT"in se?t9(d,se,o):a2(d,se,t)}break}case"DISCONTINUITY-SEQUENCE":d.startCC!==0?Nn(d,ue,D):m.length>0&&E2(d,ue,D),d.startCC=A=parseInt(F);break;case"KEY":{const se=f2(F,t,d);if(se.isSupported()){if(se.method==="NONE"){z=void 0;break}z||(z={});const ne=z[se.keyFormat];ne!=null&&ne.matches(se)||(ne&&(z=bt({},z)),z[se.keyFormat]=se)}else ft.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${F}"`);break}case"START":d.startTimeOffset=h2(F);break;case"MAP":{const se=new Rt(F,d);if(I.duration){const ne=new Hm(n,f);p2(ne,se,i,z),p=ne,I.initSegment=p,p.rawProgramDateTime&&!I.rawProgramDateTime&&(I.rawProgramDateTime=p.rawProgramDateTime)}else{const ne=I.byteRangeEndOffset;if(ne){const xe=I.byteRangeStartOffset;$=`${ne-xe}@${xe}`}else $=null;p2(I,se,i,z),p=I,V=!0}p.cc=A;break}case"SERVER-CONTROL":{j&&Nn(d,ue,D),j=new Rt(F),d.canBlockReload=j.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=j.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&j.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=j.optionalFloat("PART-HOLD-BACK",0),d.holdBack=j.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{d.partTarget&&Nn(d,ue,D);const se=new Rt(F);d.partTarget=se.decimalFloatingPoint("PART-TARGET");break}case"PART":{let se=d.partList;se||(se=d.partList=[]);const ne=y>0?se[se.length-1]:void 0,xe=y++,O=new Rt(F,d),G=new tP(O,I,f,xe,ne);se.push(G),I.duration+=G.duration;break}case"PRELOAD-HINT":{const se=new Rt(F,d);d.preloadHint=se;break}case"RENDITION-REPORT":{const se=new Rt(F,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(se);break}default:ft.warn(`line parsed but not handled: ${D}`);break}}}C&&!C.relurl?(m.pop(),S-=C.duration,d.partList&&(d.fragmentHint=C)):d.partList&&(Gg(I,C,g),I.cc=A,d.fragmentHint=I,z&&b2(I,z,d)),d.targetduration||(d.playlistParsingError=new Error("Missing Target Duration"));const te=m.length,ge=m[0],ye=m[te-1];if(S+=d.skippedSegments*d.targetduration,S>0&&te&&ye){d.averagetargetduration=S/te;const ve=ye.sn;d.endSN=ve!=="initSegment"?ve:0,d.live||(ye.endList=!0),P>0&&(b9(m,P),ge&&g.unshift(ge))}return d.fragmentHint&&(S+=d.fragmentHint.duration),d.totalduration=S,g.length&&d.dateRangeTagCount&&ge&&i3(g,d),d.endCC=A,d}}function i3(s,e){let t=s.length;if(!t)if(e.hasProgramDateTime){const c=e.fragments[e.fragments.length-1];s.push(c),t++}else return;const i=s[t-1],n=e.live?1/0:e.totalduration,a=Object.keys(e.dateRanges);for(let c=a.length;c--;){const f=e.dateRanges[a[c]],d=f.startDate.getTime();f.tagAnchor=i.ref;for(let m=t;m--;){var o;if(((o=s[m])==null?void 0:o.sn)<e.startSN)break;const g=p9(e,d,s,m,n);if(g!==-1){f.tagAnchor=e.fragments[g].ref;break}}}}function p9(s,e,t,i,n){const a=t[i];if(a){const c=a.programDateTime;if(e>=c||i===0){var o;const f=(((o=t[i+1])==null?void 0:o.start)||n)-a.start;if(e<=c+f*1e3){const d=t[i].sn-s.startSN;if(d<0)return-1;const m=s.fragments;if(m.length>t.length){const p=(t[i+1]||m[m.length-1]).sn-s.startSN;for(let T=p;T>d;T--){const y=m[T].programDateTime;if(e>=y&&e<y+m[T].duration*1e3)return T}}return d}}}return-1}function f2(s,e,t){var i,n;const a=new Rt(s,t),o=(i=a.METHOD)!=null?i:"",c=a.URI,f=a.hexadecimalInteger("IV"),d=a.KEYFORMATVERSIONS,m=(n=a.KEYFORMAT)!=null?n:"identity";c&&a.IV&&!f&&ft.error(`Invalid IV: ${a.IV}`);const g=c?rn.resolve(c,e):"",p=(d||"1").split("/").map(Number).filter(Number.isFinite);return new kr(o,g,m,p,f,a.KEYID)}function h2(s){const t=new Rt(s).decimalFloatingPoint("TIME-OFFSET");return Se(t)?t:null}function m2(s,e){let t=(s||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const n=t.filter(a=>Vp(a,i));n.length&&(e[`${i}Codec`]=n.map(a=>a.split("/")[0]).join(","),t=t.filter(a=>n.indexOf(a)===-1))}),e.unknownCodecs=t}function g2(s,e,t){const i=e[t];i&&(s[t]=i)}function b9(s,e){let t=s[e];for(let i=e;i--;){const n=s[i];if(!n)return;n.programDateTime=t.programDateTime-n.duration*1e3,t=n}}function Gg(s,e,t){s.rawProgramDateTime?t.push(s):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime)}function p2(s,e,t,i){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=t,s.sn="initSegment",i&&(s.levelkeys=i),s.initSegment=null}function b2(s,e,t){s.levelkeys=e;const{encryptedFragments:i}=t;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(n=>e[n].isCommonEncryption)&&i.push(s)}function Nn(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function E2(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Vm(s,e){const t=e.startPTS;if(Se(t)){let i=0,n;e.sn>s.sn?(i=t-s.start,n=s):(i=s.start-t,n=e),n.duration!==i&&n.setDuration(i)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.setStart(s.start+(s.minEndPTS-s.start)):e.setStart(s.start+s.duration):e.setStart(Math.max(s.start-e.duration,0))}function n3(s,e,t,i,n,a,o){i-t<=0&&(o.warn("Fragment should have a positive duration",e),i=t+e.duration,a=n+e.duration);let f=t,d=i;const m=e.startPTS,g=e.endPTS;if(Se(m)){const R=Math.abs(m-t);s&&R>s.totalduration?o.warn(`media timestamps and playlist times differ by ${R}s for level ${e.level} ${s.url}`):Se(e.deltaPTS)?e.deltaPTS=Math.max(R,e.deltaPTS):e.deltaPTS=R,f=Math.max(t,m),t=Math.min(t,m),n=e.startDTS!==void 0?Math.min(n,e.startDTS):n,d=Math.min(i,g),i=Math.max(i,g),a=e.endDTS!==void 0?Math.max(a,e.endDTS):a}const p=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(i-e.start),e.startPTS=t,e.maxStartPTS=f,e.startDTS=n,e.endPTS=i,e.minEndPTS=d,e.endDTS=a;const T=e.sn;if(!s||T<s.startSN||T>s.endSN)return 0;let y;const S=T-s.startSN,A=s.fragments;for(A[S]=e,y=S;y>0;y--)Vm(A[y],A[y-1]);for(y=S;y<A.length-1;y++)Vm(A[y],A[y+1]);return s.fragmentHint&&Vm(A[A.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,p}function E9(s,e,t){if(s===e)return;let i=null;const n=s.fragments;for(let m=n.length-1;m>=0;m--){const g=n[m].initSegment;if(g){i=g;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let a;T9(s,e,(m,g,p,T)=>{if((!e.startCC||e.skippedSegments)&&g.cc!==m.cc){const y=m.cc-g.cc;for(let S=p;S<T.length;S++)T[S].cc+=y;e.endCC=T[T.length-1].cc}Se(m.startPTS)&&Se(m.endPTS)&&(g.setStart(g.startPTS=m.startPTS),g.startDTS=m.startDTS,g.maxStartPTS=m.maxStartPTS,g.endPTS=m.endPTS,g.endDTS=m.endDTS,g.minEndPTS=m.minEndPTS,g.setDuration(m.endPTS-m.startPTS),g.duration&&(a=g),e.PTSKnown=e.alignedSliding=!0),m.hasStreams&&(g.elementaryStreams=m.elementaryStreams),g.loader=m.loader,m.hasStats&&(g.stats=m.stats),m.initSegment&&(g.initSegment=m.initSegment,i=m.initSegment)});const o=e.fragments,c=e.fragmentHint?o.concat(e.fragmentHint):o;if(i&&c.forEach(m=>{var g;m&&(!m.initSegment||m.initSegment.relurl===((g=i)==null?void 0:g.relurl))&&(m.initSegment=i)}),e.skippedSegments){if(e.deltaUpdateFailed=o.some(m=>!m),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let m=e.skippedSegments;m--;)o.shift();e.startSN=o[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=y9(s.dateRanges,e,t));const m=s.fragments.filter(g=>g.rawProgramDateTime);if(s.hasProgramDateTime&&!e.hasProgramDateTime)for(let g=1;g<c.length;g++)c[g].programDateTime===null&&Gg(c[g],c[g-1],m);i3(m,e)}e.endCC=o[o.length-1].cc}if(!e.startCC){var f;const m=u3(s,e.startSN-1);e.startCC=(f=m==null?void 0:m.cc)!=null?f:o[0].cc}x9(s.partList,e.partList,(m,g)=>{g.elementaryStreams=m.elementaryStreams,g.stats=m.stats}),a?n3(e,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS,t):r3(s,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const m=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=m),e.driftEndTime=d,e.driftEnd=m}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=s.requestScheduled)}function y9(s,e,t){const{dateRanges:i,recentlyRemovedDateranges:n}=e,a=bt({},s);n&&n.forEach(f=>{delete a[f]});const c=Object.keys(a).length;return c?(Object.keys(i).forEach(f=>{const d=a[f],m=new ZA(i[f].attr,d);m.isValid?(a[f]=m,d||(m.tagOrder+=c)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Tt(i[f].attr)}"`)}),a):i}function x9(s,e,t){if(s&&e){let i=0;for(let n=0,a=s.length;n<=a;n++){const o=s[n],c=e[n+i];o&&c&&o.index===c.index&&o.fragment.sn===c.fragment.sn?t(o,c):i--}}}function T9(s,e,t){const i=e.skippedSegments,n=Math.max(s.startSN,e.startSN)-e.startSN,a=(s.fragmentHint?1:0)+(i?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,o=e.startSN-s.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,f=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let d=n;d<=a;d++){const m=f[o+d];let g=c[d];if(i&&!g&&m&&(g=e.fragments[d]=m),m&&g){t(m,g,d,c);const p=m.relurl,T=g.relurl;if(p&&v9(p,T)){e.playlistParsingError=y2(`media sequence mismatch ${g.sn}:`,s,e,m,g);return}else if(m.cc!==g.cc){e.playlistParsingError=y2(`discontinuity sequence mismatch (${m.cc}!=${g.cc})`,s,e,m,g);return}}}}function y2(s,e,t,i,n){return new Error(`${s} ${n.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function r3(s,e,t=!0){const i=e.startSN+e.skippedSegments-s.startSN,n=s.fragments,a=i>=0;let o=0;if(a&&i<n.length)o=n[i].start;else if(a&&e.startSN===s.endSN+1)o=s.fragmentEnd;else if(a&&t)o=s.fragmentStart+i*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)o=s.fragmentStart;else return;qg(e,o)}function qg(s,e){if(e){const t=s.fragments;for(let i=s.skippedSegments;i<t.length;i++)t[i].addStart(e);s.fragmentHint&&s.fragmentHint.addStart(e)}}function a3(s,e=1/0){let t=1e3*s.targetduration;if(s.updated){const i=s.fragments;if(i.length&&t*4>e){const a=i[i.length-1].duration*1e3;a<t&&(t=a)}}else t/=2;return Math.round(t)}function u3(s,e,t){if(!s)return null;let i=s.fragments[e-s.startSN];return i||(i=s.fragmentHint,i&&i.sn===e)?i:e<s.startSN&&t&&t.sn===e?t:null}function x2(s,e,t){return s?o3(s.partList,e,t):null}function o3(s,e,t){if(s)for(let i=s.length;i--;){const n=s[i];if(n.index===t&&n.fragment.sn===e)return n}return null}function l3(s){s.forEach((e,t)=>{var i;(i=e.details)==null||i.fragments.forEach(n=>{n.level=t,n.initSegment&&(n.initSegment.level=t)})})}function v9(s,e){return s!==e&&e?T2(s)!==T2(e):!1}function T2(s){return s.replace(/\?[^?]*$/,"")}function dl(s,e){for(let i=0,n=s.length;i<n;i++){var t;if(((t=s[i])==null?void 0:t.cc)===e)return s[i]}return null}function S9(s,e){return!!(s&&e.startCC<s.endCC&&e.endCC>s.startCC)}function v2(s,e){const t=s.start+e;s.startPTS=t,s.setStart(t),s.endPTS=t+s.duration}function c3(s,e){const t=e.fragments;for(let i=0,n=t.length;i<n;i++)v2(t[i],s);e.fragmentHint&&v2(e.fragmentHint,s),e.alignedSliding=!0}function A9(s,e){s&&(d3(e,s),e.alignedSliding||If(e,s),!e.alignedSliding&&!e.skippedSegments&&r3(s,e,!1))}function d3(s,e){if(!S9(e,s))return;const t=Math.min(e.endCC,s.endCC),i=dl(e.fragments,t),n=dl(s.fragments,t);if(!i||!n)return;ft.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const a=i.start-n.start;c3(a,s)}function If(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const t=s.fragments,i=e.fragments;if(!t.length||!i.length)return;let n,a;const o=Math.min(e.endCC,s.endCC);e.startCC<o&&s.startCC<o&&(n=dl(i,o),a=dl(t,o)),(!n||!a)&&(n=i[Math.floor(i.length/2)],a=dl(t,n.cc)||t[Math.floor(t.length/2)]);const c=n.programDateTime,f=a.programDateTime;if(!c||!f)return;const d=(f-c)/1e3-(a.start-n.start);c3(d,s)}function Ds(s,e,t){zs(s,e,t),s.addEventListener(e,t)}function zs(s,e,t){s.removeEventListener(e,t)}const _9={toString:function(s){let e="";const t=s.length;for(let i=0;i<t;i++)e+=`[${s.start(i).toFixed(3)}-${s.end(i).toFixed(3)}]`;return e}},ce={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Zp extends XA{constructor(e,t,i,n,a){super(n,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ce.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:c,media:f,mediaBuffer:d,state:m}=this,g=f?f.currentTime:0,p=Ue.bufferInfo(d||f,g,o.maxBufferHole),T=!p.len;if(this.log(`Media seeking to ${Se(g)?g.toFixed(3):g}, state: ${m}, ${T?"out of":"in"} buffer`),this.state===ce.ENDED)this.resetLoadingState();else if(c){const y=o.maxFragLookUpTolerance,S=c.start-y,A=c.start+c.duration+y;if(T||A<p.start||S>p.end){const R=g>A;(g<S||R)&&(R&&c.loader&&(this.log(`Cancelling fragment load for seek (sn: ${c.sn})`),c.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(f){this.fragmentTracker.removeFragmentsInRange(g,1/0,this.playlistType,!0);const y=this.lastCurrentTime;if(g>y&&(this.lastCurrentTime=g),!this.loadingParts){const S=Math.max(p.end,g),A=this.shouldLoadParts(this.getLevelDetails(),S);A&&(this.log(`LL-Part loading ON after seeking to ${g.toFixed(2)} with buffer @${S.toFixed(2)}`),this.loadingParts=A)}}this.hls.hasEnoughToStart||(this.log(`Setting ${T?"startPosition":"nextLoadPosition"} to ${g} for seek without enough to start`),this.nextLoadPosition=g,T&&(this.startPosition=g)),T&&this.state===ce.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=e,this.fragmentLoader=new JP(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Kp(e.config)}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===ce.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ce.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const i=e.end||0,n=this.config.timelineOffset||0;if(i<=n)return!1;const a=e.buffered;this.config.maxBufferHole&&a&&a.length>1&&(e=Ue.bufferedInfo(a,e.start,0));const o=e.nextStart;if(o&&o>n&&o<t.edge||this.media.currentTime<e.start)return!1;const f=t.partList;if(f!=null&&f.length){const m=f[f.length-1];return Ue.isBuffered(this.media,m.start+m.duration/2)}const d=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(d)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;Ds(i,"seeking",this.onMediaSeeking),Ds(i,"ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===ce.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(e,t){const i=!!t.transferMedia,n=this.media;if(n!==null){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),zs(n,"seeking",this.onMediaSeeking),zs(n,"ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=ce.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this.startFragRequested=!0,this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){const n=a=>{const o=a.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${a.part?" part: "+a.part.index:""} of ${this.fragInfo(o,!1,a.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(e,t,i,n).then(a=>{if(!a)return;const o=this.state,c=a.frag;if(this.fragContextChanged(c)){(o===ce.FRAG_LOADING||!this.fragCurrent&&o===ce.PARSING)&&(this.fragmentTracker.removeFragment(c),this.state=ce.IDLE);return}"payload"in a&&(this.log(`Loaded ${c.type} sn: ${c.sn} of ${this.playlistLabel()} ${c.level}`),this.hls.trigger(L.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===ce.STOPPED||this.state===ce.ERROR||(this.warn(`Frag error: ${(a==null?void 0:a.message)||a}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===Jt.APPENDING){const a=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,a),c=Math.max(e.duration,o?o.len:this.config.maxBufferLength),f=this.backtrackFragment;((f?e.sn-f.sn:0)===1||this.reduceMaxBufferLength(c,e.duration))&&i.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===Jt.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:i};this.hls.trigger(L.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(i=>{const n=i==null?void 0:i.frag;if(!n||this.fragContextChanged(n)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:n}=this,{frag:a,payload:o}=i,c=a.decryptdata;if(o&&o.byteLength>0&&c!=null&&c.key&&c.iv&&Lu(c.method)){const f=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),c.key.buffer,c.iv.buffer,Xp(c.method)).catch(d=>{throw n.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:a}),d}).then(d=>{const m=self.performance.now();return n.trigger(L.FRAG_DECRYPTED,{frag:a,payload:d,stats:{tstart:f,tdecrypt:m}}),i.payload=d,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===ce.STOPPED||this.state===ce.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const i=e.frag.stats;this.state!==ce.STOPPED&&(this.state=ce.IDLE),e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var i,n;const a=e.tracks;if(a&&!t.encrypted&&((i=a.audio)!=null&&i.encrypted||(n=a.video)!=null&&n.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const o=this.media,c=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${o?"attached mediaKeys: "+o.mediaKeys:"detached"})`);return this.warn(c.message),!o||o.mediaKeys?!1:(this.hls.trigger(L.ERROR,{type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,fatal:!1,error:c,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${i?_9.toString(Ue.getBuffered(i)):"(detached)"})`),Ut(e)){var n;if(e.type!==_e.SUBTITLE){const o=e.elementaryStreams;if(!Object.keys(o).some(c=>!!o[c])){this.state=ce.IDLE;return}}const a=(n=this.levels)==null?void 0:n[e.level];a!=null&&a.fragmentError&&(this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),a.fragmentError=0)}this.state=ce.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:n,partsLoaded:a}=e,o=!a||a.length===0||a.some(f=>!f),c=new Qp(i.level,i.sn,i.stats.chunkCount+1,0,n?n.index:-1,!o);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,n){var a;this.fragCurrent=e;const o=t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let c=null;if(e.encrypted&&!((a=e.decryptdata)!=null&&a.key)){if(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=ce.KEY_LOADING,this.fragCurrent=e,c=this.keyLoader.load(e).then(p=>{if(!this.fragContextChanged(p.frag))return this.hls.trigger(L.KEY_LOADED,p),this.state===ce.KEY_LOADING&&(this.state=ce.IDLE),p}),this.hls.trigger(L.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(c=this.keyLoader.loadClear(e,o.encryptedFragments,this.startFragRequested),c&&this.log("[eme] blocking frag load until media-keys acquired"));const f=this.fragPrevious;if(Ut(e)&&(!f||e.sn!==f.sn)){const p=this.shouldLoadParts(t.details,e.end);p!==this.loadingParts&&(this.log(`LL-Part loading ${p?"ON":"OFF"} loading sn ${f==null?void 0:f.sn}->${e.sn}`),this.loadingParts=p)}if(i=Math.max(e.start,i||0),this.loadingParts&&Ut(e)){const p=o.partList;if(p&&n){i>o.fragmentEnd&&o.fragmentHint&&(e=o.fragmentHint);const T=this.getNextPart(p,e,i);if(T>-1){const y=p[T];e=this.fragCurrent=y.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${y.index} (${T}/${p.length-1}) of ${this.fragInfo(e,!1,y)}) cc: ${e.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=ce.FRAG_LOADING;let S;return c?S=c.then(A=>!A||this.fragContextChanged(A.frag)?null:this.doFragPartsLoad(e,y,t,n)).catch(A=>this.handleFragLoadError(A)):S=this.doFragPartsLoad(e,y,t,n).catch(A=>this.handleFragLoadError(A)),this.hls.trigger(L.FRAG_LOADING,{frag:e,part:y,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!e.url||this.loadedEndOfParts(p,i))return Promise.resolve(null)}}if(Ut(e)&&this.loadingParts){var d;this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(d=o.partList)==null?void 0:d.filter(p=>p.loaded).map(p=>`[${p.start}-${p.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+o.startSN+"-"+o.endSN+"]"}, target: ${parseFloat(i.toFixed(3))}`),Se(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ce.FRAG_LOADING;const m=this.config.progressive&&e.type!==_e.SUBTITLE;let g;return m&&c?g=c.then(p=>!p||this.fragContextChanged(p.frag)?null:this.fragmentLoader.load(e,n)).catch(p=>this.handleFragLoadError(p)):g=Promise.all([this.fragmentLoader.load(e,m?n:void 0),c]).then(([p])=>(!m&&n&&n(p),p)).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(L.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):g}doFragPartsLoad(e,t,i,n){return new Promise((a,o)=>{var c;const f=[],d=(c=i.details)==null?void 0:c.partList,m=g=>{this.fragmentLoader.loadPart(e,g,n).then(p=>{f[g.index]=p;const T=p.part;this.hls.trigger(L.FRAG_LOADED,p);const y=x2(i.details,e.sn,g.index+1)||o3(d,e.sn,g.index+1);if(y)m(y);else return a({frag:e,part:T,partsLoaded:f})}).catch(o)};m(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===Q.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Ie.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(L.ERROR,t)}else this.hls.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ce.PARSING){!this.fragCurrent&&this.state!==ce.STOPPED&&this.state!==ce.ERROR&&(this.state=ce.IDLE);return}const{frag:i,part:n,level:a}=t,o=self.performance.now();i.stats.parsing.end=o,n&&(n.stats.parsing.end=o);const c=this.getLevelDetails(),d=c&&i.sn>c.endSN||this.shouldLoadParts(c,i.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=d),this.updateLevelTiming(i,n,a,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var i;const a=e.partList[0];if(a.fragment.type===_e.SUBTITLE)return!1;const o=a.end+(((i=e.fragmentHint)==null?void 0:i.duration)||0);if(t>=o){var n;if((this.hls.hasEnoughToStart?((n=this.media)==null?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:n,sn:a,part:o}=e;if(!(t!=null&&t[n]))return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const c=t[n],f=c.details,d=o>-1?x2(f,a,o):null,m=d?d.fragment:u3(f,a,i);return m?(i&&i!==m&&(m.stats=i.stats),{frag:m,part:d,level:c}):null}bufferFragmentData(e,t,i,n,a){if(this.state!==ce.PARSING)return;const{data1:o,data2:c}=e;let f=o;if(c&&(f=_i(o,c)),!f.length)return;const d=this.initPTS[t.cc],m=d?-d.baseTime/d.timescale:void 0,g={type:e.type,frag:t,part:i,chunkMeta:n,offset:m,parent:t.type,data:f};if(this.hls.trigger(L.BUFFER_APPENDING,g),e.dropped&&e.independent&&!i){if(a)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ue.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const i=t.currentTime,n=Ue.bufferInfo(t,i,0),a=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),c=Math.max(Math.min(e.start-o,n.end-o),i+o);e.start-c>o&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){var i;const n=this.getLoadPosition();if(!Se(n))return null;const o=this.lastCurrentTime>n||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,n,t,o)}getFwdBufferInfoAtPos(e,t,i,n){const a=Ue.bufferInfo(e,t,n);if(a.len===0&&a.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,i);if(o&&(a.nextStart<=o.end||o.gap)){const c=Math.max(Math.min(a.nextStart,o.end)-t,n);return Ue.bufferInfo(e,t,c)}}return a}getMaxBufferLength(e){const{config:t}=this;let i;return e?i=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):i=t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const i=this.config,n=Math.max(Math.min(e-t,i.maxBufferLength),t),a=Math.max(e-t*3,i.maxMaxBufferLength/2,n);return a>=n?(i.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0):!1}getAppendedFrag(e,t=_e.MAIN){const i=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const i=t.fragments,n=i.length;if(!n)return null;const{config:a}=this,o=i[0].start,c=a.lowLatencyMode&&!!t.partList;let f=null;if(t.live){const g=a.initialLiveManifestSize;if(n<g)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${g})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o){var d;c&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),f=this.getInitialLiveFragment(t);const p=this.hls.startPosition,T=this.hls.liveSyncPosition,y=f?(p!==-1&&p>=o?p:T)||f.start:e;this.log(`Setting startPosition to ${y} to match start frag at live edge. mainStart: ${p} liveSyncPosition: ${T} frag.start: ${(d=f)==null?void 0:d.start}`),this.startPosition=this.nextLoadPosition=y}}else e<=o&&(f=i[0]);if(!f){const g=this.loadingParts?t.partEnd:t.fragmentEnd;f=this.getFragmentAtPosition(e,g,t)}let m=this.filterReplacedPrimary(f,t);if(!m&&f){const g=f.sn-t.startSN;m=this.filterReplacedPrimary(i[g+1]||null,t)}return this.mapToInitFragWhenRequired(m)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===Jt.OK||i===Jt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,n,a){let o=null;if(e.gap&&(o=this.getNextFragment(this.nextLoadPosition,t),o&&!o.gap&&i.nextStart)){const c=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,n,0);if(c!==null&&i.len+c.len>=a){const f=o.sn;return this.loopSn!==f&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${f}`),this.loopSn=f),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(S2(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(S2(this.config)&&e.type!==_e.SUBTITLE){const i=this.hls.interstitialsManager,n=i==null?void 0:i.bufferingItem;if(n){const o=n.event;if(o){if(o.appendInPlace||Math.abs(e.start-n.start)>1||n.start===0)return null}else if(e.end<=n.start&&(t==null?void 0:t.live)===!1||e.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||e.start-n.end>1))return null}const a=i==null?void 0:i.playerQueue;if(a)for(let o=a.length;o--;){const c=a[o].interstitial;if(c.appendInPlace&&e.start>=c.startTime&&e.end<=c.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,i){let n=-1,a=!1,o=!0;for(let c=0,f=e.length;c<f;c++){const d=e[c];if(o=o&&!d.independent,n>-1&&i<d.start)break;const m=d.loaded;m?n=-1:(a||(d.independent||o)&&d.fragment===t)&&(d.fragment!==t&&this.warn(`Need buffer at ${i} but next unloaded part starts at ${d.start}`),n=c),a=m}return n}loadedEndOfParts(e,t){let i;for(let n=e.length;n--;){if(i=e[n],!i.loaded)return!1;if(t>i.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,i=this.fragPrevious;let n=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),n=jP(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const a=i.sn+1;if(a>=e.startSN&&a<=e.endSN){const o=t[a-e.startSN];i.cc===o.cc&&(n=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=YA(e,i.cc,i.end),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(n=this.getFragmentAtPosition(a,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}getFragmentAtPosition(e,t,i){const{config:n}=this;let{fragPrevious:a}=this,{fragments:o,endSN:c}=i;const{fragmentHint:f}=i,{maxFragLookUpTolerance:d}=n,m=i.partList,g=!!(this.loadingParts&&m!=null&&m.length&&f);g&&!this.bitrateTest&&m[m.length-1].fragment.sn===f.sn&&(o=o.concat(f),c=f.sn);let p;if(e<t){var T;const S=e<this.lastCurrentTime||e>t-d||(T=this.media)!=null&&T.paused||!this.startFragRequested?0:d;p=Sa(a,o,e,S)}else p=o[o.length-1];if(p){const y=p.sn-i.startSN,S=this.fragmentTracker.getState(p);if((S===Jt.OK||S===Jt.PARTIAL&&p.gap)&&(a=p),a&&p.sn===a.sn&&(!g||m[0].fragment.sn>p.sn||!i.live)&&p.level===a.level){const R=o[y+1];p.sn<c&&this.fragmentTracker.getState(R)!==Jt.OK?p=R:p=null}}return p}alignPlaylists(e,t,i){const n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const a=e.fragmentStart,o=!t,c=e.alignedSliding&&Se(a);if(o||!c&&!a){A9(i,e);const f=e.fragmentStart;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${n}`),f}return a}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let i=this.startPosition;i<t&&(i=-1);const n=this.timelineOffset;if(i===-1){const a=this.startTimeOffset!==null,o=a?this.startTimeOffset:e.startTimeOffset;o!==null&&Se(o)?(i=t+o,o<0&&(i+=e.edge),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${o} found in ${a?"multivariant":"media"} playlist`),this.startPosition=i):e.live?(i=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+n}this.nextLoadPosition=i+n}getLoadPosition(){var e;const{media:t}=this;let i=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?i=t.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Ut(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ce.FRAG_LOADING_WAITING_RETRY)&&(this.state=ce.IDLE)}onFragmentOrKeyLoadError(e,t){var i;if(t.chunkMeta&&!t.frag){const R=this.getCurrentContext(t.chunkMeta);R&&(t.frag=R.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var a;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(a=this.fragCurrent)==null?void 0:a.url}`);return}const o=t.details===Q.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(n,!0);const c=t.errorAction;if(!c){this.state=ce.ERROR;return}const{action:f,flags:d,retryCount:m=0,retryConfig:g}=c,p=!!g,T=p&&f===bs.RetryRequest,y=p&&!c.resolved&&d===ai.MoveAllAlternatesMatchingHost,S=(i=this.hls.latestLevelDetails)==null?void 0:i.live;if(!T&&y&&Ut(n)&&!n.endList&&S&&!QA(t))this.resetFragmentErrors(e),this.treatAsGap(n),c.resolved=!0;else if((T||y)&&m<g.maxNumRetry){var A;const R=Hg((A=t.response)==null?void 0:A.code),C=Yp(g,m);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+C,this.state=ce.FRAG_LOADING_WAITING_RETRY,c.resolved=!0,R){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${m+1}/${g.maxNumRetry} in ${C}ms`)}else if(g)if(this.resetFragmentErrors(e),m<g.maxNumRetry)!o&&f!==bs.RemoveAlternatePermanently&&(c.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${m})`);return}else f===bs.SendAlternateToPenaltyBox?this.state=ce.WAITING_LEVEL:this.state=ce.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,i=t===1/0;(!t||e>=t||i&&!Hg(0))&&(i&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=ce.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===ce.PARSING||this.state===ce.PARSED){const t=e.frag,i=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,i),a=n&&n.len>.5;a&&this.reduceMaxBufferLength(n.len,(t==null?void 0:t.duration)||10);const o=!a;return o&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${i} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===_e.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==ce.STOPPED&&(this.state=ce.IDLE)}afterBufferFlushed(e,t,i){if(!e)return;const n=Ue.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,i),this.state===ce.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==ce.STOPPED&&(this.state=ce.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,n){const a=i.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((f,d)=>{const m=e.elementaryStreams[d];if(m){const g=m.endPTS-m.startPTS;if(g<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${g})`),f||!1;const p=n?0:n3(a,e,m.startPTS,m.endPTS,m.startDTS,m.endDTS,this);return this.hls.trigger(L.LEVEL_PTS_UPDATED,{details:a,level:i,drift:p,type:d,frag:e,start:m.startPTS,end:m.endPTS}),!0}return f},!1)){var c;const f=((c=this.transmuxer)==null?void 0:c.error)===null;if((i.fragmentError===0||f&&(i.fragmentError<2||e.endList))&&this.treatAsGap(e,i),f){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=ce.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(L.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===_e.MAIN?"level":"track"}fragInfo(e,t=!0,i){var n,a;return`${this.playlistLabel()} ${e.level} (${i?"part":"frag"}:[${((n=t&&!i?e.startPTS:(i||e).start)!=null?n:NaN).toFixed(3)}-${((a=t&&!i?e.endPTS:(i||e).end)!=null?a:NaN).toFixed(3)}]${i&&e.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function S2(s){return!!s.interstitialsController&&s.enableInterstitialPlayback!==!1}class f3{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;if(e.length)e.length===1?i=e[0]:i=L9(e,t);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function L9(s,e){const t=new Uint8Array(e);let i=0;for(let n=0;n<s.length;n++){const a=s[n];t.set(a,i),i+=a.length}return t}var zm={exports:{}},A2;function R9(){return A2||(A2=1,(function(s){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function n(f,d,m){this.fn=f,this.context=d,this.once=m||!1}function a(f,d,m,g,p){if(typeof m!="function")throw new TypeError("The listener must be a function");var T=new n(m,g||f,p),y=t?t+d:d;return f._events[y]?f._events[y].fn?f._events[y]=[f._events[y],T]:f._events[y].push(T):(f._events[y]=T,f._eventsCount++),f}function o(f,d){--f._eventsCount===0?f._events=new i:delete f._events[d]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],m,g;if(this._eventsCount===0)return d;for(g in m=this._events)e.call(m,g)&&d.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},c.prototype.listeners=function(d){var m=t?t+d:d,g=this._events[m];if(!g)return[];if(g.fn)return[g.fn];for(var p=0,T=g.length,y=new Array(T);p<T;p++)y[p]=g[p].fn;return y},c.prototype.listenerCount=function(d){var m=t?t+d:d,g=this._events[m];return g?g.fn?1:g.length:0},c.prototype.emit=function(d,m,g,p,T,y){var S=t?t+d:d;if(!this._events[S])return!1;var A=this._events[S],R=arguments.length,C,I;if(A.fn){switch(A.once&&this.removeListener(d,A.fn,void 0,!0),R){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,m),!0;case 3:return A.fn.call(A.context,m,g),!0;case 4:return A.fn.call(A.context,m,g,p),!0;case 5:return A.fn.call(A.context,m,g,p,T),!0;case 6:return A.fn.call(A.context,m,g,p,T,y),!0}for(I=1,C=new Array(R-1);I<R;I++)C[I-1]=arguments[I];A.fn.apply(A.context,C)}else{var D=A.length,k;for(I=0;I<D;I++)switch(A[I].once&&this.removeListener(d,A[I].fn,void 0,!0),R){case 1:A[I].fn.call(A[I].context);break;case 2:A[I].fn.call(A[I].context,m);break;case 3:A[I].fn.call(A[I].context,m,g);break;case 4:A[I].fn.call(A[I].context,m,g,p);break;default:if(!C)for(k=1,C=new Array(R-1);k<R;k++)C[k-1]=arguments[k];A[I].fn.apply(A[I].context,C)}}return!0},c.prototype.on=function(d,m,g){return a(this,d,m,g,!1)},c.prototype.once=function(d,m,g){return a(this,d,m,g,!0)},c.prototype.removeListener=function(d,m,g,p){var T=t?t+d:d;if(!this._events[T])return this;if(!m)return o(this,T),this;var y=this._events[T];if(y.fn)y.fn===m&&(!p||y.once)&&(!g||y.context===g)&&o(this,T);else{for(var S=0,A=[],R=y.length;S<R;S++)(y[S].fn!==m||p&&!y[S].once||g&&y[S].context!==g)&&A.push(y[S]);A.length?this._events[T]=A.length===1?A[0]:A:o(this,T)}return this},c.prototype.removeAllListeners=function(d){var m;return d?(m=t?t+d:d,this._events[m]&&o(this,m)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,s.exports=c})(zm)),zm.exports}var I9=R9(),Jp=JM(I9);const Il="1.6.15",$u={};function C9(){return typeof __HLS_WORKER_BUNDLE__=="function"}function N9(){const s=$u[Il];if(s)return s.clientCount++,s;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),n={worker:new self.Worker(t),objectURL:t,clientCount:1};return $u[Il]=n,n}function D9(s){const e=$u[s];if(e)return e.clientCount++,e;const t=new self.URL(s,self.location.href).href,n={worker:new self.Worker(t),scriptURL:t,clientCount:1};return $u[s]=n,n}function w9(s){const e=$u[s||Il];if(e&&e.clientCount--===1){const{worker:i,objectURL:n}=e;delete $u[s||Il],n&&self.URL.revokeObjectURL(n),i.terminate()}}function h3(s,e){return e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function e1(s,e){return e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function eh(s,e){let t=0;return t=(s[e]&127)<<21,t|=(s[e+1]&127)<<14,t|=(s[e+2]&127)<<7,t|=s[e+3]&127,t}function Cl(s,e){const t=e;let i=0;for(;e1(s,e);){i+=10;const n=eh(s,e+6);i+=n,h3(s,e+10)&&(i+=10),e+=i}if(i>0)return s.subarray(t,t+i)}function O9(s,e,t,i){const n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],a=e[t+2],o=a>>2&15;if(o>12){const T=new Error(`invalid ADTS sampling index:${o}`);s.emit(L.ERROR,L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!0,error:T,reason:T.message});return}const c=(a>>6&3)+1,f=e[t+3]>>6&3|(a&1)<<2,d="mp4a.40."+c,m=n[o];let g=o;(c===5||c===29)&&(g-=3);const p=[c<<3|(g&14)>>1,(g&1)<<7|f<<3];return ft.log(`manifest codec:${i}, parsed codec:${d}, channels:${f}, rate:${m} (ADTS object type:${c} sampling index:${o})`),{config:p,samplerate:m,channelCount:f,codec:d,parsedCodec:d,manifestCodec:i}}function m3(s,e){return s[e]===255&&(s[e+1]&246)===240}function g3(s,e){return s[e+1]&1?7:9}function t1(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function k9(s,e){return e+5<s.length}function Cf(s,e){return e+1<s.length&&m3(s,e)}function M9(s,e){return k9(s,e)&&m3(s,e)&&t1(s,e)<=s.length-e}function P9(s,e){if(Cf(s,e)){const t=g3(s,e);if(e+t>=s.length)return!1;const i=t1(s,e);if(i<=t)return!1;const n=e+i;return n===s.length||Cf(s,n)}return!1}function p3(s,e,t,i,n){if(!s.samplerate){const a=O9(e,t,i,n);if(!a)return;bt(s,a)}}function b3(s){return 1024*9e4/s}function U9(s,e){const t=g3(s,e);if(e+t<=s.length){const i=t1(s,e)-t;if(i>0)return{headerLength:t,frameLength:i}}}function E3(s,e,t,i,n){const a=b3(s.samplerate),o=i+n*a,c=U9(e,t);let f;if(c){const{frameLength:g,headerLength:p}=c,T=p+g,y=Math.max(0,t+T-e.length);y?(f=new Uint8Array(T-p),f.set(e.subarray(t+p,e.length),0)):f=e.subarray(t+p,t+T);const S={unit:f,pts:o};return y||s.samples.push(S),{sample:S,length:T,missing:y}}const d=e.length-t;return f=new Uint8Array(d),f.set(e.subarray(t,e.length),0),{sample:{unit:f,pts:o},length:d,missing:-1}}function B9(s,e){return e1(s,e)&&eh(s,e+6)+10<=s.length-e}function F9(s){return s instanceof ArrayBuffer?s:s.byteOffset==0&&s.byteLength==s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer}function Ym(s,e=0,t=1/0){return H9(s,e,t,Uint8Array)}function H9(s,e,t,i){const n=j9(s);let a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);const o=$9(s)?s.byteOffset:0,c=(o+s.byteLength)/a,f=(o+e)/a,d=Math.floor(Math.max(0,Math.min(f,c))),m=Math.floor(Math.min(d+Math.max(t,0),c));return new i(n,d,m-d)}function j9(s){return s instanceof ArrayBuffer?s:s.buffer}function $9(s){return s&&s.buffer instanceof ArrayBuffer&&s.byteLength!==void 0&&s.byteOffset!==void 0}function G9(s){const e={key:s.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(s.size<2)return;if(s.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const i=s.data.subarray(1).indexOf(0);if(i===-1)return;const n=ci(Ym(s.data,1,i)),a=s.data[2+i],o=s.data.subarray(3+i).indexOf(0);if(o===-1)return;const c=ci(Ym(s.data,3+i,o));let f;return n==="-->"?f=ci(Ym(s.data,4+i+o)):f=F9(s.data.subarray(4+i+o)),e.mimeType=n,e.pictureType=a,e.description=c,e.data=f,e}function q9(s){if(s.size<2)return;const e=ci(s.data,!0),t=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:t.buffer}}function V9(s){if(s.size<2)return;if(s.type==="TXXX"){let t=1;const i=ci(s.data.subarray(t),!0);t+=i.length+1;const n=ci(s.data.subarray(t));return{key:s.type,info:i,data:n}}const e=ci(s.data.subarray(1));return{key:s.type,info:"",data:e}}function z9(s){if(s.type==="WXXX"){if(s.size<2)return;let t=1;const i=ci(s.data.subarray(t),!0);t+=i.length+1;const n=ci(s.data.subarray(t));return{key:s.type,info:i,data:n}}const e=ci(s.data);return{key:s.type,info:"",data:e}}function Y9(s){return s.type==="PRIV"?q9(s):s.type[0]==="W"?z9(s):s.type==="APIC"?G9(s):V9(s)}function K9(s){const e=String.fromCharCode(s[0],s[1],s[2],s[3]),t=eh(s,4),i=10;return{type:e,size:t,data:s.subarray(i,i+t)}}const Rd=10,Q9=10;function y3(s){let e=0;const t=[];for(;e1(s,e);){const i=eh(s,e+6);s[e+5]>>6&1&&(e+=Rd),e+=Rd;const n=e+i;for(;e+Q9<n;){const a=K9(s.subarray(e)),o=Y9(a);o&&t.push(o),e+=a.size+Rd}h3(s,e)&&(e+=Rd)}return t}function x3(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"}function X9(s){if(s.data.byteLength===8){const e=new Uint8Array(s.data),t=e[3]&1;let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,t&&(i+=4772185884e-2),Math.round(i)}}function s1(s){const e=y3(s);for(let t=0;t<e.length;t++){const i=e[t];if(x3(i))return X9(i)}}let li=(function(s){return s.audioId3="org.id3",s.dateRange="com.apple.quicktime.HLS",s.emsg="https://aomedia.org/emsg/ID3",s.misbklv="urn:misb:KLV:bin:1910.1",s})({});function en(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class i1{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=_i(this.cachedData,e),this.cachedData=null);let i=Cl(e,0),n=i?i.length:0,a;const o=this._audioTrack,c=this._id3Track,f=i?s1(i):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&Se(f))&&(this.basePTS=W9(f,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:li.audioId3,duration:Number.POSITIVE_INFINITY});n<d;){if(this.canParse(e,n)){const m=this.appendFrame(o,e,n);m?(this.frameIndex++,this.lastPTS=m.sample.pts,n+=m.length,a=n):n=d}else B9(e,n)?(i=Cl(e,n),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:li.audioId3,duration:Number.POSITIVE_INFINITY}),n+=i.length,a=n):n++;if(n===d&&a!==d){const m=e.slice(a);this.cachedData?this.cachedData=_i(this.cachedData,m):this.cachedData=m}}return{audioTrack:o,videoTrack:en(),id3Track:c,textTrack:en()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:en(),id3Track:this._id3Track,textTrack:en()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const W9=(s,e,t)=>{if(Se(s))return s*90;const i=t?t.baseTime*9e4/t.timescale:0;return e*9e4+i};let Id=null;const Z9=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],J9=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],eU=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],tU=[0,1,1,4];function T3(s,e,t,i,n){if(t+24>e.length)return;const a=v3(e,t);if(a&&t+a.frameLength<=e.length){const o=a.samplesPerFrame*9e4/a.sampleRate,c=i+n*o,f={unit:e.subarray(t,t+a.frameLength),pts:c,dts:c};return s.config=[],s.channelCount=a.channelCount,s.samplerate=a.sampleRate,s.samples.push(f),{sample:f,length:a.frameLength,missing:0}}}function v3(s,e){const t=s[e+1]>>3&3,i=s[e+1]>>1&3,n=s[e+2]>>4&15,a=s[e+2]>>2&3;if(t!==1&&n!==0&&n!==15&&a!==3){const o=s[e+2]>>1&1,c=s[e+3]>>6,f=t===3?3-i:i===3?3:4,d=Z9[f*14+n-1]*1e3,g=J9[(t===3?0:t===2?1:2)*3+a],p=c===3?1:2,T=eU[t][i],y=tU[i],S=T*8*y,A=Math.floor(T*d/g+o)*y;if(Id===null){const I=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Id=I?parseInt(I[1]):0}return!!Id&&Id<=87&&i===2&&d>=224e3&&c===0&&(s[e+3]=s[e+3]|128),{sampleRate:g,channelCount:p,frameLength:A,samplesPerFrame:S}}}function n1(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function S3(s,e){return e+1<s.length&&n1(s,e)}function sU(s,e){return n1(s,e)&&4<=s.length-e}function A3(s,e){if(e+1<s.length&&n1(s,e)){const i=v3(s,e);let n=4;i!=null&&i.frameLength&&(n=i.frameLength);const a=e+n;return a===s.length||S3(s,a)}return!1}class iU extends i1{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,n){super.resetInitSegment(e,t,i,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const i=Cl(e,0);let n=(i==null?void 0:i.length)||0;if(A3(e,n))return!1;for(let a=e.length;n<a;n++)if(P9(e,n))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return M9(e,t)}appendFrame(e,t,i){p3(e,this.observer,t,i,e.manifestCodec);const n=E3(e,t,i,this.basePTS,this.frameIndex);if(n&&n.missing===0)return n}}const _3=(s,e)=>{let t=0,i=5;e+=i;const n=new Uint32Array(1),a=new Uint32Array(1),o=new Uint8Array(1);for(;i>0;){o[0]=s[e];const c=Math.min(i,8),f=8-c;a[0]=4278190080>>>24+f<<f,n[0]=(o[0]&a[0])>>f,t=t?t<<c|n[0]:n[0],e+=1,i-=c}return t};class nU extends i1{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,i,n){super.resetInitSegment(e,t,i,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,i){const n=L3(e,t,i,this.basePTS,this.frameIndex);if(n!==-1)return{sample:e.samples[e.samples.length-1],length:n,missing:0}}static probe(e){if(!e)return!1;const t=Cl(e,0);if(!t)return!1;const i=t.length;return e[i]===11&&e[i+1]===119&&s1(t)!==void 0&&_3(e,i)<16}}function L3(s,e,t,i,n){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const a=e[t+4]>>6;if(a>=3)return-1;const c=[48e3,44100,32e3][a],f=e[t+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][f*3+a]*2;if(t+m>e.length)return-1;const g=e[t+6]>>5;let p=0;g===2?p+=2:(g&1&&g!==1&&(p+=2),g&4&&(p+=2));const T=(e[t+6]<<8|e[t+7])>>12-p&1,S=[2,1,2,3,3,4,4,5][g]+T,A=e[t+5]>>3,R=e[t+5]&7,C=new Uint8Array([a<<6|A<<1|R>>2,(R&3)<<6|g<<3|T<<2|f>>4,f<<4&224]),I=1536/c*9e4,D=i+n*I,k=e.subarray(t,t+m);return s.config=C,s.channelCount=S,s.samplerate=c,s.samples.push({unit:k,pts:D}),m}class rU extends i1{resetInitSegment(e,t,i,n){super.resetInitSegment(e,t,i,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Cl(e,0);let i=(t==null?void 0:t.length)||0;if(t&&e[i]===11&&e[i+1]===119&&s1(t)!==void 0&&_3(e,i)<=16)return!1;for(let n=e.length;i<n;i++)if(A3(e,i))return ft.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return sU(e,t)}appendFrame(e,t,i){if(this.basePTS!==null)return T3(e,t,i,this.basePTS,this.frameIndex)}}const aU=/\/emsg[-/]ID3/i;class uU{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,n){const a=this.videoTrack=en("video",1),o=this.audioTrack=en("audio",1),c=this.txtTrack=en("text",1);if(this.id3Track=en("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const f=PA(e);if(f.video){const{id:d,timescale:m,codec:g,supplemental:p}=f.video;a.id=d,a.timescale=c.timescale=m,a.codec=g,a.supplemental=p}if(f.audio){const{id:d,timescale:m,codec:g}=f.audio;o.id=d,o.timescale=m,o.codec=g}c.id=OA.text,a.sampleDuration=0,a.duration=o.duration=n}resetContiguity(){this.remainderData=null}static probe(e){return nP(e)}demux(e,t){this.timeOffset=t;let i=e;const n=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=_i(this.remainderData,e));const c=dP(i);this.remainderData=c.remainder,n.samples=c.valid||new Uint8Array}else n.samples=i;const o=this.extractID3Track(n,t);return a.samples=$T(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(t,this.timeOffset);return i.samples=$T(e,t),{videoTrack:t,audioTrack:en(),id3Track:n,textTrack:en()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const n=$e(e.samples,["emsg"]);n&&n.forEach(a=>{const o=hP(a);if(aU.test(o.schemeIdUri)){const c=_2(o,t);let f=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;f<=.001&&(f=Number.POSITIVE_INFINITY);const d=o.payload;i.samples.push({data:d,len:d.byteLength,dts:c,pts:c,type:li.emsg,duration:f})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const c=_2(o,t);i.samples.push({data:o.payload,len:o.payload.byteLength,dts:c,pts:c,type:li.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function _2(s,e){return Se(s.presentationTime)?s.presentationTime/s.timeScale:e+s.presentationTimeDelta/s.timeScale}class oU{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Kp(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Pr.cbc)}decryptAacSample(e,t,i){const n=e[t].unit;if(n.length<=16)return;const a=n.subarray(16,n.length-n.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(o).then(c=>{const f=new Uint8Array(c);n.set(f,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)}).catch(i)}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length){i();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,i=new Int8Array(t);let n=0;for(let a=32;a<e.length-16;a+=160,n+=16)i.set(e.subarray(a,a+16),n);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let n=0;for(let a=32;a<e.length-16;a+=160,n+=16)e.set(i.subarray(n,n+16),a);return e}decryptAvcSample(e,t,i,n,a){const o=FA(a.data),c=this.getAvcEncryptedData(o);this.decryptBuffer(c.buffer).then(f=>{a.data=this.getAvcDecryptedUnit(o,f),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,n)}).catch(n)}decryptAvcSamples(e,t,i,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length){n();return}const a=e[t].units;for(;!(i>=a.length);i++){const o=a[i];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,i,n,o),!this.decrypter.isSync()))return}}}}class R3{constructor(){this.VideoSample=null}createVideoSample(e,t,i){return{key:e,frame:!1,pts:t,dts:i,units:[],length:0}}getLastNalUnit(e){var t;let i=this.VideoSample,n;if((!i||i.units.length===0)&&(i=e[e.length-1]),(t=i)!=null&&t.units){const a=i.units;n=a[a.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const i=t.samples,n=i.length;if(n){const a=i[n-1];e.pts=a.pts,e.dts=a.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,i){const n=t.byteLength;let a=e.naluState||0;const o=a,c=[];let f=0,d,m,g,p=-1,T=0;for(a===-1&&(p=0,T=this.getNALuType(t,0),a=0,f=1);f<n;){if(d=t[f++],!a){a=d?0:1;continue}if(a===1){a=d?0:2;continue}if(!d)a=3;else if(d===1){if(m=f-a-1,p>=0){const y={data:t.subarray(p,m),type:T};c.push(y)}else{const y=this.getLastNalUnit(e.samples);y&&(o&&f<=4-o&&y.state&&(y.data=y.data.subarray(0,y.data.byteLength-o)),m>0&&(y.data=_i(y.data,t.subarray(0,m)),y.state=0))}f<n?(g=this.getNALuType(t,f),p=f,T=g,a=0):a=-1}else a=0}if(p>=0&&a>=0){const y={data:t.subarray(p,n),type:T,state:a};c.push(y)}if(c.length===0){const y=this.getLastNalUnit(e.samples);y&&(y.data=_i(y.data,t))}return e.naluState=a,c}}class fl{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,n=new Uint8Array(4),a=Math.min(4,t);if(a===0)throw new Error("no bytes available");n.set(e.subarray(i,i+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&ft.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class lU extends R3{parsePES(e,t,i,n){const a=this.parseNALu(e,i.data,n);let o=this.VideoSample,c,f=!1;i.data=null,o&&a.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(d=>{var m,g;switch(d.type){case 1:{let S=!1;c=!0;const A=d.data;if(f&&A.length>4){const R=this.readSliceType(A);(R===2||R===4||R===7||R===9)&&(S=!0)}if(S){var p;(p=o)!=null&&p.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.frame=!0,o.key=S;break}case 5:c=!0,(m=o)!=null&&m.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 6:{c=!0,qp(d.data,1,i.pts,t.samples);break}case 7:{var T,y;c=!0,f=!0;const S=d.data,A=this.readSPS(S);if(!e.sps||e.width!==A.width||e.height!==A.height||((T=e.pixelRatio)==null?void 0:T[0])!==A.pixelRatio[0]||((y=e.pixelRatio)==null?void 0:y[1])!==A.pixelRatio[1]){e.width=A.width,e.height=A.height,e.pixelRatio=A.pixelRatio,e.sps=[S];const R=S.subarray(1,4);let C="avc1.";for(let I=0;I<3;I++){let D=R[I].toString(16);D.length<2&&(D="0"+D),C+=D}e.codec=C}break}case 8:c=!0,e.pps=[d.data];break;case 9:c=!0,e.audFound=!0,(g=o)!=null&&g.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:c=!0;break;default:c=!1;break}o&&c&&o.units.push(d)}),n&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new fl(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let i=8,n=8,a;for(let o=0;o<e;o++)n!==0&&(a=t.readEG(),n=(i+a+256)%256),i=n===0?i:n}readSPS(e){const t=new fl(e);let i=0,n=0,a=0,o=0,c,f,d;const m=t.readUByte.bind(t),g=t.readBits.bind(t),p=t.readUEG.bind(t),T=t.readBoolean.bind(t),y=t.skipBits.bind(t),S=t.skipEG.bind(t),A=t.skipUEG.bind(t),R=this.skipScalingList.bind(this);m();const C=m();if(g(5),y(3),m(),A(),C===100||C===110||C===122||C===244||C===44||C===83||C===86||C===118||C===128){const V=p();if(V===3&&y(1),A(),A(),y(1),T())for(f=V!==3?8:12,d=0;d<f;d++)T()&&(d<6?R(16,t):R(64,t))}A();const I=p();if(I===0)p();else if(I===1)for(y(1),S(),S(),c=p(),d=0;d<c;d++)S();A(),y(1);const D=p(),k=p(),z=g(1);z===0&&y(1),y(1),T()&&(i=p(),n=p(),a=p(),o=p());let P=[1,1];if(T()&&T())switch(m()){case 1:P=[1,1];break;case 2:P=[12,11];break;case 3:P=[10,11];break;case 4:P=[16,11];break;case 5:P=[40,33];break;case 6:P=[24,11];break;case 7:P=[20,11];break;case 8:P=[32,11];break;case 9:P=[80,33];break;case 10:P=[18,11];break;case 11:P=[15,11];break;case 12:P=[64,33];break;case 13:P=[160,99];break;case 14:P=[4,3];break;case 15:P=[3,2];break;case 16:P=[2,1];break;case 255:{P=[m()<<8|m(),m()<<8|m()];break}}return{width:Math.ceil((D+1)*16-i*2-n*2),height:(2-z)*(k+1)*16-(z?2:4)*(a+o),pixelRatio:P}}}class cU extends R3{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,i,n){const a=this.parseNALu(e,i.data,n);let o=this.VideoSample,c,f=!1;i.data=null,o&&a.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(d=>{var m,g;switch(d.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),o.frame=!0,c=!0;break;case 16:case 17:case 18:case 21:if(c=!0,f){var p;(p=o)!=null&&p.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:c=!0,(m=o)!=null&&m.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 39:c=!0,qp(d.data,2,i.pts,t.samples);break;case 32:c=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=bt(e.params,this.readVPS(d.data)),this.initVPS=d.data),e.vps=[d.data];break;case 33:if(c=!0,f=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],d.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const T=this.readSPS(d.data);e.width=T.width,e.height=T.height,e.pixelRatio=T.pixelRatio,e.codec=T.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const y in T.params)e.params[y]=T.params[y]}this.pushParameterSet(e.sps,d.data,e.vps),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0;break;case 34:if(c=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const T=this.readPPS(d.data);for(const y in T)e.params[y]=T[y]}this.pushParameterSet(e.pps,d.data,e.vps)}break;case 35:c=!0,e.audFound=!0,(g=o)!=null&&g.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:c=!1;break}o&&c&&o.units.push(d)}),n&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}pushParameterSet(e,t,i){(i&&i[0]===this.initVPS||!i&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let i=0;for(let n=0;n<e.byteLength;n++)n>=2&&e[n]===3&&e[n-1]===0&&e[n-2]===0||(t[i]=e[n],i++);return new Uint8Array(t.buffer,0,i)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new fl(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const i=t.readBits(3),n=t.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:n}}readSPS(e){const t=new fl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const i=t.readBits(3);t.readBoolean();const n=t.readBits(2),a=t.readBoolean(),o=t.readBits(5),c=t.readUByte(),f=t.readUByte(),d=t.readUByte(),m=t.readUByte(),g=t.readUByte(),p=t.readUByte(),T=t.readUByte(),y=t.readUByte(),S=t.readUByte(),A=t.readUByte(),R=t.readUByte(),C=[],I=[];for(let Ke=0;Ke<i;Ke++)C.push(t.readBoolean()),I.push(t.readBoolean());if(i>0)for(let Ke=i;Ke<8;Ke++)t.readBits(2);for(let Ke=0;Ke<i;Ke++)C[Ke]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),I[Ke]&&t.readUByte();t.readUEG();const D=t.readUEG();D==3&&t.skipBits(1);const k=t.readUEG(),z=t.readUEG(),P=t.readBoolean();let V=0,$=0,j=0,te=0;P&&(V+=t.readUEG(),$+=t.readUEG(),j+=t.readUEG(),te+=t.readUEG());const ge=t.readUEG(),ye=t.readUEG(),ve=t.readUEG(),ue=t.readBoolean();for(let Ke=ue?0:i;Ke<=i;Ke++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let ts=0;ts<4;ts++)for(let _s=0;_s<(ts===3?2:6);_s++)if(!t.readBoolean())t.readUEG();else{const Ls=Math.min(64,1<<4+(ts<<1));ts>1&&t.readEG();for(let ji=0;ji<Ls;ji++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const se=t.readUEG();let ne=0;for(let Ke=0;Ke<se;Ke++){let ts=!1;if(Ke!==0&&(ts=t.readBoolean()),ts){Ke===se&&t.readUEG(),t.readBoolean(),t.readUEG();let _s=0;for(let Ii=0;Ii<=ne;Ii++){const Ls=t.readBoolean();let ji=!1;Ls||(ji=t.readBoolean()),(Ls||ji)&&_s++}ne=_s}else{const _s=t.readUEG(),Ii=t.readUEG();ne=_s+Ii;for(let Ls=0;Ls<_s;Ls++)t.readUEG(),t.readBoolean();for(let Ls=0;Ls<Ii;Ls++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Ke=t.readUEG();for(let ts=0;ts<Ke;ts++){for(let _s=0;_s<ve+4;_s++)t.readBits(1);t.readBits(1)}}let O=0,G=1,de=1,pe=!0,Te=1,Ae=0;t.readBoolean(),t.readBoolean();let ke=!1;if(t.readBoolean()){if(t.readBoolean()){const dn=t.readUByte(),Ql=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],ss=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];dn>0&&dn<16?(G=Ql[dn-1],de=ss[dn-1]):dn===255&&(G=t.readBits(16),de=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),ke=t.readBoolean(),ke&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(Te=t.readBits(32),Ae=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const ss=t.readBoolean(),Xl=t.readBoolean();let qn=!1;(ss||Xl)&&(qn=t.readBoolean(),qn&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),qn&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Wu=0;Wu<=i;Wu++){pe=t.readBoolean();const Ca=pe||t.readBoolean();let Wl=!1;Ca?t.readEG():Wl=t.readBoolean();const Zu=Wl?1:t.readUEG()+1;if(ss)for(let Fr=0;Fr<Zu;Fr++)t.readUEG(),t.readUEG(),qn&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Xl)for(let Fr=0;Fr<Zu;Fr++)t.readUEG(),t.readUEG(),qn&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),O=t.readUEG())}let Je=k,xs=z;if(P){let Ke=1,ts=1;D===1?Ke=ts=2:D==2&&(Ke=2),Je=k-Ke*$-Ke*V,xs=z-ts*te-ts*j}const di=n?["A","B","C"][n]:"",Xu=c<<24|f<<16|d<<8|m;let Ia=0;for(let Ke=0;Ke<32;Ke++)Ia=(Ia|(Xu>>Ke&1)<<31-Ke)>>>0;let Ri=Ia.toString(16);return o===1&&Ri==="2"&&(Ri="6"),{codecString:`hvc1.${di}${o}.${Ri}.${a?"H":"L"}${R}.B0`,params:{general_tier_flag:a,general_profile_idc:o,general_profile_space:n,general_profile_compatibility_flags:[c,f,d,m],general_constraint_indicator_flags:[g,p,T,y,S,A],general_level_idc:R,bit_depth:ge+8,bit_depth_luma_minus8:ge,bit_depth_chroma_minus8:ye,min_spatial_segmentation_idc:O,chroma_format_idc:D,frame_rate:{fixed:pe,fps:Ae/Te}},width:Je,height:xs,pixelRatio:[G,de]}}readPPS(e){const t=new fl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const n=t.readBoolean(),a=t.readBoolean();let o=1;return a&&n?o=0:a?o=3:n&&(o=2),{parallelismType:o}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const rs=188;class Sr{constructor(e,t,i,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.logger=n,this.videoParser=null}static probe(e,t){const i=Sr.syncOffset(e);return i>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(e){const t=e.length;let i=Math.min(rs*5,t-rs)+1,n=0;for(;n<i;){let a=!1,o=-1,c=0;for(let f=n;f<t;f+=rs)if(e[f]===71&&(t-f===rs||e[f+rs]===71)){if(c++,o===-1&&(o=f,o!==0&&(i=Math.min(o+rs*99,e.length-rs)+1)),a||(a=Vg(e,f)===0),a&&c>1&&(o===0&&c>2||f+rs>i))return o}else{if(c)return-1;break}n++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:OA[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,i,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Sr.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=Sr.createTrack("audio",n),this._id3Track=Sr.createTrack("id3"),this._txtTrack=Sr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,i=!1,n=!1){i||(this.sampleAes=null);let a;const o=this._videoTrack,c=this._audioTrack,f=this._id3Track,d=this._txtTrack;let m=o.pid,g=o.pesData,p=c.pid,T=f.pid,y=c.pesData,S=f.pesData,A=null,R=this.pmtParsed,C=this._pmtId,I=e.length;if(this.remainderData&&(e=_i(this.remainderData,e),I=e.length,this.remainderData=null),I<rs&&!n)return this.remainderData=e,{audioTrack:c,videoTrack:o,id3Track:f,textTrack:d};const D=Math.max(0,Sr.syncOffset(e));I-=(I-D)%rs,I<e.byteLength&&!n&&(this.remainderData=new Uint8Array(e.buffer,I,e.buffer.byteLength-I));let k=0;for(let P=D;P<I;P+=rs)if(e[P]===71){const V=!!(e[P+1]&64),$=Vg(e,P),j=(e[P+3]&48)>>4;let te;if(j>1){if(te=P+5+e[P+4],te===P+rs)continue}else te=P+4;switch($){case m:V&&(g&&(a=Eu(g,this.logger))&&(this.readyVideoParser(o.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(o,d,a,!1)),g={data:[],size:0}),g&&(g.data.push(e.subarray(te,P+rs)),g.size+=P+rs-te);break;case p:if(V){if(y&&(a=Eu(y,this.logger)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,a);break;case"mp3":this.parseMPEGPES(c,a);break;case"ac3":this.parseAC3PES(c,a);break}y={data:[],size:0}}y&&(y.data.push(e.subarray(te,P+rs)),y.size+=P+rs-te);break;case T:V&&(S&&(a=Eu(S,this.logger))&&this.parseID3PES(f,a),S={data:[],size:0}),S&&(S.data.push(e.subarray(te,P+rs)),S.size+=P+rs-te);break;case 0:V&&(te+=e[te]+1),C=this._pmtId=dU(e,te);break;case C:{V&&(te+=e[te]+1);const ge=fU(e,te,this.typeSupported,i,this.observer,this.logger);m=ge.videoPid,m>0&&(o.pid=m,o.segmentCodec=ge.segmentVideoCodec),p=ge.audioPid,p>0&&(c.pid=p,c.segmentCodec=ge.segmentAudioCodec),T=ge.id3Pid,T>0&&(f.pid=T),A!==null&&!R&&(this.logger.warn(`MPEG-TS PMT found at ${P} after unknown PID '${A}'. Backtracking to sync byte @${D} to parse all TS packets.`),A=null,P=D-188),R=this.pmtParsed=!0;break}case 17:case 8191:break;default:A=$;break}}else k++;k>0&&zg(this.observer,new Error(`Found ${k} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=g,c.pesData=y,f.pesData=S;const z={audioTrack:c,videoTrack:o,id3Track:f,textTrack:d};return n&&this.extractRemainingSamples(z),z}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:n,textTrack:a}=e,o=i.pesData,c=t.pesData,f=n.pesData;let d;if(o&&(d=Eu(o,this.logger))?(this.readyVideoParser(i.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(i,a,d,!0),i.pesData=null)):i.pesData=o,c&&(d=Eu(c,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else c!=null&&c.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;f&&(d=Eu(f,this.logger))?(this.parseID3PES(n,d),n.pesData=null):n.pesData=f}demuxSampleAes(e,t,i){const n=this.demux(e,i,!0,!this.config.progressive),a=this.sampleAes=new oU(this.observer,this.config,t);return this.decrypt(n,a)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new lU:e==="hevc"&&(this.videoParser=new cU))}decrypt(e,t){return new Promise(i=>{const{audioTrack:n,videoTrack:a}=e;n.samples&&n.segmentCodec==="aac"?t.decryptAacSamples(n.samples,0,()=>{a.samples?t.decryptAvcSamples(a.samples,0,0,()=>{i(e)}):i(e)}):a.samples&&t.decryptAvcSamples(a.samples,0,0,()=>{i(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let i=0;const n=this.aacOverFlow;let a=t.data;if(n){this.aacOverFlow=null;const g=n.missing,p=n.sample.unit.byteLength;if(g===-1)a=_i(n.sample.unit,a);else{const T=p-g;n.sample.unit.set(a.subarray(0,g),T),e.samples.push(n.sample),i=n.missing}}let o,c;for(o=i,c=a.length;o<c-1&&!Cf(a,o);o++);if(o!==i){let g;const p=o<c-1;if(p?g=`AAC PES did not start with ADTS header,offset:${o}`:g="No ADTS header found in AAC PES",zg(this.observer,new Error(g),p,this.logger),!p)return}p3(e,this.observer,a,o,this.audioCodec);let f;if(t.pts!==void 0)f=t.pts;else if(n){const g=b3(e.samplerate);f=n.sample.pts+g}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,m;for(;o<c;)if(m=E3(e,a,o,f,d),o+=m.length,m.missing){this.aacOverFlow=m;break}else for(d++;o<c-1&&!Cf(a,o);o++);}parseMPEGPES(e,t){const i=t.data,n=i.length;let a=0,o=0;const c=t.pts;if(c===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<n;)if(S3(i,o)){const f=T3(e,i,o,c,a);if(f)o+=f.length,a++;else break}else o++}parseAC3PES(e,t){{const i=t.data,n=t.pts;if(n===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const a=i.length;let o=0,c=0,f;for(;c<a&&(f=L3(e,i,c,n,o++))>0;)c+=f}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=bt({},t,{type:this._videoTrack?li.emsg:li.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function Vg(s,e){return((s[e+1]&31)<<8)+s[e+2]}function dU(s,e){return(s[e+10]&31)<<8|s[e+11]}function fU(s,e,t,i,n,a){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},c=(s[e+1]&15)<<8|s[e+2],f=e+3+c-4,d=(s[e+10]&15)<<8|s[e+11];for(e+=12+d;e<f;){const m=Vg(s,e),g=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!i){Km("ADTS AAC",a);break}case 15:o.audioPid===-1&&(o.audioPid=m);break;case 21:o.id3Pid===-1&&(o.id3Pid=m);break;case 219:if(!i){Km("H.264",a);break}case 27:o.videoPid===-1&&(o.videoPid=m);break;case 3:case 4:!t.mpeg&&!t.mp3?a.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=m,o.segmentAudioCodec="mp3");break;case 193:if(!i){Km("AC-3",a);break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=m,o.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&g>0){let p=e+5,T=g;for(;T>2;){switch(s[p]){case 106:t.ac3!==!0?a.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=m,o.segmentAudioCodec="ac3");break}const S=s[p+1]+2;p+=S,T-=S}}break;case 194:case 135:return zg(n,new Error("Unsupported EC-3 in M2TS found"),void 0,a),o;case 36:o.videoPid===-1&&(o.videoPid=m,o.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"));break}e+=g+5}return o}function zg(s,e,t,i){i.warn(`parsing error: ${e.message}`),s.emit(L.ERROR,L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Km(s,e){e.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function Eu(s,e){let t=0,i,n,a,o,c;const f=s.data;if(!s||s.size===0)return null;for(;f[0].length<19&&f.length>1;)f[0]=_i(f[0],f[1]),f.splice(1,1);if(i=f[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(n=(i[4]<<8)+i[5],n&&n>s.size-6)return null;const m=i[7];m&192&&(o=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,m&64?(c=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,o-c>60*9e4&&(e.warn(`${Math.round((o-c)/9e4)}s delta between PTS and DTS, align them`),o=c)):c=o),a=i[8];let g=a+9;if(s.size<=g)return null;s.size-=g;const p=new Uint8Array(s.size);for(let T=0,y=f.length;T<y;T++){i=f[T];let S=i.byteLength;if(g)if(g>S){g-=S;continue}else i=i.subarray(g),S-=g,g=0;p.set(i,t),t+=S}return n&&(n-=a+3),{data:p,pts:o,dts:c,len:n}}return null}class hU{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const pr=Math.pow(2,32)-1;class K{static init(){K.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in K.types)K.types.hasOwnProperty(e)&&(K.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);K.HDLR_TYPES={video:t,audio:i};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);K.STTS=K.STSC=K.STCO=a,K.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),K.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),K.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),K.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),f=new Uint8Array([0,0,0,1]);K.FTYP=K.box(K.types.ftyp,o,f,o,c),K.DINF=K.box(K.types.dinf,K.box(K.types.dref,n))}static box(e,...t){let i=8,n=t.length;const a=n;for(;n--;)i+=t[n].byteLength;const o=new Uint8Array(i);for(o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=i&255,o.set(e,4),n=0,i=8;n<a;n++)o.set(t[n],i),i+=t[n].byteLength;return o}static hdlr(e){return K.box(K.types.hdlr,K.HDLR_TYPES[e])}static mdat(e){return K.box(K.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(pr+1)),n=Math.floor(t%(pr+1));return K.box(K.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))}static mdia(e){return K.box(K.types.mdia,K.mdhd(e.timescale||0,e.duration||0),K.hdlr(e.type),K.minf(e))}static mfhd(e){return K.box(K.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?K.box(K.types.minf,K.box(K.types.smhd,K.SMHD),K.DINF,K.stbl(e)):K.box(K.types.minf,K.box(K.types.vmhd,K.VMHD),K.DINF,K.stbl(e))}static moof(e,t,i){return K.box(K.types.moof,K.mfhd(e),K.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=K.trak(e[t]);return K.box.apply(null,[K.types.moov,K.mvhd(e[0].timescale||0,e[0].duration||0)].concat(i).concat(K.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=K.trex(e[t]);return K.box.apply(null,[K.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(pr+1)),n=Math.floor(t%(pr+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return K.box(K.types.mvhd,a)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let n,a;for(n=0;n<t.length;n++)a=t[n].flags,i[n+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return K.box(K.types.sdtp,i)}static stbl(e){return K.box(K.types.stbl,K.stsd(e),K.box(K.types.stts,K.STTS),K.box(K.types.stsc,K.STSC),K.box(K.types.stsz,K.STSZ),K.box(K.types.stco,K.STCO))}static avc1(e){let t=[],i=[],n,a,o;for(n=0;n<e.sps.length;n++)a=e.sps[n],o=a.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(a));for(n=0;n<e.pps.length;n++)a=e.pps[n],o=a.byteLength,i.push(o>>>8&255),i.push(o&255),i=i.concat(Array.prototype.slice.call(a));const c=K.box(K.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(i))),f=e.width,d=e.height,m=e.pixelRatio[0],g=e.pixelRatio[1];return K.box(K.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,K.box(K.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),K.box(K.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,g>>24,g>>16&255,g>>8&255,g&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return K.box(K.types.mp4a,K.audioStsd(e),K.box(K.types.esds,K.esds(e)))}static mp3(e){return K.box(K.types[".mp3"],K.audioStsd(e))}static ac3(e){return K.box(K.types["ac-3"],K.audioStsd(e),K.box(K.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return K.box(K.types.stsd,K.STSD,K.mp4a(e));if(t==="ac3"&&e.config)return K.box(K.types.stsd,K.STSD,K.ac3(e));if(t==="mp3"&&e.codec==="mp3")return K.box(K.types.stsd,K.STSD,K.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return K.box(K.types.stsd,K.STSD,K.avc1(e));if(t==="hevc"&&e.vps)return K.box(K.types.stsd,K.STSD,K.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,i=(e.duration||0)*(e.timescale||0),n=e.width||0,a=e.height||0,o=Math.floor(i/(pr+1)),c=Math.floor(i%(pr+1));return K.box(K.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,a>>8&255,a&255,0,0]))}static traf(e,t){const i=K.sdtp(e),n=e.id,a=Math.floor(t/(pr+1)),o=Math.floor(t%(pr+1));return K.box(K.types.traf,K.box(K.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),K.box(K.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255])),K.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,K.box(K.types.trak,K.tkhd(e),K.mdia(e))}static trex(e){const t=e.id;return K.box(K.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],n=i.length,a=12+16*n,o=new Uint8Array(a);let c,f,d,m,g,p;for(t+=8+a,o.set([e.type==="video"?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),c=0;c<n;c++)f=i[c],d=f.duration,m=f.size,g=f.flags,p=f.cts,o.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,g.isLeading<<2|g.dependsOn,g.isDependedOn<<6|g.hasRedundancy<<4|g.paddingValue<<1|g.isNonSync,g.degradPrio&61440,g.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*c);return K.box(K.types.trun,o)}static initSegment(e){K.types||K.init();const t=K.moov(e);return _i(K.FTYP,t)}static hvc1(e){const t=e.params,i=[e.vps,e.sps,e.pps],n=4,a=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),n-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),i.length]);let o=a.length;for(let y=0;y<i.length;y+=1){o+=3;for(let S=0;S<i[y].length;S+=1)o+=2+i[y][S].length}const c=new Uint8Array(o);c.set(a,0),o=a.length;const f=i.length-1;for(let y=0;y<i.length;y+=1){c.set(new Uint8Array([32+y|(y===f?128:0),0,i[y].length]),o),o+=3;for(let S=0;S<i[y].length;S+=1)c.set(new Uint8Array([i[y][S].length>>8,i[y][S].length&255]),o),o+=2,c.set(i[y][S],o),o+=i[y][S].length}const d=K.box(K.types.hvcC,c),m=e.width,g=e.height,p=e.pixelRatio[0],T=e.pixelRatio[1];return K.box(K.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,m&255,g>>8&255,g&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,K.box(K.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),K.box(K.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,T>>24,T>>16&255,T>>8&255,T&255])))}}K.types=void 0;K.HDLR_TYPES=void 0;K.STTS=void 0;K.STSC=void 0;K.STCO=void 0;K.STSZ=void 0;K.VMHD=void 0;K.SMHD=void 0;K.STSD=void 0;K.FTYP=void 0;K.DINF=void 0;const I3=9e4;function r1(s,e,t=1,i=!1){const n=s*e*t;return i?Math.round(n):n}function mU(s,e,t=1,i=!1){return r1(s,e,1/t,i)}function el(s,e=!1){return r1(s,1e3,1/I3,e)}function gU(s,e=1){return r1(s,I3,1/e)}function L2(s){const{baseTime:e,timescale:t,trackId:i}=s;return`${e/t} (${e}/${t}) trackId: ${i}`}const pU=10*1e3,bU=1024,EU=1152,yU=1536;let yu=null,Qm=null;function R2(s,e,t,i){return{duration:e,size:t,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:s?2:1,isNonSync:s?0:1}}}class Qd extends Li{constructor(e,t,i,n){if(super("mp4-remuxer",n),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,yu===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);yu=o?parseInt(o[1]):0}if(Qm===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);Qm=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&L2(t)} > ${e&&L2(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const i=e[0].pts,n=e.reduce((a,o)=>{let c=o.pts,f=c-a;return f<-4294967296&&(t=!0,c=ui(c,i),f=c-a),f>0?a:c},i);return t&&this.debug("PTS rollover detected"),n}remux(e,t,i,n,a,o,c,f){let d,m,g,p,T,y,S=a,A=a;const R=e.pid>-1,C=t.pid>-1,I=t.samples.length,D=e.samples.length>0,k=c&&I>0||I>1;if((!R||D)&&(!C||k)||this.ISGenerated||c){if(this.ISGenerated){var P,V,$,j;const ve=this.videoTrackConfig;(ve&&(t.width!==ve.width||t.height!==ve.height||((P=t.pixelRatio)==null?void 0:P[0])!==((V=ve.pixelRatio)==null?void 0:V[0])||(($=t.pixelRatio)==null?void 0:$[1])!==((j=ve.pixelRatio)==null?void 0:j[1]))||!ve&&k||this.nextAudioTs===null&&D)&&this.resetInitSegment()}this.ISGenerated||(g=this.generateIS(e,t,a,o));const te=this.isVideoContiguous;let ge=-1,ye;if(k&&(ge=xU(t.samples),!te&&this.config.forceKeyFrameOnDiscontinuity))if(y=!0,ge>0){this.warn(`Dropped ${ge} out of ${I} video samples due to a missing keyframe`);const ve=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(ge),t.dropped+=ge,A+=(t.samples[0].pts-ve)/t.inputTimeScale,ye=A}else ge===-1&&(this.warn(`No keyframe found out of ${I} video samples`),y=!1);if(this.ISGenerated){if(D&&k){const ve=this.getVideoStartPts(t.samples),F=(ui(e.samples[0].pts,ve)-ve)/t.inputTimeScale;S+=Math.max(0,F),A+=Math.max(0,-F)}if(D){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),g=this.generateIS(e,t,a,o)),m=this.remuxAudio(e,S,this.isAudioContiguous,o,C||k||f===_e.AUDIO?A:void 0),k){const ve=m?m.endPTS-m.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),g=this.generateIS(e,t,a,o)),d=this.remuxVideo(t,A,te,ve)}}else k&&(d=this.remuxVideo(t,A,te,0));d&&(d.firstKeyFrame=ge,d.independent=ge!==-1,d.firstKeyFramePTS=ye)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(T=C3(i,a,this._initPTS,this._initDTS)),n.samples.length&&(p=N3(n,a,this._initPTS))),{audio:m,video:d,initSegment:g,independent:y,text:p,id3:T}}computeInitPts(e,t,i,n){const a=Math.round(i*t);let o=ui(e,a);if(o<a+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(a-o)/t} ${n}`);o<a+t;)o+=8589934592;return o-a}generateIS(e,t,i,n){const a=e.samples,o=t.samples,c=this.typeSupported,f={},d=this._initPTS;let m=!d||n,g="audio/mp4",p,T,y,S=-1;if(m&&(p=T=1/0),e.config&&a.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":c.mpeg?(g="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}f.audio={id:"audio",container:g,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&c.mpeg?new Uint8Array(0):K.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(S=e.id,y=e.inputTimeScale,!d||y!==d.timescale?p=T=this.computeInitPts(a[0].pts,y,i,"audio"):m=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,f.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:K.initSegment([t]),metadata:{width:t.width,height:t.height}},m)if(S=t.id,y=t.inputTimeScale,!d||y!==d.timescale){const A=this.getVideoStartPts(o),R=ui(o[0].dts,A),C=this.computeInitPts(R,y,i,"video"),I=this.computeInitPts(A,y,i,"video");T=Math.min(T,C),p=Math.min(p,I)}else m=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(f).length)return this.ISGenerated=!0,m?(d&&this.warn(`Timestamps at playlist time: ${n?"":"~"}${i} ${p/y} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${p/y} (${p}/${y}) trackId: ${S}`),this._initPTS={baseTime:p,timescale:y,trackId:S},this._initDTS={baseTime:T,timescale:y,trackId:S}):p=y=void 0,{tracks:f,initPTS:p,timescale:y,trackId:S}}remuxVideo(e,t,i,n){const a=e.inputTimeScale,o=e.samples,c=[],f=o.length,d=this._initPTS,m=d.baseTime*a/d.timescale;let g=this.nextVideoTs,p=8,T=this.videoSampleDuration,y,S,A=Number.POSITIVE_INFINITY,R=Number.NEGATIVE_INFINITY,C=!1;if(!i||g===null){const O=m+t*a,G=o[0].pts-ui(o[0].dts,o[0].pts);yu&&g!==null&&Math.abs(O-G-(g+m))<15e3?i=!0:g=O-G-m}const I=g+m;for(let O=0;O<f;O++){const G=o[O];G.pts=ui(G.pts,I),G.dts=ui(G.dts,I),G.dts<o[O>0?O-1:O].dts&&(C=!0)}C&&o.sort(function(O,G){const de=O.dts-G.dts,pe=O.pts-G.pts;return de||pe}),y=o[0].dts,S=o[o.length-1].dts;const D=S-y,k=D?Math.round(D/(f-1)):T||e.inputTimeScale/30;if(i){const O=y-I,G=O>k,de=O<-1;if((G||de)&&(G?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${el(O,!0)} ms (${O}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${el(-O,!0)} ms (${O}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!de||I>=o[0].pts||yu)){y=I;const pe=o[0].pts-O;if(G)o[0].dts=y,o[0].pts=pe;else{let Te=!0;for(let Ae=0;Ae<o.length&&!(o[Ae].dts>pe&&Te);Ae++){const ke=o[Ae].pts;if(o[Ae].dts-=O,o[Ae].pts-=O,Ae<o.length-1){const st=o[Ae+1].pts,Je=o[Ae].pts,xs=st<=Je,di=st<=ke;Te=xs==di}}}this.log(`Video: Initial PTS/DTS adjusted: ${el(pe,!0)}/${el(y,!0)}, delta: ${el(O,!0)} ms`)}}y=Math.max(0,y);let z=0,P=0,V=y;for(let O=0;O<f;O++){const G=o[O],de=G.units,pe=de.length;let Te=0;for(let Ae=0;Ae<pe;Ae++)Te+=de[Ae].data.length;P+=Te,z+=pe,G.length=Te,G.dts<V?(G.dts=V,V+=k/4|0||1):V=G.dts,A=Math.min(G.pts,A),R=Math.max(G.pts,R)}S=o[f-1].dts;const $=P+4*z+8;let j;try{j=new Uint8Array($)}catch(O){this.observer.emit(L.ERROR,L.ERROR,{type:Ie.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:O,bytes:$,reason:`fail allocating video mdat ${$}`});return}const te=new DataView(j.buffer);te.setUint32(0,$),j.set(K.types.mdat,4);let ge=!1,ye=Number.POSITIVE_INFINITY,ve=Number.POSITIVE_INFINITY,ue=Number.NEGATIVE_INFINITY,F=Number.NEGATIVE_INFINITY;for(let O=0;O<f;O++){const G=o[O],de=G.units;let pe=0;for(let ke=0,st=de.length;ke<st;ke++){const Je=de[ke],xs=Je.data,di=Je.data.byteLength;te.setUint32(p,di),p+=4,j.set(xs,p),p+=di,pe+=4+di}let Te;if(O<f-1)T=o[O+1].dts-G.dts,Te=o[O+1].pts-G.pts;else{const ke=this.config,st=O>0?G.dts-o[O-1].dts:k;if(Te=O>0?G.pts-o[O-1].pts:k,ke.stretchShortVideoTrack&&this.nextAudioTs!==null){const Je=Math.floor(ke.maxBufferHole*a),xs=(n?A+n*a:this.nextAudioTs+m)-G.pts;xs>Je?(T=xs-st,T<0?T=st:ge=!0,this.log(`It is approximately ${xs/90} ms to the next segment; using duration ${T/90} ms for the last video frame.`)):T=st}else T=st}const Ae=Math.round(G.pts-G.dts);ye=Math.min(ye,T),ue=Math.max(ue,T),ve=Math.min(ve,Te),F=Math.max(F,Te),c.push(R2(G.key,T,pe,Ae))}if(c.length){if(yu){if(yu<70){const O=c[0].flags;O.dependsOn=2,O.isNonSync=0}}else if(Qm&&F-ve<ue-ye&&k/ue<.025&&c[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let O=y;for(let G=0,de=c.length;G<de;G++){const pe=O+c[G].duration,Te=O+c[G].cts;if(G<de-1){const Ae=pe+c[G+1].cts;c[G].duration=Ae-Te}else c[G].duration=G?c[G-1].duration:k;c[G].cts=0,O=pe}}}T=ge||!T?k:T;const J=S+T;this.nextVideoTs=g=J-m,this.videoSampleDuration=T,this.isVideoContiguous=!0;const xe={data1:K.moof(e.sequenceNumber++,y,bt(e,{samples:c})),data2:j,startPTS:(A-m)/a,endPTS:(R+T-m)/a,startDTS:(y-m)/a,endDTS:g/a,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,xe}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return EU;case"ac3":return yU;default:return bU}}remuxAudio(e,t,i,n,a){const o=e.inputTimeScale,c=e.samplerate?e.samplerate:o,f=o/c,d=this.getSamplesPerFrame(e),m=d*f,g=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,T=[],y=a!==void 0;let S=e.samples,A=p?0:8,R=this.nextAudioTs||-1;const C=g.baseTime*o/g.timescale,I=C+t*o;if(this.isAudioContiguous=i=i||S.length&&R>0&&(n&&Math.abs(I-(R+C))<9e3||Math.abs(ui(S[0].pts,I)-(R+C))<20*m),S.forEach(function(F){F.pts=ui(F.pts,I)}),!i||R<0){const F=S.length;if(S=S.filter(J=>J.pts>=0),F!==S.length&&this.warn(`Removed ${S.length-F} of ${F} samples (initPTS ${C} / ${o})`),!S.length)return;a===0?R=0:n&&!y?R=Math.max(0,I-C):R=S[0].pts-C}if(e.segmentCodec==="aac"){const F=this.config.maxAudioFramesDrift;for(let J=0,se=R+C;J<S.length;J++){const ne=S[J],xe=ne.pts,O=xe-se,G=Math.abs(1e3*O/o);if(O<=-F*m&&y)J===0&&(this.warn(`Audio frame @ ${(xe/o).toFixed(3)}s overlaps marker by ${Math.round(1e3*O/o)} ms.`),this.nextAudioTs=R=xe-C,se=xe);else if(O>=F*m&&G<pU&&y){let de=Math.round(O/m);for(se=xe-de*m;se<0&&de&&m;)de--,se+=m;J===0&&(this.nextAudioTs=R=se-C),this.warn(`Injecting ${de} audio frames @ ${((se-C)/o).toFixed(3)}s due to ${Math.round(1e3*O/o)} ms gap.`);for(let pe=0;pe<de;pe++){let Te=hU.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Te||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),Te=ne.unit.subarray()),S.splice(J,0,{unit:Te,pts:se}),se+=m,J++}}ne.pts=se,se+=m}}let D=null,k=null,z,P=0,V=S.length;for(;V--;)P+=S[V].unit.byteLength;for(let F=0,J=S.length;F<J;F++){const se=S[F],ne=se.unit;let xe=se.pts;if(k!==null){const G=T[F-1];G.duration=Math.round((xe-k)/f)}else if(i&&e.segmentCodec==="aac"&&(xe=R+C),D=xe,P>0){P+=A;try{z=new Uint8Array(P)}catch(G){this.observer.emit(L.ERROR,L.ERROR,{type:Ie.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:G,bytes:P,reason:`fail allocating audio mdat ${P}`});return}p||(new DataView(z.buffer).setUint32(0,P),z.set(K.types.mdat,4))}else return;z.set(ne,A);const O=ne.byteLength;A+=O,T.push(R2(!0,d,O,0)),k=xe}const $=T.length;if(!$)return;const j=T[T.length-1];R=k-C,this.nextAudioTs=R+f*j.duration;const te=p?new Uint8Array(0):K.moof(e.sequenceNumber++,D/f,bt({},e,{samples:T}));e.samples=[];const ge=(D-C)/o,ye=this.nextAudioTs/o,ue={data1:te,data2:z,startPTS:ge,endPTS:ye,startDTS:ge,endDTS:ye,type:"audio",hasAudio:!0,hasVideo:!1,nb:$};return this.isAudioContiguous=!0,ue}}function ui(s,e){let t;if(e===null)return s;for(e<s?t=-8589934592:t=8589934592;Math.abs(s-e)>4294967296;)s+=t;return s}function xU(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function C3(s,e,t,i){const n=s.samples.length;if(!n)return;const a=s.inputTimeScale;for(let c=0;c<n;c++){const f=s.samples[c];f.pts=ui(f.pts-t.baseTime*a/t.timescale,e*a)/a,f.dts=ui(f.dts-i.baseTime*a/i.timescale,e*a)/a}const o=s.samples;return s.samples=[],{samples:o}}function N3(s,e,t){const i=s.samples.length;if(!i)return;const n=s.inputTimeScale;for(let o=0;o<i;o++){const c=s.samples[o];c.pts=ui(c.pts-t.baseTime*n/t.timescale,e*n)/n}s.samples.sort((o,c)=>o.pts-c.pts);const a=s.samples;return s.samples=[],{samples:a}}class TU extends Li{constructor(e,t,i,n){super("passthrough-remuxer",n),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,i,n){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(e,n),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:i,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:a,video:o}=this.initData=PA(e);if(t)oP(e,t);else{const f=a||o;f!=null&&f.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${f.codec}")!`)}a&&(i=I2(a,yt.AUDIO,this)),o&&(n=I2(o,yt.VIDEO,this));const c={};a&&o?c.audiovideo={container:"video/mp4",codec:i+","+n,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:a?c.audio={container:"audio/mp4",codec:i,encrypted:a.encrypted,initSegment:e,id:"audio"}:o?c.video={container:"video/mp4",codec:n,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=c}remux(e,t,i,n,a,o){var c,f;let{initPTS:d,lastEndTime:m}=this;const g={audio:void 0,video:void 0,text:n,id3:i,initSegment:void 0};Se(m)||(m=this.lastEndTime=a||0);const p=t.samples;if(!p.length)return g;const T={initPTS:void 0,timescale:void 0,trackId:void 0};let y=this.initData;if((c=y)!=null&&c.length||(this.generateInitSegment(p),y=this.initData),!((f=y)!=null&&f.length))return this.warn("Failed to generate initSegment."),g;this.emitInitSegment&&(T.tracks=this.initTracks,this.emitInitSegment=!1);const S=cP(p,y,this),A=y.audio?S[y.audio.id]:null,R=y.video?S[y.video.id]:null,C=Cd(R,1/0),I=Cd(A,1/0),D=Cd(R,0,!0),k=Cd(A,0,!0);let z=a,P=0;const V=A&&(!R||!d&&I<C||d&&d.trackId===y.audio.id),$=V?A:R;if($){const se=$.timescale,ne=$.start-a*se,xe=V?y.audio.id:y.video.id;z=$.start/se,P=V?k-I:D-C,(o||!d)&&(vU(d,z,a,P)||se!==d.timescale)&&(d&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${a} ${ne/se} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${a} offset: ${z-a} (${ne}/${se}) trackId: ${xe}`),d=null,T.initPTS=ne,T.timescale=se,T.trackId=xe)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${a}`);d?(T.initPTS=d.baseTime,T.timescale=d.timescale,T.trackId=d.trackId):((!T.timescale||T.trackId===void 0||T.initPTS===void 0)&&(this.warn("Could not set initPTS"),T.initPTS=z,T.timescale=1,T.trackId=-1),this.initPTS=d={baseTime:T.initPTS,timescale:T.timescale,trackId:T.trackId});const j=z-d.baseTime/d.timescale,te=j+P;P>0?this.lastEndTime=te:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const ge=!!y.audio,ye=!!y.video;let ve="";ge&&(ve+="audio"),ye&&(ve+="video");const ue=(y.audio?y.audio.encrypted:!1)||(y.video?y.video.encrypted:!1),F={data1:p,startPTS:j,startDTS:j,endPTS:te,endDTS:te,type:ve,hasAudio:ge,hasVideo:ye,nb:1,dropped:0,encrypted:ue};g.audio=ge&&!ye?F:void 0,g.video=ye?F:void 0;const J=R==null?void 0:R.sampleCount;if(J){const se=R.keyFrameIndex,ne=se!==-1;F.nb=J,F.dropped=se===0||this.isVideoContiguous?0:ne?se:J,F.independent=ne,F.firstKeyFrame=se,ne&&R.keyFrameStart&&(F.firstKeyFramePTS=(R.keyFrameStart-d.baseTime)/d.timescale),this.isVideoContiguous||(g.independent=ne),this.isVideoContiguous||(this.isVideoContiguous=ne),F.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${se}/${J} dropped: ${F.dropped} start: ${F.firstKeyFramePTS||"NA"}`)}return g.initSegment=T,g.id3=C3(i,a,d,d),n.samples.length&&(g.text=N3(n,a,d)),g}}function Cd(s,e,t=!1){return(s==null?void 0:s.start)!==void 0?(s.start+(t?s.duration:0))/s.timescale:e}function vU(s,e,t,i){if(s===null)return!0;const n=Math.max(i,1),a=e-s.baseTime/s.timescale;return Math.abs(a-t)>n}function I2(s,e,t){const i=s.codec;return i&&i.length>4?i:e===yt.AUDIO?i==="ec-3"||i==="ac-3"||i==="alac"?i:i==="fLaC"||i==="Opus"?Tf(i,!1):(t.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(t.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}let Pn;try{Pn=self.performance.now.bind(self.performance)}catch{Pn=Date.now}const Xd=[{demux:uU,remux:TU},{demux:Sr,remux:Qd},{demux:iU,remux:Qd},{demux:rU,remux:Qd}];Xd.splice(2,0,{demux:nU,remux:Qd});class C2{constructor(e,t,i,n,a,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.id=a,this.logger=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,n){const a=i.transmuxing;a.executeStart=Pn();let o=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:f}=this;n&&(this.currentTransmuxState=n);const{contiguous:d,discontinuity:m,trackSwitch:g,accurateTimeOffset:p,timeOffset:T,initSegmentChange:y}=n||c,{audioCodec:S,videoCodec:A,defaultInitPts:R,duration:C,initSegmentData:I}=f,D=SU(o,t);if(D&&Lu(D.method)){const V=this.getDecrypter(),$=Xp(D.method);if(V.isSync()){let j=V.softwareDecrypt(o,D.key.buffer,D.iv.buffer,$);if(i.part>-1){const ge=V.flush();j=ge&&ge.buffer}if(!j)return a.executeEnd=Pn(),Xm(i);o=new Uint8Array(j)}else return this.asyncResult=!0,this.decryptionPromise=V.webCryptoDecrypt(o,D.key.buffer,D.iv.buffer,$).then(j=>{const te=this.push(j,null,i);return this.decryptionPromise=null,te}),this.decryptionPromise}const k=this.needsProbing(m,g);if(k){const V=this.configureTransmuxer(o);if(V)return this.logger.warn(`[transmuxer] ${V.message}`),this.observer.emit(L.ERROR,L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:V,reason:V.message}),a.executeEnd=Pn(),Xm(i)}(m||g||y||k)&&this.resetInitSegment(I,S,A,C,t),(m||y||k)&&this.resetInitialTimestamp(R),d||this.resetContiguity();const z=this.transmux(o,D,T,p,i);this.asyncResult=Nl(z);const P=this.currentTransmuxState;return P.contiguous=!0,P.discontinuity=!1,P.trackSwitch=!1,a.executeEnd=Pn(),z}flush(e){const t=e.transmuxing;t.executeStart=Pn();const{decrypter:i,currentTransmuxState:n,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(e));const o=[],{timeOffset:c}=n;if(i){const g=i.flush();g&&o.push(this.push(g.buffer,null,e))}const{demuxer:f,remuxer:d}=this;if(!f||!d){t.executeEnd=Pn();const g=[Xm(e)];return this.asyncResult?Promise.resolve(g):g}const m=f.flush(c);return Nl(m)?(this.asyncResult=!0,m.then(g=>(this.flushRemux(o,g,e),o))):(this.flushRemux(o,m,e),this.asyncResult?Promise.resolve(o):o)}flushRemux(e,t,i){const{audioTrack:n,videoTrack:a,id3Track:o,textTrack:c}=t,{accurateTimeOffset:f,timeOffset:d}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===_e.MAIN?"level":"track"} ${i.level}`);const m=this.remuxer.remux(n,a,o,c,d,f,!0,this.id);e.push({remuxResult:m,chunkMeta:i}),i.transmuxing.executeEnd=Pn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,n,a){const{demuxer:o,remuxer:c}=this;!o||!c||(o.resetInitSegment(e,t,i,n),c.resetInitSegment(e,t,i,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,n,a){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,i,n,a):o=this.transmuxUnencrypted(e,i,n,a),o}transmuxUnencrypted(e,t,i,n){const{audioTrack:a,videoTrack:o,id3Track:c,textTrack:f}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,o,c,f,t,i,!1,this.id),chunkMeta:n}}transmuxSampleAes(e,t,i,n,a){return this.demuxer.demuxSampleAes(e,t,i).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,i,n,!1,this.id),chunkMeta:a}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:n}=this;let a;for(let g=0,p=Xd.length;g<p;g++){var o;if((o=Xd[g].demux)!=null&&o.probe(e,this.logger)){a=Xd[g];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const c=this.demuxer,f=this.remuxer,d=a.remux,m=a.demux;(!f||!(f instanceof d))&&(this.remuxer=new d(i,t,n,this.logger)),(!c||!(c instanceof m))&&(this.demuxer=new m(i,t,n,this.logger),this.probe=m.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Kp(this.config)),e}}function SU(s,e){let t=null;return s.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Xm=s=>({remuxResult:{},chunkMeta:s});function Nl(s){return"then"in s&&s.then instanceof Function}class AU{constructor(e,t,i,n,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=n,this.defaultInitPts=a||null}}class _U{constructor(e,t,i,n,a,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=n,this.timeOffset=a,this.initSegmentChange=o}}let N2=0;class D3{constructor(e,t,i,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=N2++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=f=>{const d=f.data,m=this.hls;if(!(!m||!(d!=null&&d.event)||d.instanceNo!==this.instanceNo))switch(d.event){case"init":{var g;const p=(g=this.workerContext)==null?void 0:g.objectURL;p&&self.URL.revokeObjectURL(p);break}case"transmuxComplete":{this.handleTransmuxComplete(d.data);break}case"flush":{this.onFlush(d.data);break}case"workerLog":{m.logger[d.data.logType]&&m.logger[d.data.logType](d.data.message);break}default:{d.data=d.data||{},d.data.frag=this.frag,d.data.part=this.part,d.data.id=this.id,m.trigger(d.event,d.data);break}}},this.onWorkerError=f=>{if(!this.hls)return;const d=new Error(`${f.message}  (${f.filename}:${f.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:d})};const a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=i,this.onFlush=n;const o=(f,d)=>{d=d||{},d.frag=this.frag||void 0,f===L.ERROR&&(d=d,d.parent=this.id,d.part=this.part,this.error=d.error),this.hls.trigger(f,d)};this.observer=new Jp,this.observer.on(L.FRAG_DECRYPTED,o),this.observer.on(L.ERROR,o);const c=VT(a.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const f=this.hls.logger;if(a.workerPath||C9()){try{a.workerPath?(f.log(`loading Web Worker ${a.workerPath} for "${t}"`),this.workerContext=D9(a.workerPath)):(f.log(`injecting Web Worker for "${t}"`),this.workerContext=N9());const{worker:m}=this.workerContext;m.addEventListener("message",this.onWorkerMessage),m.addEventListener("error",this.onWorkerError),m.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:c,id:t,config:Tt(a)})}catch(m){f.warn(`Error setting up "${t}" Web Worker, fallback to inline`,m),this.terminateWorker(),this.error=null,this.transmuxer=new C2(this.observer,c,a,"",t,e.logger)}return}}this.transmuxer=new C2(this.observer,c,a,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=N2++;const t=this.hls.config,i=VT(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:i,id:this.id,config:Tt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),w9(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,i,n,a,o,c,f,d,m){var g,p;d.transmuxing.start=self.performance.now();const{instanceNo:T,transmuxer:y}=this,S=o?o.start:a.start,A=a.decryptdata,R=this.frag,C=!(R&&a.cc===R.cc),I=!(R&&d.level===R.level),D=R?d.sn-R.sn:-1,k=this.part?d.part-this.part.index:-1,z=D===0&&d.id>1&&d.id===(R==null?void 0:R.stats.chunkCount),P=!I&&(D===1||D===0&&(k===1||z&&k<=0)),V=self.performance.now();(I||D||a.stats.parsing.start===0)&&(a.stats.parsing.start=V),o&&(k||!P)&&(o.stats.parsing.start=V);const $=!(R&&((g=a.initSegment)==null?void 0:g.url)===((p=R.initSegment)==null?void 0:p.url)),j=new _U(C,P,f,I,S,$);if(!P||C||$){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${d.sn}${d.part>-1?" part: "+d.part:""} ${this.id===_e.MAIN?"level":"track"}: ${d.level} id: ${d.id}
        discontinuity: ${C}
        trackSwitch: ${I}
        contiguous: ${P}
        accurateTimeOffset: ${f}
        timeOffset: ${S}
        initSegmentChange: ${$}`);const te=new AU(i,n,t,c,m);this.configureTransmuxer(te)}if(this.frag=a,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:T,cmd:"demux",data:e,decryptdata:A,chunkMeta:d,state:j},e instanceof ArrayBuffer?[e]:[]);else if(y){const te=y.push(e,A,d,j);Nl(te)?te.then(ge=>{this.handleTransmuxComplete(ge)}).catch(ge=>{this.transmuxerError(ge,d,"transmuxer-interface push error")}):this.handleTransmuxComplete(te)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(i){const n=i.flush(e);Nl(n)?n.then(a=>{this.handleFlushResult(a,e)}).catch(a=>{this.transmuxerError(a,e,"transmuxer-interface flush error")}):this.handleFlushResult(n,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):i&&i.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const D2=100;class LU extends Zp{constructor(e,t,i){super(e,t,i,"audio-stream-controller",_e.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(L.BUFFER_RESET,this.onBufferReset,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(L.BUFFER_RESET,this.onBufferReset,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:i,initPTS:n,timescale:a,trackId:o}){if(i===_e.MAIN){const c=t.cc,f=this.fragCurrent;if(this.initPTS[c]={baseTime:n,timescale:a,trackId:o},this.log(`InitPTS for cc: ${c} found from main: ${n/a} (${n}/${a}) trackId: ${o}`),this.mainAnchor=t,this.state===ce.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==c)&&this.syncWithAnchor(t,d==null?void 0:d.frag)}else!this.hls.hasEnoughToStart&&f&&f.cc!==c?(f.abortRequests(),this.syncWithAnchor(t,f)):this.state===ce.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var i;const n=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(t&&(n==null?void 0:n.cc)===t.cc)return;const a=(n||e).cc,o=this.getLevelDetails(),c=this.getLoadPosition(),f=YA(o,a,c);f&&(this.log(`Syncing with main frag at ${f.start} cc ${f.cc}`),this.startFragRequested=!1,this.nextLoadPosition=f.start,this.resetLoadingState(),this.state===ce.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=ce.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(D2),i>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i,this.state=ce.IDLE):this.state=ce.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case ce.IDLE:this.doTickIdle();break;case ce.WAITING_TRACK:{const{levels:e,trackId:t}=this,i=e==null?void 0:e[t],n=i==null?void 0:i.details;if(n&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(n))break;this.state=ce.WAITING_INIT_PTS}break}case ce.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case ce.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:i,cache:n,complete:a}=e,o=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=ce.FRAG_LOADING;const c=n.flush().buffer,f={frag:t,part:i,payload:c,networkDetails:null};this._handleFragmentLoadProgress(f),a&&super._handleFragmentLoadComplete(f)}else o&&o.cc!==e.frag.cc&&this.syncWithAnchor(o,e.frag)}else this.state=ce.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:i,media:n,trackId:a}=this,o=t.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(i!=null&&i[a]))return;const c=i[a],f=c.details;if(!f||this.waitForLive(c)||this.waitForCdnTuneIn(f)){this.state=ce.WAITING_TRACK,this.startFragRequested=!1;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,yt.AUDIO,_e.AUDIO));const m=this.getFwdBufferInfo(d,_e.AUDIO);if(m===null)return;if(!this.switchingTrack&&this._streamEnded(m,f)){t.trigger(L.BUFFER_EOS,{type:"audio"}),this.state=ce.ENDED;return}const g=m.len,p=t.maxBufferLength,T=f.fragments,y=T[0].start,S=this.getLoadPosition(),A=this.flushing?S:m.end;if(this.switchingTrack&&n){const I=S;f.PTSKnown&&I<y&&(m.end>y||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=y+.05)}if(g>=p&&!this.switchingTrack&&A<T[T.length-1].start)return;let R=this.getNextFragment(A,f);if(R&&this.isLoopLoading(R,A)&&(R=this.getNextFragmentLoopLoading(R,f,m,_e.MAIN,p)),!R){this.bufferFlushed=!0;return}let C=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&C&&Ut(R)&&!R.endList&&(!f.live||!this.loadingParts&&A<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(C)===Jt.OK&&(this.mainFragLoading=C=null),C&&Ut(C))){if(R.start>C.end){const D=this.fragmentTracker.getFragAtPos(A,_e.MAIN);D&&D.end>C.end&&(C=D,this.mainFragLoading={frag:D,targetBufferTime:null})}if(R.start>C.end)return}this.loadFragment(R,c,A)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(i=>new Rl(i))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),i?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==ce.STOPPED&&(this.setInterval(D2),this.state=ce.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(L.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(e,t){var i;const{levels:n}=this,{details:a,id:o,groupId:c,track:f}=t;if(!n){this.warn(`Audio tracks reset while loading track ${o} "${f.name}" of "${c}"`);return}const d=this.mainDetails;if(!d||a.endCC>d.endCC||d.expired){this.cachedTrackLoadedData=t,this.state!==ce.STOPPED&&(this.state=ce.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${f.name}" of "${c}" loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const m=n[o];let g=0;if(a.live||(i=m.details)!=null&&i.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;if(m.details){var p;g=this.alignPlaylists(a,m.details,(p=this.levelLastLoaded)==null?void 0:p.details)}a.alignedSliding||(d3(a,d),a.alignedSliding||If(a,d),g=a.fragmentStart)}m.details=a,this.levelLastLoaded=m,this.startFragRequested||this.setStartPosition(d,g),this.hls.trigger(L.AUDIO_TRACK_UPDATED,{details:a,id:o,groupId:t.groupId}),this.state===ce.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=ce.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:n,payload:a}=e,{config:o,trackId:c,levels:f}=this;if(!f){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const d=f[c];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const m=d.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const g=o.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new D3(this.hls,_e.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const T=this.initPTS[i.cc],y=(t=i.initSegment)==null?void 0:t.data;if(T!==void 0){const A=n?n.index:-1,R=A!==-1,C=new Qp(i.level,i.sn,i.stats.chunkCount,a.byteLength,A,R);p.push(a,y,g,"",i,n,m.totalduration,!1,C,T)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${m.startSN} ,${m.endSN}],track ${c}`);const{cache:S}=this.waitingData=this.waitingData||{frag:i,part:n,cache:new f3,complete:!1};S.push(new Uint8Array(a)),this.state!==ce.STOPPED&&(this.state=ce.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===_e.MAIN&&Ut(t.frag)&&(this.mainFragLoading=t,this.state===ce.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:i,part:n}=t;if(i.type!==_e.AUDIO){!this.audioOnly&&i.type===_e.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Ut(i)){this.fragPrevious=i;const a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(L.AUDIO_TRACK_SWITCHED,dt({},a)))}this.fragBufferedComplete(i,n),this.media&&this.tick()}onError(e,t){var i;if(t.fatal){this.state=ce.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_e.AUDIO,t);break;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ce.WAITING_TRACK&&((i=t.context)==null?void 0:i.type)===Ge.AUDIO_TRACK&&(this.state=ce.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==yt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==yt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ce.ENDED&&(this.state=ce.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,t,_e.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const i="audio",{hls:n}=this,{remuxResult:a,chunkMeta:o}=e,c=this.getCurrentContext(o);if(!c){this.resetWhenMissingContext(o);return}const{frag:f,part:d,level:m}=c,{details:g}=m,{audio:p,text:T,id3:y,initSegment:S}=a;if(this.fragContextChanged(f)||!g){this.fragmentTracker.removeFragment(f);return}if(this.state=ce.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),S!=null&&S.tracks){const A=f.initSegment||f;if(this.unhandledEncryptionError(S,f))return;this._bufferInitSegment(m,S.tracks,A,o),n.trigger(L.FRAG_PARSING_INIT_SEGMENT,{frag:A,id:i,tracks:S.tracks})}if(p){const{startPTS:A,endPTS:R,startDTS:C,endDTS:I}=p;d&&(d.elementaryStreams[yt.AUDIO]={startPTS:A,endPTS:R,startDTS:C,endDTS:I}),f.setElementaryStreamInfo(yt.AUDIO,A,R,C,I),this.bufferFragmentData(p,f,d,o)}if(y!=null&&(t=y.samples)!=null&&t.length){const A=bt({id:i,frag:f,details:g},y);n.trigger(L.FRAG_PARSING_METADATA,A)}if(T){const A=bt({id:i,frag:f,details:g},T);n.trigger(L.FRAG_PARSING_USERDATA,A)}}_bufferInitSegment(e,t,i,n){if(this.state!==ce.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const a=t.audio;a.id=_e.AUDIO;const o=e.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${o}/${a.codec}]`),o&&o.split(",").length===1&&(a.levelCodec=o),this.hls.trigger(L.BUFFER_CODECS,t);const c=a.initSegment;if(c!=null&&c.byteLength){const f={type:"audio",frag:i,part:null,chunkMeta:n,parent:i.type,data:c};this.hls.trigger(L.BUFFER_APPENDING,f)}this.tickImmediate()}loadFragment(e,t,i){const n=this.fragmentTracker.getState(e);if(this.switchingTrack||n===Jt.NOT_LOADED||n===Jt.PARTIAL){var a;if(!Ut(e))this._loadInitSegment(e,t);else if((a=t.details)!=null&&a.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ce.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==t.details.fragmentStart&&If(t.details,o)}else super.loadFragment(e,t,i)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:i,assocLang:n,characteristics:a,audioCodec:o,channels:c}=this.bufferedTrack;Ea({name:t,lang:i,assocLang:n,characteristics:a,audioCodec:o,channels:c},e,ua)||(Sf(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(L.AUDIO_TRACK_SWITCHED,dt({},e))}}class a1 extends Li{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,i){const n=t==null?void 0:t.renditionReports;if(n){let a=-1;for(let o=0;o<n.length;o++){const c=n[o];let f;try{f=new self.URL(c.URI,t.url).href}catch(d){this.warn(`Could not construct new URL for Rendition Report: ${d}`),f=c.URI||""}if(f===e){a=o;break}else f===e.substring(0,f.length)&&(a=o)}if(a!==-1){const o=n[a],c=parseInt(o["LAST-MSN"])||t.lastPartSn;let f=parseInt(o["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const m=Math.min(t.age-t.partTarget,t.targetduration);f>=0&&m>t.partTarget&&(f+=1)}const d=i&&zT(i);return new YT(c,f>=0?f:void 0,d)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return e}playlistLoaded(e,t,i){const{details:n,stats:a}=t,o=self.performance.now(),c=a.loading.first?Math.max(0,o-a.loading.first):0;n.advancedDateTime=Date.now()-c;const f=this.hls.config.timelineOffset;if(f!==n.appliedTimelineOffset){const m=Math.max(f||0,0);n.appliedTimelineOffset=m,n.fragments.forEach(g=>{g.setStart(g.playlistOffset+m)})}if(n.live||i!=null&&i.live){const m="levelInfo"in t?t.levelInfo:t.track;if(n.reloaded(i),i&&n.fragments.length>0){E9(i,n,this);const C=n.playlistParsingError;if(C){this.warn(C);const I=this.hls;if(!I.config.ignorePlaylistParsingErrors){var d;const{networkDetails:D}=t;I.trigger(L.ERROR,{type:Ie.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:C,reason:C.message,level:t.level||void 0,parent:(d=n.fragments[0])==null?void 0:d.type,networkDetails:D,stats:a});return}n.playlistParsingError=null}}n.requestScheduled===-1&&(n.requestScheduled=a.loading.start);const g=this.hls.mainForwardBufferInfo,p=g?g.end-g.len:0,T=(n.edge-p)*1e3,y=a3(n,T);if(n.requestScheduled+y<o?n.requestScheduled=o:n.requestScheduled+=y,this.log(`live playlist ${e} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let S,A,R;if(n.canBlockReload&&n.endSN&&n.advanced){const C=this.hls.config.lowLatencyMode,I=n.lastPartSn,D=n.endSN,k=n.lastPartIndex,z=k!==-1,P=I===D;z?P?(A=D+1,R=C?0:k):(A=I,R=C?k+1:n.maxPartIndex):A=D+1;const V=n.age,$=V+n.ageHeader;let j=Math.min($-n.partTarget,n.targetduration*1.5);if(j>0){if($>n.targetduration*3)this.log(`Playlist last advanced ${V.toFixed(2)}s ago. Omitting segment and part directives.`),A=void 0,R=void 0;else if(i!=null&&i.tuneInGoal&&$-n.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${j} with playlist age: ${n.age}`),j=0;else{const te=Math.floor(j/n.targetduration);if(A+=te,R!==void 0){const ge=Math.round(j%n.targetduration/n.partTarget);R+=ge}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${V.toFixed(2)}s goal: ${j} skip sn ${te} to part ${R}`)}n.tuneInGoal=j}if(S=this.getDeliveryDirectives(n,t.deliveryDirectives,A,R),C||!P){n.requestScheduled=o,this.loadingPlaylist(m,S);return}}else(n.canBlockReload||n.canSkipUntil)&&(S=this.getDeliveryDirectives(n,t.deliveryDirectives,A,R));S&&A!==void 0&&n.canBlockReload&&(n.requestScheduled=a.loading.first+Math.max(y-c*2,y/2)),this.scheduleLoading(m,S,n)}else this.clearTimer()}scheduleLoading(e,t,i){const n=i||e.details;if(!n){this.loadingPlaylist(e,t);return}const a=self.performance.now(),o=n.requestScheduled;if(a>=o){this.loadingPlaylist(e,t);return}const c=o-a;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(c)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),c)}getDeliveryDirectives(e,t,i,n){let a=zT(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,n=t.part,a=Yd.No),new YT(i,n,a)}checkRetry(e){const t=e.details,i=Af(e),n=e.errorAction,{action:a,retryCount:o=0,retryConfig:c}=n||{},f=!!n&&!!c&&(a===bs.RetryRequest||!n.resolved&&a===bs.SendAlternateToPenaltyBox);if(f){var d;if(o>=c.maxNumRetry)return!1;if(i&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const m=Yp(c,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${t}" in ${m}ms`)}e.levelRetry=!0,n.resolved=!0}return f}}function w3(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!Dl(s[t].attrs,e[t].attrs))return!1;return!0}function Dl(s,e,t){const i=s["STABLE-RENDITION-ID"];return i&&!t?i===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>s[n]!==e[n])}function Yg(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}class RU extends a1{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(L.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:n,details:a}=t,o=this.tracksInGroup[i];if(!o||o.groupId!==n){this.warn(`Audio track with id:${i} and group:${n} not found in active group ${o==null?void 0:o.groupId}`);return}const c=o.details;o.details=t.details,this.log(`Audio track ${i} "${o.name}" lang:${o.lang} group:${n} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.audioGroups||null,n=this.groupIds;let a=this.currentTrack;if(!i||(n==null?void 0:n.length)!==(i==null?void 0:i.length)||i!=null&&i.some(c=>(n==null?void 0:n.indexOf(c))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(p=>!i||i.indexOf(p.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(p=>p.default)&&(this.selectDefaultTrack=!1),c.forEach((p,T)=>{p.id=T});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const f=this.hls.config.audioPreference;if(!a&&f){const p=nn(f,c,ua);if(p>-1)a=c[p];else{const T=nn(f,this.tracks);a=this.tracks[T]}}let d=this.findTrackId(a);d===-1&&a&&(d=this.findTrackId(null));const m={audioTracks:c};this.log(`Updating audio tracks, ${c.length} track(s) found in group(s): ${i==null?void 0:i.join(",")}`),this.hls.trigger(L.AUDIO_TRACKS_UPDATED,m);const g=this.trackId;if(d!==-1&&g===-1)this.setAudioTrack(d);else if(c.length&&g===-1){var o;const p=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${c.length}`);this.warn(p.message),this.hls.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}}onError(e,t){t.fatal||!t.context||t.context.type===Ge.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const n=this.currentTrack;if(n&&Ea(e,n,ua))return n;const a=nn(e,this.tracksInGroup,ua);if(a>-1){const o=this.tracksInGroup[a];return this.setAudioTrack(a),o}else if(n){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const c=FP(e,t.levels,i,o,ua);if(c===-1)return null;t.nextLoadLevel=c}if(e.channels||e.audioCodec){const o=nn(e,i);if(o>-1)return i[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,n=t[e],a=n.details&&!n.details.live;if(e===this.trackId&&n===i&&a||(this.log(`Switching to audio-track ${e} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=e,this.currentTrack=n,this.hls.trigger(L.AUDIO_TRACK_SWITCHING,dt({},n)),a))return;const o=this.switchParams(n.url,i==null?void 0:i.details,n.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const n=t[i];if(!(this.selectDefaultTrack&&!n.default)&&(!e||Ea(e,n,ua)))return i}if(e){const{name:i,lang:n,assocLang:a,characteristics:o,audioCodec:c,channels:f}=e;for(let d=0;d<t.length;d++){const m=t[d];if(Ea({name:i,lang:n,assocLang:a,characteristics:o,audioCodec:c,channels:f},m,ua))return d}for(let d=0;d<t.length;d++){const m=t[d];if(Dl(e.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const m=t[d];if(Dl(e.attrs,m.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Sf(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,n=e.groupId,a=this.getUrlWithDirectives(e.url,t),o=e.details,c=o==null?void 0:o.age;this.log(`Loading audio-track ${i} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${a}`),this.hls.trigger(L.AUDIO_TRACK_LOADING,{url:a,id:i,groupId:n,deliveryDirectives:t||null,track:e})}}class IU{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,i){if(this.queues===null||this.tracks===null)return;const n=this.queues[t];n.push(e),n.length===1&&!i&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const i={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const i={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const i=(t=e[0])==null?void 0:t.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(a){var i;if(n.onError(a),this.queues===null||this.tracks===null)return;const o=(i=this.tracks[e])==null?void 0:i.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,i;return(t=this.queues)!=null&&t[e]||(i=this.tracks)!=null&&i[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const i=(t=this.tracks)==null?void 0:t[e],n=i==null?void 0:i.buffer;return n?`SourceBuffer${n.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(i=>i.label).join(", "))||""}}const w2=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,O3="HlsJsTrackRemovedError";class CU extends Error{constructor(e){super(e),this.name=O3}}class NU extends Li{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var n;this.hls&&((n=this.mediaSource)==null?void 0:n.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:n,mediaSource:a}=this;i&&this.log("Media source opened"),!(!n||!a)&&(a.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(L.MEDIA_ATTACHED,{media:n,mediaSource:a}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:n}=this;i!==n&&this.error(`Media element src was set while attaching MediaSource (${n} > ${i})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=ZM(Mr(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.BUFFER_RESET,this.onBufferReset,this),e.on(L.BUFFER_APPENDING,this.onBufferAppending,this),e.on(L.BUFFER_CODECS,this.onBufferCodecs,this),e.on(L.BUFFER_EOS,this.onBufferEos,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.FRAG_PARSED,this.onFragParsed,this),e.on(L.FRAG_CHANGED,this.onFragChanged,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.BUFFER_RESET,this.onBufferReset,this),e.off(L.BUFFER_APPENDING,this.onBufferAppending,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.BUFFER_EOS,this.onBufferEos,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.FRAG_PARSED,this.onFragParsed,this),e.off(L.FRAG_CHANGED,this.onFragChanged,this),e.off(L.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const i={};if(this.operationQueue){const a=this.isUpdating();a||this.operationQueue.removeBlockers();const o=this.isQueued();(a||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${a?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===t?bt(i,n.tracks):this.sourceBuffers.forEach(a=>{const[o]=a;o&&(i[o]=bt({},this.tracks[o]),this.removeBuffer(o)),a[0]=a[1]=null}),{media:e,mediaSource:t,tracks:i}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var i;let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(e,t){const i=this.media=t.media;this.transferData=this.overrides=void 0;const n=Mr(this.appendSource);if(n){const a=!!t.mediaSource;(a||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const o=this.mediaSource=t.mediaSource||new n;if(this.assignMediaSource(o),a)this._objectUrl=i.src,this.attachTransferred();else{const c=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{i.removeAttribute("src");const f=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||f&&o instanceof f,O2(i),DU(i,c),i.load()}catch{i.src=c}else i.src=c}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,i;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(i=e.constructor)==null?void 0:i.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const i=this.tracks,n=t.tracks,a=n?Object.keys(n):null,o=a?a.length:0,c=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(n&&a&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Tt(i,(f,d)=>f==="initSegment"?void 0:d)};
transfer tracks: ${Tt(n,(f,d)=>f==="initSegment"?void 0:d)}}`),!CA(n,i)){t.mediaSource=null,t.tracks=void 0;const f=e.currentTime,d=this.details,m=Math.max(f,(d==null?void 0:d.fragments[0].start)||0);if(m-f>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${f} -> ${m}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(i)}") start time: ${m} currentTime: ${f}`),this.onMediaDetaching(L.MEDIA_DETACHING,{}),this.onMediaAttaching(L.MEDIA_ATTACHING,t),e.currentTime=m;return}this.transferData=void 0,a.forEach(f=>{const d=f,m=n[d];if(m){const g=m.buffer;if(g){const p=this.fragmentTracker,T=m.id;if(p.hasFragments(T)||p.hasParts(T)){const A=Ue.getBuffered(g);p.detectEvictedFragments(d,A,T,null,!0)}const y=Wm(d),S=[d,g];this.sourceBuffers[y]=S,g.updating&&this.operationQueue&&this.operationQueue.prependBlocker(d),this.trackSourceBuffer(d,m)}}}),c(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),c()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const i=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:a,_objectUrl:o}=this;if(a){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([c])=>{c&&this.removeBuffer(c)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const c=a.readyState==="open";try{const f=a.sourceBuffers;for(let d=f.length;d--;)c&&f[d].abort(),a.removeSourceBuffer(f[d]);c&&a.endOfStream()}catch(f){this.warn(`onMediaDetaching: ${f.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),i||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(n.removeAttribute("src"),this.appendSource&&O2(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(L.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const i=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),i)try{var n;(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(a){this.warn(`onBufferReset ${e}`,a)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Wm(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new IU(this.tracks)}onBufferCodecs(e,t){var i;const n=this.tracks,a=Object.keys(t);this.log(`BUFFER_CODECS: "${a}" (current SB count ${this.sourceBufferCount})`);const o="audiovideo"in t&&(n.audio||n.video)||n.audiovideo&&("audio"in t||"video"in t),c=!o&&this.sourceBufferCount&&this.media&&a.some(f=>!n[f]);if(o||c){this.warn(`Unsupported transition between "${Object.keys(n)}" and "${a}" SourceBuffers`);return}a.forEach(f=>{var d,m;const g=t[f],{id:p,codec:T,levelCodec:y,container:S,metadata:A,supplemental:R}=g;let C=n[f];const I=(d=this.transferData)==null||(d=d.tracks)==null?void 0:d[f],D=I!=null&&I.buffer?I:C,k=(D==null?void 0:D.pendingCodec)||(D==null?void 0:D.codec),z=D==null?void 0:D.levelCodec;C||(C=n[f]={buffer:void 0,listeners:[],codec:T,supplemental:R,container:S,levelCodec:y,metadata:A,id:p});const P=zd(k,z),V=P==null?void 0:P.replace(w2,"$1");let $=zd(T,y);const j=(m=$)==null?void 0:m.replace(w2,"$1");$&&P&&V!==j&&(f.slice(0,5)==="audio"&&($=Tf($,this.appendSource)),this.log(`switching codec ${k} to ${$}`),$!==(C.pendingCodec||C.codec)&&(C.pendingCodec=$),C.container=S,this.appendChangeType(f,S,$))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((i=t.audio)==null?void 0:i.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const i=this.tracks[t];return e[t]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},e},{})}appendChangeType(e,t,i){const n=`${t};codecs=${i}`,a={label:`change-type=${n}`,execute:()=>{const o=this.tracks[e];if(o){const c=o.buffer;c!=null&&c.changeType&&(this.log(`changing ${e} sourceBuffer type to ${n}`),c.changeType(n),o.codec=i,o.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};this.append(a,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const i=e.start,n=i+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(i,_e.MAIN))==null?void 0:t.gap)===!0)return;const o={label:"block-audio",execute:()=>{var c;const f=this.tracks.video;(this.lastVideoAppendEnd>n||f!=null&&f.buffer&&Ue.isBuffered(f.buffer,n)||((c=this.fragmentTracker.getAppendedFrag(n,_e.MAIN))==null?void 0:c.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn("Error executing block-audio operation",c)}};this.blockedAudioAppend={op:o,frag:e},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:i}=this,{data:n,type:a,parent:o,frag:c,part:f,chunkMeta:d,offset:m}=t,g=d.buffering[a],{sn:p,cc:T}=c,y=self.performance.now();g.start=y;const S=c.stats.buffering,A=f?f.stats.buffering:null;S.start===0&&(S.start=y),A&&A.start===0&&(A.start=y);const R=i.audio;let C=!1;a==="audio"&&(R==null?void 0:R.container)==="audio/mpeg"&&(C=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const I=i.video,D=I==null?void 0:I.buffer;if(D&&p!=="initSegment"){const P=f||c,V=this.blockedAudioAppend;if(a==="audio"&&o!=="main"&&!this.blockedAudioAppend&&!(I.ending||I.ended)){const j=P.start+P.duration*.05,te=D.buffered,ge=this.currentOp("video");!te.length&&!ge?this.blockAudio(P):!ge&&!Ue.isBuffered(D,j)&&this.lastVideoAppendEnd<j&&this.blockAudio(P)}else if(a==="video"){const $=P.end;if(V){const j=V.frag.start;($>j||$<this.lastVideoAppendEnd||Ue.isBuffered(D,j))&&this.unblockAudio()}this.lastVideoAppendEnd=$}}const k=(f||c).start,z={label:`append-${a}`,execute:()=>{var P;g.executeStart=self.performance.now();const V=(P=this.tracks[a])==null?void 0:P.buffer;V&&(C?this.updateTimestampOffset(V,k,.1,a,p,T):m!==void 0&&Se(m)&&this.updateTimestampOffset(V,m,1e-6,a,p,T)),this.appendExecutor(n,a)},onStart:()=>{},onComplete:()=>{const P=self.performance.now();g.executeEnd=g.end=P,S.first===0&&(S.first=P),A&&A.first===0&&(A.first=P);const V={};this.sourceBuffers.forEach(([$,j])=>{$&&(V[$]=Ue.getBuffered(j))}),this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(L.BUFFER_APPENDED,{type:a,frag:c,part:f,chunkMeta:d,parent:c.type,timeRanges:V})},onError:P=>{var V;const $={type:Ie.MEDIA_ERROR,parent:c.type,details:Q.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:c,part:f,chunkMeta:d,error:P,err:P,fatal:!1},j=(V=this.media)==null?void 0:V.error;if(P.code===DOMException.QUOTA_EXCEEDED_ERR||P.name=="QuotaExceededError"||"quota"in P)$.details=Q.BUFFER_FULL_ERROR;else if(P.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!j)$.errorAction=_u(!0);else if(P.name===O3&&this.sourceBufferCount===0)$.errorAction=_u(!0);else{const te=++this.appendErrors[a];this.warn(`Failed ${te}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${j||"no media error"})`),(te>=this.hls.config.appendErrorMaxRetry||j)&&($.fatal=!0)}this.hls.trigger(L.ERROR,$)}};this.log(`queuing "${a}" append sn: ${p}${f?" p: "+f.index:""} of ${c.type===_e.MAIN?"level":"track"} ${c.level} cc: ${T}`),this.append(z,a,this.isPending(this.tracks[a]))}getFlushOp(e,t,i){return this.log(`queuing "${e}" remove ${t}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(L.BUFFER_FLUSHED,{type:e})},onError:n=>{this.warn(`Failed to remove ${t}-${i} from "${e}" SourceBuffer`,n)}}}onBufferFlushing(e,t){const{type:i,startOffset:n,endOffset:a}=t;i?this.append(this.getFlushOp(i,n,a),i):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,n,a),o)})}onFragParsed(e,t){const{frag:i,part:n}=t,a=[],o=n?n.elementaryStreams:i.elementaryStreams;o[yt.AUDIOVIDEO]?a.push("audiovideo"):(o[yt.AUDIO]&&a.push("audio"),o[yt.VIDEO]&&a.push("video"));const c=()=>{const f=self.performance.now();i.stats.buffering.end=f,n&&(n.stats.buffering.end=f);const d=n?n.stats:i.stats;this.hls.trigger(L.FRAG_BUFFERED,{frag:i,part:n,stats:d,id:i.type})};a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(c,a).catch(f=>{this.warn(`Fragment buffered callback ${f}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var i;this.sourceBuffers.forEach(([o])=>{if(o){const c=this.tracks[o];(!t.type||t.type===o)&&(c.ending=!0,c.ended||(c.ended=!0,this.log(`${o} buffer reached EOS`)))}});const n=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var c;return o&&!((c=this.tracks[o])!=null&&c.ended)})?n?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(L.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(L.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===Q.BUFFER_APPEND_ERROR&&t.frag){var i;const n=(i=t.errorAction)==null?void 0:i.nextAutoLevel;Se(n)&&n!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:i}=this;if(!i||t===null||!this.sourceBufferCount)return;const n=e.config,a=i.currentTime,o=t.levelTargetDuration,c=t.live&&n.liveBackBufferLength!==null?n.liveBackBufferLength:n.backBufferLength;if(Se(c)&&c>=0){const d=Math.max(c,o),m=Math.floor(a/o)*o-d;this.flushBackBuffer(a,o,m)}const f=n.frontBufferFlushThreshold;if(Se(f)&&f>0){const d=Math.max(n.maxBufferLength,f),m=Math.max(d,o),g=Math.floor(a/o)*o+m;this.flushFrontBuffer(a,o,g)}}flushBackBuffer(e,t,i){this.sourceBuffers.forEach(([n,a])=>{if(a){const c=Ue.getBuffered(a);if(c.length>0&&i>c.start(0)){var o;this.hls.trigger(L.BACK_BUFFER_REACHED,{bufferEnd:i});const f=this.tracks[n];if((o=this.details)!=null&&o.live)this.hls.trigger(L.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(f!=null&&f.ended){this.log(`Cannot flush ${n} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:n})}}})}flushFrontBuffer(e,t,i){this.sourceBuffers.forEach(([n,a])=>{if(a){const o=Ue.getBuffered(a),c=o.length;if(c<2)return;const f=o.start(c-1),d=o.end(c-1);if(i>f||e>=f&&e<=d)return;this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:f,endOffset:1/0,type:n})}})}getDurationAndRange(){var e;const{details:t,mediaSource:i}=this;if(!t||!this.media||(i==null?void 0:i.readyState)!=="open")return null;const n=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&i.setLiveSeekableRange){const d=Math.max(0,t.fragmentStart),m=Math.max(d,n);return{duration:1/0,start:d,end:m}}return{duration:1/0}}const a=(e=this.overrides)==null?void 0:e.duration;if(a)return Se(a)?{duration:a}:null;const o=this.media.duration,c=Se(i.duration)?i.duration:0;return n>c&&n>o||!Se(o)?{duration:n}:null}updateMediaSource({duration:e,start:t,end:i}){const n=this.mediaSource;!this.media||!n||n.readyState!=="open"||(n.duration!==e&&(Se(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),n.duration=e),t!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${n.duration}. Setting seekable range to ${t}-${i}.`),n.setLiveSeekableRange(t,i)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${Tt(i)}`),this.tracksReady){var n;const a=(n=this.transferData)==null?void 0:n.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,i])=>{if(t){const n=this.tracks[t];e[t]={buffer:i,container:n.container,codec:n.codec,supplemental:n.supplemental,levelCodec:n.levelCodec,id:n.id,metadata:n.metadata}}}),this.hls.trigger(L.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const a in e){const o=a,c=e[o];if(this.isPending(c)){const f=this.getTrackCodec(c,o),d=`${c.container};codecs=${f}`;c.codec=f,this.log(`creating sourceBuffer(${d})${this.currentOp(o)?" Queued":""} ${Tt(c)}`);try{const m=i.addSourceBuffer(d),g=Wm(o),p=[o,m];t[g]=p,c.buffer=m}catch(m){var n;this.error(`error while trying to add sourceBuffer: ${m.message}`),this.shiftAndExecuteNext(o),(n=this.operationQueue)==null||n.removeBlockers(),delete this.tracks[o],this.hls.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:m,sourceBufferName:o,mimeType:d,parent:c.id});return}this.trackSourceBuffer(o,c)}}this.bufferCreated()}getTrackCodec(e,t){const i=e.supplemental;let n=e.codec;i&&(t==="video"||t==="audiovideo")&&_l(i,"video")&&(n=xP(n,i));const a=zd(n,e.levelCodec);return a?t.slice(0,5)==="audio"?Tf(a,this.appendSource):a:""}trackSourceBuffer(e,t){const i=t.buffer;if(!i)return;const n=this.getTrackCodec(t,e);this.tracks[e]={buffer:i,codec:n,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(a,o)=>{const c=o.removedRanges;c!=null&&c.length&&this.hls.trigger(L.BUFFER_FLUSHED,{type:a})})}get mediaSrc(){var e,t;const i=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return i==null?void 0:i.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const i=this.currentOp(e);i&&(i.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var i;const n=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${n}`,t),this.hls.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});const a=this.currentOp(e);a&&a.onError(n)}updateTimestampOffset(e,t,i,n,a,o){const c=t-e.timestampOffset;Math.abs(c)>=i&&(this.log(`Updating ${n} SourceBuffer timestampOffset to ${t} (sn: ${a} cc: ${o})`),e.timestampOffset=t)}removeExecutor(e,t,i){const{media:n,mediaSource:a}=this,o=this.tracks[e],c=o==null?void 0:o.buffer;if(!n||!a||!c){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const f=Se(n.duration)?n.duration:1/0,d=Se(a.duration)?a.duration:1/0,m=Math.max(0,t),g=Math.min(i,f,d);g>m&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${m},${g}] from the ${e} SourceBuffer`),c.remove(m,g)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const i=this.tracks[t],n=i==null?void 0:i.buffer;if(!n)throw new CU(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,n.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:i}=this,n=t.map(o=>this.appendBlocker(o));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then(o=>{i===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var i;const n=(i=this.tracks[t])==null?void 0:i.buffer;!n||n.updating||this.shiftAndExecuteNext(t)})}append(e,t,i){this.operationQueue&&this.operationQueue.append(e,t,i)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,i){const n=this.tracks[e];if(!n)return;const a=n.buffer;if(!a)return;const o=i.bind(this,e);n.listeners.push({event:t,listener:o}),a.addEventListener(t,o)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const i=t.buffer;i&&(t.listeners.forEach(n=>{i.removeEventListener(n.event,n.listener)}),t.listeners.length=0)}}function O2(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(t=>{s.removeChild(t)})}function DU(s,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,s.appendChild(t)}function Wm(s){return s==="audio"?1:0}class u1{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(L.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.BUFFER_CODECS,this.onBufferCodecs,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(L.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Se(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,i=this.getMaxLevel(e.length-1);i!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${i}: ${e[i].height}p@${e[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=i,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((n,a)=>this.isLevelAllowed(n)&&a<=e);return this.clientRect=null,u1.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,!t.width&&!t.height&&(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,t,i){if(!(e!=null&&e.length))return-1;const n=(c,f)=>f?c.width!==f.width||c.height!==f.height:!0;let a=e.length-1;const o=Math.max(t,i);for(let c=0;c<e.length;c+=1){const f=e[c];if((f.width>=o||f.height>=o)&&n(f,e[c+1])){a=c;break}}return a}}const wU={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},$s=wU,OU={HLS:"h"},kU=OU;class on{constructor(e,t){Array.isArray(e)&&(e=e.map(i=>i instanceof on?i:new on(i))),this.value=e,this.params=t}}const MU="Dict";function PU(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function UU(s,e,t,i){return new Error(`failed to ${s} "${PU(e)}" as ${t}`,{cause:i})}function ln(s,e,t){return UU("serialize",s,e,t)}class k3{constructor(e){this.description=e}}const k2="Bare Item",BU="Boolean";function FU(s){if(typeof s!="boolean")throw ln(s,BU);return s?"?1":"?0"}function HU(s){return btoa(String.fromCharCode(...s))}const jU="Byte Sequence";function $U(s){if(ArrayBuffer.isView(s)===!1)throw ln(s,jU);return`:${HU(s)}:`}const GU="Integer";function qU(s){return s<-999999999999999||999999999999999<s}function M3(s){if(qU(s))throw ln(s,GU);return s.toString()}function VU(s){return`@${M3(s.getTime()/1e3)}`}function P3(s,e){if(s<0)return-P3(-s,e);const t=Math.pow(10,e);if(Math.abs(s*t%1-.5)<Number.EPSILON){const n=Math.floor(s*t);return(n%2===0?n:n+1)/t}else return Math.round(s*t)/t}const zU="Decimal";function YU(s){const e=P3(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw ln(s,zU);const t=e.toString();return t.includes(".")?t:`${t}.0`}const KU="String",QU=/[\x00-\x1f\x7f]+/;function XU(s){if(QU.test(s))throw ln(s,KU);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function WU(s){return s.description||s.toString().slice(7,-1)}const ZU="Token";function M2(s){const e=WU(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw ln(e,ZU);return e}function Kg(s){switch(typeof s){case"number":if(!Se(s))throw ln(s,k2);return Number.isInteger(s)?M3(s):YU(s);case"string":return XU(s);case"symbol":return M2(s);case"boolean":return FU(s);case"object":if(s instanceof Date)return VU(s);if(s instanceof Uint8Array)return $U(s);if(s instanceof k3)return M2(s);default:throw ln(s,k2)}}const JU="Key";function Qg(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw ln(s,JU);return s}function o1(s){return s==null?"":Object.entries(s).map(([e,t])=>t===!0?`;${Qg(e)}`:`;${Qg(e)}=${Kg(t)}`).join("")}function U3(s){return s instanceof on?`${Kg(s.value)}${o1(s.params)}`:Kg(s)}function eB(s){return`(${s.value.map(U3).join(" ")})${o1(s.params)}`}function tB(s,e={whitespace:!0}){if(typeof s!="object"||s==null)throw ln(s,MU);const t=s instanceof Map?s.entries():Object.entries(s),i=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([n,a])=>{a instanceof on||(a=new on(a));let o=Qg(n);return a.value===!0?o+=o1(a.params):(o+="=",Array.isArray(a.value)?o+=eB(a):o+=U3(a)),o}).join(`,${i}`)}function B3(s,e){return tB(s,e)}const Ki="CMCD-Object",wt="CMCD-Request",ra="CMCD-Session",br="CMCD-Status",sB={br:Ki,ab:Ki,d:Ki,ot:Ki,tb:Ki,tpb:Ki,lb:Ki,tab:Ki,lab:Ki,url:Ki,pb:wt,bl:wt,tbl:wt,dl:wt,ltc:wt,mtp:wt,nor:wt,nrr:wt,rc:wt,sn:wt,sta:wt,su:wt,ttfb:wt,ttfbb:wt,ttlb:wt,cmsdd:wt,cmsds:wt,smrt:wt,df:wt,cs:wt,ts:wt,cid:ra,pr:ra,sf:ra,sid:ra,st:ra,v:ra,msd:ra,bs:br,bsd:br,cdn:br,rtp:br,bg:br,pt:br,ec:br,e:br},iB={REQUEST:wt};function nB(s){return Object.keys(s).reduce((e,t)=>{var i;return(i=s[t])===null||i===void 0||i.forEach(n=>e[n]=t),e},{})}function rB(s,e){const t={};if(!s)return t;const i=Object.keys(s),n=e?nB(e):{};return i.reduce((a,o)=>{var c;const f=sB[o]||n[o]||iB.REQUEST,d=(c=a[f])!==null&&c!==void 0?c:a[f]={};return d[o]=s[o],a},t)}function aB(s){return["ot","sf","st","e","sta"].includes(s)}function uB(s){return typeof s=="number"?Se(s):s!=null&&s!==""&&s!==!1}const F3="event";function oB(s,e){const t=new URL(s),i=new URL(e);if(t.origin!==i.origin)return s;const n=t.pathname.split("/").slice(1),a=i.pathname.split("/").slice(1,-1);for(;n[0]===a[0];)n.shift(),a.shift();for(;a.length;)a.shift(),n.unshift("..");return n.join("/")+t.search+t.hash}const Wd=s=>Math.round(s),Xg=(s,e)=>Array.isArray(s)?s.map(t=>Xg(t,e)):s instanceof on&&typeof s.value=="string"?new on(Xg(s.value,e),s.params):(e.baseUrl&&(s=oB(s,e.baseUrl)),e.version===1?encodeURIComponent(s):s),Nd=s=>Wd(s/100)*100,lB=(s,e)=>{let t=s;return e.version>=2&&(s instanceof on&&typeof s.value=="string"?t=new on([s]):typeof s=="string"&&(t=[s])),Xg(t,e)},cB={br:Wd,d:Wd,bl:Nd,dl:Nd,mtp:Nd,nor:lB,rtp:Nd,tb:Wd},H3="request",j3="response",l1=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],dB=["e"],fB=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function th(s){return fB.test(s)}function hB(s){return l1.includes(s)||dB.includes(s)||th(s)}const $3=["d","dl","nor","ot","rtp","su"];function mB(s){return l1.includes(s)||$3.includes(s)||th(s)}const gB=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function pB(s){return l1.includes(s)||$3.includes(s)||gB.includes(s)||th(s)}const bB=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function EB(s){return bB.includes(s)||th(s)}const yB={[j3]:pB,[F3]:hB,[H3]:mB};function G3(s,e={}){const t={};if(s==null||typeof s!="object")return t;const i=e.version||s.v||1,n=e.reportingMode||H3,a=i===1?EB:yB[n];let o=Object.keys(s).filter(a);const c=e.filter;typeof c=="function"&&(o=o.filter(c));const f=n===j3||n===F3;f&&!o.includes("ts")&&o.push("ts"),i>1&&!o.includes("v")&&o.push("v");const d=bt({},cB,e.formatters),m={version:i,reportingMode:n,baseUrl:e.baseUrl};return o.sort().forEach(g=>{let p=s[g];const T=d[g];if(typeof T=="function"&&(p=T(p,m)),g==="v"){if(i===1)return;p=i}g=="pr"&&p===1||(f&&g==="ts"&&!Se(p)&&(p=Date.now()),uB(p)&&(aB(g)&&typeof p=="string"&&(p=new k3(p)),t[g]=p))}),t}function xB(s,e={}){const t={};if(!s)return t;const i=G3(s,e),n=rB(i,e==null?void 0:e.customHeaderMap);return Object.entries(n).reduce((a,[o,c])=>{const f=B3(c,{whitespace:!1});return f&&(a[o]=f),a},t)}function TB(s,e,t){return bt(s,xB(e,t))}const vB="CMCD";function SB(s,e={}){return s?B3(G3(s,e),{whitespace:!1}):""}function AB(s,e={}){if(!s)return"";const t=SB(s,e);return encodeURIComponent(t)}function _B(s,e={}){if(!s)return"";const t=AB(s,e);return`${vB}=${t}`}const P2=/CMCD=[^&#]+/;function LB(s,e,t){const i=_B(e,t);if(!i)return s;if(P2.test(s))return s.replace(P2,i);const n=s.includes("?")?"&":"?";return`${s}${n}${i}`}class RB{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=n=>{try{this.apply(n,{ot:$s.MANIFEST,su:!this.initialized})}catch(a){this.hls.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=n=>{try{const{frag:a,part:o}=n,c=this.hls.levels[a.level],f=this.getObjectType(a),d={d:(o||a).duration*1e3,ot:f};(f===$s.VIDEO||f===$s.AUDIO||f==$s.MUXED)&&(d.br=c.bitrate/1e3,d.tb=this.getTopBandwidth(f)/1e3,d.bl=this.getBufferLength(f));const m=o?this.getNextPart(o):this.getNextFrag(a);m!=null&&m.url&&m.url!==a.url&&(d.nor=m.url),this.apply(n,d)}catch(a){this.hls.logger.warn("Could not generate segment CMCD data.",a)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;i!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||e.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHED,this.onMediaDetached,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHED,this.onMediaDetached,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,n;this.audioBuffer=(i=t.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(n=t.tracks.video)==null?void 0:n.buffer}createData(){var e;return{v:1,sf:kU.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){bt(t,this.createData());const i=t.ot===$s.INIT||t.ot===$s.VIDEO||t.ot===$s.MUXED;this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:n}=this;n&&(t=Object.keys(t).reduce((o,c)=>(n.includes(c)&&(o[c]=t[c]),o),{}));const a={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),TB(e.headers,t,a)):e.url=LB(e.url,t,a)}getNextFrag(e){var t;const i=(t=this.hls.levels[e.level])==null?void 0:t.details;if(i){const n=e.sn-i.startSN;return i.fragments[n+1]}}getNextPart(e){var t;const{index:i,fragment:n}=e,a=(t=this.hls.levels[n.level])==null||(t=t.details)==null?void 0:t.partList;if(a){const{sn:o}=n;for(let c=a.length-1;c>=0;c--){const f=a[c];if(f.index===i&&f.fragment.sn===o)return a[c+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return $s.TIMED_TEXT;if(e.sn==="initSegment")return $s.INIT;if(t==="audio")return $s.AUDIO;if(t==="main")return this.hls.audioTracks.length?$s.VIDEO:$s.MUXED}getTopBandwidth(e){let t=0,i;const n=this.hls;if(e===$s.AUDIO)i=n.audioTracks;else{const a=n.maxAutoLevel,o=a>-1?a+1:n.levels.length;i=n.levels.slice(0,o)}return i.forEach(a=>{a.bitrate>t&&(t=a.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,i=e===$s.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!t?NaN:Ue.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,o,c){t(a),this.loader.load(a,o,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new i(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,o,c){t(a),this.loader.load(a,o,c)}}}}const IB=3e5;class CB extends Li{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if((i==null?void 0:i.action)===bs.SendAlternateToPenaltyBox&&i.flags===ai.MoveAllAlternatesMatchingHost){const n=this.levels;let a=this._pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:c,pathwayId:f,type:d}=t.context;c&&n?o=this.getPathwayForGroupId(c,d,o):f&&(o=f)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!a&&n&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),i.resolved=this.pathwayId!==o),t.details===Q.BUFFER_APPEND_ERROR&&!t.fatal?i.resolved=!0:i.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${n&&n.length} priorities: ${Tt(a)} penalized: ${Tt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const i=this.penalizedPathways,n=performance.now();Object.keys(i).forEach(a=>{n-i[a]>IB&&delete i[a]});for(let a=0;a<e.length;a++){const o=e[a];if(o in i)continue;if(o===this.pathwayId)return;const c=this.hls.nextLoadLevel,f=this.hls.levels[c];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,l3(t),this.hls.trigger(L.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[c];f&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==f.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==f.bitrate&&this.log(`Unstable Pathways change from bitrate ${f.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=c);break}}}getPathwayForGroupId(e,t,i){const n=this.getLevelsForPathway(i).concat(this.levels||[]);for(let a=0;a<n.length;a++)if(t===Ge.AUDIO_TRACK&&n[a].hasAudioGroup(e)||t===Ge.SUBTITLE_TRACK&&n[a].hasSubtitleGroup(e))return n[a].pathwayId;return i}clonePathways(e){const t=this.levels;if(!t)return;const i={},n={};e.forEach(a=>{const{ID:o,"BASE-ID":c,"URI-REPLACEMENT":f}=a;if(t.some(m=>m.pathwayId===o))return;const d=this.getLevelsForPathway(c).map(m=>{const g=new Rt(m.attrs);g["PATHWAY-ID"]=o;const p=g.AUDIO&&`${g.AUDIO}_clone_${o}`,T=g.SUBTITLES&&`${g.SUBTITLES}_clone_${o}`;p&&(i[g.AUDIO]=p,g.AUDIO=p),T&&(n[g.SUBTITLES]=T,g.SUBTITLES=T);const y=q3(m.uri,g["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",f),S=new Rl({attrs:g,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:y,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let A=1;A<m.audioGroups.length;A++)S.addGroupId("audio",`${m.audioGroups[A]}_clone_${o}`);if(m.subtitleGroups)for(let A=1;A<m.subtitleGroups.length;A++)S.addGroupId("text",`${m.subtitleGroups[A]}_clone_${o}`);return S});t.push(...d),U2(this.audioTracks,i,f,o),U2(this.subtitleTracks,n,f,o)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;this.loader&&this.loader.destroy(),this.loader=new i(t);let n;try{n=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(n.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+m)}const a={responseType:"json",url:n.href},o=t.steeringManifestLoadPolicy.default,c=o.errorRetry||o.timeoutRetry||{},f={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},d={onSuccess:(m,g,p,T)=>{this.log(`Loaded steering manifest: "${n}"`);const y=m.data;if((y==null?void 0:y.VERSION)!==1){this.log(`Steering VERSION ${y.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=y.TTL;const{"RELOAD-URI":S,"PATHWAY-CLONES":A,"PATHWAY-PRIORITY":R}=y;if(S)try{this.uri=new self.URL(S,n).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${S}`);return}this.scheduleRefresh(this.uri||p.url),A&&this.clonePathways(A);const C={steeringManifest:y,url:n.toString()};this.hls.trigger(L.STEERING_MANIFEST_LOADED,C),R&&this.updatePathwayPriority(R)},onError:(m,g,p,T)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${g.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${g.url} no longer available`);return}let y=this.timeToLoad*1e3;if(m.code===429){const S=this.loader;if(typeof(S==null?void 0:S.getResponseHeader)=="function"){const A=S.getResponseHeader("Retry-After");A&&(y=parseFloat(A)*1e3)}this.log(`Steering manifest ${g.url} rate limited`);return}this.scheduleRefresh(this.uri||g.url,y)},onTimeout:(m,g,p)=>{this.log(`Timeout loading steering manifest (${g.url})`),this.scheduleRefresh(this.uri||g.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(a,f,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const n=(i=this.hls)==null?void 0:i.media;if(n&&!n.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function U2(s,e,t,i){s&&Object.keys(e).forEach(n=>{const a=s.filter(o=>o.groupId===n).map(o=>{const c=bt({},o);return c.details=void 0,c.attrs=new Rt(c.attrs),c.url=c.attrs.URI=q3(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[n],c.attrs["PATHWAY-ID"]=i,c});s.push(...a)})}function q3(s,e,t,i){const{HOST:n,PARAMS:a,[t]:o}=i;let c;e&&(c=o==null?void 0:o[e],c&&(s=c));const f=new self.URL(s);return n&&!c&&(f.host=n),a&&Object.keys(a).sort().forEach(d=>{d&&f.searchParams.set(d,a[d])}),f.href}class Ru extends Li{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Ru.CDMCleanupPromise?[Ru.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:i,initData:n}=t,a=`"${t.type}" event: init data type: "${i}"`;if(this.debug(a),n!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=il(this.config));const c=o.map(Gm).filter(f=>!!f);this.keyFormatPromise=this.getKeyFormatPromise(c)}this.keyFormatPromise.then(o=>{const c=Kd(o);if(i!=="sinf"||c!==It.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${i}" for selected key-system ${c}`);return}let f;try{const T=Zt(new Uint8Array(n)),y=Wp(JSON.parse(T).sinf),S=BA(y);if(!S)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");f=new Uint8Array(S.subarray(8,24))}catch(T){this.warn(`${a} Failed to parse sinf: ${T}`);return}const d=Es(f),{keyIdToKeySessionPromise:m,mediaKeySessions:g}=this;let p=m[d];for(let T=0;T<g.length;T++){const y=g[T],S=y.decryptdata;if(!S.keyId)continue;const A=Es(S.keyId);if(Lf(f,S.keyId)||S.uri.replace(/-/g,"").indexOf(d)!==-1){if(p=m[A],!p)continue;if(S.pssh)break;delete m[A],S.pssh=new Uint8Array(n),S.keyId=f,p=m[d]=p.then(()=>this.generateRequestWithPreferredKeySession(y,i,n,"encrypted-event-key-match")),p.catch(R=>this.handleError(R));break}}p||this.handleError(new Error(`Key ID ${d} not encountered in playlist. Key-system sessions ${g.length}.`))}).catch(o=>this.handleError(o))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(L.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(L.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(L.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(L.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,n=t==null?void 0:t[e];if(n)return n.licenseUrl;if(e===It.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t==null?void 0:t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(o,c,f)=>!!o&&f.indexOf(o)===c,n=t.map(o=>o.audioCodec).filter(i),a=t.map(o=>o.videoCodec).filter(i);return n.length+a.length===0&&a.push("avc1.42e01e"),new Promise((o,c)=>{const f=d=>{const m=d.shift();this.getMediaKeysPromise(m,n,a).then(g=>o({keySystem:m,mediaKeys:g})).catch(g=>{d.length?f(d):g instanceof ri?c(g):c(new ri({type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_ACCESS,error:g,fatal:!0},g.message))})};f(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let n=`Configured requestMediaKeySystemAccess is not a function ${i}`;return t3===null&&self.location.protocol==="http:"&&(n=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(n))}return i(e,t)}getMediaKeysPromise(e,t,i){var n;const a=l9(e,t,i,this.config.drmSystemOptions||{});let o=this.keySystemAccessPromises[e],c=(n=o)==null?void 0:n.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Tt(a)}`),c=this.requestMediaKeySystemAccess(e,a);const f=o=this.keySystemAccessPromises[e]={keySystemAccess:c};return c.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),c.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const m=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const g=f.mediaKeys=d.createMediaKeys().then(p=>(this.log(`Media-keys created for "${e}"`),f.hasMediaKeys=!0,m.then(T=>T?this.setMediaKeysServerCertificate(p,e,T):p)));return g.catch(p=>{this.error(`Failed to create media-keys for "${e}"}: ${p}`)}),g})}return c.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${Es(e.keyId||[])} keyUri: ${e.uri}`);const n=i.createSession(),a={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),n=Dd(t),a="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(i,a,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyId ${Es(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),i.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Gm(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:i})=>this.attemptSetMediaKeys(t,i))}selectKeySystem(e){return new Promise((t,i)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:n})=>{const a=Gm(n);a?t(a):i(new Error(`Unable to find format for key-system "${n}"`))}).catch(i)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=il(this.config),i=e.map(Kd).filter(n=>!!n&&t.indexOf(n)!==-1);return this.selectKeySystem(i)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let i=0;i<t.length;i++){const n=NB(e,t[i]);if(n)return n}}loadKey(e){const t=e.keyInfo.decryptdata,i=Dd(t),n=this.bannedKeyIds[i];if(n||this.getKeyStatus(t)==="internal-error"){const c=B2(n||"internal-error",t);return this.handleError(c,e.frag),Promise.reject(c)}const a=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${a}`);const o=this.keyIdToKeySessionPromise[i];if(!o){const c=this.getKeySystemForKeyPromise(t).then(({keySystem:f,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${a}`),this.attemptSetMediaKeys(f,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:f,mediaKeys:d,decryptdata:t}))))).then(f=>{const d="cenc",m=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(f,d,m,"playlist-key")});return c.catch(f=>this.handleError(f,e.frag)),this.keyIdToKeySessionPromise[i]=c,c}return o.catch(c=>{if(c instanceof ri){const f=dt({},c.data);this.getKeyStatus(t)==="internal-error"&&(f.decryptdata=t);const d=new ri(f,c.message);this.handleError(d,e.frag)}}),o}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof ri){t&&(e.data.frag=t);const i=e.data.decryptdata;this.error(`${e.message}${i?` (${Es(i.keyId||[])})`:""}`),this.hls.trigger(L.ERROR,e.data)}else this.error(e.message),this.hls.trigger(L.ERROR,{type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=Dd(e),i=this.keyIdToKeySessionPromise[t];if(!i){const n=Kd(e.keyFormat),a=n?[n]:il(this.config);return this.attemptKeySystemAccess(a)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=il(this.config)),e.length===0)throw new ri({type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Tt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const n=Promise.all(i).then(()=>this.media?this.media.setMediaKeys(t):new Promise((a,o)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return o(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(a).catch(o)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(n),n.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>i.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(e,t,i,n){var a;const o=(a=this.config.drmSystems)==null||(a=a[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const y=o.call(this.hls,t,i,e);if(!y)throw new Error("Invalid response from configured generateRequest filter");t=y.initDataType,i=y.initData?y.initData:null,e.decryptdata.pssh=i?new Uint8Array(i):null}catch(y){if(this.warn(y.message),this.hls&&this.hls.config.debug)throw y}if(i===null)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(e);const c=Dd(e.decryptdata),f=e.decryptdata.uri;this.log(`Generating key-session request for "${n}" keyId: ${c} URI: ${f} (init data type: ${t} length: ${i.byteLength})`);const d=new Jp,m=e._onmessage=y=>{const S=e.mediaKeysSession;if(!S){d.emit("error",new Error("invalid state"));return}const{messageType:A,message:R}=y;this.log(`"${A}" message event for session "${S.sessionId}" message size: ${R.byteLength}`),A==="license-request"||A==="license-renewal"?this.renewLicense(e,R).catch(C=>{d.eventNames().length?d.emit("error",C):this.handleError(C)}):A==="license-release"?e.keySystem===It.FAIRPLAY&&this.updateKeySession(e,$g("acknowledged")).then(()=>this.removeSession(e)).catch(C=>this.handleError(C)):this.warn(`unhandled media key message type "${A}"`)},g=(y,S)=>{S.keyStatus=y;let A;y.startsWith("usable")?d.emit("resolved"):y==="internal-error"||y==="output-restricted"||y==="output-downscaled"?A=B2(y,S.decryptdata):y==="expired"?A=new Error(`key expired (keyId: ${c})`):y==="released"?A=new Error("key released"):y==="status-pending"||this.warn(`unhandled key status change "${y}" (keyId: ${c})`),A&&(d.eventNames().length?d.emit("error",A):this.handleError(A))},p=e._onkeystatuseschange=y=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}const A=this.getKeyStatuses(e);if(!Object.keys(A).some(D=>A[D]!=="status-pending"))return;if(A[c]==="expired"){this.log(`Expired key ${Tt(A)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let C=A[c];if(C)g(C,e);else{var I;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(I=e.keyStatusTimeouts)[c]||(I[c]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const k=this.getKeyStatus(e.decryptdata);if(k&&k!=="status-pending")return this.log(`No status for keyId ${c} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${k} from other session.`),g(k,e);this.log(`key status for ${c} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),C="internal-error",g(C,e)},1e3)),this.log(`No status for keyId ${c} (${Tt(A)}).`)}};Ds(e.mediaKeysSession,"message",m),Ds(e.mediaKeysSession,"keystatuseschange",p);const T=new Promise((y,S)=>{d.on("error",S),d.on("resolved",y)});return e.mediaKeysSession.generateRequest(t,i).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${c} URI: ${f}`)}).catch(y=>{throw new ri({type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_SESSION,error:y,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>T).catch(y=>(d.removeAllListeners(),this.removeSession(e).then(()=>{throw y}))).then(()=>(d.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((i,n)=>{if(typeof n=="string"&&typeof i=="object"){const c=n;n=i,i=c}const a="buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n);if(e.keySystem===It.PLAYREADY&&a.length===16){const c=Es(a);t[c]=i,JA(a)}const o=Es(a);i==="internal-error"&&(this.bannedKeyIds[o]=i),this.log(`key status change "${i}" for keyStatuses keyId: ${o} key-session "${e.mediaKeysSession.sessionId}"`),t[o]=i}),t}fetchServerCertificate(e){const t=this.config,i=t.loader,n=new i(t),a=this.getServerCertificateUrl(e);return a?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,c)=>{const f={responseType:"arraybuffer",url:a},d=t.certLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,T,y,S)=>{o(p.data)},onError:(p,T,y,S)=>{c(new ri({type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:dt({url:f.url,data:void 0},p)},`"${e}" certificate request failed (${a}). Status: ${p.code} (${p.text})`))},onTimeout:(p,T,y)=>{c(new ri({type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:{url:f.url,data:void 0}},`"${e}" certificate request timed out (${a})`))},onAbort:(p,T,y)=>{c(new Error("aborted"))}};n.load(f,m,g)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((n,a)=>{e.setServerCertificate(i).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${i.byteLength}) on "${t}"`),n(e)}).catch(o=>{a(new ri({type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(i=>this.updateKeySession(e,new Uint8Array(i)).catch(n=>{throw new ri({type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:n,fatal:!1},n.message)}))}unpackPlayReadyKeyMessage(e,t){const i=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!i.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const n=new DOMParser().parseFromString(i,"application/xml"),a=n.querySelectorAll("HttpHeader");if(a.length>0){let m;for(let g=0,p=a.length;g<p;g++){var o,c;m=a[g];const T=(o=m.querySelector("name"))==null?void 0:o.textContent,y=(c=m.querySelector("value"))==null?void 0:c.textContent;T&&y&&e.setRequestHeader(T,y)}}const f=n.querySelector("Challenge"),d=f==null?void 0:f.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return $g(atob(d))}setupLicenseXHR(e,t,i,n){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return a.call(this.hls,e,t,i,n)}).catch(o=>{if(!i.decryptdata)throw o;return e.open("POST",t,!0),a.call(this.hls,e,t,i,n)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||n})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise((n,a)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(c.readyState===4)if(c.status===200){this._requestLicenseFailureCount=0;let f=c.response;this.log(`License received ${f instanceof ArrayBuffer?f.byteLength:f}`);const d=this.config.licenseResponseCallback;if(d)try{f=d.call(this.hls,c,o,e)}catch(m){this.error(m)}n(f)}else{const f=i.errorRetry,d=f?f.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||c.status>=400&&c.status<500)a(new ri({type:Ie.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:c,response:{url:o,data:void 0,code:c.status,text:c.statusText}},`License Request XHR failed (${o}). Status: ${c.status} (${c.statusText})`));else{const m=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(e,t).then(n,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=c,this.setupLicenseXHR(c,o,e,t).then(({xhr:f,licenseChallenge:d})=>{e.keySystem==It.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(f,d)),f.send(d)}).catch(a)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,Ds(i,"encrypted",this.onMediaEncrypted),Ds(i,"waitingforkey",this.onWaitingForKey);const n=this.mediaResolved;n?n():this.mediaKeys=i.mediaKeys}onMediaDetached(){const e=this.media;e&&(zs(e,"encrypted",this.onMediaEncrypted),zs(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const i=this.media,n=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,kr.clearKeyUriToKeyIdMap();const a=n.length;Ru.CDMCleanupPromise=Promise.all(n.map(o=>this.removeSession(o)).concat((i==null||(e=i.setMediaKeys(null))==null?void 0:e.catch(o=>{this.log(`Could not clear media keys: ${o}`),this.hls&&this.hls.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${o}`)})}))||Promise.resolve())).catch(o=>{this.log(`Could not close sessions and clear media keys: ${o}`),this.hls&&this.hls.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${o}`)})}).then(()=>{a&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=t.reduce((n,a)=>(n.indexOf(a.keyFormat)===-1&&n.push(a.keyFormat),n),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i,decryptdata:n}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Es((n==null?void 0:n.keyId)||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const a=this.mediaKeySessions.indexOf(e);a>-1&&this.mediaKeySessions.splice(a,1);const{keyStatusTimeouts:o}=e;o&&Object.keys(o).forEach(d=>self.clearTimeout(o[d]));const{drmSystemOptions:c}=this.config;return(d9(c)?new Promise((d,m)=>{self.setTimeout(()=>m(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(d).catch(m)}):Promise.resolve()).catch(d=>{this.log(`Could not remove session: ${d}`),this.hls&&this.hls.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${d}`)})}).then(()=>t.close()).catch(d=>{this.log(`Could not close session: ${d}`),this.hls&&this.hls.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${d}`)})})}return Promise.resolve()}}Ru.CDMCleanupPromise=void 0;function Dd(s){if(!s)throw new Error("Could not read keyId of undefined decryptdata");if(s.keyId===null)throw new Error("keyId is null");return Es(s.keyId)}function NB(s,e){if(s.keyId&&e.mediaKeysSession.keyStatuses.has(s.keyId))return e.mediaKeysSession.keyStatuses.get(s.keyId);if(s.matches(e.decryptdata))return e.keyStatus}class ri extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function B2(s,e){const t=s==="output-restricted",i=t?Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new ri({type:Ie.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${s}"`)}class DB{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(L.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(L.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&typeof n.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,i){const n=performance.now();if(t){if(this.lastTime){const a=n-this.lastTime,o=i-this.lastDroppedFrames,c=t-this.lastDecodedFrames,f=1e3*o/a,d=this.hls;if(d.trigger(L.FPS_DROP,{currentDropped:o,currentDecoded:c,totalDroppedFrames:i}),f>0&&o>d.config.fpsDroppedMonitoringThreshold*c){let m=d.currentLevel;d.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=m)&&(m=m-1,d.trigger(L.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:d.currentLevel}),d.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function V3(s,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=s,e.dispatchEvent(t)}function z3(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){ft.debug(`[texttrack-utils]: ${i}`);try{const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,s.addCue(n)}catch(n){ft.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}t==="disabled"&&(s.mode=t)}function vu(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues)for(let i=s.cues.length;i--;)e&&s.cues[i].removeEventListener("enter",e),s.removeCue(s.cues[i]);t==="disabled"&&(s.mode=t)}function Wg(s,e,t,i){const n=s.mode;if(n==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const a=OB(s.cues,e,t);for(let o=0;o<a.length;o++)(!i||i(a[o]))&&s.removeCue(a[o])}n==="disabled"&&(s.mode=n)}function wB(s,e){if(e<=s[0].startTime)return 0;const t=s.length-1;if(e>s[t].endTime)return-1;let i=0,n=t,a;for(;i<=n;)if(a=Math.floor((n+i)/2),e<s[a].startTime)n=a-1;else if(e>s[a].startTime&&i<t)i=a+1;else return a;return s[i].startTime-e<e-s[n].startTime?i:n}function OB(s,e,t){const i=[],n=wB(s,e);if(n>-1)for(let a=n,o=s.length;a<o;a++){const c=s[a];if(c.startTime>=e&&c.endTime<=t)i.push(c);else if(c.startTime>t)return i}return i}function Zd(s){const e=[];for(let t=0;t<s.length;t++){const i=s[t];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&e.push(s[t])}return e}class kB extends a1{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const i=Zd(this.media.textTracks);for(let a=0;a<i.length;a++)if(i[a].mode==="hidden")t=i[a];else if(i[a].mode==="showing"){t=i[a];break}const n=this.findTrackForTextTrack(t);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(L.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const i=this.media;if(!i)return;const n=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n)return;Zd(i.textTracks).forEach(o=>{vu(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,groupId:n,details:a}=t,o=this.tracksInGroup[i];if(!o||o.groupId!==n){this.warn(`Subtitle track with id:${i} and group:${n} not found in active group ${o==null?void 0:o.groupId}`);return}const c=o.details;o.details=t.details,this.log(`Subtitle track ${i} "${o.name}" lang:${o.lang} group:${n} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.subtitleGroups||null,n=this.groupIds;let a=this.currentTrack;if(!i||(n==null?void 0:n.length)!==(i==null?void 0:i.length)||i!=null&&i.some(o=>(n==null?void 0:n.indexOf(o))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(m=>!i||i.indexOf(m.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(m=>m.default)&&(this.selectDefaultTrack=!1),o.forEach((m,g)=>{m.id=g});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const c=this.hls.config.subtitlePreference;if(!a&&c){this.selectDefaultTrack=!1;const m=nn(c,o);if(m>-1)a=o[m];else{const g=nn(c,this.tracks);a=this.tracks[g]}}let f=this.findTrackId(a);f===-1&&a&&(f=this.findTrackId(null));const d={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${i==null?void 0:i.join(",")}" group-id`),this.hls.trigger(L.SUBTITLE_TRACKS_UPDATED,d),f!==-1&&this.trackId===-1&&this.setSubtitleTrack(f)}}findTrackId(e){const t=this.tracksInGroup,i=this.selectDefaultTrack;for(let n=0;n<t.length;n++){const a=t[n];if(!(i&&!a.default||!i&&!e)&&(!e||Ea(a,e)))return n}if(e){for(let n=0;n<t.length;n++){const a=t[n];if(Dl(e.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const a=t[n];if(Dl(e.attrs,a.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const n=t[i];if(Yg(n,e))return i}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Ge.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const i=this.currentTrack;if(i&&Ea(e,i))return i;const n=nn(e,this.tracksInGroup);if(n>-1){const a=this.tracksInGroup[n];return this.setSubtitleTrack(n),a}else{if(i)return null;{const a=nn(e,t);if(a>-1)return t[a]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,n=e.groupId,a=this.getUrlWithDirectives(e.url,t),o=e.details,c=o==null?void 0:o.age;this.log(`Loading subtitle ${i} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${a}`),this.hls.trigger(L.SUBTITLE_TRACK_LOADING,{url:a,id:i,groupId:n,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Zd(e.textTracks),i=this.currentTrack;let n;if(i&&(n=t.filter(a=>Yg(i,a))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(t).forEach(a=>{a.mode!=="disabled"&&a!==n&&(a.mode="disabled")}),n){const a=this.subtitleDisplay?"showing":"hidden";n.mode!==a&&(n.mode=a)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Se(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),!n){this.hls.trigger(L.SUBTITLE_TRACK_SWITCH,{id:e});return}const a=!!n.details&&!n.details.live;if(e===this.trackId&&n===i&&a)return;this.log(`Switching to subtitle-track ${e}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:o,groupId:c="",name:f,type:d,url:m}=n;this.hls.trigger(L.SUBTITLE_TRACK_SWITCH,{id:o,groupId:c,name:f,type:d,url:m});const g=this.switchParams(n.url,i==null?void 0:i.details,n.details);this.loadPlaylist(g)}}function MB(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const a=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n=="x"?a:a&3|8).toString(16)})}}}function hl(s){let e=5381,t=s.length;for(;t;)e=e*33^s.charCodeAt(--t);return(e>>>0).toString()}const Iu=.025;let Nf=(function(s){return s[s.Point=0]="Point",s[s.Range=1]="Range",s})({});function PB(s,e,t){return`${s.identifier}-${t+1}-${hl(e)}`}class UB{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const i=this.playoutLimit;return e<=0||isNaN(i)?!1:i===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>i}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Zm(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,i=Zm(t,e);return t-i<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Se(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Zm(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Iu))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Nf.Range:Nf.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return BB(this)}}function Zm(s,e){return s-e.start<e.duration/2&&!(Math.abs(s-(e.start+e.duration))<Iu)?e.start:e.start+e.duration}function Y3(s,e,t){const i=new self.URL(s,t);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",e),i}function Jm(s,e){for(;(t=s.assetList[++e])!=null&&t.error;)var t;return e}function BB(s){return`["${s.identifier}" ${s.cue.pre?"<pre>":s.cue.post?"<post>":""}${s.timelineStart.toFixed(2)}-${s.resumeTime.toFixed(2)}]`}function Tu(s){const e=s.timelineStart,t=s.duration||0;return`["${s.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class FB{constructor(e,t,i,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(L.PLAYOUT_LIMIT_REACHED,{})};const a=this.hls=new e(t);this.interstitial=i,this.assetItem=n;const o=()=>{this.hasDetails=!0};a.once(L.LEVEL_LOADED,o),a.once(L.AUDIO_TRACK_LOADED,o),a.once(L.SUBTITLE_TRACK_LOADED,o),a.on(L.MEDIA_ATTACHING,(c,{media:f})=>{this.removeMediaListeners(),this.mediaAttached=f,this.interstitial.playoutLimit&&(f.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&a.on(L.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,a.trigger(L.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=Y3(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const i=Math.min(this._bufferedEosTime||1/0,this.duration),n=this.timelineOffset,a=Ue.bufferInfo(e,n,0);return this.getAssetTime(a.end)>=i-.02}reachedPlayout(e){const i=this.interstitial.playoutLimit;return this.startOffset+e>=i}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Ue.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const i=t-this.startOffset;if(i>0&&i<e)return i}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const i=e-t;if(Math.abs(i)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,e-t),i)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=i=>delete i.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,i){var n;(n=this.hls)==null||n.on(e,t)}once(e,t,i){var n;(n=this.hls)==null||n.once(e,t)}off(e,t,i){var n;(n=this.hls)==null||n.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Tu(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const F2=.033;class HB extends Li{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((i,n)=>e<=n.startOffset&&t>n.startOffset?(delete n.error,i+1):i,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let i=-1;e.nextEvent?i=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(i=this.findEventIndex(e.previousEvent.identifier)+1);const n=this.items;if(n)for(n[i]||(t===void 0&&(t=e.start),i=this.findItemIndexAtTime(t));i>=0&&(a=n[i])!=null&&a.event;){var a;i--}return i}findItemIndexAtTime(e,t){const i=this.items;if(i)for(let n=0;n<i.length;n++){let a=i[n];if(t&&t!=="primary"&&(a=a[t]),e===a.start||e>a.start&&e<a.end)return n}return-1}findJumpRestrictedIndex(e,t){const i=this.items;if(i)for(let n=e;n<=t&&i[n];n++){const a=i[n].event;if(a!=null&&a.restrictions.jump&&!a.appendInPlace)return n}return-1}findEventIndex(e){const t=this.items;if(t)for(let n=t.length;n--;){var i;if(((i=t[n].event)==null?void 0:i.identifier)===e)return n}return-1}findAssetIndex(e,t){const i=e.assetList,n=i.length;if(n>1)for(let a=0;a<n;a++){const o=i[a];if(!o.error){const c=o.timelineStart;if(t===c||t>c&&(t<c+(o.duration||0)||a===n-1))return a}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const i=t.assetList,n=i[i.length-1];if(n)return n.identifier}return null}parseInterstitialDateRanges(e,t){const i=e.main.details,{dateRanges:n}=i,a=this.events,o=this.parseDateRanges(n,{url:i.url},t),c=Object.keys(n),f=a?a.filter(d=>!c.includes(d.identifier)):[];o.length&&o.sort((d,m)=>{const g=d.cue.pre,p=d.cue.post,T=m.cue.pre,y=m.cue.post;if(g&&!T)return-1;if(T&&!g||p&&!y)return 1;if(y&&!p)return-1;if(!g&&!T&&!p&&!y){const S=d.startTime,A=m.startTime;if(S!==A)return S-A}return d.dateRange.tagOrder-m.dateRange.tagOrder}),this.events=o,f.forEach(d=>{this.removeEvent(d)}),this.updateSchedule(e,f)}updateSchedule(e,t=[],i=!1){const n=this.events||[];if(n.length||t.length||this.length<2){const a=this.items,o=this.parseSchedule(n,e);(i||t.length||(a==null?void 0:a.length)!==o.length||o.some((f,d)=>Math.abs(f.playout.start-a[d].playout.start)>.005||Math.abs(f.playout.end-a[d].playout.end)>.005))&&(this.items=o,this.onScheduleUpdate(t,a))}}parseDateRanges(e,t,i){const n=[],a=Object.keys(e);for(let o=0;o<a.length;o++){const c=a[o],f=e[c];if(f.isInterstitial){let d=this.eventMap[c];d?d.setDateRange(f):(d=new UB(f,t),this.eventMap[c]=d,i===!1&&(d.appendInPlace=i)),n.push(d)}}return n}parseSchedule(e,t){const i=[],n=t.main.details,a=n.live?1/0:n.edge;let o=0;if(e=e.filter(f=>!f.error&&!(f.cue.once&&f.hasPlayed)),e.length){this.resolveOffsets(e,t);let f=0,d=0;if(e.forEach((m,g)=>{const p=m.cue.pre,T=m.cue.post,y=e[g-1]||null,S=m.appendInPlace,A=T?a:m.startOffset,R=m.duration,C=m.timelineOccupancy===Nf.Range?R:0,I=m.resumptionOffset,D=(y==null?void 0:y.startTime)===A,k=A+m.cumulativeDuration;let z=S?k+R:A+I;if(p||!T&&A<=0){const V=d;d+=C,m.timelineStart=k;const $=o;o+=R,i.push({event:m,start:k,end:z,playout:{start:$,end:o},integrated:{start:V,end:d}})}else if(A<=a){if(!D){const j=A-f;if(j>F2){const te=f,ge=d;d+=j;const ye=o;o+=j;const ve={previousEvent:e[g-1]||null,nextEvent:m,start:te,end:te+j,playout:{start:ye,end:o},integrated:{start:ge,end:d}};i.push(ve)}else j>0&&y&&(y.cumulativeDuration+=j,i[i.length-1].end=A)}T&&(z=k),m.timelineStart=k;const V=d;d+=C;const $=o;o+=R,i.push({event:m,start:k,end:z,playout:{start:$,end:o},integrated:{start:V,end:d}})}else return;const P=m.resumeTime;T||P>a?f=a:f=P}),f<a){var c;const m=f,g=d,p=a-f;d+=p;const T=o;o+=p,i.push({previousEvent:((c=i[i.length-1])==null?void 0:c.event)||null,nextEvent:null,start:f,end:m+p,playout:{start:T,end:o},integrated:{start:g,end:d}})}this.setDurations(a,o,d)}else i.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return i}setDurations(e,t,i){this.durations={primary:e,playout:t,integrated:i}}resolveOffsets(e,t){const i=t.main.details,n=i.live?1/0:i.edge;let a=0,o=-1;e.forEach((c,f)=>{const d=c.cue.pre,m=c.cue.post,g=d?0:m?n:c.startTime;this.updateAssetDurations(c),o===g?c.cumulativeDuration=a:(a=0,o=g),!m&&c.snapOptions.in&&(c.resumeAnchor=Sa(null,i.fragments,c.startOffset+c.resumptionOffset,0,0)||void 0),c.appendInPlace&&!c.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(c,t)||(c.appendInPlace=!1)),!c.appendInPlace&&f+1<e.length&&e[f+1].startTime-e[f].resumeTime<F2&&(e[f+1].appendInPlace=!1,e[f+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${c}`));const T=Se(c.resumeOffset)?c.resumeOffset:c.duration;a+=T})}primaryCanResumeInPlaceAt(e,t){const i=e.resumeTime,n=e.startTime+e.resumptionOffset;return Math.abs(i-n)>Iu?(this.log(`"${e.identifier}" resumption ${i} not aligned with estimated timeline end ${n}`),!1):!Object.keys(t).some(o=>{const c=t[o].details,f=c.edge;if(i>=f)return this.log(`"${e.identifier}" resumption ${i} past ${o} playlist end ${f}`),!1;const d=Sa(null,c.fragments,i);if(!d)return this.log(`"${e.identifier}" resumption ${i} does not align with any fragments in ${o} playlist (${c.fragStart}-${c.fragmentEnd})`),!0;const m=o==="audio"?.175:0;return Math.abs(d.start-i)<Iu+m||Math.abs(d.end-i)<Iu+m?!1:(this.log(`"${e.identifier}" resumption ${i} not aligned with ${o} fragment bounds (${d.start}-${d.end} sn: ${d.sn} cc: ${d.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let i=0,n=!1,a=!1;for(let o=0;o<e.assetList.length;o++){const c=e.assetList[o],f=t+i;c.startOffset=i,c.timelineStart=f,n||(n=c.duration===null),a||(a=!!c.error);const d=c.error?0:c.duration||0;i+=d}n&&!a?e.duration=Math.max(i,e.duration):e.duration=i}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function wi(s){return`[${s.event?'"'+s.event.identifier+'"':"primary"}: ${s.start.toFixed(2)}-${s.end.toFixed(2)}]`}class jB{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const i=e.assetListUrl;let n;try{n=Y3(i,this.hls.sessionId,e.baseUrl)}catch(p){const T=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_ERROR,p,i);this.hls.trigger(L.ERROR,T);return}t&&n.protocol!=="data:"&&n.searchParams.set("_HLS_start_offset",""+t);const a=this.hls.config,o=a.loader,c=new o(a),f={responseType:"json",url:n.href},d=a.interstitialAssetListLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,T,y,S)=>{const A=p.data,R=A==null?void 0:A.ASSETS;if(!Array.isArray(R)){const C=this.assignAssetListError(e,Q.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),y.url,T,S);this.hls.trigger(L.ERROR,C);return}e.assetListResponse=A,this.hls.trigger(L.ASSET_LIST_LOADED,{event:e,assetListResponse:A,networkDetails:S})},onError:(p,T,y,S)=>{const A=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${p.code} ${p.text} (${T.url})`),T.url,S,y);this.hls.trigger(L.ERROR,A)},onTimeout:(p,T,y)=>{const S=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${T.url})`),T.url,p,y);this.hls.trigger(L.ERROR,S)}};return c.load(f,m,g),this.hls.trigger(L.ASSET_LIST_LOADING,{event:e}),c}assignAssetListError(e,t,i,n,a,o){return e.error=i,{type:Ie.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:n,error:i,networkDetails:o,stats:a}}}function H2(s){var e;s==null||(e=s.play())==null||e.catch(()=>{})}function wd(s,e){return`[${s}] Advancing timeline position to ${e}`}class $B extends Li{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled||!this.schedule)return;const n=i-this.timelinePos;if(Math.abs(n)<1/7056e5)return;const o=n<=-.01;this.timelinePos=i,this.bufferedPos=i;const c=this.playingItem;if(!c){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(i,i-n)&&this.updateSchedule(!0),this.checkBuffer(),o&&i<c.start||i>=c.end){var f;const T=this.findItemIndex(c);let y=this.schedule.findItemIndexAtTime(i);if(y===-1&&(y=T+(o?-1:1),this.log(`seeked ${o?"back ":""}to position not covered by schedule ${i} (resolving from ${T} to ${y})`)),!this.isInterstitial(c)&&(f=this.media)!=null&&f.paused&&(this.shouldPlay=!1),!o&&y>T){const S=this.schedule.findJumpRestrictedIndex(T+1,y);if(S>T){this.setSchedulePosition(S);return}}this.setSchedulePosition(y);return}const d=this.playingAsset;if(!d){if(this.playingLastItem&&this.isInterstitial(c)){const T=c.event.assetList[0];T&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,T))}return}const m=d.timelineStart,g=d.duration||0;if(o&&i<m||i>=m+g){var p;(p=c.event)!=null&&p.appendInPlace&&(this.clearAssetPlayers(c.event,c),this.flushFrontBuffer(i)),this.setScheduleToAssetAtTime(i,d)}},this.onTimeupdate=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;const n=this.playingItem;if(!n||this.playingLastItem)return;if(i>=n.end){this.timelinePos=n.end;const c=this.findItemIndex(n);this.setSchedulePosition(c+1)}const a=this.playingAsset;if(!a)return;const o=a.timelineStart+(a.duration||0);i>=o&&this.setScheduleToAssetAtTime(i,a)},this.onScheduleUpdate=(i,n)=>{const a=this.schedule;if(!a)return;const o=this.playingItem,c=a.events||[],f=a.items||[],d=a.durations,m=i.map(S=>S.identifier),g=!!(c.length||m.length);(g||n)&&this.log(`INTERSTITIALS_UPDATED (${c.length}): ${c}
Schedule: ${f.map(S=>wi(S))} pos: ${this.timelinePos}`),m.length&&this.log(`Removed events ${m}`);let p=null,T=null;o&&(p=this.updateItem(o,this.timelinePos),this.itemsMatch(o,p)?this.playingItem=p:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const y=this.bufferingItem;if(y&&(T=this.updateItem(y,this.bufferedPos),this.itemsMatch(y,T)?this.bufferingItem=T:y.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(y.event,null))),i.forEach(S=>{S.assetList.forEach(A=>{this.clearAssetPlayer(A.identifier,null)})}),this.playerQueue.forEach(S=>{if(S.interstitial.appendInPlace){const A=S.assetItem.timelineStart,R=S.timelineOffset-A;if(R)try{S.timelineOffset=A}catch(C){Math.abs(R)>Iu&&this.warn(`${C} ("${S.assetId}" ${S.timelineOffset}->${A})`)}}}),g||n){if(this.hls.trigger(L.INTERSTITIALS_UPDATED,{events:c.slice(0),schedule:f.slice(0),durations:d,removedIds:m}),this.isInterstitial(o)&&m.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}o&&this.trimInPlace(p,o),y&&T!==p&&this.trimInPlace(T,y),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new jB(e),this.schedule=new HB(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(L.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(L.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(L.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(L.MEDIA_ENDED,this.onMediaEnded,this),e.on(L.ERROR,this.onError,this),e.on(L.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(L.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(L.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(L.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(L.MEDIA_ENDED,this.onMediaEnded,this),e.off(L.ERROR,this.onError,this),e.off(L.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){zs(e,"play",this.onPlay),zs(e,"pause",this.onPause),zs(e,"seeking",this.onSeeking),zs(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const i=this.media=t.media;Ds(i,"seeking",this.onSeeking),Ds(i,"timeupdate",this.onTimeupdate),Ds(i,"play",this.onPlay),Ds(i,"pause",this.onPause)}onMediaAttached(e,t){const i=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!n){this.clearScheduleState();const a=this.findItemIndex(i);this.setSchedulePosition(a)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const i=!!t.transferMedia,n=this.media;if(this.media=null,!i&&(n&&this.removeMediaListeners(n),this.detachedData)){const a=this.getBufferingPlayer();a&&(this.log(`Removing schedule state for detachedData and ${a}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,i=g=>g&&e.getAssetPlayer(g.identifier),n=(g,p,T,y,S)=>{if(g){let A=g[p].start;const R=g.event;if(R){if(p==="playout"||R.timelineOccupancy!==Nf.Point){const C=i(T);(C==null?void 0:C.interstitial)===R&&(A+=C.assetItem.startOffset+C[S])}}else{const C=y==="bufferedPos"?o():e[y];A+=C-g.start}return A}return 0},a=(g,p)=>{var T;if(g!==0&&p!=="primary"&&(T=e.schedule)!=null&&T.length){var y;const S=e.schedule.findItemIndexAtTime(g),A=(y=e.schedule.items)==null?void 0:y[S];if(A){const R=A[p].start-A.start;return g+R}}return g},o=()=>{const g=e.bufferedPos;return g===Number.MAX_VALUE?c("primary"):Math.max(g,0)},c=g=>{var p,T;return(p=e.primaryDetails)!=null&&p.live?e.primaryDetails.edge:((T=e.schedule)==null?void 0:T.durations[g])||0},f=(g,p)=>{var T,y;const S=e.effectivePlayingItem;if(S!=null&&(T=S.event)!=null&&T.restrictions.skip||!e.schedule)return;e.log(`seek to ${g} "${p}"`);const A=e.effectivePlayingItem,R=e.schedule.findItemIndexAtTime(g,p),C=(y=e.schedule.items)==null?void 0:y[R],I=e.getBufferingPlayer(),D=I==null?void 0:I.interstitial,k=D==null?void 0:D.appendInPlace,z=A&&e.itemsMatch(A,C);if(A&&(k||z)){const P=i(e.playingAsset),V=(P==null?void 0:P.media)||e.primaryMedia;if(V){const $=p==="primary"?V.currentTime:n(A,p,e.playingAsset,"timelinePos","currentTime"),j=g-$,te=(k?$:V.currentTime)+j;if(te>=0&&(!P||k||te<=P.duration)){V.currentTime=te;return}}}if(C){let P=g;if(p!=="primary"){const $=C[p].start,j=g-$;P=C.start+j}const V=!e.isInterstitial(C);if((!e.isInterstitial(A)||A.event.appendInPlace)&&(V||C.event.appendInPlace)){const $=e.media||(k?I==null?void 0:I.media:null);$&&($.currentTime=P)}else if(A){const $=e.findItemIndex(A);if(R>$){const te=e.schedule.findJumpRestrictedIndex($+1,R);if(te>$){e.setSchedulePosition(te);return}}let j=0;if(V)e.timelinePos=P,e.checkBuffer();else{const te=C.event.assetList,ge=g-(C[p]||C).start;for(let ye=te.length;ye--;){const ve=te[ye];if(ve.duration&&ge>=ve.startOffset&&ge<ve.startOffset+ve.duration){j=ye;break}}}e.setSchedulePosition(R,j)}}},d=()=>{const g=e.effectivePlayingItem;if(e.isInterstitial(g))return g;const p=t();return e.isInterstitial(p)?p:null},m={get bufferedEnd(){const g=t(),p=e.bufferingItem;if(p&&p===g){var T;return n(p,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-p.playout.start||((T=e.bufferingAsset)==null?void 0:T.startOffset)||0}return 0},get currentTime(){const g=d(),p=e.effectivePlayingItem;return p&&p===g?n(p,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-p.playout.start:0},set currentTime(g){const p=d(),T=e.effectivePlayingItem;T&&T===p&&f(g+T.playout.start,"playout")},get duration(){const g=d();return g?g.playout.end-g.playout.start:0},get assetPlayers(){var g;const p=(g=d())==null?void 0:g.event.assetList;return p?p.map(T=>e.getAssetPlayer(T.identifier)):[]},get playingIndex(){var g;const p=(g=d())==null?void 0:g.event;return p&&e.effectivePlayingAsset?p.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return d()}};return this.manager={get events(){var g;return((g=e.schedule)==null||(g=g.events)==null?void 0:g.slice(0))||[]},get schedule(){var g;return((g=e.schedule)==null||(g=g.items)==null?void 0:g.slice(0))||[]},get interstitialPlayer(){return d()?m:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const g=t();return e.findItemIndex(g)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const g=e.effectivePlayingItem;return e.findItemIndex(g)},primary:{get bufferedEnd(){return o()},get currentTime(){const g=e.timelinePos;return g>0?g:0},set currentTime(g){f(g,"primary")},get duration(){return c("primary")},get seekableStart(){var g;return((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(g){f(g,"integrated")},get duration(){return c("integrated")},get seekableStart(){var g;return a(((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0,"integrated")}},skip:()=>{const g=e.effectivePlayingItem,p=g==null?void 0:g.event;if(p&&!p.restrictions.skip){const T=e.findItemIndex(g);if(p.appendInPlace){const y=g.playout.start+g.event.duration;f(y+.001,"playout")}else e.advanceAfterAssetEnded(p,T,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,i=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!i?!1:this.findItemIndex(t)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let n=this.media;!n&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(n=this.primaryMedia);const a=(t=n)==null?void 0:t.currentTime;if(!(a===void 0||!Se(a)))return a}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const i=this.getAssetPlayer(e);i&&this.transferMediaFromPlayer(i,t)}transferMediaFromPlayer(e,t){const i=e.interstitial.appendInPlace,n=e.media;if(i&&n===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&n){this.detachedData={media:n};return}const a=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Tt(a)}`),this.detachedData=a}else t&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(e,t){var i,n;if(e.media===t)return;let a=null;const o=this.hls,c=e!==o,f=c&&e.interstitial.appendInPlace,d=(i=this.detachedData)==null?void 0:i.mediaSource;let m;if(o.media)f&&(a=o.transferMedia(),this.detachedData=a),m="Primary";else if(d){const y=this.getBufferingPlayer();y?(a=y.transferMedia(),m=`${y}`):m="detached MediaSource"}else m="detached media";if(!a){if(d)a=this.detachedData,this.log(`using detachedData: MediaSource ${Tt(a)}`);else if(!this.detachedData||o.media===t){const y=this.playerQueue;y.length>1&&y.forEach(S=>{if(c&&S.interstitial.appendInPlace!==f){const A=S.interstitial;this.clearInterstitial(S.interstitial,null),A.appendInPlace=!1,A.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${A}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const g=a&&"mediaSource"in a&&((n=a.mediaSource)==null?void 0:n.readyState)!=="closed",p=g&&a?a:t;this.log(`${g?"transfering MediaSource":"attaching media"} to ${c?e:"Primary"} from ${m} (media.currentTime: ${t.currentTime})`);const T=this.schedule;if(p===a&&T){const y=c&&e.assetId===T.assetIdAtEnd;p.overrides={duration:T.duration,endOfStream:!c||y,cueRemoval:!c}}e.attachMedia(p)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e==null?void 0:e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const i=this.timelinePos,n=this.effectivePlayingItem;if(i===-1){const a=this.hls.startPosition;if(this.log(wd("checkStart",a)),this.timelinePos=a,t.length&&t[0].cue.pre){const o=e.findEventIndex(t[0].identifier);this.setSchedulePosition(o)}else if(a>=0||!this.primaryLive){const o=this.timelinePos=a>0?a:0,c=e.findItemIndexAtTime(o);this.setSchedulePosition(c)}}else if(n&&!this.playingItem){const a=e.findItemIndex(n);this.setSchedulePosition(a)}}advanceAssetBuffering(e,t){const i=e.event,n=i.findAssetIndex(t),a=Jm(i,n);if(!i.isAssetPastPlayoutLimit(a))this.bufferedToEvent(e,a);else if(this.schedule){var o;const c=(o=this.schedule.items)==null?void 0:o[this.findItemIndex(e)+1];c&&this.bufferedToItem(c)}}advanceAfterAssetEnded(e,t,i){const n=Jm(e,i);if(e.isAssetPastPlayoutLimit(n)){if(this.schedule){const a=this.schedule.items;if(a){const o=t+1,c=a.length;if(o>=c){this.setSchedulePosition(-1);return}const f=e.resumeTime;this.timelinePos<f&&(this.log(wd("advanceAfterAssetEnded",f)),this.timelinePos=f,e.appendInPlace&&this.advanceInPlace(f),this.checkBuffer(this.bufferedPos<f)),this.setSchedulePosition(o)}}}else{if(e.appendInPlace){const a=e.assetList[n];a&&this.advanceInPlace(a.timelineStart)}this.setSchedulePosition(t,n)}}setScheduleToAssetAtTime(e,t){const i=this.schedule;if(!i)return;const n=t.parentIdentifier,a=i.getEvent(n);if(a){const o=i.findEventIndex(n),c=i.findAssetIndex(a,e);this.advanceAfterAssetEnded(a,o,c-1)}}setSchedulePosition(e,t){var i;const n=(i=this.schedule)==null?void 0:i.items;if(!n||this.playbackDisabled)return;const a=e>=0?n[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${a&&wi(a)}) pos: ${this.timelinePos}`);const o=this.waitingItem||this.playingItem,c=this.playingLastItem;if(this.isInterstitial(o)){const m=o.event,g=this.playingAsset,p=g==null?void 0:g.identifier,T=p?this.getAssetPlayer(p):null;if(T&&p&&(!this.eventItemsMatch(o,a)||t!==void 0&&p!==m.assetList[t].identifier)){var f;const y=m.findAssetIndex(g);if(this.log(`INTERSTITIAL_ASSET_ENDED ${y+1}/${m.assetList.length} ${Tu(g)}`),this.endedAsset=g,this.playingAsset=null,this.hls.trigger(L.INTERSTITIAL_ASSET_ENDED,{asset:g,assetListIndex:y,event:m,schedule:n.slice(0),scheduleIndex:e,player:T}),o!==this.playingItem){this.itemsMatch(o,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(m,this.findItemIndex(this.playingItem),y);return}this.retreiveMediaSource(p,a),T.media&&!((f=this.detachedData)!=null&&f.mediaSource)&&T.detachMedia()}if(!this.eventItemsMatch(o,a)&&(this.endedItem=o,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${m} ${wi(o)}`),m.hasPlayed=!0,this.hls.trigger(L.INTERSTITIAL_ENDED,{event:m,schedule:n.slice(0),scheduleIndex:e}),m.cue.once)){var d;this.updateSchedule();const y=(d=this.schedule)==null?void 0:d.items;if(a&&y){const S=this.findItemIndex(a);this.advanceSchedule(S,y,t,o,c)}return}}this.advanceSchedule(e,n,t,o,c)}advanceSchedule(e,t,i,n,a){const o=this.schedule;if(!o)return;const c=t[e]||null,f=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(m=>{const g=m.interstitial,p=o.findEventIndex(g.identifier);(p<e||p>e+1)&&this.clearInterstitial(g,c)}),this.isInterstitial(c)){this.timelinePos=Math.min(Math.max(this.timelinePos,c.start),c.end);const m=c.event;if(i===void 0){i=o.findAssetIndex(m,this.timelinePos);const y=Jm(m,i-1);if(m.isAssetPastPlayoutLimit(y)||m.appendInPlace&&this.timelinePos===c.end){this.advanceAfterAssetEnded(m,e,i);return}i=y}const g=this.waitingItem;this.assetsBuffered(c,f)||this.setBufferingItem(c);let p=this.preloadAssets(m,i);if(this.eventItemsMatch(c,g||n)||(this.waitingItem=c,this.log(`INTERSTITIAL_STARTED ${wi(c)} ${m.appendInPlace?"append in place":""}`),this.hls.trigger(L.INTERSTITIAL_STARTED,{event:m,schedule:t.slice(0),scheduleIndex:e})),!m.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${m}`);return}if(m.assetListLoader&&(m.assetListLoader.destroy(),m.assetListLoader=void 0),!f){this.log(`Waiting for attachMedia to start Interstitial ${m}`);return}this.waitingItem=this.endedItem=null,this.playingItem=c;const T=m.assetList[i];if(!T){this.advanceAfterAssetEnded(m,e,i||0);return}if(p||(p=this.getAssetPlayer(T.identifier)),p===null||p.destroyed){const y=m.assetList.length;this.warn(`asset ${i+1}/${y} player destroyed ${m}`),p=this.createAssetPlayer(m,T,i),p.loadSource()}if(!this.eventItemsMatch(c,this.bufferingItem)&&m.appendInPlace&&this.isAssetBuffered(T))return;this.startAssetPlayer(p,i,t,e,f),this.shouldPlay&&H2(p.media)}else c?(this.resumePrimary(c,e,n),this.shouldPlay&&H2(this.hls.media)):a&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(o.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,i){var n,a;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${wi(e)}`),!((n=this.detachedData)!=null&&n.mediaSource)){let c=this.timelinePos;(c<e.start||c>=e.end)&&(c=this.getPrimaryResumption(e,t),this.log(wd("resumePrimary",c)),this.timelinePos=c),this.attachPrimary(c,e)}if(!i)return;const o=(a=this.schedule)==null?void 0:a.items;o&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${wi(e)}`),this.hls.trigger(L.INTERSTITIALS_PRIMARY_RESUMED,{schedule:o.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const i=e.start;if(this.primaryLive){const n=this.primaryDetails;if(t===0)return this.hls.startPosition;if(n&&(i<n.fragmentStart||i>n.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Ue.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,i){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,n),i&&this.startLoadingPrimaryAt(e,i)),i||(this.log(wd("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,i))}startLoadingPrimaryAt(e,t){var i;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs((((i=n.mainForwardBufferInfo)==null?void 0:i.start)||n.media.currentTime)-e)>.5?n.startLoad(e,t):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(L.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(L.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const i=this.hls.levels[t.level];if(!i.details)return;const n=dt(dt({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const i=this.hls.audioTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=dt(dt({},this.altSelection),{},{audio:i});return}const a=dt(dt({},n),{},{audio:i});this.mediaSelection=a}onSubtitleTrackUpdated(e,t){const i=this.hls.subtitleTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=dt(dt({},this.altSelection),{},{subtitles:i});return}const a=dt(dt({},n),{},{subtitles:i});this.mediaSelection=a}onAudioTrackSwitching(e,t){const i=QT(t);this.playerQueue.forEach(({hls:n})=>n&&(n.setAudioOption(t)||n.setAudioOption(i)))}onSubtitleTrackSwitch(e,t){const i=QT(t);this.playerQueue.forEach(({hls:n})=>n&&(n.setSubtitleOption(t)||t.id!==-1&&n.setSubtitleOption(i)))}onBufferCodecs(e,t){const i=t.tracks;i&&(this.requiredTracks=i)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let n=0;n<t.length;n++){const a=t[n];if(a.cue.post){var i;const o=this.schedule.findEventIndex(a.identifier),c=(i=this.schedule.items)==null?void 0:i[o];this.isInterstitial(c)&&this.eventItemsMatch(c,this.bufferingItem)&&this.bufferedToItem(c,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const i=this.findItemIndex(t);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(e,t){var i;const n=(i=this.schedule)==null?void 0:i.items;if(e&&n){const a=this.findItemIndex(e,t);return n[a]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((a,o)=>{e.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(a.identifier,null)});const i=e.end+.25,n=Ue.bufferInfo(this.primaryMedia,i,0);(n.end>i||(n.nextStart||0)>i)&&(this.log(`trim buffered interstitial ${wi(e)} (was ${wi(t)})`),this.attachPrimary(i,null,!0),this.flushFrontBuffer(i))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var i;return!!t&&(e===t||e.event.identifier===((i=t.event)==null?void 0:i.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const i=this.mediaSelection;i&&((t=this.schedule)==null||t.updateSchedule(i,[],e))}checkBuffer(e){var t;const i=(t=this.schedule)==null?void 0:t.items;if(!i)return;const n=Ue.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,i,e)}updateBufferedPos(e,t,i){const n=this.schedule,a=this.bufferingItem;if(this.bufferedPos>e||!n)return;if(t.length===1&&this.itemsMatch(t[0],a)){this.bufferedPos=e;return}const o=this.playingItem,c=this.findItemIndex(o);let f=n.findItemIndexAtTime(e);if(this.bufferedPos<e){var d;const m=this.findItemIndex(a),g=Math.min(m+1,t.length-1),p=t[g];if((f===-1&&a&&e>=a.end||(d=p.event)!=null&&d.appendInPlace&&e+.01>=p.start)&&(f=g),this.isInterstitial(a)){const T=a.event;if(g-c>1&&T.appendInPlace===!1||T.assetList.length===0&&T.assetListLoader)return}if(this.bufferedPos=e,f>m&&f>c)this.bufferedToItem(p);else{const T=this.primaryDetails;this.primaryLive&&T&&e>T.edge-T.targetduration&&p.start<T.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(p)&&this.preloadAssets(p.event,0)}}else i&&o&&!this.itemsMatch(o,a)&&(f===c?this.bufferedToItem(o):f===c+1&&this.bufferedToItem(t[f]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(n=>{const a=this.getAssetPlayer(n.identifier);return!(a!=null&&a.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,i=this.schedule;if(!this.itemsMatch(e,t)&&i){const{items:n,events:a}=i;if(!n||!a)return t;const o=this.isInterstitial(e),c=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const f=c?c.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${wi(e)}`+(t?` (${f.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(o){const d=i.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((m,g)=>{const p=this.getAssetPlayer(m.identifier);p&&(g===d&&p.loadSource(),p.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(d=>d.pauseBuffering());this.hls.trigger(L.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const i=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(i!==null){this.bufferingAsset=null;const n=this.detachedData;n?n.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),i=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(i)}bufferedToEvent(e,t){const i=e.event,n=i.assetList.length===0&&!i.assetListLoader,a=i.cue.once;if(n||!a){const o=this.preloadAssets(i,t);if(o!=null&&o.interstitial.appendInPlace){const c=this.primaryMedia;c&&this.bufferAssetPlayer(o,c)}}}preloadAssets(e,t){const i=e.assetUrl,n=e.assetList.length,a=n===0&&!e.assetListLoader,o=e.cue.once;if(a){const f=e.timelineStart;if(e.appendInPlace){var c;const p=this.playingItem;!this.isInterstitial(p)&&(p==null||(c=p.nextEvent)==null?void 0:c.identifier)===e.identifier&&this.flushFrontBuffer(f+.25)}let d,m=0;if(!this.playingItem&&this.primaryLive&&(m=this.hls.startPosition,m===-1&&(m=this.hls.liveSyncPosition||0)),m&&!(e.cue.pre||e.cue.post)){const p=m-f;p>0&&(d=Math.round(p*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${i?1:n} ${e}${d?` live-start: ${m} start-offset: ${d}`:""}`),i)return this.createAsset(e,0,0,f,e.duration,i);const g=this.assetListLoader.loadAssetList(e,d);g&&(e.assetListLoader=g)}else if(!o&&n){for(let d=t;d<n;d++){const m=e.assetList[d],g=this.getAssetPlayerQueueIndex(m.identifier);(g===-1||this.playerQueue[g].destroyed)&&!m.error&&this.createAssetPlayer(e,m,d)}const f=e.assetList[t];if(f){const d=this.getAssetPlayer(f.identifier);return d&&d.loadSource(),d}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(n=>{this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:n})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let i=0;i<t.length;i++)if(e===t[i].assetId)return i;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let i=0;i<e.length;i++)if(e[i].media===t)return e[i]}return null}createAsset(e,t,i,n,a,o){const c={parentIdentifier:e.identifier,identifier:PB(e,o,t),duration:a,startOffset:i,timelineStart:n,uri:o};return this.createAssetPlayer(e,c,t)}createAssetPlayer(e,t,i){const n=this.hls,a=n.userConfig;let o=a.videoPreference;const c=n.loadLevelObj||n.levels[n.currentLevel];(o||c)&&(o=bt({},o),c.videoCodec&&(o.videoCodec=c.videoCodec),c.videoRange&&(o.allowedVideoRanges=[c.videoRange]));const f=n.audioTracks[n.audioTrack],d=n.subtitleTracks[n.subtitleTrack];let m=0;if(this.primaryLive||e.appendInPlace){const D=this.timelinePos-t.timelineStart;if(D>1){const k=t.duration;k&&D<k&&(m=D)}}const g=t.identifier,p=dt(dt({},a),{},{maxMaxBufferLength:Math.min(180,n.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:g,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:m,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:f||a.audioPreference,subtitlePreference:d||a.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(p.timelineOffset=t.timelineStart));const T=p.cmcd;T!=null&&T.sessionId&&T.contentId&&(p.cmcd=bt({},T,{contentId:hl(t.uri)})),this.getAssetPlayer(g)&&this.warn(`Duplicate date range identifier ${e} and asset ${g}`);const y=new FB(this.HlsPlayerClass,p,e,t);this.playerQueue.push(y),e.assetList[i]=t;let S=!0;const A=D=>{if(D.live){var k;const V=new Error(`Interstitials MUST be VOD assets ${e}`),$={fatal:!0,type:Ie.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:V},j=((k=this.schedule)==null?void 0:k.findEventIndex(e.identifier))||-1;this.handleAssetItemError($,e,j,i,V.message);return}const z=D.edge-D.fragmentStart,P=t.duration;(S||P===null||z>P)&&(S=!1,this.log(`Interstitial asset "${g}" duration change ${P} > ${z}`),t.duration=z,this.updateSchedule())};y.on(L.LEVEL_UPDATED,(D,{details:k})=>A(k)),y.on(L.LEVEL_PTS_UPDATED,(D,{details:k})=>A(k)),y.on(L.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const R=(D,k)=>{const z=this.getAssetPlayer(g);if(z&&k.tracks){z.off(L.BUFFER_CODECS,R),z.tracks=k.tracks;const P=this.primaryMedia;this.bufferingAsset===z.assetItem&&P&&!z.media&&this.bufferAssetPlayer(z,P)}};y.on(L.BUFFER_CODECS,R);const C=()=>{var D;const k=this.getAssetPlayer(g);if(this.log(`buffered to end of asset ${k}`),!k||!this.schedule)return;const z=this.schedule.findEventIndex(e.identifier),P=(D=this.schedule.items)==null?void 0:D[z];this.isInterstitial(P)&&this.advanceAssetBuffering(P,t)};y.on(L.BUFFERED_TO_END,C);const I=D=>()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;this.shouldPlay=!0;const z=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,z,D)};return y.once(L.MEDIA_ENDED,I(i)),y.once(L.PLAYOUT_LIMIT_REACHED,I(1/0)),y.on(L.ERROR,(D,k)=>{if(!this.schedule)return;const z=this.getAssetPlayer(g);if(k.details===Q.BUFFER_STALLED_ERROR){if(z!=null&&z.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(k,e,this.schedule.findEventIndex(e.identifier),i,`Asset player error ${k.error} ${e}`)}),y.on(L.DESTROYING,()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;const k=new Error(`Asset player destroyed unexpectedly ${g}`),z={fatal:!0,type:Ie.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:k};this.handleAssetItemError(z,e,this.schedule.findEventIndex(e.identifier),i,k.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Tu(t)}`),this.hls.trigger(L.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:i,event:e,player:y}),y}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const i=this.playerQueue[t];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(e,t){const i=this.getAssetPlayerQueueIndex(e);if(i!==-1){const n=this.playerQueue[i];this.log(`clear ${n} toSegment: ${t&&wi(t)}`),this.transferMediaFromPlayer(n,t),this.playerQueue.splice(i,1),n.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,i,n,a){const{interstitial:o,assetItem:c,assetId:f}=e,d=o.assetList.length,m=this.playingAsset;this.endedAsset=null,this.playingAsset=c,(!m||m.identifier!==f)&&(m&&(this.clearAssetPlayer(m.identifier,i[n]),delete m.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${d} ${Tu(c)}`),this.hls.trigger(L.INTERSTITIAL_ASSET_STARTED,{asset:c,assetListIndex:t,event:o,schedule:i.slice(0),scheduleIndex:n,player:e})),this.bufferAssetPlayer(e,a)}bufferAssetPlayer(e,t){var i,n;if(!this.schedule)return;const{interstitial:a,assetItem:o}=e,c=this.schedule.findEventIndex(a.identifier),f=(i=this.schedule.items)==null?void 0:i[c];if(!f)return;e.loadSource(),this.setBufferingItem(f),this.bufferingAsset=o;const d=this.getBufferingPlayer();if(d===e)return;const m=a.appendInPlace;if(m&&(d==null?void 0:d.interstitial.appendInPlace)===!1)return;const g=(d==null?void 0:d.tracks)||((n=this.detachedData)==null?void 0:n.tracks)||this.requiredTracks;if(m&&o!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(g&&!CA(g,e.tracks)){const p=new Error(`Asset ${Tu(o)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(g)}')`),T={fatal:!0,type:Ie.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:p},y=a.findAssetIndex(o);this.handleAssetItemError(T,a,c,y,p.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,i=this.primaryMedia;if(!t||!i)return;const n=i.currentTime,a=t.findAssetIndex(e,n),o=e.assetList[a];if(o){const c=this.getAssetPlayer(o.identifier);if(c){const f=c.currentTime||n-o.timelineStart,d=c.duration-f;if(this.warn(`Stalled at ${f} of ${f+d} in ${c} ${e} (media.currentTime: ${n})`),f&&(d/i.playbackRate<.5||c.bufferedInPlaceToEnd(i))&&c.hls){const m=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,m,a)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,i,n,a){if(e.details===Q.BUFFER_STALLED_ERROR)return;const o=t.assetList[n]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&Tu(o)} ${e.error}`),!this.schedule)return;const c=(o==null?void 0:o.identifier)||"",f=this.getAssetPlayerQueueIndex(c),d=this.playerQueue[f]||null,m=this.schedule.items,g=bt({},e,{fatal:!1,errorAction:_u(!0),asset:o,assetListIndex:n,event:t,schedule:m,scheduleIndex:i,player:d});if(this.hls.trigger(L.INTERSTITIAL_ASSET_ERROR,g),!e.fatal)return;const p=this.playingAsset,T=this.bufferingAsset,y=new Error(a);if(o&&(this.clearAssetPlayer(c,null),o.error=y),!t.assetList.some(S=>!S.error))t.error=y;else for(let S=n;S<t.assetList.length;S++)this.resetAssetPlayer(t.assetList[S].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):p&&p.identifier===c?this.advanceAfterAssetEnded(t,i,n):T&&T.identifier===c&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,T)}primaryFallback(e){const t=e.timelineStart,i=this.effectivePlayingItem;let n=this.timelinePos;if(i){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${n} playing: ${wi(i)} error: ${e.error}`),n===-1&&(n=this.hls.startPosition);const o=this.updateItem(i,n);this.itemsMatch(i,o)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(n===-1){this.checkStart();return}if(!this.schedule)return;const a=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(a)}onAssetListLoaded(e,t){var i,n;const a=t.event,o=a.identifier,c=t.assetListResponse.ASSETS;if(!((i=this.schedule)!=null&&i.hasEvent(o)))return;const f=a.timelineStart,d=a.duration;let m=0;c.forEach((S,A)=>{const R=parseFloat(S.DURATION);this.createAsset(a,A,m,f+m,R,S.URI),m+=R}),a.duration=m,this.log(`Loaded asset-list with duration: ${m} (was: ${d}) ${a}`);const g=this.waitingItem,p=(g==null?void 0:g.event.identifier)===o;this.updateSchedule();const T=(n=this.bufferingItem)==null?void 0:n.event;if(p){var y;const S=this.schedule.findEventIndex(o),A=(y=this.schedule.items)==null?void 0:y[S];if(A){if(!this.playingItem&&this.timelinePos>A.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==S){a.error=new Error(`Interstitial ${c.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${a}`),this.log(a.error.message),this.updateSchedule(!0),this.primaryFallback(a);return}this.setBufferingItem(A)}this.setSchedulePosition(S)}else if((T==null?void 0:T.identifier)===o){const S=a.assetList[0];if(S){const A=this.getAssetPlayer(S.identifier);if(T.appendInPlace){const R=this.primaryMedia;A&&R&&this.bufferAssetPlayer(A,R)}else A&&A.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case Q.ASSET_LIST_PARSING_ERROR:case Q.ASSET_LIST_LOAD_ERROR:case Q.ASSET_LIST_LOAD_TIMEOUT:{const i=t.interstitial;i&&(this.updateSchedule(!0),this.primaryFallback(i));break}case Q.BUFFER_STALLED_ERROR:{const i=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&i.event.appendInPlace){this.handleInPlaceStall(i.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const j2=500;class GB extends Zp{constructor(e,t,i){super(e,t,i,"subtitle-stream-controller",_e.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(L.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(L.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=ce.IDLE,this.setInterval(j2),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:n}=t;if(this.fragContextChanged(i)||(Ut(i)&&(this.fragPrevious=i),this.state=ce.IDLE),!n)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let o;const c=i.start;for(let d=0;d<a.length;d++)if(c>=a[d].start&&c<=a[d].end){o=a[d];break}const f=i.start+i.duration;o?o.end=f:(o={start:c,end:f},a.push(o)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:i,endOffset:n}=t;if(i===0&&n!==Number.POSITIVE_INFINITY){const a=n-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(o=>{for(let c=0;c<o.length;){if(o[c].end<=a){o.shift();continue}else if(o[c].start<a)o[c].start=a;else break;c++}}),this.fragmentTracker.removeFragmentsInRange(i,a,_e.SUBTITLE)}}onError(e,t){const i=t.frag;(i==null?void 0:i.type)===_e.SUBTITLE&&(t.details===Q.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ce.STOPPED&&(this.state=ce.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&w3(this.levels,t)){this.levels=t.map(i=>new Rl(i));return}this.tracksBuffered=[],this.levels=t.map(i=>{const n=new Rl(i);return this.tracksBuffered[n.id]=[],n}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,_e.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var i;if(this.currentTrackId=t.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==ce.STOPPED&&this.setInterval(j2)}onSubtitleTrackLoaded(e,t){var i;const{currentTrackId:n,levels:a}=this,{details:o,id:c}=t;if(!a){this.warn(`Subtitle tracks were reset while loading level ${c}`);return}const f=a[c];if(c>=a.length||!f)return;this.log(`Subtitle track ${c} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(o.live||(i=f.details)!=null&&i.live){if(o.deltaUpdateFailed)return;const g=this.mainDetails;if(!g){this.startFragRequested=!1;return}const p=g.fragments[0];if(!f.details)o.hasProgramDateTime&&g.hasProgramDateTime?(If(o,g),d=o.fragmentStart):p&&(d=p.start,qg(o,d));else{var m;d=this.alignPlaylists(o,f.details,(m=this.levelLastLoaded)==null?void 0:m.details),d===0&&p&&(d=p.start,qg(o,d))}g&&!this.startFragRequested&&this.setStartPosition(g,d)}f.details=o,this.levelLastLoaded=f,c===n&&(this.hls.trigger(L.SUBTITLE_TRACK_UPDATED,{details:o,id:c,groupId:t.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===ce.IDLE&&(Sa(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),f.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,n=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&n!=null&&n.key&&n.iv&&Lu(n.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(i),n.key.buffer,n.iv.buffer,Xp(n.method)).catch(c=>{throw a.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const f=performance.now();a.trigger(L.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:o,tdecrypt:f}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state=ce.IDLE})}}doTick(){if(!this.media){this.state=ce.IDLE;return}if(this.state===ce.IDLE){const{currentTrackId:e,levels:t}=this,i=t==null?void 0:t[e];if(!i||!t.length||!i.details||this.waitForLive(i))return;const{config:n}=this,a=this.getLoadPosition(),o=Ue.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,n.maxBufferHole),{end:c,len:f}=o,d=i.details,m=this.hls.maxBufferLength+d.levelTargetDuration;if(f>m)return;const g=d.fragments,p=g.length,T=d.edge;let y=null;const S=this.fragPrevious;if(c<T){const C=n.maxFragLookUpTolerance,I=c>T-C?0:C;y=Sa(S,g,Math.max(g[0].start,c),I),!y&&S&&S.start<g[0].start&&(y=g[0])}else y=g[p-1];if(y=this.filterReplacedPrimary(y,i.details),!y)return;const A=y.sn-d.startSN,R=g[A-1];if(R&&R.cc===y.cc&&this.fragmentTracker.getState(R)===Jt.NOT_LOADED&&(y=R),this.fragmentTracker.getState(y)===Jt.NOT_LOADED){const C=this.mapToInitFragWhenRequired(y);C&&this.loadFragment(C,i,c)}}}loadFragment(e,t,i){Ut(e)?super.loadFragment(e,t,i):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new qB(this.tracksBuffered[this.currentTrackId]||[])}}class qB{constructor(e){this.buffered=void 0;const t=(i,n,a)=>{if(n=n>>>0,n>a-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${a})`);return e[n][i]};this.buffered={get length(){return e.length},end(i){return t("end",i,e.length)},start(i){return t("start",i,e.length)}}}}const VB={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},K3=s=>String.fromCharCode(VB[s]||s),Oi=15,Dn=100,zB={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},YB={17:2,18:4,21:6,22:8,23:10,19:13,20:15},KB={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},QB={25:2,26:4,29:6,30:8,31:10,27:13,28:15},XB=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class WB{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i=typeof t=="function"?t():t;ft.log(`${this.time} [${e}] ${i}`)}}}const aa=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class Q3{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const n=t[i];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class ZB{constructor(){this.uchar=" ",this.penState=new Q3}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class JB{constructor(e){this.chars=[],this.pos=0,this.currPenState=new Q3,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Dn;t++)this.chars.push(new ZB);this.logger=e}equals(e){for(let t=0;t<Dn;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Dn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Dn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Dn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Dn)}moveCursor(e){const t=this.pos+e;if(e>1)for(let i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=K3(e);if(this.pos>=Dn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Dn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<Dn;i++){const n=this.chars[i].uchar;n!==" "&&(t=!1),e.push(n)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class eg{constructor(e){this.rows=[],this.currRow=Oi-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Oi;t++)this.rows.push(new JB(e));this.logger=e}reset(){for(let e=0;e<Oi;e++)this.rows[e].clear();this.currRow=Oi-1}equals(e){let t=!0;for(let i=0;i<Oi;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<Oi;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Oi;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Tt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<Oi;c++)this.rows[c].clear();const a=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const c=o.rows[a].cueStartTime,f=this.logger.time;if(c!==null&&f!==null&&c<f)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(o.rows[a+d])}}this.currRow=t;const i=this.rows[this.currRow];if(e.indent!==null){const a=e.indent,o=Math.max(a-1,0);i.setCursor(e.indent),e.color=i.chars[o].penState.foreground}const n={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Tt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",n=-1;for(let a=0;a<Oi;a++){const o=this.rows[a].getTextString();o&&(n=a+1,e?t.push("Row "+n+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?i="["+t.join(" | ")+"]":i=t.join(`
`)),i}getTextAndFormat(){return this.rows}}class $2{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new eg(i),this.nonDisplayedMemory=new eg(i),this.lastOutputScreen=new eg(i),this.currRollUpRow=this.displayedMemory.rows[Oi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Oi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[i]}this.logger.log(2,"MIDROW: "+Tt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class G2{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=tF(),this.logger=void 0;const n=this.logger=new WB;this.channels=[null,new $2(e,t,n),new $2(e+1,i,n)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let i=0;i<t.length;i+=2){const n=t[i]&127,a=t[i+1]&127;let o=!1,c=null;if(n===0&&a===0)continue;this.logger.log(3,()=>"["+aa([t[i],t[i+1]])+"] -> ("+aa([n,a])+")");const f=this.cmdHistory;if(n>=16&&n<=31){if(eF(n,a,f)){Od(null,null,f),this.logger.log(3,()=>"Repeated command ("+aa([n,a])+") is dropped");continue}Od(n,a,this.cmdHistory),o=this.parseCmd(n,a),o||(o=this.parseMidrow(n,a)),o||(o=this.parsePAC(n,a)),o||(o=this.parseBackgroundAttributes(n,a))}else Od(null,null,f);if(!o&&(c=this.parseChars(n,a),c)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!c&&this.logger.log(2,()=>"Couldn't parse cleaned data "+aa([n,a])+" orig: "+aa([t[i],t[i+1]]))}}parseCmd(e,t){const i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=33&&t<=35;if(!(i||n))return!1;const a=e===20||e===21||e===23?1:2,o=this.channels[a];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=a,!0}parseMidrow(e,t){let i=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[i];return n?(n.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+aa([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let i;const n=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(n||a))return!1;const o=e<=23?1:2;t>=64&&t<=95?i=o===1?zB[e]:KB[e]:i=o===1?YB[e]:QB[e];const c=this.channels[o];return c?(c.setPAC(this.interpretPAC(i,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let i;const n={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?i=t-96:i=t-64,n.underline=(i&1)===1,i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=Math.floor((i-16)/2)*4,n}parseChars(e,t){let i,n=null,a=null;if(e>=25?(i=2,a=e-8):(i=1,a=e),a>=17&&a<=19){let o;a===17?o=t+80:a===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+K3(o)+"' in channel "+i),n=[o]}else e>=32&&e<=127&&(n=t===0?[e]:[e,t]);return n&&this.logger.log(3,()=>"Char codes =  "+aa(n).join(",")),n}parseBackgroundAttributes(e,t){const i=(e===16||e===24)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=45&&t<=47;if(!(i||n))return!1;let a;const o={};e===16||e===24?(a=Math.floor((t-32)/2),o.background=XB[a],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const c=e<=23?1:2;return this.channels[c].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Od(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function Od(s,e,t){t.a=s,t.b=e}function eF(s,e,t){return t.a===s&&t.b===e}function tF(){return{a:null,b:null}}var c1=(function(){if(Rf!=null&&Rf.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,f){if(typeof f!="string"||!Array.isArray(c))return!1;const d=f.toLowerCase();return~c.indexOf(d)?d:!1}function i(c){return t(s,c)}function n(c){return t(e,c)}function a(c,...f){let d=1;for(;d<arguments.length;d++){const m=arguments[d];for(const g in m)c[g]=m[g]}return c}function o(c,f,d){const m=this,g={enumerable:!0};m.hasBeenReset=!1;let p="",T=!1,y=c,S=f,A=d,R=null,C="",I=!0,D="auto",k="start",z=50,P="middle",V=50,$="middle";Object.defineProperty(m,"id",a({},g,{get:function(){return p},set:function(j){p=""+j}})),Object.defineProperty(m,"pauseOnExit",a({},g,{get:function(){return T},set:function(j){T=!!j}})),Object.defineProperty(m,"startTime",a({},g,{get:function(){return y},set:function(j){if(typeof j!="number")throw new TypeError("Start time must be set to a number.");y=j,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",a({},g,{get:function(){return S},set:function(j){if(typeof j!="number")throw new TypeError("End time must be set to a number.");S=j,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",a({},g,{get:function(){return A},set:function(j){A=""+j,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",a({},g,{get:function(){return R},set:function(j){R=j,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",a({},g,{get:function(){return C},set:function(j){const te=i(j);if(te===!1)throw new SyntaxError("An invalid or illegal string was specified.");C=te,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",a({},g,{get:function(){return I},set:function(j){I=!!j,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",a({},g,{get:function(){return D},set:function(j){if(typeof j!="number"&&j!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");D=j,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",a({},g,{get:function(){return k},set:function(j){const te=n(j);if(!te)throw new SyntaxError("An invalid or illegal string was specified.");k=te,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",a({},g,{get:function(){return z},set:function(j){if(j<0||j>100)throw new Error("Position must be between 0 and 100.");z=j,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",a({},g,{get:function(){return P},set:function(j){const te=n(j);if(!te)throw new SyntaxError("An invalid or illegal string was specified.");P=te,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",a({},g,{get:function(){return V},set:function(j){if(j<0||j>100)throw new Error("Size must be between 0 and 100.");V=j,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",a({},g,{get:function(){return $},set:function(j){const te=n(j);if(!te)throw new SyntaxError("An invalid or illegal string was specified.");$=te,this.hasBeenReset=!0}})),m.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o})();class sF{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function X3(s){function e(i,n,a,o){return(i|0)*3600+(n|0)*60+(a|0)+parseFloat(o||0)}const t=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class iF{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function W3(s,e,t,i){const n=i?s.split(i):[s];for(const a in n){if(typeof n[a]!="string")continue;const o=n[a].split(t);if(o.length!==2)continue;const c=o[0],f=o[1];e(c,f)}}const Zg=new c1(0,0,""),kd=Zg.align==="middle"?"middle":"center";function nF(s,e,t){const i=s;function n(){const c=X3(s);if(c===null)throw new Error("Malformed timestamp: "+i);return s=s.replace(/^[^\sa-zA-Z-]+/,""),c}function a(c,f){const d=new iF;W3(c,function(p,T){let y;switch(p){case"region":for(let S=t.length-1;S>=0;S--)if(t[S].id===T){d.set(p,t[S].region);break}break;case"vertical":d.alt(p,T,["rl","lr"]);break;case"line":y=T.split(","),d.integer(p,y[0]),d.percent(p,y[0])&&d.set("snapToLines",!1),d.alt(p,y[0],["auto"]),y.length===2&&d.alt("lineAlign",y[1],["start",kd,"end"]);break;case"position":y=T.split(","),d.percent(p,y[0]),y.length===2&&d.alt("positionAlign",y[1],["start",kd,"end","line-left","line-right","auto"]);break;case"size":d.percent(p,T);break;case"align":d.alt(p,T,["start",kd,"end","left","right"]);break}},/:/,/\s/),f.region=d.get("region",null),f.vertical=d.get("vertical","");let m=d.get("line","auto");m==="auto"&&Zg.line===-1&&(m=-1),f.line=m,f.lineAlign=d.get("lineAlign","start"),f.snapToLines=d.get("snapToLines",!0),f.size=d.get("size",100),f.align=d.get("align",kd);let g=d.get("position","auto");g==="auto"&&Zg.position===50&&(g=f.align==="start"||f.align==="left"?0:f.align==="end"||f.align==="right"?100:50),f.position=g}function o(){s=s.replace(/^\s+/,"")}if(o(),e.startTime=n(),o(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);s=s.slice(3),o(),e.endTime=n(),o(),a(s,e)}function Z3(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class rF{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new sF,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function i(){let a=t.buffer,o=0;for(a=Z3(a);o<a.length&&a[o]!=="\r"&&a[o]!==`
`;)++o;const c=a.slice(0,o);return a[o]==="\r"&&++o,a[o]===`
`&&++o,t.buffer=a.slice(o),c}function n(a){W3(a,function(o,c){},/:/)}try{let a="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;a=i();const c=a.match(/^()?WEBVTT([ \t].*)?$/);if(!(c!=null&&c[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:a=i(),t.state){case"HEADER":/:/.test(a)?n(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new c1(0,0,""),t.state="CUE",a.indexOf("-->")===-1){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{nF(a,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=a.indexOf("-->")!==-1;if(!a||c&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=a}continue;case"BADCUE":a||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const aF=/\r\n|\n\r|\n|\r/g,tg=function(e,t,i=0){return e.slice(i,i+t.length)===t},uF=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Se(t)||!Se(i)||!Se(n)||!Se(a))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=60*1e3*n,t+=3600*1e3*a,t};function d1(s,e,t){return hl(s.toString())+hl(e.toString())+hl(t)}const oF=function(e,t,i){let n=e[t],a=e[n.prevCC];if(!a||!a.new&&n.new){e.ccOffset=e.presentationOffset=n.start,n.new=!1;return}for(;(o=a)!=null&&o.new;){var o;e.ccOffset+=n.start-a.start,n.new=!1,n=a,a=e[n.prevCC]}e.presentationOffset=i};function lF(s,e,t,i,n,a,o){const c=new rF,f=ci(new Uint8Array(s)).trim().replace(aF,`
`).split(`
`),d=[],m=e?gU(e.baseTime,e.timescale):0;let g="00:00.000",p=0,T=0,y,S=!0;c.oncue=function(A){const R=t[i];let C=t.ccOffset;const I=(p-m)/9e4;if(R!=null&&R.new&&(T!==void 0?C=t.ccOffset=R.start:oF(t,i,I)),I){if(!e){y=new Error("Missing initPTS for VTT MPEGTS");return}C=I-t.presentationOffset}const D=A.endTime-A.startTime,k=ui((A.startTime+C-T)*9e4,n*9e4)/9e4;A.startTime=Math.max(k,0),A.endTime=Math.max(k+D,0);const z=A.text.trim();A.text=decodeURIComponent(encodeURIComponent(z)),A.id||(A.id=d1(A.startTime,A.endTime,z)),A.endTime>0&&d.push(A)},c.onparsingerror=function(A){y=A},c.onflush=function(){if(y){o(y);return}a(d)},f.forEach(A=>{if(S)if(tg(A,"X-TIMESTAMP-MAP=")){S=!1,A.slice(16).split(",").forEach(R=>{tg(R,"LOCAL:")?g=R.slice(6):tg(R,"MPEGTS:")&&(p=parseInt(R.slice(7)))});try{T=uF(g)/1e3}catch(R){y=R}return}else A===""&&(S=!1);c.parse(A+`
`)}),c.flush()}const sg="stpp.ttml.im1t",J3=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,e_=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,cF={left:"start",center:"center",right:"end",start:"start",end:"end"};function q2(s,e,t,i){const n=$e(new Uint8Array(s),["mdat"]);if(n.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const a=n.map(c=>ci(c)),o=mU(e.baseTime,1,e.timescale);try{a.forEach(c=>t(dF(c,o)))}catch(c){i(c)}}function dF(s,e){const n=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(a).reduce((g,p)=>(g[p]=n.getAttribute(`ttp:${p}`)||a[p],g),{}),c=n.getAttribute("xml:space")!=="preserve",f=V2(ig(n,"styling","style")),d=V2(ig(n,"layout","region")),m=ig(n,"body","[begin]");return[].map.call(m,g=>{const p=t_(g,c);if(!p||!g.hasAttribute("begin"))return null;const T=rg(g.getAttribute("begin"),o),y=rg(g.getAttribute("dur"),o);let S=rg(g.getAttribute("end"),o);if(T===null)throw z2(g);if(S===null){if(y===null)throw z2(g);S=T+y}const A=new c1(T-e,S-e,p);A.id=d1(A.startTime,A.endTime,A.text);const R=d[g.getAttribute("region")],C=f[g.getAttribute("style")],I=fF(R,C,f),{textAlign:D}=I;if(D){const k=cF[D];k&&(A.lineAlign=k),A.align=D}return bt(A,I),A}).filter(g=>g!==null)}function ig(s,e,t){const i=s.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(t)):[]}function V2(s){return s.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function t_(s,e){return[].slice.call(s.childNodes).reduce((t,i,n)=>{var a;return i.nodeName==="br"&&n?t+`
`:(a=i.childNodes)!=null&&a.length?t_(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent},"")}function fF(s,e,t){const i="http://www.w3.org/ns/ttml#styling";let n=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(n=t[o]),a.reduce((c,f)=>{const d=ng(e,i,f)||ng(s,i,f)||ng(n,i,f);return d&&(c[f]=d),c},{})}function ng(s,e,t){return s&&s.hasAttributeNS(e,t)?s.getAttributeNS(e,t):null}function z2(s){return new Error(`Could not parse ttml timestamp ${s}`)}function rg(s,e){if(!s)return null;let t=X3(s);return t===null&&(J3.test(s)?t=hF(s,e):e_.test(s)&&(t=mF(s,e))),t}function hF(s,e){const t=J3.exec(s),i=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+i/e.frameRate}function mF(s,e){const t=e_.exec(s),i=Number(t[1]);switch(t[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}class Md{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class gF{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=K2(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this),e.on(L.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(L.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(L.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this),e.off(L.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(L.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(L.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Md(this,"textTrack1"),t=new Md(this,"textTrack2"),i=new Md(this,"textTrack3"),n=new Md(this,"textTrack4");this.cea608Parser1=new G2(1,e,t),this.cea608Parser2=new G2(3,i,n)}addCues(e,t,i,n,a){let o=!1;for(let c=a.length;c--;){const f=a[c],d=pF(f[0],f[1],t,i);if(d>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],i),o=!0,d/(i-t)>.5))return}if(o||a.push([t,i]),this.config.renderTextTracksNatively){const c=this.captionsTracks[e];this.Cues.newCue(c,t,i,n)}else{const c=this.Cues.newCue(null,t,i,n);this.hls.trigger(L.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:n,timescale:a,trackId:o}){const{unparsedVttFrags:c}=this;i===_e.MAIN&&(this.initPTS[t.cc]={baseTime:n,timescale:a,trackId:o}),c.length&&(this.unparsedVttFrags=[],c.forEach(f=>{this.initPTS[f.frag.cc]?this.onFragLoaded(L.FRAG_LOADED,f):this.hls.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:i}=this;if(i)for(let n=0;n<i.textTracks.length;n++){const a=i.textTracks[n];if(Y2(a,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:n}=this,{label:a,languageCode:o}=t[e],c=this.getExistingTrack(a,o);if(c)i[e]=c,vu(i[e]),V3(i[e],n);else{const f=this.createTextTrack("captions",a,o);f&&(f[e]=!0,i[e]=f)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i=t.label,n={_id:e,label:i,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(L.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,i){const n=this.media;if(n)return n.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const i=!!t.transferMedia;if(this.media=null,i)return;const{captionsTracks:n}=this;Object.keys(n).forEach(a=>{vu(n[a]),delete n[a]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=K2(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let i=0;i<t.length;i++)vu(t[i])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],n=i.some(a=>a.textCodec===sg);if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(w3(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const o=this.media,c=o?Zd(o.textTracks):null;if(this.tracks.forEach((f,d)=>{let m;if(c){let g=null;for(let p=0;p<c.length;p++)if(c[p]&&Y2(c[p],f)){g=c[p],c[p]=null;break}g&&(m=g)}if(m)vu(m);else{const g=s_(f);m=this.createTextTrack(g,f.name,f.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),c!=null&&c.length){const f=c.filter(d=>d!==null).map(d=>d.label);f.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${f.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(L.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(i=>{const n=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!n)return;const a=`textTrack${n[1]}`,o=this.captionsProperties[a];o&&(o.label=i.name,i.lang&&(o.languageCode=i.lang),o.media=i)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===_e.MAIN){var i,n;const{cea608Parser1:a,cea608Parser2:o,lastSn:c}=this,{cc:f,sn:d}=t.frag,m=(i=(n=t.part)==null?void 0:n.index)!=null?i:-1;a&&o&&(d!==c+1||d===c&&m!==this.lastPartIndex+1||f!==this.lastCc)&&(a.reset(),o.reset()),this.lastCc=f,this.lastSn=d,this.lastPartIndex=m}}onFragLoaded(e,t){const{frag:i,payload:n}=t;if(i.type===_e.SUBTITLE)if(n.byteLength){const a=i.decryptdata,o="stats"in t;if(a==null||!a.encrypted||o){const c=this.tracks[i.level],f=this.vttCCs;f[i.cc]||(f[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),c&&c.textCodec===sg?this._parseIMSC1(i,n):this._parseVTTs(t)}}else this.hls.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;q2(t,this.initPTS[e.cc],n=>{this._appendCues(n,e.level),i.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},n=>{i.logger.log(`Failed to parse IMSC1: ${n}`),i.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:n})})}_parseVTTs(e){var t;const{frag:i,payload:n}=e,{initPTS:a,unparsedVttFrags:o}=this,c=a.length-1;if(!a[i.cc]&&c===-1){o.push(e);return}const f=this.hls,d=(t=i.initSegment)!=null&&t.data?_i(i.initSegment.data,new Uint8Array(n)).buffer:n;lF(d,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,m=>{this._appendCues(m,i.level),f.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},m=>{const g=m.message==="Missing initPTS for VTT MPEGTS";g?o.push(e):this._fallbackToIMSC1(i,n),f.logger.log(`Failed to parse VTT cue: ${m}`),!(g&&c>i.cc)&&f.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:m})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||q2(t,this.initPTS[e.cc],()=>{i.textCodec=sg,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||n.mode==="disabled")return;e.forEach(a=>z3(n,a))}else{const n=this.tracks[t];if(!n)return;const a=n.default?"default":"subtitles"+t;i.trigger(L.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===_e.SUBTITLE&&this.onFragLoaded(L.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:n}=t;if(!(i.type===_e.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let a=0;a<n.length;a++){const o=n[a].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const c=this.extractCea608Data(o);this.cea608Parser1.addData(n[a].pts,c[0]),this.cea608Parser2.addData(n[a].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:n,type:a}){const{media:o}=this;if(!(!o||o.currentTime<i)){if(!a||a==="video"){const{captionsTracks:c}=this;Object.keys(c).forEach(f=>Wg(c[f],t,i))}if(this.config.renderTextTracksNatively&&t===0&&n!==void 0){const{textTracks:c}=this;Object.keys(c).forEach(f=>Wg(c[f],t,n))}}}extractCea608Data(e){const t=[[],[]],i=e[0]&31;let n=2;for(let a=0;a<i;a++){const o=e[n++],c=127&e[n++],f=127&e[n++];if(c===0&&f===0)continue;if((4&o)!==0){const m=3&o;(m===0||m===1)&&(t[m].push(c),t[m].push(f))}}return t}}function s_(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function Y2(s,e){return!!s&&s.kind===s_(e)&&Yg(e,s)}function pF(s,e,t,i){return Math.min(e,i)-Math.max(s,t)}function K2(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const bF=/\s/,EF={newCue(s,e,t,i){const n=[];let a,o,c,f,d;const m=self.VTTCue||self.TextTrackCue;for(let p=0;p<i.rows.length;p++)if(a=i.rows[p],c=!0,f=0,d="",!a.isEmpty()){var g;for(let S=0;S<a.chars.length;S++)bF.test(a.chars[S].uchar)&&c?f++:(d+=a.chars[S].uchar,c=!1);a.cueStartTime=e,e===t&&(t+=1e-4),f>=16?f--:f++;const T=Z3(d.trim()),y=d1(e,t,T);s!=null&&(g=s.cues)!=null&&g.getCueById(y)||(o=new m(e,t,T),o.id=y,o.line=p+1,o.align="left",o.position=10+Math.min(80,Math.floor(f*8/32)*10),n.push(o))}return s&&n.length&&(n.sort((p,T)=>p.line==="auto"||T.line==="auto"?0:p.line>8&&T.line>8?T.line-p.line:p.line-T.line),n.forEach(p=>z3(s,p))),n}};function yF(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const xF=/(\d+)-(\d+)\/(\d+)/;class Q2{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||AF,this.controller=new self.AbortController,this.stats=new Gp}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const a=TF(e,this.controller.signal),o=e.responseType==="arraybuffer",c=o?"byteLength":"length",{maxTimeToFirstByteMs:f,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=f&&Se(f)?f:d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},t.timeout),(Nl(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(g=>{var p;this.response=this.loader=g;const T=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},d-(T-n.loading.start)),!g.ok){const{status:S,statusText:A}=g;throw new _F(A||"fetch, bad network response",S,g)}n.loading.first=T,n.total=SF(g.headers)||n.total;const y=(p=this.callbacks)==null?void 0:p.onProgress;return y&&Se(t.highWaterMark)?this.loadProgressively(g,n,e,t.highWaterMark,y):o?g.arrayBuffer():e.responseType==="json"?g.json():g.text()}).then(g=>{var p,T;const y=this.response;if(!y)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const S=g[c];S&&(n.loaded=n.total=S);const A={url:y.url,data:g,code:y.status},R=(p=this.callbacks)==null?void 0:p.onProgress;R&&!Se(t.highWaterMark)&&R(n,e,g,y),(T=this.callbacks)==null||T.onSuccess(A,n,e,y)}).catch(g=>{var p;if(self.clearTimeout(this.requestTimeout),n.aborted)return;const T=g&&g.code||0,y=g?g.message:null;(p=this.callbacks)==null||p.onError({code:T,text:y},e,g?g.details:null,n)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,n=0,a){const o=new f3,c=e.body.getReader(),f=()=>c.read().then(d=>{if(d.done)return o.dataLength&&a(t,i,o.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const m=d.value,g=m.length;return t.loaded+=g,g<n||o.dataLength?(o.push(m),o.dataLength>=n&&a(t,i,o.flush().buffer,e)):a(t,i,m.buffer,e),f()}).catch(()=>Promise.reject());return f()}}function TF(s,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(bt({},s.headers))};return s.rangeEnd&&t.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),t}function vF(s){const e=xF.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function SF(s){const e=s.get("Content-Range");if(e){const i=vF(e);if(Se(i))return i}const t=s.get("Content-Length");if(t)return parseInt(t)}function AF(s,e){return new self.Request(s.url,e)}class _F extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const LF=/^age:\s*[\d.]+\s*$/im;class i_{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Gp,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const i=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return a(i,t.url)}).catch(o=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",t.url,!0),a(i,t.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(o=>{var c;(c=this.callbacks)==null||c.onError({code:i.status,text:o.message},t,i,n)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const n=t.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:o}=i.loadPolicy;if(n)for(const c in n)e.setRequestHeader(c,n[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=a&&Se(a)?a:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const n=t.readyState,a=this.config;if(!i.aborted&&n>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),n===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const d=t.status,m=t.responseType==="text"?t.responseText:null;if(d>=200&&d<300){const y=m??t.response;if(y!=null){var o,c;i.loading.end=Math.max(self.performance.now(),i.loading.first);const S=t.responseType==="arraybuffer"?y.byteLength:y.length;i.loaded=i.total=S,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);const A=(o=this.callbacks)==null?void 0:o.onProgress;A&&A(i,e,y,t);const R={url:t.responseURL,data:y,code:d};(c=this.callbacks)==null||c.onSuccess(R,i,e,t);return}}const g=a.loadPolicy.errorRetry,p=i.retry,T={url:e.url,data:void 0,code:d};if(_f(g,p,!1,T))this.retry(g);else{var f;ft.error(`${d} while loading ${e.url}`),(f=this.callbacks)==null||f.onError({code:d,text:t.statusText},e,t,i)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(_f(e,t,!0))this.retry(e);else{var i;ft.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=Yp(e,i.retry),i.retry++,ft.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&LF.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const RF={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},IF=dt(dt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:i_,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:HP,bufferController:NU,capLevelController:u1,errorController:VP,fpsController:DB,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:t3,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:RF},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},CF()),{},{subtitleStreamController:GB,subtitleTrackController:kB,timelineController:gF,audioStreamController:LU,audioTrackController:RU,emeController:Ru,cmcdController:RB,contentSteeringController:CB,interstitialsController:$B});function CF(){return{cueHandler:EF,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function NF(s,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=Jg(s),n=["manifest","level","frag"],a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(o=>{const c=`${o==="level"?"playlist":o}LoadPolicy`,f=e[c]===void 0,d=[];a.forEach(m=>{const g=`${o}Loading${m}`,p=e[g];if(p!==void 0&&f){d.push(g);const T=i[c].default;switch(e[c]={default:T},m){case"TimeOut":T.maxLoadTimeMs=p,T.maxTimeToFirstByteMs=p;break;case"MaxRetry":T.errorRetry.maxNumRetry=p,T.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":T.errorRetry.retryDelayMs=p,T.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":T.errorRetry.maxRetryDelayMs=p,T.timeoutRetry.maxRetryDelayMs=p;break}}}),d.length&&t.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${c}": ${Tt(e[c])}`)}),dt(dt({},i),e)}function Jg(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(Jg):Object.keys(s).reduce((e,t)=>(e[t]=Jg(s[t]),e),{}):s}function DF(s,e){const t=s.loader;t!==Q2&&t!==i_?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):yF()&&(s.loader=Q2,s.progressive=!0,s.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const Jd=2,wF=.1,OF=.05,kF=100;class MF extends XA{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(kF),this.mediaSource=t.mediaSource;const i=this.media=t.media;Ds(i,"playing",this.onMediaPlaying),Ds(i,"waiting",this.onMediaWaiting),Ds(i,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:i}=this;i&&(zs(i,"playing",this.onMediaPlaying),zs(i,"waiting",this.onMediaWaiting),zs(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var i,n;const a=(i=this.hls)==null?void 0:i.config;if(!a)return;const o=this.media;if(!o)return;const{seeking:c}=o,f=this.seeking&&!c,d=!this.seeking&&c,m=o.paused&&!c||o.ended||o.playbackRate===0;if(this.seeking=c,e!==t){t&&(this.ended=0),this.moved=!0,c||(this.nudgeRetry=0,a.nudgeOnVideoHole&&!m&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(d||f){f&&this.stallResolved(e);return}if(m){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&o.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!1}));return}if(!Ue.getBuffered(o).length){this.nudgeRetry=0;return}const g=Ue.bufferInfo(o,e,0),p=g.nextStart||0,T=this.fragmentTracker;if(c&&T&&this.hls){const z=X2(this.hls.inFlightFragments,e),P=g.len>Jd,V=!p||z||p-e>Jd&&!T.getPartialFragment(e);if(P||V)return;this.moved=!1}const y=(n=this.hls)==null?void 0:n.latestLevelDetails;if(!this.moved&&this.stalled!==null&&T){if(!(g.len>0)&&!p)return;const P=Math.max(p,g.start||0)-e,$=!!(y!=null&&y.live)?y.targetduration*2:Jd,j=Pd(e,T);if(P>0&&(P<=$||j)){o.paused||this._trySkipBufferHole(j);return}}const S=a.detectStallWithCurrentTimeMs,A=self.performance.now(),R=this.waiting;let C=this.stalled;if(C===null)if(R>0&&A-R<S)C=this.stalled=R;else{this.stalled=A;return}const I=A-C;if(!c&&(I>=S||R)&&this.hls){var D;if(((D=this.mediaSource)==null?void 0:D.readyState)==="ended"&&!(y!=null&&y.live)&&Math.abs(e-((y==null?void 0:y.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(g),!this.media||!this.hls)return}const k=Ue.bufferInfo(o,e,a.maxBufferHole);this._tryFixBufferStall(k,I,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(L.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var i;const n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&n&&n.length>1&&e>n.end(0)){const a=Ue.bufferedInfo(Ue.timeRangesToArray(this.buffered.audio),e,0);if(a.len>1&&t>=a.start){const o=Ue.timeRangesToArray(n),c=Ue.bufferedInfo(o,t,0).bufferedIndex;if(c>-1&&c<o.length-1){const f=Ue.bufferedInfo(o,e,0).bufferedIndex,d=o[c].end,m=o[c+1].start;if((f===-1||f>c)&&m-d<1&&e-d<2){const g=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${d} -> ${m} buffered index: ${f}`);this.warn(g.message),this.media.currentTime+=1e-6;let p=Pd(e,this.fragmentTracker);p&&"fragment"in p?p=p.fragment:p||(p=void 0);const T=Ue.bufferInfo(this.media,e,0);this.hls.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:g,reason:g.message,frag:p,buffer:T.len,bufferInfo:T})}}}}}_tryFixBufferStall(e,t,i){var n,a;const{fragmentTracker:o,media:c}=this,f=(n=this.hls)==null?void 0:n.config;if(!c||!o||!f)return;const d=(a=this.hls)==null?void 0:a.latestLevelDetails,m=Pd(i,o);if((m||d!=null&&d.live&&i<d.fragmentStart)&&(this._trySkipBufferHole(m)||!this.media))return;const g=e.buffered,p=this.adjacentTraversal(e,i);(g&&g.length>1&&e.len>f.maxBufferHole||e.nextStart&&(e.nextStart-i<f.maxBufferHole||p))&&(t>f.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const i=this.fragmentTracker,n=e.nextStart;if(i&&n){const a=i.getFragAtPos(t,_e.MAIN),o=i.getFragAtPos(n,_e.MAIN);if(a&&o)return o.sn-a.sn<2}return!1}_reportStall(e){const{hls:t,media:i,stallReported:n,stalled:a}=this;if(!n&&a!==null&&i&&t){this.stallReported=!0;const o=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${Tt(e)})`);this.warn(o.message),t.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len,bufferInfo:e,stalled:{start:a}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:i,media:n}=this,a=(t=this.hls)==null?void 0:t.config;if(!n||!i||!a)return 0;const o=n.currentTime,c=Ue.bufferInfo(n,o,0),f=o<c.start?c.start:c.nextStart;if(f&&this.hls){const m=c.len<=a.maxBufferHole,g=c.len>0&&c.len<1&&n.readyState<3,p=f-o;if(p>0&&(m||g)){if(p>a.maxBufferHole){let y=!1;if(o===0){const S=i.getAppendedFrag(0,_e.MAIN);S&&f<S.end&&(y=!0)}if(!y&&e){var d;if(!((d=this.hls.loadLevelObj)!=null&&d.details)||X2(this.hls.inFlightFragments,f))return 0;let A=!1,R=e.end;for(;R<f;){const C=Pd(R,i);if(C)R+=C.duration;else{A=!0;break}}if(A)return 0}}const T=Math.max(f+OF,o+wF);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${T}`),this.moved=!0,n.currentTime=T,!(e!=null&&e.gap)){const y=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${T}`),S={type:Ie.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,buffer:c.len,bufferInfo:c};e&&("fragment"in e?S.part=e:S.frag=e),this.hls.trigger(L.ERROR,S)}return T}}return 0}_tryNudgeBuffer(e){const{hls:t,media:i,nudgeRetry:n}=this,a=t==null?void 0:t.config;if(!i||!a)return 0;const o=i.currentTime;if(this.nudgeRetry++,n<a.nudgeMaxRetry){const c=o+(n+1)*a.nudgeOffset,f=new Error(`Nudging 'currentTime' from ${o} to ${c}`);this.warn(f.message),i.currentTime=c,t.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.BUFFER_NUDGE_ON_STALL,error:f,fatal:!1,buffer:e.len,bufferInfo:e})}else{const c=new Error(`Playhead still not moving while enough data buffered @${o} after ${a.nudgeMaxRetry} nudges`);this.error(c.message),t.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,error:c,fatal:!0,buffer:e.len,bufferInfo:e})}}}function X2(s,e){const t=W2(s.main);if(t&&t.start<=e)return t;const i=W2(s.audio);return i&&i.start<=e?i:null}function W2(s){if(!s)return null;switch(s.state){case ce.IDLE:case ce.STOPPED:case ce.ENDED:case ce.ERROR:return null}return s.frag}function Pd(s,e){return e.getAppendedFrag(s,_e.MAIN)||e.getPartialFragment(s)}const PF=.25;function ep(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function ag(s,e,t,i,n){let a=new s(e,t,"");try{a.value=i,n&&(a.type=n)}catch{a=new s(e,t,Tt(n?dt({type:n},i):i))}return a}const Ud=(()=>{const s=ep();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class UF{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(L.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var i;this.media=t.media,((i=t.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&vu(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if(i.kind==="metadata"&&i.label==="id3")return V3(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:i,enableID3MetadataCues:n}=this.hls.config;if(!i&&!n)return;const{samples:a}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=ep();if(o)for(let c=0;c<a.length;c++){const f=a[c].type;if(f===li.emsg&&!i||!n)continue;const d=y3(a[c].data),m=a[c].pts;let g=m+a[c].duration;g>Ud&&(g=Ud),g-m<=0&&(g=m+PF);for(let T=0;T<d.length;T++){const y=d[T];if(!x3(y)){this.updateId3CueEnds(m,f);const S=ag(o,m,g,y,f);S&&this.id3Track.addCue(S)}}}}updateId3CueEnds(e,t){var i;const n=(i=this.id3Track)==null?void 0:i.cues;if(n)for(let a=n.length;a--;){const o=n[a];o.type===t&&o.startTime<e&&o.endTime===Ud&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:n}){const{id3Track:a,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:f}}=o;if(a&&(c||f)){let d;n==="audio"?d=m=>m.type===li.audioId3&&f:n==="video"?d=m=>m.type===li.emsg&&c:d=m=>m.type===li.audioId3&&f||m.type===li.emsg&&c,Wg(a,t,i,d)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:i,timelineOffset:n,enableDateRangeMetadataCues:a,interstitialsController:o}=this.hls.config;if(!a)return;const c=ep();if(i&&n&&!o){const{fragmentStart:S,fragmentEnd:A}=e;let R=this.assetCue;R?(R.startTime=S,R.endTime=A):c&&(R=this.assetCue=ag(c,S,A,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),R&&(R.id=i,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(R),R.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:f}=this,{dateRanges:d}=e,m=Object.keys(d);let g=this.dateRangeCuesAppended;if(f&&t){var p;if((p=f.cues)!=null&&p.length){const S=Object.keys(g).filter(A=>!m.includes(A));for(let A=S.length;A--;){var T;const R=S[A],C=(T=g[R])==null?void 0:T.cues;delete g[R],C&&Object.keys(C).forEach(I=>{const D=C[I];if(D){D.removeEventListener("enter",this.onEventCueEnter);try{f.removeCue(D)}catch{}}})}}else g=this.dateRangeCuesAppended={}}const y=e.fragments[e.fragments.length-1];if(!(m.length===0||!Se(y==null?void 0:y.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let S=0;S<m.length;S++){const A=m[S],R=d[A],C=R.startTime,I=g[A],D=(I==null?void 0:I.cues)||{};let k=(I==null?void 0:I.durationKnown)||!1,z=Ud;const{duration:P,endDate:V}=R;if(V&&P!==null)z=C+P,k=!0;else if(R.endOnNext&&!k){const j=m.reduce((te,ge)=>{if(ge!==R.id){const ye=d[ge];if(ye.class===R.class&&ye.startDate>R.startDate&&(!te||R.startDate<te.startDate))return ye}return te},null);j&&(z=j.startTime,k=!0)}const $=Object.keys(R.attr);for(let j=0;j<$.length;j++){const te=$[j];if(!n9(te))continue;const ge=D[te];if(ge)k&&!(I!=null&&I.durationKnown)?ge.endTime=z:Math.abs(ge.startTime-C)>.01&&(ge.startTime=C,ge.endTime=z);else if(c){let ye=R.attr[te];r9(te)&&(ye=NA(ye));const ue=ag(c,C,z,{key:te,data:ye},li.dateRange);ue&&(ue.id=A,this.id3Track.addCue(ue),D[te]=ue,o&&(te==="X-ASSET-LIST"||te==="X-ASSET-URL")&&ue.addEventListener("enter",this.onEventCueEnter))}}g[A]={cues:D,dateRange:R,durationKnown:k}}}}}class BF{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,i=this.levelDetails;if(!t||!i)return;this.currentTime=t.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:a,maxLiveSyncPlaybackRate:o}=this.config;if(!a||o===1||!i.live)return;const c=this.targetLatency;if(c===null)return;const f=n-c,d=Math.min(this.maxLatency,c+i.targetduration);if(f<d&&f>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,o)),p=Math.round(2/(1+Math.exp(-.75*f-this.edgeStalled))*20)/20,T=Math.min(g,Math.max(1,p));this.changeMediaPlaybackRate(t,T)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:i,targetduration:n}=e,{liveSyncDuration:a,liveSyncDurationCount:o,lowLatencyMode:c}=this.config,f=this.hls.userConfig;let d=c&&i||t;(this._targetLatencyUpdated||f.liveSyncDuration||f.liveSyncDurationCount||d===0)&&(d=a!==void 0?a:o*n);const m=n;return d+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,m)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const i=this.levelDetails;if(i===null)return null;const n=i.edge,a=e-t-this.edgeStalled,o=n-i.totalduration,c=n-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(o,a),c)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var i;t.details===Q.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var i,n;e.playbackRate!==t&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(n=this.targetLatency)==null?void 0:n.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class FF extends a1{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=this.hls.config.preferManagedMediaSource,n=[],a={},o={};let c=!1,f=!1,d=!1;t.levels.forEach(m=>{const g=m.attrs;let{audioCodec:p,videoCodec:T}=m;p&&(m.audioCodec=p=Tf(p,i)||void 0),T&&(T=m.videoCodec=TP(T));const{width:y,height:S,unknownCodecs:A}=m,R=(A==null?void 0:A.length)||0;if(c||(c=!!(y&&S)),f||(f=!!T),d||(d=!!p),R||p&&!this.isAudioSupported(p)||T&&!this.isVideoSupported(T)){this.log(`Some or all CODECS not supported "${g.CODECS}"`);return}const{CODECS:C,"FRAME-RATE":I,"HDCP-LEVEL":D,"PATHWAY-ID":k,RESOLUTION:z,"VIDEO-RANGE":P}=g,$=`${`${k||"."}-`}${m.bitrate}-${z}-${I}-${C}-${P}-${D}`;if(a[$])if(a[$].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const j=o[$]+=1;m.attrs["PATHWAY-ID"]=new Array(j+1).join(".");const te=this.createLevel(m);a[$]=te,n.push(te)}else a[$].addGroupId("audio",g.AUDIO),a[$].addGroupId("text",g.SUBTITLES);else{const j=this.createLevel(m);a[$]=j,o[$]=1,n.push(j)}}),this.filterAndSortMediaOptions(n,t,c,f,d)}createLevel(e){const t=new Rl(e),i=e.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const n=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(n.message),t.supportedResult=$A(n,[])}return t}isAudioSupported(e){return _l(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return _l(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,i,n,a){var o;let c=[],f=[],d=e;const m=((o=t.stats)==null?void 0:o.parsing)||{};if((i||n)&&a&&(d=d.filter(({videoCodec:C,videoRange:I,width:D,height:k})=>(!!C||!!(D&&k))&&DP(I))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let C="no level with compatible codecs found in manifest",I=C;t.levels.length&&(I=`one or more CODECS in variant not supported: ${Tt(t.levels.map(k=>k.attrs.CODECS).filter((k,z,P)=>P.indexOf(k)===z))}`,this.warn(I),C+=` (${I})`);const D=new Error(C);this.hls.trigger(L.ERROR,{type:Ie.MEDIA_ERROR,details:Q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:D,reason:I})}}),m.end=performance.now();return}t.audioTracks&&(c=t.audioTracks.filter(C=>!C.audioCodec||this.isAudioSupported(C.audioCodec)),Z2(c)),t.subtitles&&(f=t.subtitles,Z2(f));const g=d.slice(0);d.sort((C,I)=>{if(C.attrs["HDCP-LEVEL"]!==I.attrs["HDCP-LEVEL"])return(C.attrs["HDCP-LEVEL"]||"")>(I.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&C.height!==I.height)return C.height-I.height;if(C.frameRate!==I.frameRate)return C.frameRate-I.frameRate;if(C.videoRange!==I.videoRange)return vf.indexOf(C.videoRange)-vf.indexOf(I.videoRange);if(C.videoCodec!==I.videoCodec){const D=GT(C.videoCodec),k=GT(I.videoCodec);if(D!==k)return k-D}if(C.uri===I.uri&&C.codecSet!==I.codecSet){const D=xf(C.codecSet),k=xf(I.codecSet);if(D!==k)return k-D}return C.averageBitrate!==I.averageBitrate?C.averageBitrate-I.averageBitrate:0});let p=g[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==g.length)){for(let C=0;C<g.length;C++)if(g[C].pathwayId===d[0].pathwayId){p=g[C];break}}this._levels=d;for(let C=0;C<d.length;C++)if(d[C]===p){var T;this._firstLevel=C;const I=p.bitrate,D=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${I}`),((T=this.hls.userConfig)==null?void 0:T.abrEwmaDefaultEstimate)===void 0){const k=Math.min(I,this.hls.config.abrEwmaDefaultEstimateMax);k>D&&D===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=k)}break}const y=a&&!n,S=this.hls.config,A=!!(S.audioStreamController&&S.audioTrackController),R={levels:d,audioTracks:c,subtitleTracks:f,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:n,altAudio:A&&!y&&c.some(C=>!!C.url)};m.end=performance.now(),this.hls.trigger(L.MANIFEST_PARSED,R)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const m=new Error("invalid level idx"),g=e<0;if(this.hls.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.LEVEL_SWITCH_ERROR,level:e,fatal:g,error:m,reason:m.message}),g)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,n=this.currentLevel,a=n?n.attrs["PATHWAY-ID"]:void 0,o=t[e],c=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,i===e&&n&&a===c)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${c?" with Pathway "+c:""} from level ${i}${a?" with Pathway "+a:""}`);const f={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(L.LEVEL_SWITCHING,f);const d=o.details;if(!d||d.live){const m=this.switchParams(o.uri,n==null?void 0:n.details,d);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),i=e.filter(n=>t.indexOf(n)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=i}}onError(e,t){t.fatal||!t.context||t.context.type===Ge.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===_e.MAIN){const i=t.elementaryStreams;if(!Object.keys(i).some(a=>!!i[a]))return;const n=this._levels[t.level];n!=null&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var i;const{level:n,details:a}=t,o=t.levelInfo;if(!o){var c;this.warn(`Invalid level index ${n}`),(c=t.deliveryDirectives)!=null&&c.skip&&(a.deltaUpdateFailed=!0);return}if(o===this.currentLevel||t.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let f=o.details;f===t.details&&f.advanced&&(f=void 0),this.playlistLoaded(n,t,f)}else(i=t.deliveryDirectives)!=null&&i.skip&&(a.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=this.getUrlWithDirectives(e.uri,t),n=this.currentLevelIndex,a=e.attrs["PATHWAY-ID"],o=e.details,c=o==null?void 0:o.age;this.log(`Loading level index ${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${a?" Pathway "+a:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${i}`),this.hls.trigger(L.LEVEL_LOADING,{url:i,level:n,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const i=this._levels.filter((a,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(c=>c.level=-1)),!1));l3(i),this._levels=i,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const n=i.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(L.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(L.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function Z2(s){const e={};s.forEach(t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++})}function n_(){return self.SourceBuffer||self.WebKitSourceBuffer}function r_(){if(!Mr())return!1;const e=n_();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function HF(){if(!r_())return!1;const s=Mr();return typeof(s==null?void 0:s.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(Ll(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(Ll(e,"audio"))))}function jF(){var s;const e=n_();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const $F=100;class GF extends Zp{constructor(e,t,i){super(e,t,i,"stream-controller",_e.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const n=this.media,a=n?n.currentTime:null;if(a===null||!Se(a)||(this.log(`Media seeked to ${a.toFixed(3)}`),!this.getBufferedFrag(a)))return;const o=this.getFwdBufferInfoAtPos(n,a,_e.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${a} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:i,hls:n}=this;if(this.stopLoad(),this.setInterval($F),this.level=-1,!this.startFragRequested){let a=n.startLevel;a===-1&&(n.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=n.firstAutoLevel),n.nextLoadLevel=a,this.level=n.loadLevel,this._hasEnoughToStart=!!t}i>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i),this.state=ce.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=ce.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ce.WAITING_LEVEL:{const{levels:e,level:t}=this,i=e==null?void 0:e[t],n=i==null?void 0:i.details;if(n&&(!n.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(n))break;this.state=ce.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ce.IDLE;break}break}case ce.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===ce.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:n}=this;if(t===null||!n&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const a=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(i!=null&&i[a]))return;const o=i[a],c=this.getMainFwdBufferInfo();if(c===null)return;const f=this.getLevelDetails();if(f&&this._streamEnded(c,f)){const S={};this.altAudio===2&&(S.type="video"),this.hls.trigger(L.BUFFER_EOS,S),this.state=ce.ENDED;return}if(!this.buffering)return;e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;const d=o.details;if(!d||this.state===ce.WAITING_LEVEL||this.waitForLive(o)){this.level=a,this.state=ce.WAITING_LEVEL,this.startFragRequested=!1;return}const m=c.len,g=this.getMaxBufferLength(o.maxBitrate);if(m>=g)return;this.backtrackFragment&&this.backtrackFragment.start>c.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:c.end;let T=this.getNextFragment(p,d);if(this.couldBacktrack&&!this.fragPrevious&&T&&Ut(T)&&this.fragmentTracker.getState(T)!==Jt.OK){var y;const A=((y=this.backtrackFragment)!=null?y:T).sn-d.startSN,R=d.fragments[A-1];R&&T.cc===R.cc&&(T=R,this.fragmentTracker.removeFragment(R))}else this.backtrackFragment&&c.len&&(this.backtrackFragment=null);if(T&&this.isLoopLoading(T,p)){if(!T.gap){const A=this.audioOnly&&!this.altAudio?yt.AUDIO:yt.VIDEO,R=(A===yt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;R&&this.afterBufferFlushed(R,A,_e.MAIN)}T=this.getNextFragmentLoopLoading(T,d,c,_e.MAIN,g)}T&&(T.initSegment&&!T.initSegment.data&&!this.bitrateTest&&(T=T.initSegment),this.loadFragment(T,o,p))}loadFragment(e,t,i){const n=this.fragmentTracker.getState(e);n===Jt.NOT_LOADED||n===Jt.PARTIAL?Ut(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,i):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,_e.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let i;const n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const a=this.getLevelDetails();if(a!=null&&a.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<a.targetduration*2)return}if(!t.paused&&e){const c=this.hls.nextLoadLevel,f=e[c],d=this.fragLastKbps;d&&this.fragCurrent?i=this.fragCurrent.duration*f.maxBitrate/(1e3*d)+1:i=0}else i=0;const o=this.getBufferedFrag(t.currentTime+i);if(o){const c=this.followingBufferedFrag(o);if(c){this.abortCurrentFrag();const f=c.maxStartPTS?c.maxStartPTS:c.start,d=c.duration,m=Math.max(o.end,f+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ce.KEY_LOADING:case ce.FRAG_LOADING:case ce.FRAG_LOADING_WAITING_RETRY:case ce.PARSING:case ce.PARSED:this.state=ce.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;Ds(i,"playing",this.onMediaPlaying),Ds(i,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:i}=this;i&&(zs(i,"playing",this.onMediaPlaying),zs(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(L.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let i=!1,n=!1;for(let a=0;a<t.levels.length;a++){const o=t.levels[a].audioCodec;o&&(i=i||o.indexOf("mp4a.40.2")!==-1,n=n||o.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=i&&n&&!jF(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==ce.IDLE)return;const n=t.levelInfo;(!n.details||n.details.live&&(this.levelLastLoaded!==n||n.details.expired)||this.waitForCdnTuneIn(n.details))&&(this.state=ce.WAITING_LEVEL)}onLevelLoaded(e,t){var i;const{levels:n,startFragRequested:a}=this,o=t.level,c=t.details,f=c.totalduration;if(!n){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""}, cc [${c.startCC}, ${c.endCC}] duration:${f}`);const d=t.levelInfo,m=this.fragCurrent;m&&(this.state===ce.FRAG_LOADING||this.state===ce.FRAG_LOADING_WAITING_RETRY)&&m.level!==t.level&&m.loader&&this.abortCurrentFrag();let g=0;if(c.live||(i=d.details)!=null&&i.live){var p;if(this.checkLiveUpdate(c),c.deltaUpdateFailed)return;g=this.alignPlaylists(c,d.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(d.details=c,this.levelLastLoaded=d,a||this.setStartPosition(c,g),this.hls.trigger(L.LEVEL_UPDATED,{details:c,level:o}),this.state===ce.WAITING_LEVEL){if(this.waitForCdnTuneIn(c))return;this.state=ce.IDLE}a&&c.live&&this.synchronizeToLiveEdge(c),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const n=this.hls.liveSyncPosition,a=this.getLoadPosition(),o=e.fragmentStart,c=e.edge,f=a>=o-t.maxFragLookUpTolerance&&a<=c;if(n!==null&&i.duration>n&&(a<n||!f)){const m=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!f&&i.readyState<4||a<c-m)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),i.readyState))if(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${n.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var d;const g=Ue.bufferInfo(i,n,0);if(!((d=g.buffered)!=null&&d.length)){i.currentTime=n;return}if(g.start<=a){i.currentTime=n;return}const{nextStart:T}=Ue.bufferedInfo(g.buffered,a,0);T&&(i.currentTime=T)}else i.currentTime=n}}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:n,payload:a}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const c=o[i.level];if(!c){this.warn(`Level ${i.level} not found on progress`);return}const f=c.details;if(!f){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const d=c.videoCodec,m=f.PTSKnown||!f.live,g=(t=i.initSegment)==null?void 0:t.data,p=this._getAudioCodec(c),T=this.transmuxer=this.transmuxer||new D3(this.hls,_e.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),y=n?n.index:-1,S=y!==-1,A=new Qp(i.level,i.sn,i.stats.chunkCount,a.byteLength,y,S),R=this.initPTS[i.cc];T.push(a,g,p,d,i,n,f.totalduration,m,A,R)}onAudioTrackSwitching(e,t){const i=this.hls,n=this.altAudio!==0;if(Sf(t.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(n){this.altAudio=0,this.fragmentTracker.removeAllFragments(),i.once(L.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(L.AUDIO_TRACK_SWITCHED,t)}),i.trigger(L.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(L.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=Sf(t.url,this.hls);if(i){const n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i?2:0,this.tick()}onBufferCreated(e,t){const i=t.tracks;let n,a,o=!1;for(const c in i){const f=i[c];if(f.id==="main"){if(a=c,n=f,c==="video"){const d=i[c];d&&(this.videoBuffer=d.buffer)}}else o=!0}o&&n?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:n}=t,a=i.type===_e.MAIN;if(a){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ce.PARSED&&(this.state=ce.IDLE);return}const c=n?n.stats:i.stats;this.fragLastKbps=Math.round(8*c.total/(c.buffering.end-c.loading.first)),Ut(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,n)}const o=this.media;o&&(!this._hasEnoughToStart&&Ue.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var i;if(t.fatal){this.state=ce.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_e.MAIN,t);break;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ce.WAITING_LEVEL&&((i=t.context)==null?void 0:i.type)===Ge.LEVEL&&(this.state=ce.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=ce.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==yt.AUDIO||!this.altAudio){const i=(t===yt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,t,_e.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${t}`);return}const n=this.timelineOffset;n&&i&&(i+=n);const a=this.getLevelDetails(),o=Ue.getBuffered(e),c=o.length?o.start(0):0,f=c-i,d=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||f>0&&(f<d||this.loadingParts&&f<2*((a==null?void 0:a.partTarget)||0)))&&(this.log(`adjusting start position by ${f} to match buffer start`),i+=f,this.startPosition=i),t<i&&(this.log(`seek to target start position ${i} from current time ${t} buffer start ${c}`),e.currentTime=i)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{const{hls:n}=this,a=i==null?void 0:i.frag;if(!a||this.fragContextChanged(a))return;t.fragmentError=0,this.state=ce.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=a.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),n.trigger(L.FRAG_LOADED,i),a.bitrateTest=!1}).catch(i=>{this.state===ce.STOPPED||this.state===ce.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:i}=this,{remuxResult:n,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:c,part:f,level:d}=o,{video:m,text:g,id3:p,initSegment:T}=n,{details:y}=d,S=this.altAudio?void 0:n.audio;if(this.fragContextChanged(c)){this.fragmentTracker.removeFragment(c);return}if(this.state=ce.PARSING,T){const A=T.tracks;if(A){const D=c.initSegment||c;if(this.unhandledEncryptionError(T,c))return;this._bufferInitSegment(d,A,D,a),i.trigger(L.FRAG_PARSING_INIT_SEGMENT,{frag:D,id:t,tracks:A})}const R=T.initPTS,C=T.timescale,I=this.initPTS[c.cc];if(Se(R)&&(!I||I.baseTime!==R||I.timescale!==C)){const D=T.trackId;this.initPTS[c.cc]={baseTime:R,timescale:C,trackId:D},i.trigger(L.INIT_PTS_FOUND,{frag:c,id:t,initPTS:R,timescale:C,trackId:D})}}if(m&&y){S&&m.type==="audiovideo"&&this.logMuxedErr(c);const A=y.fragments[c.sn-1-y.startSN],R=c.sn===y.startSN,C=!A||c.cc>A.cc;if(n.independent!==!1){const{startPTS:I,endPTS:D,startDTS:k,endDTS:z}=m;if(f)f.elementaryStreams[m.type]={startPTS:I,endPTS:D,startDTS:k,endDTS:z};else if(m.firstKeyFrame&&m.independent&&a.id===1&&!C&&(this.couldBacktrack=!0),m.dropped&&m.independent){const P=this.getMainFwdBufferInfo(),V=(P?P.end:this.getLoadPosition())+this.config.maxBufferHole,$=m.firstKeyFramePTS?m.firstKeyFramePTS:I;if(!R&&V<$-this.config.maxBufferHole&&!C){this.backtrack(c);return}else C&&(c.gap=!0);c.setElementaryStreamInfo(m.type,c.start,D,c.start,z,!0)}else R&&I-(y.appliedTimelineOffset||0)>Jd&&(c.gap=!0);c.setElementaryStreamInfo(m.type,I,D,k,z),this.backtrackFragment&&(this.backtrackFragment=c),this.bufferFragmentData(m,c,f,a,R||C)}else if(R||C)c.gap=!0;else{this.backtrack(c);return}}if(S){const{startPTS:A,endPTS:R,startDTS:C,endDTS:I}=S;f&&(f.elementaryStreams[yt.AUDIO]={startPTS:A,endPTS:R,startDTS:C,endDTS:I}),c.setElementaryStreamInfo(yt.AUDIO,A,R,C,I),this.bufferFragmentData(S,c,f,a)}if(y&&p!=null&&p.samples.length){const A={id:t,frag:c,details:y,samples:p.samples};i.trigger(L.FRAG_PARSING_METADATA,A)}if(y&&g){const A={id:t,frag:c,details:y,samples:g.samples};i.trigger(L.FRAG_PARSING_USERDATA,A)}}logMuxedErr(e){this.warn(`${Ut(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,i,n){if(this.state!==ce.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(i));const{audio:a,video:o,audiovideo:c}=t;if(a){const d=e.audioCodec;let m=zd(a.codec,d);m==="mp4a"&&(m="mp4a.40.5");const g=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){m&&(m.indexOf("mp4a.40.5")!==-1?m="mp4a.40.2":m="mp4a.40.5");const p=a.metadata;p&&"channelCount"in p&&(p.channelCount||1)!==1&&g.indexOf("firefox")===-1&&(m="mp4a.40.5")}m&&m.indexOf("mp4a.40.5")!==-1&&g.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(m="mp4a.40.2",this.log(`Android: force audio codec to ${m}`)),d&&d!==m&&this.log(`Swapping manifest audio codec "${d}" for "${m}"`),a.levelCodec=m,a.id=_e.MAIN,this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${m||""}/${d||""}/${a.codec}]`),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=_e.MAIN;const d=o.codec;if((d==null?void 0:d.length)===4)switch(d){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${d}]${o.codec!==d?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete t.audiovideo}c&&(this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.codecs}/${c.codec}]`),delete t.video,delete t.audio);const f=Object.keys(t);if(f.length){if(this.hls.trigger(L.BUFFER_CODECS,t),!this.hls)return;f.forEach(d=>{const g=t[d].initSegment;g!=null&&g.byteLength&&this.hls.trigger(L.BUFFER_APPENDING,{type:d,data:g,frag:i,part:null,chunkMeta:n,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,_e.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,i=e==null?void 0:e[t];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ce.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const i=e.currentTime;if(Ue.isBuffered(e,i)?t=this.getAppendedFrag(i):Ue.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const n=this.fragPlaying,a=t.level;(!n||t.sn!==n.sn||n.level!==a)&&(this.fragPlaying=t,this.hls.trigger(L.FRAG_CHANGED,{frag:t}),(!n||n.level!==a)&&this.hls.trigger(L.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Se(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Se(t)){const i=this.getLevelDetails(),n=this.currentFrag||(i?Sa(null,i.fragments,t):null);if(n){const a=n.programDateTime;if(a!==null){const o=a+(t-n.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class qF extends Li{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const i in this.keyIdToKeyInfo){const n=this.keyIdToKeyInfo[i].loader;if(n){var t;if(e&&e!==((t=n.context)==null?void 0:t.frag.type))return;n.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=Q.KEY_LOAD_ERROR,i,n,a){return new Mn({type:Ie.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:i,networkDetails:n})}loadClear(e,t,i){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let n=0,a=t.length;n<a;n++){const o=t[n];if(e.cc<=o.cc&&(!Ut(e)||!Ut(o)||e.sn<o.sn)||!i&&n==a-1)return this.emeController.selectKeySystemFormat(o).then(c=>{if(!this.emeController)return;o.setKeyFormat(c);const f=Kd(c);if(f)return this.emeController.getKeySystemAccess([f])})}if(this.config.requireKeySystemAccessOnStart){const n=il(this.config);if(n.length)return this.emeController.getKeySystemAccess(n)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,n;t&&e.setKeyFormat(t);const a=e.decryptdata;if(!a){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,d))}const o=a.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));const c=ug(a);let f=this.keyIdToKeyInfo[c];if((i=f)!=null&&i.decryptdata.key)return a.key=f.decryptdata.key,Promise.resolve({frag:e,keyInfo:f});if(this.emeController&&(n=f)!=null&&n.keyLoadPromise)switch(this.emeController.getKeyStatus(f.decryptdata)){case"usable":case"usable-in-future":return f.keyLoadPromise.then(m=>{const{keyInfo:g}=m;return a.key=g.decryptdata.key,{frag:e,keyInfo:g}})}switch(this.log(`${this.keyIdToKeyInfo[c]?"Rel":"L"}oading${a.keyId?" keyId: "+Es(a.keyId):""} URI: ${a.uri} from ${e.type} ${e.level}`),f=this.keyIdToKeyInfo[c]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(f,e):this.loadKeyEME(f,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(f,e);default:return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var n;if(!e.decryptdata.keyId&&(n=t.initSegment)!=null&&n.data){const o=lP(t.initSegment.data);if(o.length){let c=o[0];c.some(f=>f!==0)?(this.log(`Using keyId found in init segment ${Es(c)}`),kr.setKeyIdForUri(e.decryptdata.uri,c)):(c=kr.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${Es(c)}`)),e.decryptdata.keyId=c}}if(!e.decryptdata.keyId&&!Ut(t))return Promise.resolve(i);const a=this.emeController.loadKey(i);return(e.keyLoadPromise=a.then(o=>(e.mediaKeySessionContext=o,i))).catch(o=>{throw e.keyLoadPromise=null,"data"in o&&(o.data.frag=t),o})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,n=i.loader,a=new n(i);return t.keyLoader=e.loader=a,e.keyLoadPromise=new Promise((o,c)=>{const f={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=i.keyLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,T,y,S)=>{const{frag:A,keyInfo:R}=y,C=ug(R.decryptdata);if(!A.decryptdata||R!==this.keyIdToKeyInfo[C])return c(this.createKeyLoadError(A,Q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),S));R.decryptdata.key=A.decryptdata.key=new Uint8Array(p.data),A.keyLoader=null,R.loader=null,o({frag:A,keyInfo:R})},onError:(p,T,y,S)=>{this.resetLoader(T),c(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),y,dt({url:f.url,data:void 0},p)))},onTimeout:(p,T,y)=>{this.resetLoader(T),c(this.createKeyLoadError(t,Q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),y))},onAbort:(p,T,y)=>{this.resetLoader(T),c(this.createKeyLoadError(t,Q.INTERNAL_ABORTED,new Error("key loading aborted"),y))}};a.load(f,m,g)})}resetLoader(e){const{frag:t,keyInfo:i,url:n}=e,a=i.loader;t.keyLoader===a&&(t.keyLoader=null,i.loader=null);const o=ug(i.decryptdata)||n;delete this.keyIdToKeyInfo[o],a&&a.destroy()}}function ug(s){if(s.keyFormat!==ys.FAIRPLAY){const e=s.keyId;if(e)return Es(e)}return s.uri}function J2(s){const{type:e}=s;switch(e){case Ge.AUDIO_TRACK:return _e.AUDIO;case Ge.SUBTITLE_TRACK:return _e.SUBTITLE;default:return _e.MAIN}}function og(s,e){let t=s.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class VF{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(L.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(L.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,n=t.loader,a=i||n,o=new a(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ge.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:i,level:n,pathwayId:a,url:o,deliveryDirectives:c,levelInfo:f}=t;this.load({id:i,level:n,pathwayId:a,responseType:"text",type:Ge.LEVEL,url:o,deliveryDirectives:c,levelOrTrack:f})}onAudioTrackLoading(e,t){const{id:i,groupId:n,url:a,deliveryDirectives:o,track:c}=t;this.load({id:i,groupId:n,level:null,responseType:"text",type:Ge.AUDIO_TRACK,url:a,deliveryDirectives:o,levelOrTrack:c})}onSubtitleTrackLoading(e,t){const{id:i,groupId:n,url:a,deliveryDirectives:o,track:c}=t;this.load({id:i,groupId:n,level:null,responseType:"text",type:Ge.SUBTITLE_TRACK,url:a,deliveryDirectives:o,levelOrTrack:c})}onLevelsUpdated(e,t){const i=this.loaders[Ge.LEVEL];if(i){const n=i.context;n&&!t.levels.some(a=>a===n.levelOrTrack)&&(i.abort(),delete this.loaders[Ge.LEVEL])}}load(e){var t;const i=this.hls.config;let n=this.getInternalLoader(e);if(n){const d=this.hls.logger,m=n.context;if(m&&m.levelOrTrack===e.levelOrTrack&&(m.url===e.url||m.deliveryDirectives&&!e.deliveryDirectives)){m.url===e.url?d.log(`[playlist-loader]: ignore ${e.url} ongoing request`):d.log(`[playlist-loader]: ignore ${e.url} in favor of ${m.url}`);return}d.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),n.abort()}let a;if(e.type===Ge.MANIFEST?a=i.manifestLoadPolicy.default:a=bt({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),n=this.createInternalLoader(e),Se((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===Ge.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===Ge.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===Ge.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const m=d.partTarget,g=d.targetduration;if(m&&g){const p=Math.max(m*3,g*.8)*1e3;a=bt({},a,{maxTimeToFirstByteMs:Math.min(p,a.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,a.maxTimeToFirstByteMs)})}}}const o=a.errorRetry||a.timeoutRetry||{},c={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},f={onSuccess:(d,m,g,p)=>{const T=this.getInternalLoader(g);this.resetInternalLoader(g.type);const y=d.data;m.parsing.start=performance.now(),rn.isMediaPlaylist(y)||g.type!==Ge.MANIFEST?this.handleTrackOrLevelPlaylist(d,m,g,p||null,T):this.handleMasterPlaylist(d,m,g,p)},onError:(d,m,g,p)=>{this.handleNetworkError(m,g,!1,d,p)},onTimeout:(d,m,g)=>{this.handleNetworkError(m,g,!0,void 0,d)}};n.load(e,c,f)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:i}=this.hls;(e||i)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,i,n){const a=this.hls,o=e.data,c=og(e,i),f=rn.parseMasterPlaylist(o,c);if(f.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,i,f.playlistParsingError,n,t);return}const{contentSteering:d,levels:m,sessionData:g,sessionKeys:p,startTimeOffset:T,variableList:y}=f;this.variableList=y,m.forEach(C=>{const{unknownCodecs:I}=C;if(I){const{preferManagedMediaSource:D}=this.hls.config;let{audioCodec:k,videoCodec:z}=C;for(let P=I.length;P--;){const V=I[P];_l(V,"audio",D)?(C.audioCodec=k=k?`${k},${V}`:V,ju.audio[k.substring(0,4)]=2,I.splice(P,1)):_l(V,"video",D)&&(C.videoCodec=z=z?`${z},${V}`:V,ju.video[z.substring(0,4)]=2,I.splice(P,1))}}});const{AUDIO:S=[],SUBTITLES:A,"CLOSED-CAPTIONS":R}=rn.parseMasterPlaylistMedia(o,c,f);S.length&&!S.some(I=>!I.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),S.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Rt({}),bitrate:0,url:""})),a.trigger(L.MANIFEST_LOADED,{levels:m,audioTracks:S,subtitles:A,captions:R,contentSteering:d,url:c,stats:t,networkDetails:n,sessionData:g,sessionKeys:p,startTimeOffset:T,variableList:y})}handleTrackOrLevelPlaylist(e,t,i,n,a){const o=this.hls,{id:c,level:f,type:d}=i,m=og(e,i),g=Se(f)?f:Se(c)?c:0,p=J2(i),T=rn.parseLevelPlaylist(e.data,m,g,p,0,this.variableList);if(d===Ge.MANIFEST){const y={attrs:new Rt({}),bitrate:0,details:T,name:"",url:m};T.requestScheduled=t.loading.start+a3(T,0),o.trigger(L.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:m,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=T,this.handlePlaylistLoaded(T,e,t,i,n,a)}handleManifestParsingError(e,t,i,n,a){this.hls.trigger(L.ERROR,{type:Ie.NETWORK_ERROR,details:Q.MANIFEST_PARSING_ERROR,fatal:t.type===Ge.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:n,stats:a})}handleNetworkError(e,t,i=!1,n,a){let o=`A network ${i?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${e.type}`;e.type===Ge.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===Ge.AUDIO_TRACK||e.type===Ge.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let f=Q.UNKNOWN,d=!1;const m=this.getInternalLoader(e);switch(e.type){case Ge.MANIFEST:f=i?Q.MANIFEST_LOAD_TIMEOUT:Q.MANIFEST_LOAD_ERROR,d=!0;break;case Ge.LEVEL:f=i?Q.LEVEL_LOAD_TIMEOUT:Q.LEVEL_LOAD_ERROR,d=!1;break;case Ge.AUDIO_TRACK:f=i?Q.AUDIO_TRACK_LOAD_TIMEOUT:Q.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case Ge.SUBTITLE_TRACK:f=i?Q.SUBTITLE_TRACK_LOAD_TIMEOUT:Q.SUBTITLE_LOAD_ERROR,d=!1;break}m&&this.resetInternalLoader(e.type);const g={type:Ie.NETWORK_ERROR,details:f,fatal:d,url:e.url,loader:m,context:e,error:c,networkDetails:t,stats:a};if(n){const p=(t==null?void 0:t.url)||e.url;g.response=dt({url:p,data:void 0},n)}this.hls.trigger(L.ERROR,g)}handlePlaylistLoaded(e,t,i,n,a,o){const c=this.hls,{type:f,level:d,levelOrTrack:m,id:g,groupId:p,deliveryDirectives:T}=n,y=og(t,n),S=J2(n);let A=typeof n.level=="number"&&S===_e.MAIN?d:void 0;const R=e.playlistParsingError;if(R){if(this.hls.logger.warn(`${R} ${e.url}`),!c.config.ignorePlaylistParsingErrors){c.trigger(L.ERROR,{type:Ie.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:R,reason:R.message,response:t,context:n,level:A,parent:S,networkDetails:a,stats:i});return}e.playlistParsingError=null}if(!e.fragments.length){const C=e.playlistParsingError=new Error("No Segments found in Playlist");c.trigger(L.ERROR,{type:Ie.NETWORK_ERROR,details:Q.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:C,reason:C.message,response:t,context:n,level:A,parent:S,networkDetails:a,stats:i});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),f){case Ge.MANIFEST:case Ge.LEVEL:if(A){if(!m)A=0;else if(m!==c.levels[A]){const C=c.levels.indexOf(m);C>-1&&(A=C)}}c.trigger(L.LEVEL_LOADED,{details:e,levelInfo:m||c.levels[0],level:A||0,id:g||0,stats:i,networkDetails:a,deliveryDirectives:T,withoutMultiVariant:f===Ge.MANIFEST});break;case Ge.AUDIO_TRACK:c.trigger(L.AUDIO_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:p||"",stats:i,networkDetails:a,deliveryDirectives:T});break;case Ge.SUBTITLE_TRACK:c.trigger(L.SUBTITLE_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:p||"",stats:i,networkDetails:a,deliveryDirectives:T});break}}}class Fn{static get version(){return Il}static isMSESupported(){return r_()}static isSupported(){return HF()}static getMediaSource(){return Mr()}static get Events(){return L}static get MetadataSchema(){return li}static get ErrorTypes(){return Ie}static get ErrorDetails(){return Q}static get DefaultConfig(){return Fn.defaultConfig?Fn.defaultConfig:IF}static set DefaultConfig(e){Fn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Jp,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=WM(e.debug||!1,"Hls instance",e.assetPlayerId),i=this.config=NF(Fn.DefaultConfig,e,t);this.userConfig=e,i.progressive&&DF(i,t);const{abrController:n,bufferController:a,capLevelController:o,errorController:c,fpsController:f}=i,d=new c(this),m=this.abrController=new n(this),g=new zP(this),p=i.interstitialsController,T=p?this.interstitialsController=new p(this,Fn):null,y=this.bufferController=new a(this,g),S=this.capLevelController=new o(this),A=new f(this),R=new VF(this),C=i.contentSteeringController,I=C?new C(this):null,D=this.levelController=new FF(this,I),k=new UF(this),z=new qF(this.config,this.logger),P=this.streamController=new GF(this,g,z),V=this.gapController=new MF(this,g);S.setStreamController(P),A.setStreamController(P);const $=[R,D,P];T&&$.splice(1,0,T),I&&$.splice(1,0,I),this.networkControllers=$;const j=[m,y,V,S,A,k,g];this.audioTrackController=this.createController(i.audioTrackController,$);const te=i.audioStreamController;te&&$.push(this.audioStreamController=new te(this,g,z)),this.subtitleTrackController=this.createController(i.subtitleTrackController,$);const ge=i.subtitleStreamController;ge&&$.push(this.subtititleStreamController=new ge(this,g,z)),this.createController(i.timelineController,j),z.emeController=this.emeController=this.createController(i.emeController,j),this.cmcdController=this.createController(i.cmcdController,j),this.latencyController=this.createController(BF,j),this.coreComponents=j,$.push(d);const ye=d.onErrorOut;typeof ye=="function"&&this.on(L.ERROR,ye,d),this.on(L.MANIFEST_LOADED,R.onManifestLoaded,R)}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,n){this._emitter.off(e,t,i,n)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(i){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const n=e===L.ERROR;this.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:n,event:e,error:i}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(L.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const a=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(L.ERROR,{type:Ie.OTHER_ERROR,details:Q.ATTACH_MEDIA_ERROR,fatal:!0,error:a});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,i=t?e.media:e,n=t?e:{media:i};this._media=i,this.trigger(L.MEDIA_ATTACHING,n)}detachMedia(){this.logger.log("detachMedia"),this.trigger(L.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(L.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,i=this._url,n=this._url=$p.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${n}`),t&&i&&(i!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(L.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(e,t),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[_e.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[_e.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[_e.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=MB()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){NP(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let n=0;n<i;n++)if(e[n].maxBitrate>=t)return n;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let n;if(t===-1&&e!=null&&e.length?n=e.length-1:n=t,i)for(let a=n;a--;){const o=e[a].attrs["HDCP-LEVEL"];if(o&&o<=i)return a}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const i=VA(t);return GA(e,i,navigator.mediaCapabilities)}}Fn.defaultConfig=void 0;const zF=({src:s,poster:e})=>{const t=U.useRef(null);return U.useEffect(()=>{const i=t.current;if(!i)return;let n=null;return Fn.isSupported()?(n=new Fn,n.loadSource(s),n.attachMedia(i)):i.canPlayType("application/vnd.apple.mpegurl")&&(i.src=s),()=>{n&&n.destroy()}},[s]),E.jsx("div",{className:"relative w-full aspect-video bg-black rounded-xl overflow-hidden shadow-2xl border border-white/10",children:E.jsx("video",{ref:t,poster:e,controls:!0,className:"w-full h-full object-contain",playsInline:!0})})},YF="https://iptv-org.github.io/iptv",ev={getChannelsByCategory:async s=>{try{if(s==="xxx")return KF();const e=await ut.get(`${YF}/categories/${s}.m3u`);return QF(e.data,s)}catch(e){return console.error(`Failed to fetch channels for category: ${s}`,e),[]}},getAllCategories:()=>[{id:"movies",name:"Movies"},{id:"news",name:"News"},{id:"music",name:"Music"},{id:"sport",name:"Sports"},{id:"documentary",name:"Documentary"},{id:"kids",name:"Kids"},{id:"family",name:"Family"},{id:"education",name:"Education"},{id:"entertainment",name:"Entertainment"},{id:"lifestyle",name:"Lifestyle"},{id:"xxx",name:"Adult 18+"}]},KF=async()=>{const s=[];try{const t=await ut.get("https://www.eporner.com/api/v2/video/search/",{params:{query:"",per_page:30,page:1,thumbsize:"medium",order:"top-weekly",format:"json"},timeout:5e3});if(t.data&&t.data.videos){const i=t.data.videos.map((n,a)=>{var o;return{id:`eporner-${n.id||a}`,name:n.title||`Adult Video ${a+1}`,logo:((o=n.default_thumb)==null?void 0:o.src)||"",url:n.embed||n.url||"#",category:"xxx"}});s.push(...i)}}catch(t){console.log("Failed to fetch Eporner videos, using fallback channels...",t)}const e=[{id:"adult-1",name:"RedTraffic Big Ass",logo:"",url:"http://live.redtraffic.xyz/bigass.m3u8",category:"xxx"},{id:"adult-2",name:"RedTraffic Big Dick",logo:"",url:"http://live.redtraffic.xyz/bigdick.m3u8",category:"xxx"},{id:"adult-3",name:"RedTraffic Big Tits",logo:"",url:"http://live.redtraffic.xyz/bigtits.m3u8",category:"xxx"},{id:"adult-4",name:"RedTraffic Blowjob",logo:"",url:"http://live.redtraffic.xyz/blowjob.m3u8",category:"xxx"},{id:"adult-5",name:"RedTraffic Cuckold",logo:"",url:"http://live.redtraffic.xyz/cuckold.m3u8",category:"xxx"},{id:"adult-6",name:"RedTraffic Fetish",logo:"",url:"http://live.redtraffic.xyz/fetish.m3u8",category:"xxx"},{id:"adult-7",name:"RedTraffic Hardcore",logo:"",url:"http://live.redtraffic.xyz/hardcore.m3u8",category:"xxx"},{id:"adult-8",name:"RedTraffic Interracial",logo:"",url:"http://live.redtraffic.xyz/interracial.m3u8",category:"xxx"},{id:"adult-9",name:"RedTraffic Latina",logo:"",url:"http://live.redtraffic.xyz/latina.m3u8",category:"xxx"},{id:"adult-10",name:"RedTraffic Lesbian",logo:"",url:"http://live.redtraffic.xyz/lesbian.m3u8",category:"xxx"},{id:"adult-11",name:"RedTraffic MILF",logo:"",url:"http://live.redtraffic.xyz/milf.m3u8",category:"xxx"},{id:"adult-12",name:"RedTraffic Pornstar",logo:"",url:"http://live.redtraffic.xyz/pornstar.m3u8",category:"xxx"},{id:"adult-13",name:"RedTraffic POV",logo:"",url:"http://live.redtraffic.xyz/pov.m3u8",category:"xxx"},{id:"adult-14",name:"RedTraffic Russian",logo:"",url:"http://live.redtraffic.xyz/russian.m3u8",category:"xxx"},{id:"adult-15",name:"RedTraffic Teen",logo:"",url:"http://live.redtraffic.xyz/teen.m3u8",category:"xxx"},{id:"adult-16",name:"RedTraffic Threesome",logo:"",url:"http://live.redtraffic.xyz/threesome.m3u8",category:"xxx"}];return s.push(...e),s},QF=(s,e)=>{const t=s.split(`
`),i=[];let n={};return t.forEach(a=>{if(a=a.trim(),a.startsWith("#EXTINF:")){const o=a.substring(8),c=o.split(","),f=c[c.length-1].trim(),d=o.match(/tvg-logo="([^"]*)"/),m=d?d[1]:"",g=o.match(/tvg-id="([^"]*)"/);n={id:g?g[1]:`ch-${i.length}`,name:f,logo:m,category:e}}else a.startsWith("http")&&n.name&&(i.push({...n,url:a}),n={})}),i},XF=()=>{const[s]=U.useState(ev.getAllCategories()),[e,t]=U.useState("movies"),[i,n]=U.useState([]),[a,o]=U.useState(null),[c,f]=U.useState(!0),[d,m]=U.useState("");U.useEffect(()=>{(async()=>{f(!0),n([]);try{const T=await ev.getChannelsByCategory(e);n(T),T.length>0?o(T[0]):o(null)}catch(T){console.error("Failed to load channels",T)}finally{f(!1)}})()},[e]);const g=U.useMemo(()=>i.filter(p=>p.name.toLowerCase().includes(d.toLowerCase())),[i,d]);return E.jsx("div",{className:"min-h-screen bg-background pt-24 pb-20 px-4",children:E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[E.jsx(uS,{className:"text-primary w-8 h-8 animate-pulse"}),E.jsx("h1",{className:"text-3xl font-bold text-text",children:"Global Live TV"})]}),E.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[E.jsx("div",{className:"flex-1 order-2 lg:order-1",children:a?E.jsxs(E.Fragment,{children:[E.jsx(zF,{src:a.url,poster:a.logo}),E.jsxs("div",{className:"mt-4 p-4 bg-surface rounded-xl border border-white/10 flex items-center gap-4",children:[E.jsxs("div",{className:"w-16 h-16 bg-white/5 rounded-lg p-2 flex items-center justify-center overflow-hidden",children:[a.logo?E.jsx("img",{src:a.logo,alt:a.name,className:"max-w-full max-h-full object-contain",onError:p=>{var T;p.currentTarget.style.display="none",(T=p.currentTarget.nextElementSibling)==null||T.classList.remove("hidden")}}):null,E.jsx(bl,{size:32,className:`text-text-muted ${a.logo?"hidden":""}`})]}),E.jsxs("div",{children:[E.jsx("h2",{className:"text-2xl font-bold text-text",children:a.name}),E.jsxs("p",{className:"text-text-muted mt-1 capitalize",children:[a.category,"  Live Stream"]})]})]})]}):E.jsx("div",{className:"aspect-video bg-black/50 rounded-xl flex items-center justify-center border border-white/10",children:E.jsx("p",{className:"text-text-muted",children:"Select a channel to start watching"})})}),E.jsxs("div",{className:"w-full lg:w-96 flex-shrink-0 order-1 lg:order-2 flex flex-col gap-6",children:[E.jsxs("div",{className:"bg-surface p-4 rounded-xl border border-white/10",children:[E.jsx("h3",{className:"text-sm font-bold text-text-muted uppercase mb-3",children:"Categories"}),E.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(p=>E.jsx("button",{onClick:()=>t(p.id),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-colors ${e===p.id?"bg-primary text-black":"bg-background text-text-muted hover:bg-white/10 hover:text-text"}`,children:p.name},p.id))})]}),E.jsxs("div",{className:"bg-surface p-4 rounded-xl border border-white/10 flex-1 min-h-[500px] flex flex-col",children:[E.jsx("div",{className:"mb-4",children:E.jsxs("div",{className:"relative",children:[E.jsx(Bu,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",size:18}),E.jsx("input",{type:"text",placeholder:"Search channels...",value:d,onChange:p=>m(p.target.value),className:"w-full bg-background border border-white/10 rounded-lg pl-10 pr-4 py-2 text-text focus:outline-none focus:border-primary/50"})]})}),E.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2 max-h-[600px] custom-scrollbar",children:c?E.jsx("div",{className:"flex justify-center py-10",children:E.jsx(Gn,{className:"animate-spin text-primary"})}):g.length>0?g.map(p=>E.jsxs("button",{onClick:()=>o(p),className:`w-full flex items-center gap-3 p-3 rounded-lg transition-all text-left ${(a==null?void 0:a.url)===p.url?"bg-primary text-black font-bold shadow-lg shadow-primary/20":"bg-background text-text-muted hover:bg-white/10 hover:text-text"}`,children:[E.jsxs("div",{className:"w-10 h-10 bg-white/10 rounded-full flex items-center justify-center overflow-hidden p-1 flex-shrink-0",children:[p.logo?E.jsx("img",{src:p.logo,alt:p.name,className:"w-full h-full object-contain",onError:T=>{var y;T.currentTarget.style.display="none",(y=T.currentTarget.nextElementSibling)==null||y.classList.remove("hidden")}}):null,E.jsx(bl,{size:18,className:`text-text-muted ${p.logo?"hidden":""}`})]}),E.jsx("span",{className:"truncate",children:p.name}),(a==null?void 0:a.url)===p.url&&E.jsx("div",{className:"ml-auto w-2 h-2 bg-red-500 rounded-full animate-pulse flex-shrink-0"})]},`${p.id}-${p.url}`)):E.jsx("div",{className:"text-center py-10 text-text-muted",children:E.jsx("p",{children:"No channels found"})})})]})]})]})]})})},WF=()=>{const{actorId:s}=wf(),[e,t]=U.useState(null),[i,n]=U.useState(null),[a,o]=U.useState(null),[c,f]=U.useState("movies"),[d,m]=U.useState(!0),[g,p]=U.useState(null);if(U.useEffect(()=>{(async()=>{if(s){m(!0),p(null);try{const[A,R,C]=await Promise.all([Ve.getActorDetails(s),Ve.getActorMovieCredits(s),Ve.getActorTVCredits(s)]);t(A),n(R),o(C)}catch(A){console.error(A),p("Failed to load actor details.")}finally{m(!1)}}})()},[s]),d)return E.jsx("div",{className:"min-h-screen flex items-center justify-center",children:E.jsxs("div",{className:"flex flex-col items-center gap-4",children:[E.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin"}),E.jsx("p",{className:"text-primary font-medium",children:"Loading actor details..."})]})});if(g)return E.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center text-red-500 gap-4",children:[E.jsx("p",{className:"text-xl",children:g}),E.jsx(xt,{to:"/",className:"px-4 py-2 bg-primary text-black rounded hover:bg-blue-400",children:"Go Home"})]});if(!e)return E.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Actor not found"});const T=(i==null?void 0:i.cast.sort((S,A)=>(A.popularity||0)-(S.popularity||0)))||[],y=(a==null?void 0:a.cast.map(S=>({...S,title:S.name,release_date:S.first_air_date})).sort((S,A)=>(A.popularity||0)-(S.popularity||0)))||[];return E.jsx("div",{className:"min-h-screen bg-background pb-20",children:E.jsx("div",{className:"relative bg-gradient-to-b from-surface to-background",children:E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 md:px-8 py-8",children:[E.jsxs(xt,{to:"/",className:"inline-flex items-center gap-2 text-gray-400 hover:text-primary transition-colors mb-6",children:[E.jsx(nS,{size:20})," Back"]}),E.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[E.jsx("div",{className:"w-64 md:w-80 flex-shrink-0 mx-auto md:mx-0",children:E.jsx("div",{className:"aspect-[2/3] rounded-2xl overflow-hidden shadow-2xl border border-white/10",children:E.jsx("img",{src:Ve.getImageUrl(e.profile_path,"original"),alt:e.name,className:"w-full h-full object-cover"})})}),E.jsxs("div",{className:"flex gap-4 mb-8 border-b border-white/10",children:[E.jsxs("button",{onClick:()=>f("movies"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 ${c==="movies"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text"}`,children:[E.jsx(xg,{size:20}),"Movies (",T.length,")"]}),E.jsxs("button",{onClick:()=>f("tv"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 ${c==="tv"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text"}`,children:[E.jsx(bl,{size:20}),"TV Shows (",y.length,")"]})]}),E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:(c==="movies"?T:y).map(S=>E.jsx("div",{className:"transform transition-transform hover:-translate-y-1",children:E.jsx(xt,{to:`/${c==="movies"?"movies":"webseries"}/${S.id}`,className:"group relative block",children:E.jsxs("div",{className:"relative bg-surface backdrop-blur-xl rounded-2xl overflow-hidden border border-white/10 transition-all duration-500 hover:shadow-2xl hover:shadow-primary/20 hover:border-primary/30",children:[E.jsxs("div",{className:"relative aspect-[2/3] w-full overflow-hidden",children:[E.jsx("img",{src:Ve.getImageUrl(S.poster_path),alt:S.title||S.name,loading:"lazy",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent opacity-60 group-hover:opacity-80 transition-opacity duration-300"}),S.vote_average>0&&E.jsxs("div",{className:"absolute bottom-2 right-2 flex items-center gap-1 px-2 py-1 bg-black/60 backdrop-blur-md rounded-full border border-yellow-500/30",children:[E.jsx(Ns,{size:10,className:"fill-yellow-400 text-yellow-400"}),E.jsx("span",{className:"text-yellow-400 text-xs font-bold",children:S.vote_average.toFixed(1)})]})]}),E.jsxs("div",{className:"p-3",children:[E.jsx("h3",{className:"text-sm font-bold text-text line-clamp-2 group-hover:text-primary transition-colors",children:S.title||S.name}),(S.release_date||S.first_air_date)&&E.jsx("p",{className:"text-xs text-text-muted mt-1",children:new Date(S.release_date||S.first_air_date||"").getFullYear()})]})]})})},S.id))}),c==="movies"&&T.length===0&&E.jsxs("div",{className:"text-center py-20 text-gray-500",children:[E.jsx(xg,{size:48,className:"mx-auto mb-4 opacity-50"}),E.jsx("p",{children:"No movies found"})]}),c==="tv"&&y.length===0&&E.jsxs("div",{className:"text-center py-20 text-gray-500",children:[E.jsx(bl,{size:48,className:"mx-auto mb-4 opacity-50"}),E.jsx("p",{children:"No TV shows found"})]})]})]})})})},ZF=()=>{const[s,e]=U.useState(""),[t,i]=U.useState(""),[n,a]=U.useState(!1),[o,c]=U.useState(""),[f,d]=U.useState(!1),{login:m,isAuthenticated:g}=jl();U.useEffect(()=>{o&&c("")},[s,t]);const p=async T=>{T.preventDefault(),c(""),d(!0);try{await m(s,t)}catch(y){c(y.message||"Login failed. Please try again.")}finally{d(!1)}};return g?E.jsx(lp,{to:"/",replace:!0}):E.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 via-red-900 to-black px-4",children:[E.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[E.jsx("div",{className:"absolute -top-1/2 -left-1/2 w-full h-full bg-purple-500/10 rounded-full blur-3xl animate-pulse"}),E.jsx("div",{className:"absolute -bottom-1/2 -right-1/2 w-full h-full bg-pink-500/10 rounded-full blur-3xl animate-pulse delay-1000"})]}),E.jsxs("div",{className:"relative w-full max-w-md",children:[E.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-xl rounded-2xl shadow-2xl border border-gray-700/50 overflow-hidden",children:[E.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 p-8 text-center",children:[E.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white/20 rounded-full mb-4",children:E.jsx(Su,{className:"w-8 h-8 text-white"})}),E.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back"}),E.jsx("p",{className:"text-purple-100",children:"Sign in to access CineStream Pro"})]}),E.jsx("div",{className:"p-8 bg-surface",children:E.jsxs("form",{onSubmit:p,className:"space-y-6",children:[o&&E.jsxs("div",{className:"bg-red-500/10 border border-red-500/50 rounded-lg p-4 flex items-start gap-3 animate-shake",children:[E.jsx(rS,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),E.jsx("p",{className:"text-red-400 text-sm",children:o})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-text-muted mb-2",children:"Username "}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(of,{className:"w-5 h-5 text-text-muted"})}),E.jsx("input",{id:"username",type:"text",value:s,onChange:T=>e(T.target.value),className:"w-full pl-10 pr-4 py-3 bg-background border border-white/10 rounded-lg text-text placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"Enter your username",required:!0,autoComplete:"username",disabled:f})]})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-text-muted mb-2",children:"Password "}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(Su,{className:"w-5 h-5 text-text-muted"})}),E.jsx("input",{id:"password",type:n?"text":"password",value:t,onChange:T=>i(T.target.value),className:"w-full pl-10 pr-12 py-3 bg-background border border-white/10 rounded-lg text-text placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:f}),E.jsx("button",{type:"button",onClick:()=>a(!n),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-text-muted hover:text-text transition",disabled:f,children:n?E.jsx(LN,{className:"w-5 h-5"}):E.jsx(xu,{className:"w-5 h-5"})})]})]}),E.jsx("button",{type:"submit",disabled:f,className:"w-full py-3 px-4 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:f?E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}),E.jsx("span",{children:"Signing in..."})]}):E.jsxs(E.Fragment,{children:[E.jsx(Su,{className:"w-5 h-5"}),E.jsx("span",{children:"Sign In"})]})})]})})]}),E.jsx("p",{className:"text-center text-white/60 text-sm mt-6",children:" 2025 CineStream Pro. All rights reserved."}),E.jsxs("span",{className:"flex justify-center text-center text-white/60 text-sm mt-6",children:["Designed and Developed by",E.jsx("span",{className:"text-[#F5B027] ml-2",children:" K Mahesh Kumar Achary "})]})]})]})},JF=()=>{const{user:s,logout:e}=jl(),[t,i]=U.useState([]),[n,a]=U.useState(!0),[o,c]=U.useState(""),[f,d]=U.useState(!1),[m,g]=U.useState(!1),[p,T]=U.useState(null),[y,S]=U.useState(null),[A,R]=U.useState(""),[C,I]=U.useState(""),[D,k]=U.useState("user"),[z,P]=U.useState("");U.useEffect(()=>{V()},[]);const V=async()=>{try{a(!0);const ue=await xr.getAllUsers();ue.success&&i(ue.data.users)}catch{$("error","Failed to fetch users")}finally{a(!1)}},$=(ue,F)=>{S({type:ue,message:F}),setTimeout(()=>S(null),5e3)},j=async ue=>{var F,J;ue.preventDefault();try{(await xr.createUser(A,C,D)).success&&($("success","User created successfully"),d(!1),R(""),I(""),k("user"),V())}catch(se){$("error",((J=(F=se.response)==null?void 0:F.data)==null?void 0:J.message)||"Failed to create user")}},te=async ue=>{var F,J;if(confirm("Are you sure you want to delete this user?"))try{(await xr.deleteUser(ue)).success&&($("success","User deleted successfully"),V())}catch(se){$("error",((J=(F=se.response)==null?void 0:F.data)==null?void 0:J.message)||"Failed to delete user")}},ge=async(ue,F)=>{var J,se;try{(F?await xr.unblockUser(ue):await xr.blockUser(ue)).success&&($("success",F?"User unblocked":"User blocked"),V())}catch(ne){$("error",((se=(J=ne.response)==null?void 0:J.data)==null?void 0:se.message)||"Failed to update user")}},ye=async ue=>{var F,J;if(ue.preventDefault(),!!p)try{(await xr.resetPassword(p.id,z)).success&&($("success","Password reset successfully"),g(!1),P(""),T(null))}catch(se){$("error",((J=(F=se.response)==null?void 0:F.data)==null?void 0:J.message)||"Failed to reset password")}},ve=t.filter(ue=>ue.username.toLowerCase().includes(o.toLowerCase()));return E.jsxs("div",{className:"min-h-screen bg-background",children:[E.jsx("div",{className:"bg-surface/50 backdrop-blur-xl border-b border-white/10",children:E.jsx("div",{className:"w-full max-w-[2000px] mx-auto px-4 sm:px-6 lg:px-8 py-6",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("div",{className:"p-3 bg-primary rounded-xl",children:E.jsx(af,{className:"w-8 h-8 text-white"})}),E.jsxs("div",{children:[E.jsx("h1",{className:"text-3xl font-bold text-text",children:"Admin Dashboard"}),E.jsx("p",{className:"text-text-muted",children:"Manage users and system settings"})]})]}),E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsxs("div",{className:"text-right",children:[E.jsx("p",{className:"text-sm text-text-muted",children:"Logged in as"}),E.jsx("p",{className:"text-text font-semibold",children:s==null?void 0:s.username})]}),E.jsx("button",{onClick:e,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition",children:"Logout"})]})]})})}),y&&E.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-md animate-slide-in",children:E.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg shadow-lg ${y.type==="success"?"bg-green-500/20 border border-green-500/50":"bg-red-500/20 border border-red-500/50"}`,children:[y.type==="success"?E.jsx(Xx,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}):E.jsx(rS,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),E.jsx("p",{className:y.type==="success"?"text-green-400":"text-red-400",children:y.message})]})}),E.jsxs("div",{className:"w-full max-w-[2000px] mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[E.jsx("div",{className:"bg-surface/50 backdrop-blur-xl rounded-xl p-6 border border-white/10",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{children:[E.jsx("p",{className:"text-text-muted text-sm",children:"Total Users"}),E.jsx("p",{className:"text-3xl font-bold text-text mt-1",children:t.length})]}),E.jsx(Jx,{className:"w-12 h-12 text-primary"})]})}),E.jsx("div",{className:"bg-surface/50 backdrop-blur-xl rounded-xl p-6 border border-white/10",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{children:[E.jsx("p",{className:"text-text-muted text-sm",children:"Active Users"}),E.jsx("p",{className:"text-3xl font-bold text-text mt-1",children:t.filter(ue=>!ue.isBlocked).length})]}),E.jsx(Xx,{className:"w-12 h-12 text-green-500"})]})}),E.jsx("div",{className:"bg-surface/50 backdrop-blur-xl rounded-xl p-6 border border-white/10",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{children:[E.jsx("p",{className:"text-text-muted text-sm",children:"Blocked Users"}),E.jsx("p",{className:"text-3xl font-bold text-text mt-1",children:t.filter(ue=>ue.isBlocked).length})]}),E.jsx(Su,{className:"w-12 h-12 text-red-500"})]})})]}),E.jsx("div",{className:"bg-surface/50 backdrop-blur-xl rounded-xl p-6 border border-white/10 mb-6",children:E.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[E.jsxs("div",{className:"relative flex-1 w-full sm:max-w-md",children:[E.jsx(Bu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-text-muted"}),E.jsx("input",{type:"text",value:o,onChange:ue=>c(ue.target.value),placeholder:"Search users...",className:"w-full pl-10 pr-4 py-2 bg-background border border-white/10 rounded-lg text-text placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-primary"})]}),E.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary hover:bg-blue-600 text-black font-bold rounded-lg transition transform hover:scale-105",children:[E.jsx(i4,{className:"w-5 h-5"}),E.jsx("span",{children:"Add User"})]})]})}),E.jsx("div",{className:"bg-surface/50 backdrop-blur-xl rounded-xl border border-white/10 overflow-hidden",children:n?E.jsxs("div",{className:"p-12 text-center",children:[E.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"}),E.jsx("p",{className:"text-text-muted mt-4",children:"Loading users..."})]}):ve.length===0?E.jsxs("div",{className:"p-12 text-center",children:[E.jsx(Jx,{className:"w-16 h-16 text-text-muted mx-auto mb-4"}),E.jsx("p",{className:"text-text-muted",children:"No users found"})]}):E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"w-full",children:[E.jsx("thead",{className:"bg-white/5",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"User"}),E.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"Role"}),E.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"Status"}),E.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"Created"}),E.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"Actions"})]})}),E.jsx("tbody",{className:"divide-y divide-white/10",children:ve.map(ue=>E.jsxs("tr",{className:"hover:bg-white/5 transition",children:[E.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:E.jsx(of,{className:"w-5 h-5 text-primary"})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-text font-medium",children:ue.username}),E.jsxs("p",{className:"text-text-muted text-sm",children:["ID: ",ue.id]})]})]})}),E.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:E.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${ue.role==="admin"?"bg-purple-500/20 text-purple-400":"bg-blue-500/20 text-blue-400"}`,children:ue.role})}),E.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:E.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${ue.isBlocked?"bg-red-500/20 text-red-400":"bg-green-500/20 text-green-400"}`,children:ue.isBlocked?"Blocked":"Active"})}),E.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-text-muted text-sm",children:new Date(ue.createdAt).toLocaleDateString()}),E.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("button",{onClick:()=>ge(ue.id,ue.isBlocked),disabled:ue.id===(s==null?void 0:s.id),className:`p-2 rounded-lg transition ${ue.isBlocked?"bg-green-600/20 hover:bg-green-600/30 text-green-400":"bg-red-600/20 hover:bg-red-600/30 text-red-400"} disabled:opacity-50 disabled:cursor-not-allowed`,title:ue.isBlocked?"Unblock":"Block",children:ue.isBlocked?E.jsx(UN,{className:"w-4 h-4"}):E.jsx(Su,{className:"w-4 h-4"})}),E.jsx("button",{onClick:()=>{T(ue),g(!0)},className:"p-2 bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 rounded-lg transition",title:"Reset Password",children:E.jsx(kN,{className:"w-4 h-4"})}),E.jsx("button",{onClick:()=>te(ue.id),disabled:ue.id===(s==null?void 0:s.id),className:"p-2 bg-red-600/20 hover:bg-red-600/30 text-red-400 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete User",children:E.jsx(uf,{className:"w-4 h-4"})})]})})]},ue.id))})]})})})]}),f&&E.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:E.jsxs("div",{className:"bg-surface rounded-2xl max-w-md w-full border border-white/10 shadow-2xl",children:[E.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[E.jsx("h2",{className:"text-2xl font-bold text-text",children:"Add New User"}),E.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-white/10 rounded-lg transition",children:E.jsx(El,{className:"w-5 h-5 text-text-muted"})})]}),E.jsxs("form",{onSubmit:j,className:"p-6 space-y-4",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"Username"}),E.jsx("input",{type:"text",value:A,onChange:ue=>R(ue.target.value),className:"w-full px-4 py-2 bg-background border border-white/10 rounded-lg text-text focus:outline-none focus:border-primary",required:!0,minLength:3,maxLength:30})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"Password"}),E.jsx("input",{type:"password",value:C,onChange:ue=>I(ue.target.value),className:"w-full px-4 py-2 bg-background border border-white/10 rounded-lg text-text focus:outline-none focus:border-primary",required:!0,minLength:8})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"Role"}),E.jsxs("select",{value:D,onChange:ue=>k(ue.target.value),className:"w-full px-4 py-2 bg-background border border-white/10 rounded-lg text-text focus:outline-none focus:border-primary",children:[E.jsx("option",{value:"user",children:"User"}),E.jsx("option",{value:"admin",children:"Admin"})]})]}),E.jsxs("div",{className:"flex gap-3 pt-4",children:[E.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 px-4 py-2 bg-surface hover:bg-white/10 text-text rounded-lg transition",children:"Cancel"}),E.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary text-black font-bold rounded-lg transition hover:bg-blue-400",children:"Create User"})]})]})]})}),m&&p&&E.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:E.jsxs("div",{className:"bg-surface rounded-2xl max-w-md w-full border border-white/10 shadow-2xl",children:[E.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[E.jsx("h2",{className:"text-2xl font-bold text-text",children:"Reset Password"}),E.jsx("button",{onClick:()=>{g(!1),T(null),P("")},className:"p-2 hover:bg-white/10 rounded-lg transition",children:E.jsx(El,{className:"w-5 h-5 text-text-muted"})})]}),E.jsxs("form",{onSubmit:ye,className:"p-6 space-y-4",children:[E.jsxs("p",{className:"text-text-muted",children:["Reset password for ",E.jsx("span",{className:"text-text font-semibold",children:p.username})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"New Password"}),E.jsx("input",{type:"password",value:z,onChange:ue=>P(ue.target.value),className:"w-full px-4 py-2 bg-background border border-white/10 rounded-lg text-text focus:outline-none focus:border-primary",required:!0,minLength:8})]}),E.jsxs("div",{className:"flex gap-3 pt-4",children:[E.jsx("button",{type:"button",onClick:()=>{g(!1),T(null),P("")},className:"flex-1 px-4 py-2 bg-surface hover:bg-white/10 text-text rounded-lg transition",children:"Cancel"}),E.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary text-black font-bold rounded-lg transition hover:bg-blue-400",children:"Reset Password"})]})]})]})}),E.jsx("style",{children:`
        @keyframes slide-in {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in {
          animation: slide-in 0.3s ease-out;
        }
      `})]})},e7=()=>E.jsx("footer",{className:"w-full py-8 mt-auto bg-gradient-to-t from-black to-transparent backdrop-blur-sm",children:E.jsxs("div",{className:"container mx-auto px-4 flex flex-col items-center justify-center gap-2",children:[E.jsx("div",{className:"flex items-center gap-2 text-gray-400 font-medium tracking-wide",children:E.jsx("span",{children:"Designed & Developed by"})}),E.jsx("h3",{className:"text-2xl md:text-3xl font-bold bg-gradient-to-r from-primary via-purple-500 to-secondary bg-clip-text text-transparent animate-pulse font-signature tracking-wider",children:"K Mahesh Kumar Achary"}),E.jsxs("div",{className:"flex items-center gap-2 text-gray-400 font-medium tracking-wide",children:[E.jsx("p",{children:"Made In India With "}),E.jsx(Tg,{className:"w-4 h-4",color:"red",fill:"red"})]})]})}),t7=new wI({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*30,retry:1,refetchOnWindowFocus:!1}}}),Gs=({children:s})=>E.jsxs("div",{className:"min-h-screen flex flex-col",children:[E.jsx(u4,{}),E.jsx("main",{className:"flex-grow",children:s}),E.jsx(e7,{})]}),s7=()=>(U.useEffect(()=>{RA()},[]),E.jsx(kI,{client:t7,children:E.jsx(XR,{children:E.jsx(cN,{children:E.jsx(dN,{children:E.jsxs(LR,{children:[E.jsx(as,{path:"/login",element:E.jsx(ZF,{})}),E.jsx(as,{path:"/",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(h4,{})})})}),E.jsx(as,{path:"/movies",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(FM,{})})})}),E.jsx(as,{path:"/webseries",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(HM,{})})})}),E.jsx(as,{path:"/livetv",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(XF,{})})})}),E.jsx(as,{path:"/favorites",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(jM,{})})})}),E.jsx(as,{path:"/history",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx($M,{})})})}),E.jsx(as,{path:"/search",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(BM,{})})})}),E.jsx(as,{path:"/genres",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(PT,{})})})}),E.jsx(as,{path:"/genres/:genreId",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(PT,{})})})}),E.jsx(as,{path:"/movies/:id",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(tT,{type:"movie"})})})}),E.jsx(as,{path:"/webseries/:id",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(tT,{type:"tv"})})})}),E.jsx(as,{path:"/watch/:movieId",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(PM,{})})})}),E.jsx(as,{path:"/actor/:actorId",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(WF,{})})})}),E.jsx(as,{path:"/adult/*",element:E.jsx(Fs,{children:E.jsx(Gs,{children:E.jsx(UM,{})})})}),E.jsx(as,{path:"/admin-dashboard",element:E.jsx(o4,{children:E.jsx(JF,{})})}),E.jsx(as,{path:"*",element:E.jsx("div",{className:"p-20 text-center text-white",children:"404 - Page Not Found"})})]})})})})})),a_=document.getElementById("root");if(!a_)throw new Error("Failed to find the root element");const i7=ML.createRoot(a_);i7.render(E.jsx(RL.StrictMode,{children:E.jsx(s7,{})}));
